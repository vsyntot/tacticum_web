{"version":3,"file":"entity-selector.bundle.js","sources":["../src/item/item-node-comparator.js","../src/common/text-node-type.js","../src/common/text-node.js","../src/search/highlighter.js","../src/item/item-badge.js","../src/search/search-field.js","../src/search/match-index.js","../src/search/match-field.js","../src/common/animation.js","../src/common/encode-url.js","../src/item/item-node.js","../src/search/search-field-index.js","../src/search/word-index.js","../src/search/unicode-words.js","../src/search/search-index.js","../src/entity/entity-filter.js","../src/entity/entity.js","../src/common/type-utils.js","../src/item/item.js","../src/dialog/tabs/base-stub.js","../src/dialog/tabs/default-stub.js","../src/dialog/header/base-header.js","../src/dialog/footer/base-footer.js","../src/dialog/tabs/tab.js","../src/entity/entity-error.js","../src/entity/entity-error-collection.js","../src/tag-selector/tag-item.js","../src/tag-selector/tag-selector.js","../src/dialog/navigation.js","../src/dialog/integration/slider-integration.js","../src/dialog/header/default-header.js","../src/dialog/footer/default-footer.js","../src/dialog/tabs/recent-tab.js","../src/search/match-result.js","../src/search/search-engine.js","../src/search/search-query.js","../src/dialog/tabs/search-loader.js","../src/dialog/footer/search-tab-footer.js","../src/dialog/tabs/search-tab.js","../src/dialog/dialog.js","../src/index.js"],"sourcesContent":["import { Type, Text } from 'main.core';\nimport type ItemNode from './item-node';\n\nexport default class ItemNodeComparator\n{\n\tstatic makeMultipleComparator(order: {[key: string]: 'asc' | 'desc'})\n\t{\n\t\tconst props = Object.keys(order).map(property => `get${Text.capitalize(property)}`);\n\n\t\t/*\n\t\tasc *\n\t\tasc nulls last *\n\t\tasc nulls first\n\n\t\tdesc *\n\t\tdesc nulls first *\n\t\tdesc nulls last\n\t\t*/\n\t\tconst directions: Array<{ ascOrdering: boolean, nullsOrdering: boolean }> = [];\n\n\t\tObject.values(order).forEach((element) => {\n\n\t\t\tconst direction = element.toLowerCase().trim();\n\n\t\t\t// Default sorting: 'asc' || 'asc nulls last'\n\t\t\tlet ascOrdering = true;\n\t\t\tlet nullsOrdering = true;\n\n\t\t\tif (direction === 'desc' || direction === 'desc nulls first')\n\t\t\t{\n\t\t\t\tascOrdering = false;\n\t\t\t}\n\t\t\telse if (direction === 'asc nulls first')\n\t\t\t{\n\t\t\t\tnullsOrdering = false;\n\t\t\t}\n\t\t\telse if (direction === 'desc nulls last')\n\t\t\t{\n\t\t\t\tascOrdering = false;\n\t\t\t\tnullsOrdering = false;\n\t\t\t}\n\n\t\t\tdirections.push({ ascOrdering, nullsOrdering });\n\t\t});\n\n\t\tconst numberOfProperties = props.length;\n\n\t\treturn (nodeA: ItemNode, nodeB : ItemNode) => {\n\t\t\tlet i = 0;\n\t\t\tlet result = 0;\n\n\t\t\twhile (result === 0 && i < numberOfProperties)\n\t\t\t{\n\t\t\t\tconst propertyGetter = props[i];\n\t\t\t\tconst direction = directions[i];\n\n\t\t\t\tresult = this.compareItemNodes(\n\t\t\t\t\tnodeA, nodeB, propertyGetter, direction.ascOrdering, direction.nullsOrdering\n\t\t\t\t);\n\n\t\t\t\ti += 1;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\tstatic compareItemNodes(\n\t\tnodeA: ItemNode,\n\t\tnodeB: ItemNode,\n\t\tpropertyGetter: string,\n\t\tascOrdering: boolean,\n\t\tnullsOrdering: boolean\n\t)\n\t{\n\t\tconst itemA = nodeA.getItem();\n\t\tconst itemB = nodeB.getItem();\n\n\t\titemA.getCustomData().get();\n\n\t\tconst valueA = itemA[propertyGetter]();\n\t\tconst valueB = itemB[propertyGetter]();\n\n\t\tlet result = 0;\n\n\t\tif (valueA !== null && valueB === null)\n\t\t{\n\t\t\tresult = nullsOrdering ? -1 : 1;\n\t\t}\n\t\telse if (valueA === null && valueB !== null)\n\t\t{\n\t\t\tresult = nullsOrdering ? 1 : -1;\n\t\t}\n\t\telse if (valueA === null && valueB === null)\n\t\t{\n\t\t\tresult = ascOrdering ? -1 : 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isString(valueA))\n\t\t\t{\n\t\t\t\tresult = valueA.localeCompare(valueB);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = valueA - valueB;\n\t\t\t}\n\t\t}\n\n\t\tconst sortOrder = ascOrdering ? 1 : -1;\n\n\t\treturn result * sortOrder;\n\t}\n}","import { Type } from 'main.core';\n\nexport default class TextNodeType\n{\n\tstatic TEXT: string = 'text';\n\tstatic HTML: string = 'html';\n\n\tstatic isValid(type: string)\n\t{\n\t\treturn Type.isString(type) && (type === this.HTML || type === this.TEXT);\n\t}\n}","import { Type } from 'main.core';\nimport TextNodeType from './text-node-type';\nimport type { TextNodeOptions } from './text-node-options';\n\nexport default class TextNode\n{\n\ttext: ?string = null;\n\ttype: ?TextNodeType = null;\n\n\tconstructor(options: TextNodeOptions | string)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isString(options.text))\n\t\t\t{\n\t\t\t\tthis.text = options.text;\n\t\t\t}\n\n\t\t\tif (TextNodeType.isValid(options.type))\n\t\t\t{\n\t\t\t\tthis.type = options.type;\n\t\t\t}\n\t\t}\n\t\telse if (Type.isString(options))\n\t\t{\n\t\t\tthis.text = options;\n\t\t}\n\t}\n\n\tgetText(): ?string\n\t{\n\t\treturn this.text;\n\t}\n\n\tgetType(): ?TextNodeType\n\t{\n\t\treturn this.type;\n\t}\n\n\tisNullable(): boolean\n\t{\n\t\treturn this.getText() === null;\n\t}\n\n\trenderTo(element: HTMLElement): void\n\t{\n\t\tconst text = this.getText();\n\t\tif (text === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getType() === null || this.getType() === TextNodeType.TEXT)\n\t\t{\n\t\t\telement.textContent = text;\n\t\t}\n\t\telse if (this.getType() === TextNodeType.HTML)\n\t\t{\n\t\t\telement.innerHTML = text;\n\t\t}\n\t}\n\n\ttoString()\n\t{\n\t\treturn this.getText() ?? '';\n\t}\n\n\ttoJSON()\n\t{\n\t\tif (this.getType() === null)\n\t\t{\n\t\t\treturn this.getText();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.getText(),\n\t\t\t\ttype: this.getType()\n\t\t\t};\n\t\t}\n\t}\n}","import { Type, Text } from 'main.core';\nimport TextNode from '../common/text-node';\nimport type MatchIndex from './match-index';\nimport type { OrderedArray } from 'main.core.collections';\n\nexport default class Highlighter\n{\n\tstatic mark(text: string | TextNode, matches: OrderedArray<MatchIndex>)\n\t{\n\t\tlet encode = true;\n\t\tif (text instanceof TextNode)\n\t\t{\n\t\t\tif (text.getType() === 'html')\n\t\t\t{\n\t\t\t\tencode = false;\n\t\t\t}\n\n\t\t\ttext = text.getText();\n\t\t}\n\n\t\tif (!Type.isStringFilled(text) || !matches || matches.count() === 0)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet result = '';\n\t\tlet offset = 0;\n\t\tlet chunk = '';\n\t\tmatches.forEach((match: MatchIndex) => {\n\n\t\t\tif (offset > match.getStartIndex())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchunk = text.substring(offset, match.getStartIndex());\n\t\t\tresult += encode ? Text.encode(chunk) : chunk;\n\n\t\t\tresult += '<span class=\"ui-selector-highlight-mark\">';\n\n\t\t\tchunk = text.substring(match.getStartIndex(), match.getEndIndex());\n\t\t\tresult += encode ? Text.encode(chunk) : chunk;\n\n\t\t\tresult += '</span>';\n\n\t\t\toffset = match.getEndIndex();\n\n\t\t});\n\n\t\tchunk = text.substring(offset);\n\t\tresult += encode ? Text.encode(chunk) : chunk;\n\n\t\treturn result;\n\t}\n}","import { Type, Dom } from 'main.core';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport TextNode from '../common/text-node';\nimport type { TextNodeOptions } from '../common/text-node-options';\n\nexport default class ItemBadge\n{\n\ttitle: ?TextNode = null;\n\ttextColor: string | null = null;\n\tbgColor: string | null = null;\n\tborder: string | null = null;\n\tcontainers: WeakMap<HTMLElement, HTMLElement> = new WeakMap();\n\n\tconstructor(badgeOptions: ItemBadgeOptions)\n\t{\n\t\tconst options: ItemBadgeOptions = Type.isPlainObject(badgeOptions) ? badgeOptions : {};\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setBorder(options.border);\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null && !titleNode.isNullable() ? titleNode.getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor;\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\t}\n\n\tgetBgColor(): ?string\n\t{\n\t\treturn this.bgColor;\n\t}\n\n\tsetBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.bgColor = bgColor;\n\t\t}\n\t}\n\n\tgetBorder(): string | null\n\t{\n\t\treturn this.border;\n\t}\n\n\tsetBorder(border: string | null): void\n\t{\n\t\tif (Type.isString(border) || border === null)\n\t\t{\n\t\t\tthis.border = border;\n\t\t}\n\t}\n\n\tgetContainer(target: HTMLElement): HTMLElement\n\t{\n\t\tlet container = this.containers.get(target);\n\t\tif (!container)\n\t\t{\n\t\t\tcontainer = document.createElement('span');\n\t\t\tcontainer.className = 'ui-selector-item-badge';\n\n\t\t\tthis.containers.set(target, container);\n\t\t}\n\n\t\treturn container;\n\t}\n\n\trenderTo(target: HTMLElement): void\n\t{\n\t\tconst container = this.getContainer(target);\n\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\tthis.getTitleNode().renderTo(container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontainer.textContent = '';\n\t\t}\n\n\t\tDom.style(container, 'color', this.getTextColor());\n\t\tDom.style(container, 'background-color', this.getBgColor());\n\t\tDom.style(container, 'border', this.getBorder());\n\t\tDom.append(container, target);\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\ttitle: this.getTitleNode(),\n\t\t\ttextColor: this.getTextColor(),\n\t\t\tbgColor: this.getBgColor(),\n\t\t\tborder: this.getBorder(),\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\nimport type { SearchFieldOptions } from './search-field-options';\n\nexport default class SearchField\n{\n\tname: string = null;\n\ttype: string = 'string';\n\tsearchable: boolean = true;\n\tsystem: boolean = false;\n\tsort: ?number = null;\n\n\tconstructor(fieldOptions: SearchFieldOptions)\n\t{\n\t\tconst options = Type.isPlainObject(fieldOptions) ? fieldOptions : {};\n\n\t\tif (!Type.isStringFilled(options.name))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.SearchField: \"name\" parameter is required.');\n\t\t}\n\n\t\tthis.name = options.name;\n\t\tthis.setType(options.type);\n\t\tthis.setSystem(options.system);\n\t\tthis.setSort(options.sort);\n\t\tthis.setSearchable(options.searchable);\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.type;\n\t}\n\n\tsetType(type: string): void\n\t{\n\t\tif (Type.isStringFilled(type))\n\t\t{\n\t\t\tthis.type = type;\n\t\t}\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.sort = sort;\n\t\t}\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSystem(flag: boolean)\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.system = flag;\n\t\t}\n\t}\n\n\tisCustom(): boolean\n\t{\n\t\treturn !this.isSystem();\n\t}\n\n\tisSystem(): boolean\n\t{\n\t\treturn this.system;\n\t}\n}","import SearchField from './search-field';\n\nexport default class MatchIndex\n{\n\tfield: SearchField = null;\n\tqueryWord: string = null;\n\tstartIndex: number = null;\n\tendIndex: number = null;\n\n\tconstructor(field: SearchField, queryWord: string, startIndex: number)\n\t{\n\t\tthis.field = field;\n\t\tthis.queryWord = queryWord;\n\t\tthis.startIndex = startIndex;\n\t\tthis.endIndex = startIndex + queryWord.length;\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetQueryWord(): string\n\t{\n\t\treturn this.queryWord;\n\t}\n\n\tgetStartIndex(): number\n\t{\n\t\treturn this.startIndex;\n\t}\n\n\tgetEndIndex(): number\n\t{\n\t\treturn this.endIndex;\n\t}\n}","import { Type } from 'main.core';\n\nimport type SearchField from './search-field';\nimport MatchIndex from './match-index';\nimport { OrderedArray } from 'main.core.collections';\n\nconst comparator = (a: MatchIndex, b: MatchIndex) => {\n\n\tif (a.getStartIndex() === b.getStartIndex())\n\t{\n\t\treturn a.getEndIndex() > b.getEndIndex() ? -1 : 1;\n\t}\n\telse\n\t{\n\t\treturn a.getStartIndex() > b.getStartIndex() ? 1 : -1;\n\t}\n};\n\nexport default class MatchField\n{\n\tfield: SearchField = null;\n\tmatchIndexes: OrderedArray<MatchIndex> = new OrderedArray(comparator);\n\n\tconstructor(field: SearchField, indexes: MatchIndex[] = [])\n\t{\n\t\tthis.field = field;\n\t\tthis.addIndexes(indexes);\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetMatches(): OrderedArray<MatchIndex>\n\t{\n\t\treturn this.matchIndexes;\n\t}\n\n\taddIndex(matchIndex: MatchIndex): void\n\t{\n\t\tthis.matchIndexes.add(matchIndex);\n\t}\n\n\taddIndexes(matchIndexes: MatchIndex[]): void\n\t{\n\t\tif (Type.isArray(matchIndexes))\n\t\t{\n\t\t\tmatchIndexes.forEach(matchIndex => {\n\t\t\t\tthis.addIndex(matchIndex);\n\t\t\t});\n\t\t}\n\t}\n}","import { Event, Type } from 'main.core';\n\nexport default class Animation\n{\n\tstatic handleTransitionEnd(element: HTMLElement, propertyName: string | string[]): Promise\n\t{\n\t\tconst properties = Type.isArray(propertyName) ? new Set(propertyName) : new Set([propertyName]);\n\n\t\treturn new Promise(function(resolve) {\n\t\t\tconst handler = (event: TransitionEvent) => {\n\t\t\t\tif (event.target !== element || !properties.has(event.propertyName))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tproperties.delete(event.propertyName);\n\t\t\t\tif (properties.size === 0)\n\t\t\t\t{\n\t\t\t\t\tresolve(event);\n\t\t\t\t\tEvent.unbind(element, 'transitionend', handler);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(element, 'transitionend', handler);\n\t\t});\n\t}\n\n\tstatic handleAnimationEnd(element: HTMLElement, animationName: string)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tconst handler = (event) => {\n\t\t\t\tif (!animationName || (event.animationName === animationName))\n\t\t\t\t{\n\t\t\t\t\tresolve(event);\n\t\t\t\t\tEvent.unbind(element, 'animationend', handler);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(element, 'animationend', handler);\n\t\t});\n\t}\n}","const regexp = /^data:((?:\\w+\\/(?:(?!;).)+)?)((?:;[\\w\\W]*?[^;])*),(.+)$/;\n\nconst isDataUri = (str: string): boolean => {\n\treturn typeof(str) === 'string' ? str.match(regexp) : false;\n};\n\nexport default function encodeUrl(url: string): string\n{\n\tif (isDataUri(url))\n\t{\n\t\treturn url;\n\t}\n\n\treturn encodeURI(url);\n}","import { ajax as Ajax, Cache, Dom, Runtime, Tag, Type, Browser, Event } from 'main.core';\nimport { OrderedArray } from 'main.core.collections';\nimport { Loader } from 'main.loader';\n\nimport { Icon } from 'ui.icon-set.api.core';\n\nimport ItemNodeComparator from './item-node-comparator';\nimport Highlighter from '../search/highlighter';\nimport ItemBadge from './item-badge';\nimport MatchField from '../search/match-field';\nimport TextNode from '../common/text-node';\nimport Animation from '../common/animation';\nimport Item from './item';\nimport encodeUrl from '../common/encode-url';\n\nimport type Tab from '../dialog/tabs/tab';\nimport type Dialog from '../dialog/dialog';\nimport type { ItemOptions } from './item-options';\nimport type { ItemNodeOptions } from './item-node-options';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport type { TextNodeOptions } from '../common/text-node-options';\nimport type { CaptionOptions } from './caption-options';\nimport type { BadgesOptions } from './badges-options';\nimport type { AvatarOptions } from './avatar-options';\n\nexport class RenderMode\n{\n\tstatic PARTIAL = 'partial';\n\tstatic OVERRIDE = 'override';\n}\n\nexport default class ItemNode\n{\n\titem: Item = null;\n\ttab: Tab = null;\n\tcache = new Cache.MemoryCache();\n\tparentNode: ItemNode = null;\n\n\tchildren: OrderedArray<ItemNode> = null;\n\tchildItems: WeakMap<Item, ItemNode> = new WeakMap(); // for the fast access\n\n\tloaded: boolean = false;\n\tdynamic: boolean = false;\n\tdynamicPromise: ?Promise = null;\n\tloader: Loader = null;\n\topen: boolean = false;\n\tautoOpen: boolean = false;\n\tfocused: boolean = false;\n\n\trenderMode: RenderMode = RenderMode.PARTIAL;\n\ttitle: ?TextNode = null;\n\tsubtitle: ?TextNode = null;\n\tsupertitle: ?TextNode = null;\n\tcaption: ?TextNode = null;\n\tcaptionOptions: CaptionOptions = {};\n\tavatar: ?string = null;\n\tavatarOptions: ?AvatarOptions = null;\n\tlink: ?string = null;\n\tlinkTitle: ?TextNode = null;\n\ttextColor: ?string = null;\n\tbadges: ItemBadgeOptions[] = null;\n\tbadgesOptions: BadgesOptions = {};\n\thidden: boolean = false;\n\n\thighlights: MatchField[] = [];\n\n\trendered: false;\n\trenderWithDebounce = Runtime.debounce(this.render, 50, this);\n\n\tconstructor(item: Item, nodeOptions: ItemNodeOptions)\n\t{\n\t\tconst options: ItemNodeOptions = Type.isPlainObject(nodeOptions) ? nodeOptions : {};\n\n\t\tif (Type.isObject(item))\n\t\t{\n\t\t\tthis.item = item;\n\t\t}\n\n\t\tlet comparator = null;\n\t\tif (Type.isFunction(options.itemOrder))\n\t\t{\n\t\t\tcomparator = options.itemOrder;\n\t\t}\n\t\telse if (Type.isPlainObject(options.itemOrder))\n\t\t{\n\t\t\tcomparator = ItemNodeComparator.makeMultipleComparator(options.itemOrder);\n\t\t}\n\n\t\tthis.children = new OrderedArray(comparator);\n\n\t\tthis.renderMode = options.renderMode === RenderMode.OVERRIDE ? RenderMode.OVERRIDE : RenderMode.PARTIAL;\n\t\tif (this.renderMode === RenderMode.OVERRIDE)\n\t\t{\n\t\t\tthis.setTitle('');\n\t\t\tthis.setSubtitle('');\n\t\t\tthis.setSupertitle('');\n\t\t\tthis.setCaption('');\n\t\t\tthis.setLinkTitle('');\n\n\t\t\tthis.avatar = '';\n\t\t\tthis.avatarOptions = {\n\t\t\t\tbgSize: null,\n\t\t\t\tbgColor: null,\n\t\t\t\tbgImage: null,\n\t\t\t\tborder: null,\n\t\t\t\tborderRadius: null,\n\t\t\t\toutline: null,\n\t\t\t\toutlineOffset: null,\n\t\t\t\ticon: null,\n\t\t\t\ticonColor: null,\n\t\t\t};\n\t\t\tthis.textColor = '';\n\t\t\tthis.link = '';\n\t\t\tthis.badges = [];\n\t\t\tthis.captionOptions = {\n\t\t\t\tfitContent: null,\n\t\t\t\tmaxWidth: null,\n\t\t\t\tjustifyContent: null,\n\t\t\t};\n\t\t\tthis.badgesOptions = {\n\t\t\t\tfitContent: null,\n\t\t\t\tmaxWidth: null,\n\t\t\t\tjustifyContent: null,\n\t\t\t};\n\t\t}\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setSubtitle(options.subtitle);\n\t\tthis.setSupertitle(options.supertitle);\n\t\tthis.setCaption(options.caption);\n\t\tthis.setCaptionOptions(options.captionOptions);\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setAvatarOptions(options.avatarOptions);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setLink(options.link);\n\t\tthis.setLinkTitle(options.linkTitle);\n\t\tthis.setBadges(options.badges);\n\t\tthis.setBadgesOptions(options.badgesOptions);\n\n\t\tthis.setDynamic(options.dynamic);\n\t\tthis.setOpen(options.open);\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tisRoot(): boolean\n\t{\n\t\treturn this.getParentNode() === null;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.getTab().getDialog();\n\t}\n\n\tsetTab(tab: Tab): void\n\t{\n\t\tthis.tab = tab;\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetParentNode(): ?ItemNode\n\t{\n\t\treturn this.parentNode;\n\t}\n\n\tsetParentNode(parentNode: ItemNode): void\n\t{\n\t\tthis.parentNode = parentNode;\n\t}\n\n\tgetNextSibling(): ?ItemNode\n\t{\n\t\tif (!this.getParentNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst siblings = this.getParentNode().getChildren();\n\t\tconst index = siblings.getIndex(this);\n\n\t\treturn siblings.getByIndex(index + 1);\n\t}\n\n\tgetPreviousSibling(): ?ItemNode\n\t{\n\t\tif (!this.getParentNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst siblings = this.getParentNode().getChildren();\n\t\tconst index = siblings.getIndex(this);\n\n\t\treturn siblings.getByIndex(index - 1);\n\t}\n\n\taddChildren(children: ItemOptions[]): void\n\t{\n\t\tif (!Type.isArray(children))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tchildren.forEach((childOptions: ItemOptions) => {\n\t\t\tdelete childOptions.tabs;\n\t\t\tconst childItem = this.getDialog().addItem(childOptions);\n\n\t\t\tconst childNode = this.addItem(childItem, childOptions.nodeOptions);\n\t\t\tchildNode.addChildren(childOptions.children);\n\t\t});\n\t}\n\n\taddChild(child: ItemNode): ItemNode\n\t{\n\t\tif (!(child instanceof ItemNode))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode: an item must be an instance of EntitySelector.ItemNode.');\n\t\t}\n\n\t\tif (this.isChildOf(child) || child === this)\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode: a child item cannot be a parent of current item.');\n\t\t}\n\n\t\tif (this.getChildren().has(child) || this.childItems.has(child.getItem()))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.getChildren().add(child);\n\t\tthis.childItems.set(child.getItem(), child);\n\n\t\tchild.setTab(this.getTab());\n\t\tchild.setParentNode(this);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.renderWithDebounce();\n\t\t}\n\n\t\treturn child;\n\t}\n\n\tgetDepthLevel(): number\n\t{\n\t\treturn this.isRoot() ? 0 : this.getParentNode().getDepthLevel() + 1;\n\t}\n\n\taddItem(item: Item, nodeOptions: ItemNodeOptions): ItemNode\n\t{\n\t\tlet itemNode = this.childItems.get(item);\n\t\tif (!itemNode)\n\t\t{\n\t\t\titemNode = item.createNode(nodeOptions);\n\t\t\tthis.addChild(itemNode);\n\t\t}\n\n\t\treturn itemNode;\n\t}\n\n\taddItems(items: Item[] | Array<[Item, ItemNodeOptions]>): void\n\t{\n\t\tif (Type.isArray(items))\n\t\t{\n\t\t\tthis.disableRender();\n\n\t\t\titems.forEach((item: Item | [Item, ItemNodeOptions]) => {\n\t\t\t\tif (Type.isArray(item) && item.length === 2)\n\t\t\t\t{\n\t\t\t\t\tthis.addItem(item[0], item[1]);\n\t\t\t\t}\n\t\t\t\telse if (item instanceof Item)\n\t\t\t\t{\n\t\t\t\t\tthis.addItem(item);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.enableRender();\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.renderWithDebounce();\n\t\t\t}\n\t\t}\n\t}\n\n\thasItem(item: Item): boolean\n\t{\n\t\treturn this.childItems.has(item);\n\t}\n\n\tremoveChild(child: ItemNode): boolean\n\t{\n\t\tif (!this.getChildren().has(child))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tchild.removeChildren();\n\n\t\tif (child.isFocused())\n\t\t{\n\t\t\tchild.unfocus();\n\t\t}\n\n\t\tchild.setParentNode(null);\n\t\tchild.getItem().removeNode(child);\n\n\t\tthis.getChildren().delete(child);\n\t\tthis.childItems.delete(child.getItem());\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tDom.remove(child.getOuterContainer());\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tremoveChildren(): void\n\t{\n\t\tif (!this.hasChildren())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getChildren().forEach((node: ItemNode) => {\n\n\t\t\tnode.removeChildren();\n\n\t\t\tif (node.isFocused())\n\t\t\t{\n\t\t\t\tnode.unfocus();\n\t\t\t}\n\n\t\t\tnode.setParentNode(null);\n\t\t\tnode.getItem().removeNode(node);\n\t\t});\n\n\t\tthis.getChildren().clear();\n\t\tthis.childItems = new WeakMap();\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tif (Browser.isIE())\n\t\t\t{\n\t\t\t\tDom.clean(this.getChildrenContainer());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChildrenContainer().textContent = '';\n\t\t\t}\n\t\t}\n\t}\n\n\thasChild(child: ItemNode): boolean\n\t{\n\t\treturn this.getChildren().has(child);\n\t}\n\n\tisChildOf(parent: ItemNode): boolean\n\t{\n\t\tlet parentNode = this.getParentNode();\n\t\twhile (parentNode !== null)\n\t\t{\n\t\t\tif (parentNode === parent)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tparentNode = parentNode.getParentNode();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetFirstChild(): ?ItemNode\n\t{\n\t\treturn this.children.getFirst();\n\t}\n\n\tgetLastChild(): ?ItemNode\n\t{\n\t\treturn this.children.getLast();\n\t}\n\n\tgetChildren(): OrderedArray<ItemNode>\n\t{\n\t\treturn this.children;\n\t}\n\n\thasChildren(): boolean\n\t{\n\t\treturn this.children.count() > 0;\n\t}\n\n\tloadChildren(): Promise\n\t{\n\t\tif (!this.isDynamic())\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode.loadChildren: an item node is not dynamic.');\n\t\t}\n\n\t\tif (this.dynamicPromise)\n\t\t{\n\t\t\treturn this.dynamicPromise;\n\t\t}\n\n\t\tthis.dynamicPromise = Ajax.runAction('ui.entityselector.getChildren', {\n\t\t\tjson: {\n\t\t\t\tparentItem: this.getItem().getAjaxJson(),\n\t\t\t\tdialog: this.getDialog().getAjaxJson()\n\t\t\t},\n\t\t\tgetParameters: {\n\t\t\t\tcontext: this.getDialog().getContext()\n\t\t\t}\n\t\t});\n\n\t\tthis.dynamicPromise.then((response) => {\n\t\t\tif (response && response.data && Type.isPlainObject(response.data.dialog))\n\t\t\t{\n\t\t\t\tthis.addChildren(response.data.dialog.items);\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t\tthis.loaded = true;\n\t\t});\n\n\t\tthis.dynamicPromise.catch((error) => {\n\t\t\tthis.loaded = false;\n\t\t\tthis.dynamicPromise = null;\n\t\t\tconsole.error(error);\n\t\t});\n\n\t\treturn this.dynamicPromise;\n\t}\n\n\tsetOpen(open: boolean): void\n\t{\n\t\tif (Type.isBoolean(open))\n\t\t{\n\t\t\tif (open && this.isDynamic() && !this.isLoaded())\n\t\t\t{\n\t\t\t\tthis.setAutoOpen(true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.open = open;\n\t\t\t}\n\t\t}\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.open;\n\t}\n\n\tisAutoOpen(): boolean\n\t{\n\t\treturn this.autoOpen && this.isDynamic() && !this.isLoaded();\n\t}\n\n\tsetAutoOpen(autoOpen: boolean): void\n\t{\n\t\tif (Type.isBoolean(autoOpen))\n\t\t{\n\t\t\tthis.autoOpen = autoOpen;\n\t\t}\n\t}\n\n\tsetDynamic(dynamic: boolean): void\n\t{\n\t\tif (Type.isBoolean(dynamic))\n\t\t{\n\t\t\tthis.dynamic = dynamic;\n\t\t}\n\t}\n\n\tisDynamic(): boolean\n\t{\n\t\treturn this.dynamic;\n\t}\n\n\tisLoaded(): boolean\n\t{\n\t\treturn this.loaded;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getIndicatorContainer(),\n\t\t\t\tsize: 30\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t\tDom.addClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\thideLoader(): void\n\t{\n\t\tvoid this.getLoader().hide();\n\t\tDom.removeClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\tdestroyLoader(): void\n\t{\n\t\tthis.getLoader().destroy();\n\t\tthis.loader = null;\n\t\tDom.removeClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\texpand(): void\n\t{\n\t\tif (this.isOpen() || (!this.hasChildren() && !this.isDynamic()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDynamic() && !this.isLoaded())\n\t\t{\n\t\t\tthis.loadChildren().then(() => {\n\t\t\t\tthis.destroyLoader();\n\t\t\t\tthis.expand();\n\t\t\t});\n\n\t\t\tthis.showLoader();\n\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\tDom.style(this.getChildrenContainer(), 'height', '0px');\n\t\tDom.style(this.getChildrenContainer(), 'opacity', 0);\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this.getChildrenContainer(), 'height', `${this.getChildrenContainer().scrollHeight}px`);\n\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', 1);\n\n\t\t\t\tAnimation.handleTransitionEnd(this.getChildrenContainer(), 'height').then(() => {\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'height', null);\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', null);\n\t\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\t\t\t\tthis.setOpen(true);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tcollapse(): void\n\t{\n\t\tif (!this.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(this.getChildrenContainer(), 'height', `${this.getChildrenContainer().offsetHeight}px`);\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this.getChildrenContainer(), 'height', '0px');\n\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', 0);\n\n\t\t\t\tAnimation.handleTransitionEnd(this.getChildrenContainer(), 'height').then(() => {\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'height', null);\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', null);\n\t\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\t\t\t\tthis.setOpen(false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\trender(appendChildren = false): void\n\t{\n\t\tif (this.isRoot())\n\t\t{\n\t\t\tthis.renderRoot(appendChildren);\n\t\t\treturn;\n\t\t}\n\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\ttitleNode.renderTo(this.getTitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().textContent = '';\n\t\t}\n\n\t\tconst supertitleNode = this.getSupertitleNode();\n\t\tif (supertitleNode)\n\t\t{\n\t\t\tsupertitleNode.renderTo(this.getSupertitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getSupertitleContainer().textContent = '';\n\t\t}\n\n\t\tconst subtitleNode = this.getSubtitleNode();\n\t\tif (subtitleNode)\n\t\t{\n\t\t\tsubtitleNode.renderTo(this.getSubtitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getSubtitleContainer().textContent = '';\n\t\t}\n\n\t\tconst captionNode = this.getCaptionNode();\n\t\tif (captionNode)\n\t\t{\n\t\t\tcaptionNode.renderTo(this.getCaptionContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getCaptionContainer().textContent = '';\n\t\t}\n\n\t\tconst captionFitContent = this.getCaptionOption('fitContent');\n\t\tif (Type.isBoolean(captionFitContent))\n\t\t{\n\t\t\tDom.style(this.getCaptionContainer(), 'flex-shrink', captionFitContent ? 0 : null);\n\t\t}\n\n\t\tconst captionJustifyContent = this.getCaptionOption('justifyContent');\n\t\tif (Type.isStringFilled(captionJustifyContent) || captionJustifyContent === null)\n\t\t{\n\t\t\tDom.style(\n\t\t\t\tthis.getCaptionContainer(),\n\t\t\t\t{\n\t\t\t\t\tflexGrow: captionJustifyContent ? '1' : null,\n\t\t\t\t\ttextAlign: captionJustifyContent || null,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tconst captionMaxWidth = this.getCaptionOption('maxWidth');\n\t\tif (Type.isString(captionMaxWidth) || Type.isNumber(captionMaxWidth))\n\t\t{\n\t\t\tDom.style(\n\t\t\t\tthis.getCaptionContainer(),\n\t\t\t\t'max-width',\n\t\t\t\tType.isNumber(captionMaxWidth) ? `${captionMaxWidth}px` : captionMaxWidth\n\t\t\t);\n\t\t}\n\n\t\tif (Type.isStringFilled(this.getTextColor()))\n\t\t{\n\t\t\tthis.getTitleContainer().style.color = this.getTextColor();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().style.removeProperty('color');\n\t\t}\n\n\t\tDom.clean(this.getAvatarContainer());\n\t\tconst avatar = this.getAvatar();\n\t\tif (Type.isStringFilled(avatar))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.backgroundImage = `url('${encodeUrl(avatar)}')`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst bgImage = this.getAvatarOption('bgImage');\n\t\t\tif (Type.isStringFilled(bgImage))\n\t\t\t{\n\t\t\t\tthis.getAvatarContainer().style.backgroundImage = bgImage;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getAvatarContainer().style.removeProperty('background-image');\n\t\t\t}\n\t\t}\n\n\t\tconst bgColor = this.getAvatarOption('bgColor');\n\t\tif (Type.isStringFilled(bgColor))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.backgroundColor = bgColor;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('background-color');\n\t\t}\n\n\t\tconst bgSize = this.getAvatarOption('bgSize');\n\t\tif (Type.isStringFilled(bgSize))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.backgroundSize = bgSize;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('background-size');\n\t\t}\n\n\t\tconst border = this.getAvatarOption('border');\n\t\tif (Type.isStringFilled(border))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.border = border;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('border');\n\t\t}\n\n\t\tconst borderRadius = this.getAvatarOption('borderRadius');\n\t\tif (Type.isStringFilled(borderRadius))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.borderRadius = borderRadius;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('border-radius');\n\t\t}\n\n\t\tconst outline = this.getAvatarOption('outline');\n\t\tDom.style(this.getAvatarContainer(), 'outline', outline);\n\n\t\tconst outlineOffset = this.getAvatarOption('outlineOffset');\n\t\tDom.style(this.getAvatarContainer(), 'outline-offset', outlineOffset);\n\n\t\tconst icon = {\n\t\t\ticon: this.getAvatarOption('icon'),\n\t\t\tsize: bgSize ?? undefined,\n\t\t\tcolor: this.getAvatarOption('iconColor') ?? undefined,\n\t\t};\n\t\tif (Icon.isValid(icon))\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', 'none');\n\t\t\tDom.append(new Icon(icon).render(), this.getAvatarContainer());\n\t\t}\n\n\t\tDom.clean(this.getBadgeContainer());\n\t\tthis.getBadges().forEach((badge: ItemBadge) => {\n\t\t\tbadge.renderTo(this.getBadgeContainer());\n\t\t});\n\n\t\tconst badgesFitContent = this.getBadgesOption('fitContent');\n\t\tif (Type.isBoolean(badgesFitContent))\n\t\t{\n\t\t\tDom.style(this.getBadgeContainer(), 'flex-shrink', badgesFitContent ? 0 : null);\n\t\t}\n\n\t\tconst badgesJustifyContent = this.getBadgesOption('justifyContent');\n\t\tif (Type.isStringFilled(badgesJustifyContent) || badgesJustifyContent === null)\n\t\t{\n\t\t\tDom.style(\n\t\t\t\tthis.getBadgeContainer(),\n\t\t\t\t{\n\t\t\t\t\tflexGrow: badgesJustifyContent ? '1' : null,\n\t\t\t\t\tjustifyContent: badgesJustifyContent || null,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tconst badgesMaxWidth = this.getBadgesOption('maxWidth');\n\t\tif (Type.isString(badgesMaxWidth) || Type.isNumber(badgesMaxWidth))\n\t\t{\n\t\t\tDom.style(\n\t\t\t\tthis.getBadgeContainer(),\n\t\t\t\t'max-width',\n\t\t\t\tType.isNumber(badgesMaxWidth) ? `${badgesMaxWidth}px` : badgesMaxWidth\n\t\t\t);\n\t\t}\n\n\t\tconst linkTitleNode = this.getLinkTitleNode();\n\t\tif (linkTitleNode)\n\t\t{\n\t\t\tlinkTitleNode.renderTo(this.getLinkTextContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getLinkTextContainer().textContent = '';\n\t\t}\n\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-has-children');\n\t\t\tif (this.getDepthLevel() >= this.getTab().getItemMaxDepth())\n\t\t\t{\n\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-max-depth');\n\t\t\t}\n\t\t}\n\t\telse if (this.getOuterContainer().classList.contains('ui-selector-item-box-has-children'))\n\t\t{\n\t\t\tDom.removeClass(\n\t\t\t\tthis.getOuterContainer(),\n\t\t\t\t['ui-selector-item-box-has-children', 'ui-selector-item-box-max-depth']\n\t\t\t);\n\t\t}\n\n\t\tif (this.hasChildren())\n\t\t{\n\t\t\tconst hasVisibleChild = this.getChildren().getAll().some((child: ItemNode) => {\n\t\t\t\treturn child.isHidden() !== true;\n\t\t\t});\n\n\t\t\tif (!hasVisibleChild)\n\t\t\t{\n\t\t\t\tthis.#setHidden(true);\n\t\t\t}\n\t\t}\n\n\t\tthis.toggleVisibility();\n\t\tthis.highlight();\n\t\tthis.renderChildren(appendChildren);\n\n\t\tif (this.isAutoOpen())\n\t\t{\n\t\t\tthis.setAutoOpen(false);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.expand();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\t/**\n\t * @private\n\t */\n\trenderRoot(appendChildren = false): void\n\t{\n\t\tthis.renderChildren(appendChildren);\n\t\tthis.rendered = true;\n\n\t\tconst stub = this.getTab().getStub();\n\t\tif (stub && stub.isAutoShow() && (this.getDialog().isLoaded() || !this.getDialog().hasDynamicLoad()))\n\t\t{\n\t\t\tif (this.hasChildren())\n\t\t\t{\n\t\t\t\tstub.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tstub.show();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\trenderChildren(appendChildren = false): void\n\t{\n\t\tif (!appendChildren)\n\t\t{\n\t\t\tif (Browser.isIE())\n\t\t\t{\n\t\t\t\tDom.clean(this.getChildrenContainer());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChildrenContainer().textContent = '';\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasChildren())\n\t\t{\n\t\t\tlet previousSibling: ItemNode = null;\n\t\t\tthis.getChildren().forEach((child: ItemNode) => {\n\t\t\t\tchild.render(appendChildren);\n\t\t\t\tconst container = child.getOuterContainer();\n\n\t\t\t\tif (!appendChildren)\n\t\t\t\t{\n\t\t\t\t\tDom.append(container, this.getChildrenContainer());\n\t\t\t\t}\n\t\t\t\tif (!container.parentNode)\n\t\t\t\t{\n\t\t\t\t\tif (previousSibling !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.insertAfter(container, previousSibling.getOuterContainer());\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(container, this.getChildrenContainer());\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tpreviousSibling = child;\n\t\t\t});\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\tenableRender(): void\n\t{\n\t\tthis.rendered = true;\n\t}\n\n\tdisableRender(): void\n\t{\n\t\tthis.rendered = false;\n\t}\n\n\tgetRenderMode(): RenderMode\n\t{\n\t\treturn this.renderMode;\n\t}\n\n\tisHidden(): boolean\n\t{\n\t\treturn this.hidden === true || this.getItem().isHidden() === true;\n\t}\n\n\tsetHidden(flag: boolean): void\n\t{\n\t\tif (!Type.isBoolean(flag) || this.isRoot())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#setHidden(flag);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.toggleVisibility();\n\n\t\t\tlet parentNode = this.getParentNode();\n\t\t\tconst isHidden = this.isHidden();\n\t\t\twhile (parentNode.isRoot() === false)\n\t\t\t{\n\t\t\t\tif (isHidden)\n\t\t\t\t{\n\t\t\t\t\tconst hasVisibleChild = parentNode.getChildren().getAll().some((child: ItemNode) => {\n\t\t\t\t\t\treturn child.isHidden() !== true;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!hasVisibleChild)\n\t\t\t\t\t{\n\t\t\t\t\t\tparentNode.#setHidden(true);\n\t\t\t\t\t}\n\n\t\t\t\t\tparentNode.toggleVisibility();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tparentNode.#setHidden(false);\n\t\t\t\t\tparentNode.toggleVisibility();\n\t\t\t\t\tif (parentNode.isHidden())\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tparentNode = parentNode.getParentNode();\n\t\t\t}\n\t\t}\n\t}\n\n\t#setHidden(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag) && !this.isRoot())\n\t\t{\n\t\t\tthis.hidden = flag;\n\t\t}\n\t}\n\n\ttoggleVisibility(): boolean\n\t{\n\t\tif (this.isHidden())\n\t\t{\n\t\t\tDom.addClass(this.getOuterContainer(), '--hidden');\n\t\t}\n\t\telse if (this.getOuterContainer().classList.contains('--hidden'))\n\t\t{\n\t\t\tDom.removeClass(this.getOuterContainer(), '--hidden');\n\t\t}\n\t}\n\n\tlock(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-locked');\n\t}\n\n\tunlock(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-locked');\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null ? titleNode.getText() : null;\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title !== null ? this.title: this.getItem().getTitleNode();\n\t}\n\n\tsetTitle(title: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(title) || Type.isPlainObject(title))\n\t\t{\n\t\t\tthis.title = new TextNode(title);\n\t\t}\n\t\telse if (title === null)\n\t\t{\n\t\t\tthis.title = null;\n\t\t}\n\t}\n\n\tgetSubtitle(): ?string\n\t{\n\t\tconst subtitleNode = this.getSubtitleNode();\n\n\t\treturn subtitleNode !== null ? subtitleNode.getText() : null;\n\t}\n\n\tgetSubtitleNode(): ?TextNode\n\t{\n\t\treturn this.subtitle !== null ? this.subtitle: this.getItem().getSubtitleNode();\n\t}\n\n\tsetSubtitle(subtitle: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(subtitle) || Type.isPlainObject(subtitle))\n\t\t{\n\t\t\tthis.subtitle = new TextNode(subtitle);\n\t\t}\n\t\telse if (subtitle === null)\n\t\t{\n\t\t\tthis.subtitle = null;\n\t\t}\n\t}\n\n\tgetSupertitle(): ?string\n\t{\n\t\tconst supertitleNode = this.getSupertitleNode();\n\n\t\treturn supertitleNode !== null ? supertitleNode.getText() : null;\n\t}\n\n\tgetSupertitleNode(): ?TextNode\n\t{\n\t\treturn this.supertitle !== null ? this.supertitle: this.getItem().getSupertitleNode();\n\t}\n\n\tsetSupertitle(supertitle: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(supertitle) || Type.isPlainObject(supertitle))\n\t\t{\n\t\t\tthis.supertitle = new TextNode(supertitle);\n\t\t}\n\t\telse if (supertitle === null)\n\t\t{\n\t\t\tthis.supertitle = null;\n\t\t}\n\t}\n\n\tgetCaption(): ?string\n\t{\n\t\tconst caption = this.getCaptionNode();\n\n\t\treturn caption !== null ? caption.getText() : null;\n\t}\n\n\tgetCaptionNode(): ?TextNode\n\t{\n\t\treturn this.caption !== null ? this.caption: this.getItem().getCaptionNode();\n\t}\n\n\tsetCaption(caption: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(caption) || Type.isPlainObject(caption))\n\t\t{\n\t\t\tthis.caption = new TextNode(caption);\n\t\t}\n\t\telse if (caption === null)\n\t\t{\n\t\t\tthis.caption = null;\n\t\t}\n\t}\n\n\tgetCaptionOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.captionOptions[option]))\n\t\t{\n\t\t\treturn this.captionOptions[option];\n\t\t}\n\n\t\treturn this.getItem().getCaptionOption(option);\n\t}\n\n\tsetCaptionOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.captionOptions[option] = value;\n\t\t}\n\t}\n\n\tsetCaptionOptions(options: {[key: string]: any } | null): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setCaptionOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\treturn this.avatar !== null ? this.avatar : this.getItem().getAvatar();\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t}\n\t}\n\n\tgetAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\treturn (\n\t\t\tthis.avatarOptions === null || Type.isUndefined(this.avatarOptions[option])\n\t\t\t\t? this.getItem().getAvatarOption(option)\n\t\t\t\t: this.avatarOptions[option]\n\t\t);\n\t}\n\n\tsetAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.avatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.avatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.avatarOptions[option] = value;\n\t\t}\n\t}\n\n\tsetAvatarOptions(avatarOptions: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(avatarOptions))\n\t\t{\n\t\t\tObject.keys(avatarOptions).forEach((option: string) => {\n\t\t\t\tthis.setAvatarOption(option, avatarOptions[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor !== null ? this.textColor : this.getItem().getTextColor();\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\treturn this.link !== null ? this.getItem().replaceMacros(this.link) : this.getItem().getLink();\n\t}\n\n\tsetLink(link: string): void\n\t{\n\t\tif (Type.isString(link) || link === null)\n\t\t{\n\t\t\tthis.link = link;\n\t\t}\n\t}\n\n\tgetLinkTitle(): ?string\n\t{\n\t\tconst linkTitle = this.getLinkTitleNode();\n\n\t\treturn linkTitle !== null ? linkTitle.getText() : null;\n\t}\n\n\tgetLinkTitleNode(): ?TextNode\n\t{\n\t\treturn this.linkTitle !== null ? this.linkTitle: this.getItem().getLinkTitleNode();\n\t}\n\n\tsetLinkTitle(title: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(title) || Type.isPlainObject(title))\n\t\t{\n\t\t\tthis.linkTitle = new TextNode(title);\n\t\t}\n\t\telse if (title === null)\n\t\t{\n\t\t\tthis.linkTitle = null;\n\t\t}\n\t}\n\n\tgetBadges(): ItemBadge[]\n\t{\n\t\treturn this.badges !== null ? this.badges : this.getItem().getBadges();\n\t}\n\n\tsetBadges(badges: ?ItemBadgeOptions[]): void\n\t{\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.badges = [];\n\t\t\tbadges.forEach(badge => {\n\t\t\t\tthis.badges.push(new ItemBadge(badge));\n\t\t\t});\n\t\t}\n\t\telse if (badges === null)\n\t\t{\n\t\t\tthis.badges = null;\n\t\t}\n\t}\n\n\tgetBadgesOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.badgesOptions[option]))\n\t\t{\n\t\t\treturn this.badgesOptions[option];\n\t\t}\n\n\t\treturn this.getItem().getBadgesOption(option);\n\t}\n\n\tsetBadgesOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.badgesOptions[option] = value;\n\t\t}\n\t}\n\n\tsetBadgesOptions(options: {[key: string]: any } | null): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setBadgesOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetOuterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\n\t\t\tlet className = '';\n\n\t\t\tif (this.hasChildren() || this.isDynamic())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-has-children';\n\t\t\t\tif (this.getDepthLevel() >= this.getTab().getItemMaxDepth())\n\t\t\t\t{\n\t\t\t\t\tclassName += ' ui-selector-item-box-max-depth';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.getItem().isLocked())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-locked';\n\t\t\t}\n\t\t\telse if (this.getItem().isSelected())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-selected';\n\t\t\t}\n\n\t\t\tif (this.isOpen())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-open';\n\t\t\t}\n\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = `ui-selector-item-box${className}`;\n\t\t\tdiv.appendChild(this.getContainer());\n\t\t\tdiv.appendChild(this.getChildrenContainer());\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetChildrenContainer(): HTMLElement\n\t{\n\t\tif (this.isRoot() && this.getTab())\n\t\t{\n\t\t\treturn this.getTab().getItemsContainer();\n\t\t}\n\n\t\treturn this.cache.remember('children-container', () => {\n\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-children';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item --ui-hoverable';\n\n\t\t\tEvent.bind(div, 'click', this.handleClick.bind(this))\n\t\t\tEvent.bind(div, 'mouseenter', this.handleMouseEnter.bind(this))\n\t\t\tEvent.bind(div, 'mouseleave', this.handleMouseLeave.bind(this))\n\n\t\t\tdiv.appendChild(this.getAvatarContainer());\n\t\t\tdiv.appendChild(this.getTitlesContainer());\n\t\t\tdiv.appendChild(this.getIndicatorContainer());\n\n\t\t\tif (Type.isStringFilled(this.getLink()))\n\t\t\t{\n\t\t\t\tdiv.appendChild(this.getLinkContainer());\n\t\t\t}\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetAvatarContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-avatar';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetTitlesContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('titles', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-titles';\n\n\t\t\tdiv.appendChild(this.getSupertitleContainer());\n\t\t\tdiv.appendChild(this.getTitleBoxContainer());\n\t\t\tdiv.appendChild(this.getSubtitleContainer());\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetTitleBoxContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title-box', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-title-box';\n\n\t\t\tdiv.appendChild(this.getTitleContainer());\n\t\t\tdiv.appendChild(this.getBadgeContainer());\n\t\t\tdiv.appendChild(this.getCaptionContainer());\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-title';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetSubtitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('subtitle', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-subtitle';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetSupertitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('supertitle', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-supertitle';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetCaptionContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('caption', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-caption';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetIndicatorContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('indicator', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-indicator ui-icon-set__scope';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetBadgeContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('badge', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-badges';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetLinkContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('link', () => {\n\t\t\tconst anchor: HTMLAnchorElement = document.createElement('a');\n\t\t\tanchor.className = 'ui-selector-item-link';\n\t\t\tanchor.href = this.getLink();\n\t\t\tanchor.target = '_blank';\n\t\t\tanchor.title = '';\n\n\t\t\tEvent.bind(anchor, 'click', this.handleLinkClick.bind(this));\n\t\t\tanchor.appendChild(this.getLinkTextContainer());\n\n\t\t\treturn anchor;\n\t\t});\n\t}\n\n\tgetLinkTextContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('link-text', () => {\n\t\t\tconst span = document.createElement('span');\n\t\t\tspan.className = 'ui-selector-item-link-text';\n\n\t\t\treturn span;\n\t\t});\n\t}\n\n\tshowLink(): void\n\t{\n\t\tif (Type.isStringFilled(this.getLink()))\n\t\t{\n\t\t\tDom.addClass(this.getLinkContainer(), 'ui-selector-item-link--show');\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tDom.addClass(this.getLinkContainer(), 'ui-selector-item-link--animate');\n\t\t\t\t});\n\t\t\t});\n\n\t\t}\n\t}\n\n\thideLink(): void\n\t{\n\t\tif (Type.isStringFilled(this.getLink()))\n\t\t{\n\t\t\tDom.removeClass(\n\t\t\t\tthis.getLinkContainer(), ['ui-selector-item-link--show', 'ui-selector-item-link--animate']\n\t\t\t);\n\t\t}\n\t}\n\n\tsetHighlights(highlights: MatchField[]): void\n\t{\n\t\tthis.highlights = highlights;\n\t}\n\n\tgetHighlights(): MatchField[]\n\t{\n\t\treturn this.highlights;\n\t}\n\n\thighlight(): void\n\t{\n\t\tthis.getHighlights().forEach(matchField => {\n\t\t\tconst field = matchField.getField();\n\t\t\tconst fieldName = field.getName();\n\n\t\t\tif (field.isCustom())\n\t\t\t{\n\t\t\t\tconst text = this.getItem().getCustomData().get(fieldName);\n\t\t\t\tthis.getSubtitleContainer().innerHTML = Highlighter.mark(text, matchField.getMatches());\n\t\t\t}\n\t\t\telse if (field.getName() === 'title')\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getTitleNode(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t{\n\t\t\t\tthis.getSubtitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getSubtitleNode(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (field.getName() === 'supertitle')\n\t\t\t{\n\t\t\t\tthis.getSupertitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getSupertitleNode(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (field.getName() === 'caption')\n\t\t\t{\n\t\t\t\tthis.getCaptionContainer().innerHTML = (\n\t\t\t\t\tHighlighter.mark(this.getItem().getCaptionNode(), matchField.getMatches())\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n\n\tselect(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-selected');\n\t}\n\n\tdeselect(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-selected');\n\t}\n\n\tfocus(): void\n\t{\n\t\tif (this.isFocused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focused = true;\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-focused');\n\n\t\tthis.getDialog().emit('ItemNode:onFocus', { node: this });\n\t}\n\n\tunfocus(): void\n\t{\n\t\tif (!this.isFocused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focused = false;\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-focused');\n\n\t\tthis.getDialog().emit('ItemNode:onUnfocus', { node: this });\n\t}\n\n\tisFocused(): boolean\n\t{\n\t\treturn this.focused;\n\t}\n\n\tclick(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\tif (this.isOpen())\n\t\t\t{\n\t\t\t\tthis.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.expand();\n\t\t\t}\n\t\t}\n\t\telse if (this.getItem().isSelected())\n\t\t{\n\t\t\tif (this.getItem().isDeselectable())\n\t\t\t{\n\t\t\t\tthis.getItem().deselect({ node: this });\n\t\t\t}\n\n\t\t\tif (!this.getItem().isSelected() && this.getDialog().shouldHideOnDeselect())\n\t\t\t{\n\t\t\t\tthis.getDialog().hide();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getItem().select({ node: this });\n\n\t\t\tif (this.getDialog().shouldClearSearchOnSelect())\n\t\t\t{\n\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t}\n\n\t\t\tif (this.getItem().isSelected() && this.getDialog().shouldHideOnSelect())\n\t\t\t{\n\t\t\t\tthis.getDialog().hide();\n\t\t\t}\n\t\t}\n\n\t\tthis.getDialog().focusSearch();\n\t}\n\n\tscrollIntoView(): void\n\t{\n\t\tconst tabContainer = this.getTab().getContainer();\n\t\tconst nodeContainer = this.getContainer();\n\n\t\tconst tabRect = Dom.getPosition(tabContainer);\n\t\tconst nodeRect = Dom.getPosition(nodeContainer);\n\t\tconst margin = 9; // 'ui-selector-items' padding - 'ui-selector-item' margin = 10 - 1\n\n\t\tif (nodeRect.top < tabRect.top) // scroll up\n\t\t{\n\t\t\ttabContainer.scrollTop -= (tabRect.top - nodeRect.top + margin);\n\t\t}\n\t\telse if (nodeRect.bottom > tabRect.bottom) // scroll down\n\t\t{\n\t\t\ttabContainer.scrollTop += nodeRect.bottom - tabRect.bottom + margin;\n\t\t}\n\t}\n\n\t#makeEllipsisTitle(): void\n\t{\n\t\tif (this.constructor.#isEllipsisActive(this.getTitleContainer()))\n\t\t{\n\t\t\tthis.getContainer().setAttribute(\n\t\t\t\t'title',\n\t\t\t\tthis.constructor.#sanitizeTitle(this.getTitleContainer().textContent)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.attr(this.getContainer(), 'title', null);\n\t\t}\n\n\t\tconst containers = [\n\t\t\tthis.getSupertitleContainer(),\n\t\t\tthis.getSubtitleContainer(),\n\t\t\tthis.getCaptionContainer(),\n\t\t\t...this.getBadges().map((badge: ItemBadge) => badge.getContainer(this.getBadgeContainer()))\n\t\t];\n\n\t\tcontainers.forEach(container => {\n\t\t\tif (this.constructor.#isEllipsisActive(container))\n\t\t\t{\n\t\t\t\tcontainer.setAttribute('title', this.constructor.#sanitizeTitle(container.textContent));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.attr(container, 'title', null);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic #isEllipsisActive(element: HTMLElement): boolean\n\t{\n\t\treturn element.offsetWidth < element.scrollWidth;\n\t}\n\n\tstatic #sanitizeTitle(text: string)\n\t{\n\t\treturn text.replace(/[\\t ]+/gm, ' ').replace(/\\n+/gm, '\\n').trim();\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.click();\n\t}\n\n\thandleLinkClick(event: MouseEvent): void\n\t{\n\t\tthis.getDialog().emit('ItemNode:onLinkClick', { node: this, event });\n\t\tevent.stopPropagation();\n\t}\n\n\thandleMouseEnter(): void\n\t{\n\t\tthis.focus();\n\t\tthis.showLink();\n\t\tthis.#makeEllipsisTitle();\n\t}\n\n\thandleMouseLeave(): void\n\t{\n\t\tthis.unfocus();\n\t\tthis.hideLink();\n\t}\n}\n","import type SearchField from './search-field';\nimport type WordIndex from './word-index';\n\nexport default class SearchFieldIndex\n{\n\tfield: SearchField = null;\n\tindexes: WordIndex[] = [];\n\n\tconstructor(field: SearchField, indexes: WordIndex[] = [])\n\t{\n\t\tthis.field = field;\n\t\tthis.addIndexes(indexes);\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetIndexes(): WordIndex[]\n\t{\n\t\treturn this.indexes;\n\t}\n\n\taddIndex(index: WordIndex)\n\t{\n\t\tthis.getIndexes().push(index);\n\t}\n\n\taddIndexes(indexes: WordIndex[])\n\t{\n\t\tindexes.forEach(index => {\n\t\t\tthis.addIndex(index);\n\t\t});\n\t}\n}","import { Type } from 'main.core';\n\nexport default class WordIndex\n{\n\tword: string = '';\n\tstartIndex: number = 0;\n\n\tconstructor(word: string, startIndex: number)\n\t{\n\t\tthis.setWord(word);\n\t\tthis.setStartIndex(startIndex);\n\t}\n\n\tgetWord(): string\n\t{\n\t\treturn this.word;\n\t}\n\n\tsetWord(word: string): this\n\t{\n\t\tif (Type.isStringFilled(word))\n\t\t{\n\t\t\tthis.word = word;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetStartIndex(): number\n\t{\n\t\treturn this.startIndex;\n\t}\n\n\tsetStartIndex(index: number): this\n\t{\n\t\tif (Type.isNumber(index) && index >= 0)\n\t\t{\n\t\t\tthis.startIndex = index;\n\t\t}\n\n\t\treturn this;\n\t}\n}","/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used to compose unicode character classes. */\nconst rsAstralRange = '\\\\ud800-\\\\udfff';\nconst rsComboMarksRange = '\\\\u0300-\\\\u036f';\nconst reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f';\nconst rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff';\nconst rsComboMarksExtendedRange = '\\\\u1ab0-\\\\u1aff';\nconst rsComboMarksSupplementRange = '\\\\u1dc0-\\\\u1dff';\nconst rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange + rsComboMarksExtendedRange + rsComboMarksSupplementRange;\nconst rsDingbatRange = '\\\\u2700-\\\\u27bf';\nconst rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff';\nconst rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7';\nconst rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf';\nconst rsPunctuationRange = '\\\\u2000-\\\\u206f';\nconst rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000';\nconst rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde';\nconst rsVarRange = '\\\\ufe0e\\\\ufe0f';\nconst rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n/** Used to compose unicode capture groups. */\nconst rsApos = '[\\'\\u2019]';\nconst rsBreak = `[${rsBreakRange}]`;\nconst rsCombo = `[${rsComboRange}]`;\nconst rsDigit = '\\\\d';\nconst rsDingbat = `[${rsDingbatRange}]`;\nconst rsLower = `[${rsLowerRange}]`;\nconst rsMisc = `[^${rsAstralRange}${rsBreakRange + rsDigit + rsDingbatRange + rsLowerRange + rsUpperRange}]`;\nconst rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]';\nconst rsModifier = `(?:${rsCombo}|${rsFitz})`;\nconst rsNonAstral = `[^${rsAstralRange}]`;\nconst rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}';\nconst rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]';\nconst rsUpper = `[${rsUpperRange}]`;\nconst rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nconst rsMiscLower = `(?:${rsLower}|${rsMisc})`;\nconst rsMiscUpper = `(?:${rsUpper}|${rsMisc})`;\nconst rsOptContrLower = `(?:${rsApos}(?:d|ll|m|re|s|t|ve))?`;\nconst rsOptContrUpper = `(?:${rsApos}(?:D|LL|M|RE|S|T|VE))?`;\nconst reOptMod = `${rsModifier}?`;\nconst rsOptVar = `[${rsVarRange}]?`;\nconst rsOptJoin = `(?:${rsZWJ}(?:${[rsNonAstral, rsRegional, rsSurrPair].join('|')})${rsOptVar + reOptMod})*`;\nconst rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])';\nconst rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])';\nconst rsSeq = rsOptVar + reOptMod + rsOptJoin;\nconst rsEmoji = `(?:${[rsDingbat, rsRegional, rsSurrPair].join('|')})${rsSeq}`;\n\nconst unicodeWordsRegExp = new RegExp([\n\t`${rsUpper}?${rsLower}+${rsOptContrLower}(?=${[rsBreak, rsUpper, '$'].join('|')})`,\n\t`${rsMiscUpper}+${rsOptContrUpper}(?=${[rsBreak, rsUpper + rsMiscLower, '$'].join('|')})`,\n\t`${rsUpper}?${rsMiscLower}+${rsOptContrLower}`,\n\t`${rsUpper}+${rsOptContrUpper}`,\n\trsOrdUpper,\n\trsOrdLower,\n\t`${rsDigit}+`,\n\trsEmoji\n].join('|'), 'g');\n\nexport default unicodeWordsRegExp;","import { Type } from 'main.core';\n\nimport SearchFieldIndex from './search-field-index';\nimport WordIndex from './word-index';\n\nimport type Item from '../item/item';\nimport type SearchField from './search-field';\n\nimport unicodeWordsRegExp from './unicode-words';\nconst asciiWordRegExp = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\nconst hasUnicodeWordRegExp = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\nconst nonWhitespaceRegExp = /[^\\s]+/g;\nconst specialChars = `!\"#$%&'()*+,-.\\/:;<=>?@[\\\\]^_\\`{|}`;\nconst specialCharsRegExp = new RegExp(`[${specialChars}]`);\n\nexport default class SearchIndex\n{\n\tindexes: SearchFieldIndex[] = [];\n\n\tconstructor()\n\t{\n\t}\n\n\taddIndex(fieldIndex: SearchFieldIndex)\n\t{\n\t\tif (Type.isObject(fieldIndex))\n\t\t{\n\t\t\tthis.getIndexes().push(fieldIndex);\n\t\t}\n\t}\n\n\tgetIndexes()\n\t{\n\t\treturn this.indexes;\n\t}\n\n\tstatic create(item: Item)\n\t{\n\t\tconst index = new SearchIndex();\n\t\tconst entity = item.getEntity();\n\n\t\tif (!item.isSearchable() || !entity.isSearchable() || item.isHidden())\n\t\t{\n\t\t\treturn index;\n\t\t}\n\n\t\tconst searchFields = entity.getSearchFields();\n\t\tsearchFields.forEach(field => {\n\t\t\tif (!field.isSearchable())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (field.isSystem())\n\t\t\t{\n\t\t\t\tif (field.getName() === 'title')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getTitleNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getTitle(), stripTags));\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getSubtitleNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getSubtitle(), stripTags));\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'supertitle')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getSupertitleNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getSupertitle(), stripTags));\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'caption')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getCaptionNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getCaption(), stripTags));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst customData = item.getCustomData().get(field.getName());\n\t\t\t\tif (!Type.isUndefined(customData))\n\t\t\t\t{\n\t\t\t\t\tindex.addIndex(this.createIndex(field, customData));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn index;\n\t}\n\n\tstatic createIndex(field: SearchField, text: string, stripTags = false): SearchFieldIndex\n\t{\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (stripTags)\n\t\t{\n\t\t\ttext = text.replace(/<\\/?[^>]+>/g, (match) => ' '.repeat(match.length));\n\t\t\ttext = text.replace(/&(?:#\\d+|#x[\\da-fA-F]+|[0-9a-zA-Z]+);/g, (match) => ' '.repeat(match.length));\n\t\t}\n\n\t\tlet index: SearchFieldIndex = null;\n\t\tif (field.getType() === 'string')\n\t\t{\n\t\t\tconst wordIndexes = this.splitText(text);\n\t\t\tif (Type.isArrayFilled(wordIndexes))\n\t\t\t{\n\t\t\t\t// \"GoPro111 Leto15\"\n\t\t\t\t// [go, pro, 111, leto, 15] + [gopro111, leto15]\n\t\t\t\tthis.fillComplexWords(wordIndexes);\n\t\t\t\tthis.fillNonCharWords(wordIndexes, text);\n\n\t\t\t\tindex = new SearchFieldIndex(field, wordIndexes);\n\t\t\t}\n\t\t}\n\t\telse if (field.getType() === 'email')\n\t\t{\n\t\t\tconst position = text.indexOf('@');\n\t\t\tif (position !== -1)\n\t\t\t{\n\t\t\t\tindex = new SearchFieldIndex(\n\t\t\t\t\tfield,\n\t\t\t\t\t[\n\t\t\t\t\t\tnew WordIndex(text.toLowerCase(), 0),\n\t\t\t\t\t\tnew WordIndex(text.substr(position + 1).toLowerCase(), position + 1)\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tstatic splitText(text: string): WordIndex[]\n\t{\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn this.hasUnicodeWord(text) ? this.splitUnicodeText(text) : this.splitAsciiText(text);\n\t}\n\n\tstatic splitUnicodeText(text: string): WordIndex[]\n\t{\n\t\treturn this.splitTextInternal(text, unicodeWordsRegExp);\n\t}\n\n\tstatic splitAsciiText(text: string): WordIndex[]\n\t{\n\t\treturn this.splitTextInternal(text, asciiWordRegExp);\n\t}\n\n\tstatic hasUnicodeWord(text: string): boolean\n\t{\n\t\treturn hasUnicodeWordRegExp.test(text);\n\t}\n\n\tstatic splitTextInternal(text: string, regExp: RegExp): WordIndex[]\n\t{\n\t\tlet match;\n\t\tconst result = [];\n\n\t\tregExp.lastIndex = 0;\n\t\twhile ((match = regExp.exec(text)) !== null)\n\t\t{\n\t\t\tif (match.index === regExp.lastIndex)\n\t\t\t{\n\t\t\t\tregExp.lastIndex++;\n\t\t\t}\n\n\t\t\tresult.push(new WordIndex(match[0].toLowerCase(), match.index));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t *  @private\n\t */\n\tstatic fillComplexWords(indexes: WordIndex[]): void\n\t{\n\t\tif (indexes.length < 2)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet complexWord: ?string = null;\n\t\tlet startIndex: ?number = null;\n\n\t\tindexes.forEach((currentIndex, currentArrayIndex) => {\n\t\t\tconst nextIndex = indexes[currentArrayIndex + 1];\n\t\t\tif (nextIndex)\n\t\t\t{\n\t\t\t\tconst sameWord =\n\t\t\t\t\tcurrentIndex.getStartIndex() + currentIndex.getWord().length === nextIndex.getStartIndex()\n\t\t\t\t;\n\n\t\t\t\tif (sameWord)\n\t\t\t\t{\n\t\t\t\t\tif (complexWord === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tcomplexWord = currentIndex.getWord();\n\t\t\t\t\t\tstartIndex = currentIndex.getStartIndex();\n\t\t\t\t\t}\n\n\t\t\t\t\tcomplexWord += nextIndex.getWord();\n\t\t\t\t}\n\t\t\t\telse if (complexWord !== null)\n\t\t\t\t{\n\t\t\t\t\tindexes.push(new WordIndex(complexWord, startIndex));\n\t\t\t\t\tcomplexWord = null;\n\t\t\t\t\tstartIndex = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (complexWord !== null)\n\t\t\t{\n\t\t\t\tindexes.push(new WordIndex(complexWord, startIndex));\n\t\t\t\tcomplexWord = null;\n\t\t\t\tstartIndex = null;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t *  @private\n\t */\n\tstatic fillNonCharWords(indexes: WordIndex[], text: string): void\n\t{\n\t\tif (!specialCharsRegExp.test(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet match;\n\t\twhile ((match = nonWhitespaceRegExp.exec(text)) !== null)\n\t\t{\n\t\t\tif (match.index === nonWhitespaceRegExp.lastIndex)\n\t\t\t{\n\t\t\t\tnonWhitespaceRegExp.lastIndex++;\n\t\t\t}\n\n\t\t\tconst word = match[0];\n\t\t\tif (specialCharsRegExp.test(word))\n\t\t\t{\n\t\t\t\tindexes.push(new WordIndex(word.toLowerCase(), match.index));\n\n\t\t\t\tfor (let i = 0; i < word.length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst char = word[i];\n\t\t\t\t\tif (!specialChars.includes(char))\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wordToIndex = word.substr(i + 1);\n\t\t\t\t\tif (wordToIndex.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tindexes.push(new WordIndex(wordToIndex.toLowerCase(), match.index + i + 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnonWhitespaceRegExp.lastIndex = 0;\n\t}\n}\n","import { Type } from 'main.core';\nimport type { EntityFilterOptions } from './entity-filter-options';\n\nexport default class EntityFilter\n{\n\tid: string = null;\n\toptions: { [key: string]: any } = {};\n\n\tconstructor(filterOptions: EntityFilterOptions)\n\t{\n\t\tconst options = Type.isPlainObject(filterOptions) ? filterOptions : {};\n\n\t\tthis.id = options.id;\n\t\tthis.options = options.options;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetOptions(): { [key: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\toptions: this.getOptions(),\n\t\t}\n\t}\n}","import { Extension, Runtime, Type } from 'main.core';\nimport { OrderedArray } from 'main.core.collections';\n\nimport SearchField from '../search/search-field';\nimport TextNode from '../common/text-node';\n\nimport type Item from '../item/item';\nimport type { EntityOptions } from './entity-options';\nimport type { SearchFieldOptions } from '../search/search-field-options';\nimport type { ItemBadgeOptions } from '../item/item-badge-options';\nimport type { EntityBadgeOptions } from './entity-badge-options';\nimport type { EntityFilterOptions } from \"./entity-filter-options\";\nimport EntityFilter from './entity-filter';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Entity\n{\n\tstatic extensions: string[] = null;\n\tstatic defaultOptions: { [entityId: string]: { [key: string]: any } } = null;\n\n\tid: string = null;\n\toptions: { [key: string]: any } = {};\n\tsearchable: boolean = true;\n\tsearchFields: OrderedArray<SearchField> = null;\n\tdynamicLoad: boolean = false;\n\tdynamicSearch: boolean = false;\n\tdynamicSearchMatchMode: 'all' | 'exact' = 'exact';\n\tsubstituteEntityId: string = null;\n\tsearchCacheLimits: RegExp[] = [];\n\tfilters: Map<string, EntityFilter> = new Map();\n\n\titemOptions: { [key: string]: any } = {};\n\ttagOptions: { [key: string]: any } = {};\n\tbadgeOptions: ItemBadgeOptions[] = [];\n\ttextNodes: Map<string, Map<string, TextNode>> = new Map();\n\n\tconstructor(entityOptions: EntityOptions)\n\t{\n\t\tlet options: EntityOptions = Type.isPlainObject(entityOptions) ? entityOptions : {};\n\t\tif (!Type.isStringFilled(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Entity: \"id\" parameter is required.');\n\t\t}\n\n\t\tconst defaultOptions = this.constructor.getEntityDefaultOptions(options.id) || {};\n\t\toptions = Runtime.merge(JSON.parse(JSON.stringify(defaultOptions)), options);\n\n\t\tthis.id = options.id.toLowerCase();\n\t\tthis.options = Type.isPlainObject(options.options) ? options.options : {};\n\t\tthis.itemOptions = Type.isPlainObject(options.itemOptions) ? options.itemOptions : {};\n\t\tthis.tagOptions = Type.isPlainObject(options.tagOptions) ? options.tagOptions : {};\n\t\tthis.badgeOptions = Type.isArray(options.badgeOptions) ? options.badgeOptions : [];\n\t\tthis.substituteEntityId = Type.isStringFilled(options.substituteEntityId) ? options.substituteEntityId : null;\n\n\t\tif (Type.isArray(options.filters))\n\t\t{\n\t\t\toptions.filters.forEach((filterOptions: EntityFilterOptions) => {\n\t\t\t\tthis.addFilter(filterOptions);\n\t\t\t});\n\t\t}\n\n\t\tthis.searchFields = new OrderedArray((fieldA: SearchField, fieldB: SearchField) => {\n\t\t\tif (fieldA.getSort() !== null && fieldB.getSort() === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse if (fieldA.getSort() === null && fieldB.getSort() !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (fieldA.getSort() === null && fieldB.getSort() === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn fieldA.getSort() - fieldB.getSort();\n\t\t\t}\n\t\t});\n\n\t\tthis.setSearchable(options.searchable);\n\t\tthis.setDynamicLoad(options.dynamicLoad);\n\t\tthis.setDynamicSearch(options.dynamicSearch);\n\t\tthis.setDynamicSearchMatchMode(options.dynamicSearchMatchMode);\n\t\tthis.setSearchFields(options.searchFields);\n\t\tthis.setSearchCacheLimits(options.searchCacheLimits);\n\t}\n\n\tstatic getDefaultOptions()\n\t{\n\t\tif (this.defaultOptions === null)\n\t\t{\n\t\t\tthis.defaultOptions = {};\n\t\t\tthis.getExtensions().forEach((extension: string) => {\n\t\t\t\tconst settings = Extension.getSettings(extension);\n\t\t\t\tconst entities: [] = settings.get('entities', []);\n\t\t\t\tentities.forEach(entity => {\n\t\t\t\t\tif (Type.isStringFilled(entity.id) && Type.isPlainObject(entity.options))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultOptions[entity.id] = JSON.parse(JSON.stringify(entity.options)); // clone\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn this.defaultOptions;\n\t}\n\n\tstatic getExtensions(): string[]\n\t{\n\t\tif (this.extensions === null)\n\t\t{\n\t\t\tconst settings = Extension.getSettings('ui.entity-selector');\n\t\t\tthis.extensions = settings.get('extensions', []);\n\t\t}\n\n\t\treturn this.extensions;\n\t}\n\n\tstatic getEntityDefaultOptions(entityId: string)\n\t{\n\t\treturn this.getDefaultOptions()[entityId] || null;\n\t}\n\n\tstatic getItemOptions(entityId: string, entityType: string)\n\t{\n\t\tif (!Type.isStringFilled(entityId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst options = this.getEntityDefaultOptions(entityId);\n\t\tconst itemOptions = options && options['itemOptions'] ? options['itemOptions'] : null;\n\n\t\tif (Type.isUndefined(entityType))\n\t\t{\n\t\t\treturn itemOptions;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn itemOptions && !Type.isUndefined(itemOptions[entityType]) ? itemOptions[entityType] : null;\n\t\t}\n\t}\n\n\tstatic getTagOptions(entityId: string, entityType?: string)\n\t{\n\t\tif (!Type.isStringFilled(entityId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst options = this.getEntityDefaultOptions(entityId);\n\t\tconst tagOptions = options && options['tagOptions'] ? options['tagOptions'] : null;\n\n\t\tif (Type.isUndefined(entityType))\n\t\t{\n\t\t\treturn tagOptions;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn tagOptions && !Type.isUndefined(tagOptions[entityType]) ? tagOptions[entityType] : null;\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetOptions(): { [key: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetItemOptions(): { [key: string]: any }\n\t{\n\t\treturn this.itemOptions;\n\t}\n\n\tstatic getItemOption(entityId: string, option: string, entityType?: string): any\n\t{\n\t\treturn this.getOptionInternal(this.getItemOptions(entityId), option, entityType);\n\t}\n\n\tgetItemOption(option: string, entityType?: string): any\n\t{\n\t\treturn this.constructor.getOptionInternal(this.itemOptions, option, entityType);\n\t}\n\n\tgetTagOptions(): { [key: string]: any }\n\t{\n\t\treturn this.tagOptions;\n\t}\n\n\tstatic getTagOption(entityId: string, option: string, entityType?: string): any\n\t{\n\t\treturn this.getOptionInternal(this.getTagOptions(entityId), option, entityType);\n\t}\n\n\tgetTagOption(option: string, entityType?: string): any\n\t{\n\t\treturn this.constructor.getOptionInternal(this.tagOptions, option, entityType);\n\t}\n\n\tstatic getOptionInternal(options, option: string, type?: string): any\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (options[type] && !Type.isUndefined(options[type][option]))\n\t\t{\n\t\t\treturn options[type][option];\n\t\t}\n\t\telse if (options['default'] && !Type.isUndefined(options['default'][option]))\n\t\t{\n\t\t\treturn options['default'][option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetBadges(item: Item): EntityBadgeOptions[]\n\t{\n\t\tconst entityTypeBadges = this.getItemOption('badges', item.getEntityType()) || [];\n\t\tconst badges = [...entityTypeBadges];\n\n\t\tthis.badgeOptions.forEach((badge: EntityBadgeOptions) => {\n\t\t\tif (Type.isPlainObject(badge.conditions))\n\t\t\t{\n\t\t\t\tfor (const condition in badge.conditions)\n\t\t\t\t{\n\t\t\t\t\tif (item.getCustomData().get(condition) !== badge.conditions[condition])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbadges.push(badge);\n\t\t\t}\n\t\t});\n\n\t\treturn badges;\n\t}\n\n\tgetOptionTextNode(option: string, entityType?: string): ?TextNode\n\t{\n\t\tif (!Type.isString(option))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!Type.isString(entityType))\n\t\t{\n\t\t\tentityType = 'default';\n\t\t}\n\n\t\tlet optionNodes = this.textNodes.get(option);\n\t\tlet node = optionNodes ? optionNodes.get(entityType) : undefined;\n\n\t\tif (Type.isUndefined(node))\n\t\t{\n\t\t\tif (!optionNodes)\n\t\t\t{\n\t\t\t\toptionNodes = new Map();\n\t\t\t\tthis.textNodes.set(option, optionNodes);\n\t\t\t}\n\n\t\t\tconst itemOption = this.getItemOption(option, entityType);\n\t\t\tnode = Type.isString(itemOption) || Type.isPlainObject(itemOption) ? new TextNode(itemOption) : null;\n\n\t\t\toptionNodes.set(entityType, node);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tgetSearchFields(): OrderedArray<SearchField>\n\t{\n\t\treturn this.searchFields;\n\t}\n\n\tsetSearchFields(searchFields: SearchFieldOptions[]): void\n\t{\n\t\tthis.searchFields.clear();\n\n\t\t// Default Search Fields\n\t\tconst titleField = new SearchField({ name: 'title', searchable: true, system: true, type: 'string' });\n\t\tconst subtitleField = new SearchField({ name: 'subtitle', searchable: true, system: true, type: 'string' });\n\t\tthis.searchFields.add(titleField);\n\t\tthis.searchFields.add(subtitleField);\n\n\t\t// Custom Search Fields\n\t\tconst customFields = Type.isArray(searchFields) ? searchFields : [];\n\t\tcustomFields.forEach(fieldOptions => {\n\t\t\tconst field = new SearchField(fieldOptions);\n\t\t\tif (field.isSystem()) // Entity can override default fields.\n\t\t\t{\n\t\t\t\t// delete a default title field\n\t\t\t\tif (field.getName() === 'title')\n\t\t\t\t{\n\t\t\t\t\tthis.searchFields.delete(titleField);\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t\t{\n\t\t\t\t\tthis.searchFields.delete(subtitleField);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.searchFields.add(field);\n\t\t});\n\n\t\tthis.searchFields.forEach((field: SearchField, index: number) => {\n\t\t\tfield.setSort(index);\n\t\t});\n\t}\n\n\tsetSearchCacheLimits(limits: string[]): void\n\t{\n\t\tif (Type.isArrayFilled(limits))\n\t\t{\n\t\t\tlimits.forEach((limit: string) => {\n\t\t\t\tif (Type.isStringFilled(limit))\n\t\t\t\t{\n\t\t\t\t\tthis.searchCacheLimits.push(new RegExp(limit, 'i'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSearchCacheLimits(): RegExp[]\n\t{\n\t\treturn this.searchCacheLimits;\n\t}\n\n\thasDynamicLoad(): boolean\n\t{\n\t\treturn this.dynamicLoad;\n\t}\n\n\tsetDynamicLoad(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dynamicLoad = flag;\n\t\t}\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\treturn this.dynamicSearch;\n\t}\n\n\tsetDynamicSearch(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dynamicSearch = flag;\n\t\t}\n\t}\n\n\tsetDynamicSearchMatchMode(mode: 'all' | 'exact'): void\n\t{\n\t\tif (mode === 'all' || mode === 'exact')\n\t\t{\n\t\t\tthis.dynamicSearchMatchMode = mode;\n\t\t}\n\t}\n\n\tgetDynamicSearchMatchMode(): 'all' | 'exact'\n\t{\n\t\treturn this.dynamicSearchMatchMode;\n\t}\n\n\tgetFilters(): EntityFilter[]\n\t{\n\t\treturn Array.from(this.filters.values());\n\t}\n\n\taddFilters(filters: EntityFilterOptions[]): void\n\t{\n\t\tif (Type.isArray(filters))\n\t\t{\n\t\t\tfilters.forEach((filterOptions: EntityFilterOptions) => {\n\t\t\t\tthis.addFilter(filterOptions);\n\t\t\t});\n\t\t}\n\t}\n\n\taddFilter(filterOptions: EntityFilterOptions): void\n\t{\n\t\tif (Type.isPlainObject(filterOptions))\n\t\t{\n\t\t\tconst filter = new EntityFilter(filterOptions);\n\t\t\tthis.filters.set(filter.getId(), filter);\n\t\t}\n\t}\n\n\tgetFilter(id: string): ?Filter\n\t{\n\t\treturn this.filters.get(id) || null;\n\t}\n\n\tgetSubstituteEntityId(): string | null\n\t{\n\t\treturn this.substituteEntityId;\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\toptions: this.getOptions(),\n\t\t\tsearchable: this.isSearchable(),\n\t\t\tdynamicLoad: this.hasDynamicLoad(),\n\t\t\tdynamicSearch: this.hasDynamicSearch(),\n\t\t\tfilters: this.getFilters(),\n\t\t\tsubstituteEntityId: this.getSubstituteEntityId(),\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\n\nexport default class TypeUtils\n{\n\tstatic createMapFromOptions(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn new Map(Object.entries(options));\n\t\t}\n\n\t\tconst map = new Map();\n\t\tif (Type.isArrayFilled(options))\n\t\t{\n\t\t\toptions.forEach((element: Array) => {\n\t\t\t\tif (Type.isArray(element) && element.length === 2 && Type.isString(element[0]))\n\t\t\t\t{\n\t\t\t\t\tmap.set(element[0], element[1]);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\treturn map;\n\t}\n\n\tstatic convertMapToObject(map: Map): object\n\t{\n\t\tconst obj = {};\n\t\tif (Type.isMap(map))\n\t\t{\n\t\t\tmap.forEach((value, key) => {\n\t\t\t\tif (Type.isString(key))\n\t\t\t\t{\n\t\t\t\t\tobj[key] = value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn obj;\n\t}\n}","import { Type, Loc, Text } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport ItemNode from './item-node';\nimport SearchIndex from '../search/search-index';\nimport Entity from '../entity/entity';\nimport ItemBadge from './item-badge';\nimport TextNode from '../common/text-node';\nimport TypeUtils from '../common/type-utils';\n\nimport type Dialog from '../dialog/dialog';\nimport type { ItemOptions, ItemSelectOptions } from './item-options';\nimport type { ItemNodeOptions } from './item-node-options';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport type { TagItemOptions } from '../tag-selector/tag-item-options';\nimport type { TextNodeOptions } from '../common/text-node-options';\nimport type { CaptionOptions } from './caption-options';\nimport type { BadgesOptions } from './badges-options';\nimport type { AvatarOptions } from './avatar-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n * @package ui.entity-selector\n */\nexport default class Item\n{\n\tid: string | number = null;\n\tentityId: string = null;\n\tentityType: string = null;\n\n\ttitle: ?TextNode = null;\n\tsubtitle: ?TextNode = null;\n\tsupertitle: ?TextNode = null;\n\tcaption: ?TextNode = null;\n\tcaptionOptions: CaptionOptions = {};\n\tavatar: ?string = null;\n\tavatarOptions: ?AvatarOptions = null;\n\ttextColor: ?string = null;\n\tlink: ?string = null;\n\tlinkTitle: ?TextNode = null;\n\ttagOptions: Map<string, any> = null;\n\tbadges: ItemBadgeOptions[] = null;\n\tbadgesOptions: BadgesOptions = {};\n\n\tdialog: Dialog = null;\n\tnodes: Set<ItemNode> = new Set();\n\tselected: boolean = false;\n\tsearchable: boolean = true;\n\tsaveable: boolean = true;\n\tdeselectable: boolean = true;\n\thidden: boolean = false;\n\tlocked: boolean = false;\n\tsearchIndex: { [key: string]: string[] } = null;\n\tcustomData: Map<string, any> = null;\n\n\tsort: number = null;\n\tcontextSort: number = null;\n\tglobalSort: number = null;\n\n\tconstructor(itemOptions: ItemOptions)\n\t{\n\t\tconst options: ItemOptions = Type.isPlainObject(itemOptions) ? itemOptions : {};\n\t\tif (!Type.isStringFilled(options.id) && !Type.isNumber(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Item: \"id\" parameter is required.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(options.entityId))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Item: \"entityId\" parameter is required.');\n\t\t}\n\n\t\tthis.id = options.id;\n\t\tthis.entityId = options.entityId.toLowerCase();\n\t\tthis.entityType = Type.isStringFilled(options.entityType) ? options.entityType : 'default';\n\n\t\tthis.locked = Type.isBoolean(options.locked) ? options.locked : false;\n\t\tthis.selected = Type.isBoolean(options.selected) && !this.locked ? options.selected : false;\n\n\t\tthis.customData = TypeUtils.createMapFromOptions(options.customData);\n\t\tthis.tagOptions = TypeUtils.createMapFromOptions(options.tagOptions);\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setSubtitle(options.subtitle);\n\t\tthis.setSupertitle(options.supertitle);\n\t\tthis.setCaption(options.caption);\n\t\tthis.setCaptionOptions(options.captionOptions);\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setAvatarOptions(options.avatarOptions);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setLink(options.link);\n\t\tthis.setLinkTitle(options.linkTitle);\n\t\tthis.setBadges(options.badges);\n\t\tthis.setBadgesOptions(options.badgesOptions);\n\n\t\tthis.setSearchable(options.searchable);\n\t\tthis.setSaveable(options.saveable);\n\t\tthis.setDeselectable(options.deselectable);\n\t\tthis.setHidden(options.hidden);\n\t\tthis.setContextSort(options.contextSort);\n\t\tthis.setGlobalSort(options.globalSort);\n\t\tthis.setSort(options.sort);\n\t}\n\n\tgetId(): string | number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tgetEntity(): Entity\n\t{\n\t\tlet entity = this.getDialog().getEntity(this.getEntityId());\n\t\tif (entity === null)\n\t\t{\n\t\t\tentity = new Entity({ id: this.getEntityId() });\n\t\t\tthis.getDialog().addEntity(entity);\n\t\t}\n\n\t\treturn entity;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null && !titleNode.isNullable() ? titleNode.getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetSubtitle(): ?string\n\t{\n\t\tconst subtitleNode = this.getSubtitleNode();\n\n\t\treturn subtitleNode !== null ? subtitleNode.getText() : null;\n\t}\n\n\tgetSubtitleNode(): ?TextNode\n\t{\n\t\treturn this.subtitle !== null ? this.subtitle : this.getEntityTextNode('subtitle');\n\t}\n\n\tsetSubtitle(subtitle: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(subtitle) || Type.isPlainObject(subtitle) || subtitle === null)\n\t\t{\n\t\t\tthis.subtitle = subtitle === null ? null : new TextNode(subtitle);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetSupertitle(): ?string\n\t{\n\t\tconst supertitleNode = this.getSupertitleNode();\n\n\t\treturn supertitleNode !== null ? supertitleNode.getText() : null;\n\t}\n\n\tgetSupertitleNode(): ?TextNode\n\t{\n\t\treturn this.supertitle !== null ? this.supertitle : this.getEntityTextNode('supertitle');\n\t}\n\n\tsetSupertitle(supertitle: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(supertitle) || Type.isPlainObject(supertitle) || supertitle === null)\n\t\t{\n\t\t\tthis.supertitle = supertitle === null ? null : new TextNode(supertitle);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetCaption(): ?string\n\t{\n\t\tconst captionNode = this.getCaptionNode();\n\n\t\treturn captionNode !== null ? captionNode.getText() : null;\n\t}\n\n\tgetCaptionNode(): ?TextNode\n\t{\n\t\treturn this.caption !== null ? this.caption : this.getEntityTextNode('caption');\n\t}\n\n\tsetCaption(caption: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(caption) || Type.isPlainObject(caption) || caption === null)\n\t\t{\n\t\t\tthis.caption = caption === null ? null : new TextNode(caption);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetCaptionOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.captionOptions[option]))\n\t\t{\n\t\t\treturn this.captionOptions[option];\n\t\t}\n\n\t\tconst captionOptions = this.getEntityItemOption('captionOptions');\n\t\tif (Type.isPlainObject(captionOptions) && !Type.isUndefined(captionOptions[option]))\n\t\t{\n\t\t\treturn captionOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetCaptionOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.captionOptions[option] = value;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tsetCaptionOptions(options: {[key: string]: any }): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setCaptionOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\treturn this.avatar !== null ? this.avatar : this.getEntityItemOption('avatar');\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\tif (this.avatarOptions !== null && !Type.isUndefined(this.avatarOptions[option]))\n\t\t{\n\t\t\treturn this.avatarOptions[option];\n\t\t}\n\n\t\tconst avatarOptions = this.getEntityItemOption('avatarOptions');\n\t\tif (Type.isPlainObject(avatarOptions) && !Type.isUndefined(avatarOptions[option]))\n\t\t{\n\t\t\treturn avatarOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.avatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.avatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.avatarOptions[option] = value;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tsetAvatarOptions(options: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setAvatarOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor !== null ? this.textColor : this.getEntityItemOption('textColor');\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\tconst link = this.link !== null ? this.link : this.getEntityItemOption('link');\n\n\t\treturn this.replaceMacros(link);\n\t}\n\n\tsetLink(link: ?string): void\n\t{\n\t\tif (Type.isString(link) || link === null)\n\t\t{\n\t\t\tthis.link = link;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetLinkTitle(): ?string\n\t{\n\t\tconst linkTitleNode = this.getLinkTitleNode();\n\n\t\treturn linkTitleNode !== null ? linkTitleNode.getText() : Loc.getMessage('UI_SELECTOR_ITEM_LINK_TITLE');\n\t}\n\n\tgetLinkTitleNode(): ?TextNode\n\t{\n\t\treturn this.linkTitle !== null ? this.linkTitle : this.getEntityTextNode('linkTitle');\n\t}\n\n\tsetLinkTitle(linkTitle: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(linkTitle) || Type.isPlainObject(linkTitle) || linkTitle === null)\n\t\t{\n\t\t\tthis.linkTitle = linkTitle === null ? null : new TextNode(linkTitle);\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetBadges(): ItemBadge[]\n\t{\n\t\tif (this.badges !== null)\n\t\t{\n\t\t\treturn this.badges;\n\t\t}\n\n\t\tconst badges = this.getEntity().getBadges(this);\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.setBadges(badges);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.badges = [];\n\t\t}\n\n\t\treturn this.badges;\n\t}\n\n\tsetBadges(badges: ?ItemBadgeOptions[]): void\n\t{\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.badges = [];\n\t\t\tbadges.forEach(badge => {\n\t\t\t\tthis.badges.push(new ItemBadge(badge));\n\t\t\t});\n\n\t\t\tthis.#renderNodes();\n\t\t}\n\t\telse if (badges === null)\n\t\t{\n\t\t\tthis.badges = null;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetBadgesOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.badgesOptions[option]))\n\t\t{\n\t\t\treturn this.badgesOptions[option];\n\t\t}\n\n\t\tconst badgesOptions = this.getEntityItemOption('badgesOptions');\n\t\tif (Type.isPlainObject(badgesOptions) && !Type.isUndefined(badgesOptions[option]))\n\t\t{\n\t\t\treturn badgesOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetBadgesOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.badgesOptions[option] = value;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tsetBadgesOptions(options: {[key: string]: any }): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setBadgesOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tsetDialog(dialog: Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tcreateNode(nodeOptions: ItemNodeOptions): ItemNode\n\t{\n\t\tconst itemNode = new ItemNode(this, nodeOptions);\n\t\tthis.nodes.add(itemNode);\n\n\t\treturn itemNode;\n\t}\n\n\tremoveNode(node: ItemNode): void\n\t{\n\t\tthis.nodes.delete(node);\n\t}\n\n\tgetNodes(): Set<ItemNode>\n\t{\n\t\treturn this.nodes;\n\t}\n\n\tselect(selectOptions: ItemSelectOptions = {}): void\n\t{\n\t\tif (this.selected)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst options: ItemSelectOptions = (\n\t\t\tType.isBoolean(selectOptions) // Compatibility signature select(preselectedMode: boolean = false)\n\t\t\t\t? { emitEvents: !selectOptions, animate: !selectOptions }\n\t\t\t\t: selectOptions\n\t\t);\n\n\t\tconst { emitEvents, animate, node } = {\n\t\t\temitEvents: true,\n\t\t\tanimate: true,\n\t\t\tnode: null,\n\t\t\t...options,\n\t\t};\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog && emitEvents)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this, node } });\n\t\t\tdialog.emit('Item:onBeforeSelect', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isLocked())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selected = true;\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.handleItemSelect(this, animate);\n\t\t}\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((itemNode: ItemNode) => {\n\t\t\t\titemNode.select();\n\t\t\t});\n\t\t}\n\n\t\tif (dialog && emitEvents)\n\t\t{\n\t\t\tdialog.emit('Item:onSelect', { item: this, node });\n\t\t\tdialog.saveRecentItem(this);\n\t\t}\n\t}\n\n\tdeselect(deselectOptions: ItemSelectOptions = {}): void\n\t{\n\t\tif (!this.selected)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst options: ItemSelectOptions = (\n\t\t\tType.isBoolean(deselectOptions) // Compatibility signature select(preselectedMode: boolean = false)\n\t\t\t\t? { emitEvents: !deselectOptions, animate: !deselectOptions }\n\t\t\t\t: deselectOptions\n\t\t);\n\n\t\tconst { emitEvents, animate, node } = {\n\t\t\temitEvents: true,\n\t\t\tanimate: true,\n\t\t\tnode: null,\n\t\t\t...options,\n\t\t};\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog && emitEvents)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this, node } });\n\t\t\tdialog.emit('Item:onBeforeDeselect', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = false;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((itemNode: ItemNode) => {\n\t\t\t\titemNode.deselect();\n\t\t\t});\n\t\t}\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.handleItemDeselect(this, animate);\n\t\t}\n\n\t\tif (dialog && emitEvents)\n\t\t{\n\t\t\tdialog.emit('Item:onDeselect', { item: this, node });\n\t\t}\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.selected;\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSaveable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.saveable = flag;\n\t\t}\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn this.saveable;\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (this.getDialog() && this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tconst tag = this.getDialog().getTagSelector().getTag({\n\t\t\t\t\tid: this.getId(),\n\t\t\t\t\tentityId: this.getEntityId()\n\t\t\t\t});\n\n\t\t\t\tif (tag)\n\t\t\t\t{\n\t\t\t\t\ttag.setDeselectable(flag);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable;\n\t}\n\n\tsetHidden(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hidden = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\t\tnode.setHidden(flag);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tisHidden(): boolean\n\t{\n\t\treturn this.hidden;\n\t}\n\n\tlock(): void\n\t{\n\t\tif (this.locked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this } });\n\t\t\tdialog.emit('Item:onBeforeLock', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.locked = true;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.lock();\n\t\t\t});\n\t\t}\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.emit('Item:onLock', { item: this });\n\t\t}\n\t}\n\n\tunlock(): void\n\t{\n\t\tif (!this.locked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this } });\n\t\t\tdialog.emit('Item:onBeforeUnlock', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.locked = false;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.unlock();\n\t\t\t});\n\t\t}\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.emit('Item:onUnlock', { item: this });\n\t\t}\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\tsetContextSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.contextSort = sort;\n\t\t}\n\t}\n\n\tgetContextSort(): ?number\n\t{\n\t\treturn this.contextSort;\n\t}\n\n\tsetGlobalSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.globalSort = sort;\n\t\t}\n\t}\n\n\tgetGlobalSort(): ?number\n\t{\n\t\treturn this.globalSort;\n\t}\n\n\tsetSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.sort = sort;\n\t\t}\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tgetSearchIndex(): SearchIndex\n\t{\n\t\tif (this.searchIndex === null)\n\t\t{\n\t\t\tthis.searchIndex = SearchIndex.create(this);\n\t\t}\n\n\t\treturn this.searchIndex;\n\t}\n\n\tresetSearchIndex(): void\n\t{\n\t\tthis.searchIndex = null;\n\t}\n\n\tgetCustomData(): Map<string, any>\n\t{\n\t\treturn this.customData;\n\t}\n\n\tsetCustomData(property: ?string | { [key: string]: any }, value?: any): void\n\t{\n\t\tif (Type.isNull(property))\n\t\t{\n\t\t\tthis.customData = new Map();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t\telse if (Type.isPlainObject(property))\n\t\t{\n\t\t\tObject.entries(property).forEach((item) => {\n\t\t\t\tconst [currentKey, currentValue] = item;\n\t\t\t\tthis.customData.set(currentKey, currentValue);\n\t\t\t});\n\n\t\t\tthis.#renderNodes();\n\t\t}\n\t\telse if (Type.isString(property))\n\t\t{\n\t\t\tif (Type.isNull(value))\n\t\t\t{\n\t\t\t\tthis.customData.delete(property);\n\t\t\t\tthis.#renderNodes();\n\t\t\t}\n\t\t\telse if (!Type.isUndefined(value))\n\t\t\t{\n\t\t\t\tthis.customData.set(property, value);\n\t\t\t\tthis.#renderNodes();\n\t\t\t}\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\t#renderNodes(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.render();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetEntityItemOption(option): any\n\t{\n\t\treturn this.getEntity().getItemOption(option, this.getEntityType());\n\t}\n\n\tgetEntityTagOption(option): any\n\t{\n\t\treturn this.getEntity().getTagOption(option, this.getEntityType());\n\t}\n\n\tgetEntityTextNode(option): any\n\t{\n\t\treturn this.getEntity().getOptionTextNode(option, this.getEntityType());\n\t}\n\n\tgetTagOptions(): Map<string, any>\n\t{\n\t\treturn this.tagOptions;\n\t}\n\n\tgetTagOption(option: string): any\n\t{\n\t\tconst value = this.getTagOptions().get(option);\n\n\t\tif (!Type.isUndefined(value))\n\t\t{\n\t\t\treturn value;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetTagGlobalOption(option: string, useItemOptions: boolean = false): any\n\t{\n\t\tif (!Type.isStringFilled(option))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet value = this.getTagOption(option);\n\n\t\tif (value === null && useItemOptions === true && this[option] !== null)\n\t\t{\n\t\t\tvalue = this[option];\n\t\t}\n\n\t\tif (value === null && this.getDialog().getTagSelector())\n\t\t{\n\t\t\tconst fn = `getTag${Text.toPascalCase(option)}`;\n\t\t\tif (Type.isFunction(this.getDialog().getTagSelector()[fn]))\n\t\t\t{\n\t\t\t\tvalue = this.getDialog().getTagSelector()[fn]();\n\t\t\t}\n\t\t}\n\n\t\tif (value === null)\n\t\t{\n\t\t\tvalue = this.getEntityTagOption(option);\n\t\t}\n\n\t\tif (value === null && useItemOptions === true)\n\t\t{\n\t\t\tvalue = this.getEntityItemOption(option);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tgetTagBgColor(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('bgColor');\n\t}\n\n\tgetTagTextColor(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('textColor');\n\t}\n\n\tgetTagMaxWidth(): ?number\n\t{\n\t\treturn this.getTagGlobalOption('maxWidth');\n\t}\n\n\tgetTagFontWeight(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('fontWeight');\n\t}\n\n\tgetTagAvatar(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('avatar', true);\n\t}\n\n\tgetTagAvatarOptions(): ?AvatarOptions\n\t{\n\t\treturn this.getTagGlobalOption('avatarOptions', true);\n\t}\n\n\tgetTagLink(): ?string\n\t{\n\t\treturn this.replaceMacros(this.getTagGlobalOption('link', true));\n\t}\n\n\t/**\n\t * @internal\n\t */\n\treplaceMacros(str: string): string\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\treturn (\n\t\t\tstr\n\t\t\t\t.replace(/#id#/i, this.getId())\n\t\t\t\t.replace(/#element_id#/i, this.getId())\n\t\t);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tcreateTag(): TagItemOptions\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tentityType: this.getEntityType(),\n\t\t\ttitle: this.getTagOption('title') || (this.getTitleNode() && this.getTitleNode().toJSON()) || '',\n\t\t\tdeselectable: this.isDeselectable(),\n\t\t\tavatar: this.getTagAvatar(),\n\t\t\tavatarOptions: this.getTagAvatarOptions(),\n\t\t\tlink: this.getTagLink(),\n\t\t\tmaxWidth: this.getTagMaxWidth(),\n\t\t\ttextColor: this.getTagTextColor(),\n\t\t\tbgColor: this.getTagBgColor(),\n\t\t\tfontWeight: this.getTagFontWeight(),\n\t\t\tonclick: this.getTagOption('onclick'),\n\t\t};\n\t}\n\n\tgetAjaxJson(): { [key: string]: any }\n\t{\n\t\treturn this.toJSON();\n\t}\n\n\ttoJSON(): { [key: string]: any }\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tentityType: this.getEntityType(),\n\t\t\tselected: this.isSelected(),\n\t\t\tdeselectable: this.isDeselectable(),\n\t\t\tsearchable: this.isSearchable(),\n\t\t\tsaveable: this.isSaveable(),\n\t\t\thidden: this.isHidden(),\n\t\t\tlocked: this.isLocked(),\n\t\t\ttitle: this.getTitleNode(),\n\t\t\tlink: this.getLink(),\n\t\t\tlinkTitle: this.getLinkTitleNode(),\n\t\t\tsubtitle: this.getSubtitleNode(),\n\t\t\tsupertitle: this.getSupertitleNode(),\n\t\t\tcaption: this.getCaptionNode(),\n\t\t\tavatar: this.getAvatar(),\n\t\t\ttextColor: this.getTextColor(),\n\t\t\tsort: this.getSort(),\n\t\t\tcontextSort: this.getContextSort(),\n\t\t\tglobalSort: this.getGlobalSort(),\n\t\t\tcustomData: TypeUtils.convertMapToObject(this.getCustomData()),\n\t\t\ttagOptions: TypeUtils.convertMapToObject(this.getTagOptions()),\n\t\t\tbadges: this.getBadges(),\n\t\t};\n\t}\n}\n","import { Cache, Dom, Tag, Type } from 'main.core';\nimport type Tab from '../tabs/tab';\n\nexport default class BaseStub\n{\n\ttab: Tab = null;\n\tautoShow: boolean = true;\n\tcache = new Cache.MemoryCache();\n\tcontent: HTMLElement = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\t\tthis.tab = tab;\n\t\tthis.autoShow = this.getOption('autoShow', true);\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetOuterContainer()\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-stub\">${this.render()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tisAutoShow(): boolean\n\t{\n\t\treturn this.autoShow;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.append(this.getOuterContainer(), this.getTab().getContainer());\n\t\t/*requestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-tab-stub--show');\n\t\t});*/\n\t}\n\n\thide(): void\n\t{\n\t\t// Dom.removeClass(this.getOuterContainer(), 'ui-selector-tab-stub--show');\n\t\tDom.remove(this.getOuterContainer());\n\t}\n\n\tgetOptions(): { [option: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { Tag, Type, Loc } from 'main.core';\nimport { Icon } from 'ui.icon-set.api.core';\n\nimport type Tab from '../tabs/tab';\nimport BaseStub from './base-stub';\nimport encodeUrl from '../../common/encode-url';\n\nexport default class DefaultStub extends BaseStub\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tsuper(tab, options);\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst subtitle = this.getOption('subtitle');\n\t\t\tconst title = Type.isStringFilled(this.getOption('title')) ? this.getOption('title') : this.getDefaultTitle();\n\n\t\t\tconst icon = this.getOption('icon') || this.getTab().getIcon('default');\n\t\t\tlet iconOpacity = 35;\n\t\t\tif (Type.isNumber(this.getOption('iconOpacity')))\n\t\t\t{\n\t\t\t\ticonOpacity = Math.min(100, Math.max(0, this.getOption('iconOpacity')));\n\t\t\t}\n\n\t\t\tconst iconStyle = Type.isStringFilled(icon) && !Icon.isValid({ icon })\n\t\t\t\t? `style=\"background-image: url('${encodeUrl(icon)}'); opacity: ${iconOpacity / 100};\"`\n\t\t\t\t: ''\n\t\t\t;\n\n\t\t\tconst arrow = this.getOption('arrow', false) && this.getTab().getDialog().getActiveFooter() !== null;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-default-stub\">\n\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-icon\" ${iconStyle}></div>\n\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-titles\">\n\t\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-title\">${title}</div>\n\t\t\t\t\t\t${subtitle ? Tag.render`<div class=\"ui-selector-tab-default-stub-subtitle\">${subtitle}</div>` : ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t${arrow ? Tag.render`<div class=\"ui-selector-tab-default-stub-arrow\"></div>` : ''}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDefaultTitle(): string\n\t{\n\t\tconst titleNode = this.getTab().getTitleNode();\n\t\tif (titleNode === null)\n\t\t{\n\t\t\treturn Loc.getMessage('UI_SELECTOR_TAB_STUB_TITLE').replace(/#TAB_TITLE#/, '');\n\t\t}\n\n\t\tconst titleContainer = Tag.render`<span class=\"ui-selector-tab-default-stub-title\"></span>`;\n\t\ttitleNode.renderTo(titleContainer);\n\n\t\treturn Loc.getMessage('UI_SELECTOR_TAB_STUB_TITLE').replace(/#TAB_TITLE#/, titleContainer.innerHTML);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getContainer();\n\t}\n}\n","import { Tag, Type, Dom, Cache } from 'main.core';\nimport Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { HeaderOptions } from './header-content';\n\nexport default class BaseHeader\n{\n\tdialog: Dialog = null;\n\ttab: Tab = null;\n\tcontainer: ?HTMLElement = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(context: Dialog | Tab, options: HeaderOptions)\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\n\t\tif (context instanceof Dialog)\n\t\t{\n\t\t\tthis.dialog = context;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.tab = context;\n\t\t\tthis.dialog = this.tab.getDialog();\n\t\t}\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetTab(): ?Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.addClass(this.getContainer(), 'ui-selector-header--show');\n\t}\n\n\thide(): void\n\t{\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-header--show');\n\t}\n\n\tgetOptions(): HeaderOptions\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.container === null)\n\t\t{\n\t\t\tthis.container = Tag.render`\n\t\t\t\t<div class=\"ui-selector-header\">${this.render()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n}","import { Tag, Type, Dom, Cache } from 'main.core';\nimport Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { FooterOptions } from './footer-content';\n\nexport default class BaseFooter\n{\n\tdialog: Dialog = null;\n\ttab: Tab = null;\n\tcontainer: ?HTMLElement = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(context: Dialog | Tab, options: FooterOptions)\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\n\t\tif (context instanceof Dialog)\n\t\t{\n\t\t\tthis.dialog = context;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.tab = context;\n\t\t\tthis.dialog = this.tab.getDialog();\n\t\t}\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetTab(): ?Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.addClass(this.getContainer(), 'ui-selector-footer--show');\n\t}\n\n\thide(): void\n\t{\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-footer--show');\n\t}\n\n\tgetOptions(): FooterOptions\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.container === null)\n\t\t{\n\t\t\tthis.container = Tag.render`\n\t\t\t\t<div class=\"ui-selector-footer\">${this.render()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n}","import { Type, Tag, Dom, Cache, Reflection } from 'main.core';\nimport { Icon, Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport ItemNode from '../../item/item-node';\nimport Dialog from '../dialog';\nimport BaseStub from './base-stub';\nimport DefaultStub from './default-stub';\nimport BaseHeader from '../header/base-header';\nimport BaseFooter from '../footer/base-footer';\nimport TextNode from '../../common/text-node';\nimport encodeUrl from '../../common/encode-url';\n\nimport type { TabLabelState, TabLabelStates, TabOptions } from './tab-options';\nimport type { HeaderContent, HeaderOptions } from '../header/header-content';\nimport type { FooterContent, FooterOptions } from '../footer/footer-content';\nimport type { TextNodeOptions } from '../../common/text-node-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Tab\n{\n\tid: string = null;\n\ttitle: ?TextNode = null;\n\trootNode: ItemNode = null;\n\n\tdialog: Dialog = null;\n\tstub: BaseStub = null;\n\n\tvisible: boolean = true;\n\trendered: boolean = false;\n\tlocked: boolean = false;\n\tselected: boolean = false;\n\thovered: boolean = false;\n\n\ticon: TabLabelStates = {};\n\ttextColor: TabLabelStates = {};\n\tbgColor: TabLabelStates = {};\n\n\titemMaxDepth: number = 5;\n\n\theader: BaseHeader = null;\n\tshowDefaultHeader = true;\n\tfooter: BaseFooter = null;\n\tshowDefaultFooter = true;\n\tshowAvatars: ?boolean = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(dialog: Dialog, tabOptions: TabOptions)\n\t{\n\t\tconst options: TabOptions = Type.isPlainObject(tabOptions) ? tabOptions : {};\n\n\t\tif (!Type.isStringFilled(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Tab: \"id\" parameter is required.');\n\t\t}\n\n\t\tthis.setDialog(dialog);\n\t\tthis.id = options.id;\n\t\tthis.showDefaultHeader = options.showDefaultHeader !== false;\n\t\tthis.showDefaultFooter = options.showDefaultFooter !== false;\n\n\t\tthis.rootNode = new ItemNode(null, { itemOrder: options.itemOrder });\n\t\tthis.rootNode.setTab(this);\n\n\t\tthis.setVisible(options.visible);\n\t\tthis.setTitle(options.title);\n\t\tthis.setItemMaxDepth(options.itemMaxDepth);\n\t\tthis.setIcon(options.icon ?? Outline.ARROW_RIGHT_L);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setStub(options.stub, options.stubOptions);\n\t\tthis.setHeader(options.header, options.headerOptions);\n\t\tthis.setFooter(options.footer, options.footerOptions);\n\t\tthis.setShowAvatars(options.showAvatars);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tsetDialog(dialog: Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetStub(): ?BaseStub\n\t{\n\t\treturn this.stub;\n\t}\n\n\tsetStub(stub?: boolean | string | Function, stubOptions?: { [option: string]: any }): void\n\t{\n\t\tlet instance = null;\n\t\tconst options = Type.isPlainObject(stubOptions) ? stubOptions : {};\n\n\t\tif (Type.isString(stub) || Type.isFunction(stub))\n\t\t{\n\t\t\tconst className = Type.isString(stub) ? Reflection.getClass(stub) : stub;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\tinstance = new className(this, options);\n\t\t\t\tif (!(instance instanceof BaseStub))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: stub is not an instance of BaseStub.');\n\t\t\t\t\tinstance = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!instance && stub !== false)\n\t\t{\n\t\t\tinstance = new DefaultStub(this, options);\n\t\t}\n\n\t\tthis.stub = instance;\n\t}\n\n\tgetHeader(): ?BaseHeader\n\t{\n\t\treturn this.header;\n\t}\n\n\tsetHeader(headerContent: ?HeaderContent, headerOptions?: HeaderOptions)\n\t{\n\t\t/** @var {BaseHeader} */\n\t\tlet header = null;\n\t\tif (headerContent !== null)\n\t\t{\n\t\t\theader = Dialog.createHeader(this, headerContent, headerOptions);\n\t\t\tif (header === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getHeader() !== null)\n\t\t{\n\t\t\tDom.remove(this.getHeader().getContainer());\n\t\t\tthis.getDialog().adjustHeader();\n\t\t}\n\n\t\tthis.header = header;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getDialog().appendHeader(header);\n\t\t\tthis.getDialog().adjustHeader();\n\t\t}\n\t}\n\n\tcanShowDefaultHeader(): boolean\n\t{\n\t\treturn this.showDefaultHeader;\n\t}\n\n\tenableDefaultHeader(): void\n\t{\n\t\tthis.showDefaultHeader = true;\n\t\tthis.getDialog().adjustHeader();\n\t}\n\n\tdisableDefaultHeader(): void\n\t{\n\t\tthis.showDefaultHeader = false;\n\t\tthis.getDialog().adjustHeader();\n\t}\n\n\tgetFooter(): ?BaseFooter\n\t{\n\t\treturn this.footer;\n\t}\n\n\tsetFooter(footerContent: ?FooterContent, footerOptions?: FooterOptions)\n\t{\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tif (footerContent !== null)\n\t\t{\n\t\t\tfooter = Dialog.createFooter(this, footerContent, footerOptions);\n\t\t\tif (footer === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getFooter() !== null)\n\t\t{\n\t\t\tDom.remove(this.getFooter().getContainer());\n\t\t\tthis.getDialog().adjustFooter();\n\t\t}\n\n\t\tthis.footer = footer;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getDialog().appendFooter(footer);\n\t\t\tthis.getDialog().adjustFooter();\n\t\t}\n\t}\n\n\tcanShowDefaultFooter(): boolean\n\t{\n\t\treturn this.showDefaultFooter;\n\t}\n\n\tenableDefaultFooter(): void\n\t{\n\t\tthis.showDefaultFooter = true;\n\t\tthis.getDialog().adjustFooter();\n\t}\n\n\tdisableDefaultFooter(): void\n\t{\n\t\tthis.showDefaultFooter = false;\n\t\tthis.getDialog().adjustFooter();\n\t}\n\n\tsetShowAvatars(flag: ?boolean): void\n\t{\n\t\tif (Type.isBoolean(flag) || flag === null)\n\t\t{\n\t\t\tthis.showAvatars = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.renderContainer();\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldShowAvatars(): boolean\n\t{\n\t\treturn this.showAvatars ?? this.getDialog().shouldShowAvatars();\n\t}\n\n\tgetRootNode(): ItemNode\n\t{\n\t\treturn this.rootNode;\n\t}\n\n\tsetTitle(title: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.renderLabel();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null && !titleNode.isNullable() ? titleNode.getText() : '';\n\t}\n\n\tgetTitleNode(): TextNode | null\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetIcon(icon: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('icon', icon);\n\t}\n\n\tgetIcon(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('icon', state);\n\t}\n\n\tsetBgColor(bgColor: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('bgColor', bgColor);\n\t}\n\n\tgetBgColor(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('bgColor', state);\n\t}\n\n\tsetTextColor(textColor: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('textColor', textColor);\n\t}\n\n\tgetTextColor(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('textColor', state);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetProperty(name: string, states: TabLabelStates | string): void\n\t{\n\t\tconst property = this[name];\n\t\tif (!property)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isPlainObject(states))\n\t\t{\n\t\t\tObject.keys(states).forEach(state => {\n\t\t\t\tif (Type.isStringFilled(states[state]))\n\t\t\t\t{\n\t\t\t\t\tproperty[state] = states[state];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isStringFilled(states))\n\t\t{\n\t\t\tproperty['default'] = states;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetPropertyByState(name: string, state?: TabLabelState): ?string\n\t{\n\t\tconst property = this[name];\n\t\tconst labelState = Type.isStringFilled(state) ? state : 'default';\n\n\t\tif (!Type.isUndefined(property) && !Type.isUndefined(property[labelState]))\n\t\t{\n\t\t\treturn property[labelState];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetPropertyByCurrentState(name: string): ?string\n\t{\n\t\tconst property = this[name];\n\t\tif (this.isSelected() && this.isHovered() && property.selectedHovered)\n\t\t{\n\t\t\treturn property.selectedHovered;\n\t\t}\n\t\telse if (this.isSelected() && property.selected)\n\t\t{\n\t\t\treturn property.selected;\n\t\t}\n\t\telse if (this.isHovered() && property.hovered)\n\t\t{\n\t\t\treturn property.hovered;\n\t\t}\n\t\telse if (property.default)\n\t\t{\n\t\t\treturn property.default;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetItemMaxDepth(depth: number): void\n\t{\n\t\tif (Type.isNumber(depth) && depth > 0)\n\t\t{\n\t\t\tthis.itemMaxDepth = depth;\n\t\t}\n\t}\n\n\tgetItemMaxDepth(): number\n\t{\n\t\treturn this.itemMaxDepth;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-content\">${this.getItemsContainer()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\tconst className = this.isVisible() ? '' : ' ui-selector-tab-label-hidden';\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-selector-tab-label${className} --ui-hoverable\"\n\t\t\t\t\tonclick=\"${this.handleLabelClick.bind(this)}\"\n\t\t\t\t\tonmouseenter=\"${this.handleLabelMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.handleLabelMouseLeave.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${this.getIconContainer()}\n\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetIconContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-icon\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-title\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('items', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-items\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\trender(): void\n\t{\n\t\tthis.getRootNode().render();\n\t\tthis.rendered = true;\n\t}\n\n\t/** @internal **/\n\trenderLabel(): void\n\t{\n\t\tDom.style(this.getTitleContainer(), 'color', this.getPropertyByCurrentState('textColor'));\n\t\tDom.style(this.getLabelContainer(), 'background-color', this.getPropertyByCurrentState('bgColor'));\n\n\t\tconst icon = this.getPropertyByCurrentState('icon');\n\t\tDom.clean(this.getIconContainer());\n\t\ttry\n\t\t{\n\t\t\tDom.append(new Icon({ icon }).render(), this.getIconContainer());\n\t\t\tDom.style(this.getIconContainer(), 'mask-image', 'none');\n\t\t\tDom.style(this.getIconContainer(), 'background-color', 'transparent');\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tDom.style(this.getIconContainer(), 'mask-image', icon ? `url('${encodeUrl(icon)}')` : null);\n\t\t}\n\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\tthis.getTitleNode().renderTo(this.getTitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().textContent = '';\n\t\t}\n\t}\n\n\t/** @internal **/\n\trenderContainer(): void\n\t{\n\t\tconst className = 'ui-selector-tab-content--hide-avatars';\n\t\tif (this.shouldShowAvatars())\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), className);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), className);\n\t\t}\n\t}\n\n\tisVisible(): boolean\n\t{\n\t\treturn this.visible;\n\t}\n\n\tsetVisible(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.visible = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (this.visible)\n\t\t\t\t{\n\t\t\t\t\tDom.remove(this.getLabelContainer(), 'ui-selector-tab-label-hidden');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-hidden');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tselect(): void\n\t{\n\t\tif (this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getContainer(), 'ui-selector-tab-content-active');\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-active');\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tthis.selected = true;\n\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tif (this.getHeader())\n\t\t{\n\t\t\tthis.getHeader().show();\n\t\t}\n\n\t\tif (this.getFooter())\n\t\t{\n\t\t\tthis.getFooter().show();\n\t\t}\n\n\t\tthis.getDialog().emit('Tab:onSelect', { tab: this });\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tdeselect(): void\n\t{\n\t\tif (!this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-tab-content-active');\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tDom.removeClass(this.getLabelContainer(), 'ui-selector-tab-label-active');\n\t\t}\n\n\t\tthis.selected = false;\n\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tif (this.getHeader())\n\t\t{\n\t\t\tthis.getHeader().hide();\n\t\t}\n\n\t\tif (this.getFooter())\n\t\t{\n\t\t\tthis.getFooter().hide();\n\t\t}\n\n\t\tthis.getDialog().emit('Tab:onDeselect', { tab: this\t});\n\t}\n\n\thover(): void\n\t{\n\t\tif (this.isHovered())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-hover');\n\t\tthis.hovered = true;\n\n\t\tthis.renderLabel();\n\t}\n\n\tunhover(): void\n\t{\n\t\tif (!this.isHovered())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getLabelContainer(), 'ui-selector-tab-label-hover');\n\t\tthis.hovered = false;\n\n\t\tthis.renderLabel();\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.selected;\n\t}\n\n\tisHovered(): boolean\n\t{\n\t\treturn this.hovered;\n\t}\n\n\tlock(): void\n\t{\n\t\tthis.locked = true;\n\t\tDom.addClass(this.getContainer(), 'ui-selector-tab-content-locked');\n\t}\n\n\tunlock(): void\n\t{\n\t\tthis.locked = false;\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-tab-content-locked');\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\thandleLabelClick(): void\n\t{\n\t\tthis.getDialog().selectTab(this.getId());\n\t}\n\n\thandleLabelMouseEnter(): void\n\t{\n\t\tthis.hover();\n\t}\n\n\thandleLabelMouseLeave(): void\n\t{\n\t\tthis.unhover();\n\t}\n}\n","import { BaseError, Type } from 'main.core';\n\n/**\n * @namespace BX.UI.Uploader\n */\nexport default class EntityError extends BaseError\n{\n\t#entityId: string;\n\n\tsetEntityId(entityId: string): void\n\t{\n\t\tif (Type.isStringFilled(entityId))\n\t\t{\n\t\t\tthis.#entityId = entityId;\n\t\t}\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.#entityId;\n\t}\n}\n","import { Type } from 'main.core';\nimport EntityError from './entity-error';\nimport type { EntityErrorOptions } from './entity-error-options';\n\n/**\n * @namespace BX.UI.Uploader\n */\nexport default class EntityErrorCollection\n{\n\t#errors: EntityError[] = [];\n\n\tstatic create(errorOptions: EntityErrorOptions[]): this\n\t{\n\t\tconst errorCollection = new this();\n\t\terrorOptions.forEach((errorOption: EntityErrorOptions) => {\n\t\t\tif (!Type.isStringFilled(errorOption.entityId))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst error = new EntityError();\n\t\t\terror.setEntityId(errorOption.entityId);\n\n\t\t\tif (Type.isStringFilled(errorOption.message))\n\t\t\t{\n\t\t\t\terror.setMessage(errorOption.message);\n\t\t\t}\n\n\t\t\tif (!Type.isNil(errorOption.code))\n\t\t\t{\n\t\t\t\terror.setCode(errorOption.code);\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(errorOption.customData))\n\t\t\t{\n\t\t\t\terror.setCustomData(errorOption.customData);\n\t\t\t}\n\n\t\t\terrorCollection.add(error);\n\t\t});\n\n\t\treturn errorCollection;\n\t}\n\n\tgetByEntityId(entityId: string): Array\n\t{\n\t\treturn this.#errors.filter((error: EntityError) => error.getEntityId() === entityId);\n\t}\n\n\tadd(item: EntityError): void\n\t{\n\t\tthis.#errors.push(item);\n\t}\n\n\thas(item: EntityError): boolean\n\t{\n\t\treturn this.#errors.includes(item);\n\t}\n\n\tclear(): void\n\t{\n\t\tthis.#errors = [];\n\t}\n\n\tgetIndex(item: EntityError): number\n\t{\n\t\treturn this.#errors.indexOf(item);\n\t}\n\n\tgetByIndex(index: number): ?EntityError\n\t{\n\t\tif (Type.isNumber(index) && index >= 0)\n\t\t{\n\t\t\tconst error = this.#errors[index];\n\n\t\t\treturn Type.isUndefined(error) ? null : error;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t[Symbol.iterator](): IterableIterator<EntityError>\n\t{\n\t\treturn this.#errors[Symbol.iterator]();\n\t}\n}\n","import { Cache, Tag, Type, Dom } from 'main.core';\nimport { Icon } from 'ui.icon-set.api.core';\nimport Entity from '../entity/entity';\nimport TextNode from '../common/text-node';\nimport Animation from '../common/animation';\nimport TypeUtils from '../common/type-utils';\nimport encodeUrl from '../common/encode-url';\n\nimport type TagSelector from './tag-selector';\nimport type { TagItemOptions } from './tag-item-options';\nimport type { TextNodeOptions } from '../common/text-node-options';\nimport type { AvatarOptions } from '../item/avatar-options';\n\nexport default class TagItem\n{\n\tid: string | number = null;\n\tentityId: string = null;\n\tentityType: string = null;\n\ttitle: ?TextNode = null;\n\n\tavatar: ?string = null;\n\tavatarOptions: ?AvatarOptions = null;\n\tmaxWidth: ?number = null;\n\ttextColor: ?string = null;\n\tbgColor: ?string = null;\n\tfontWeight: ?string = null;\n\n\tlink: ?string = null;\n\tonclick: ?Function = null;\n\tclickable: boolean = null;\n\n\tdeselectable: ?boolean = null;\n\tcustomData: Map<string, any> = null;\n\n\tcache = new Cache.MemoryCache();\n\tselector: TagSelector = null;\n\trendered: ?boolean = false;\n\n\tconstructor(itemOptions: TagItemOptions)\n\t{\n\t\tconst options = Type.isPlainObject(itemOptions) ? itemOptions : {};\n\t\tif (!Type.isStringFilled(options.id) && !Type.isNumber(options.id))\n\t\t{\n\t\t\tthrow new Error('TagSelector.TagItem: \"id\" parameter is required.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(options.entityId))\n\t\t{\n\t\t\tthrow new Error('TagSelector.TagItem: \"entityId\" parameter is required.');\n\t\t}\n\n\t\tthis.id = options.id;\n\t\tthis.entityId = options.entityId.toLowerCase();\n\t\tthis.entityType = Type.isStringFilled(options.entityType) ? options.entityType : 'default';\n\t\tthis.customData = TypeUtils.createMapFromOptions(options.customData);\n\n\t\tthis.onclick = Type.isFunction(options.onclick) ? options.onclick : null;\n\t\tthis.link = Type.isStringFilled(options.link) ? options.link : null;\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setDeselectable(options.deselectable);\n\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setAvatarOptions(options.avatarOptions);\n\t\tthis.setMaxWidth(options.maxWidth);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setFontWeight(options.fontWeight);\n\t\tthis.setClickable(options.clickable);\n\t}\n\n\tgetId(): string | number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tgetSelector(): TagSelector\n\t{\n\t\treturn this.selector;\n\t}\n\n\tsetSelector(selector: TagSelector)\n\t{\n\t\tthis.selector = selector;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.getTitleNode() && !this.getTitleNode().isNullable() ? this.getTitleNode().getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\tif (this.avatar !== null)\n\t\t{\n\t\t\treturn this.avatar;\n\t\t}\n\n\t\tif (this.getSelector().getTagAvatar() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagAvatar();\n\t\t}\n\n\t\tif (this.getEntityTagOption('avatar') !== null)\n\t\t{\n\t\t\treturn this.getEntityTagOption('avatar');\n\t\t}\n\n\t\treturn this.getEntityItemOption('avatar');\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t}\n\t}\n\n\tgetAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\tif (this.avatarOptions !== null && !Type.isUndefined(this.avatarOptions[option]))\n\t\t{\n\t\t\treturn this.avatarOptions[option];\n\t\t}\n\n\t\tconst selectorAvatarOption = this.getSelector().getTagAvatarOption(option);\n\t\tif (selectorAvatarOption !== null)\n\t\t{\n\t\t\treturn selectorAvatarOption[option];\n\t\t}\n\n\t\tconst entityTagAvatarOptions = this.getEntityTagOption('avatarOptions');\n\t\tif (Type.isPlainObject(entityTagAvatarOptions) && !Type.isUndefined(entityTagAvatarOptions[option]))\n\t\t{\n\t\t\treturn entityTagAvatarOptions[option];\n\t\t}\n\n\t\tconst entityItemAvatarOptions = this.getEntityItemOption('avatarOptions');\n\t\tif (Type.isPlainObject(entityItemAvatarOptions) && !Type.isUndefined(entityItemAvatarOptions[option]))\n\t\t{\n\t\t\treturn entityItemAvatarOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.avatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.avatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.avatarOptions[option] = value;\n\t\t}\n\t}\n\n\tsetAvatarOptions(options: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setAvatarOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\tif (this.textColor !== null)\n\t\t{\n\t\t\treturn this.textColor;\n\t\t}\n\n\t\tif (this.getSelector().getTagTextColor() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagTextColor();\n\t\t}\n\n\t\treturn this.getEntityTagOption('textColor');\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\t}\n\n\tgetBgColor(): ?string\n\t{\n\t\tif (this.bgColor !== null)\n\t\t{\n\t\t\treturn this.bgColor;\n\t\t}\n\n\t\tif (this.getSelector().getTagBgColor() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagBgColor();\n\t\t}\n\n\t\treturn this.getEntityTagOption('bgColor');\n\t}\n\n\tsetBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.bgColor = bgColor;\n\t\t}\n\t}\n\n\tgetFontWeight(): ?string\n\t{\n\t\tif (this.fontWeight !== null)\n\t\t{\n\t\t\treturn this.fontWeight;\n\t\t}\n\n\t\tif (this.getSelector().getTagFontWeight() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagFontWeight();\n\t\t}\n\n\t\treturn this.getEntityTagOption('fontWeight');\n\t}\n\n\tsetFontWeight(fontWeight: ?string): void\n\t{\n\t\tif (Type.isString(fontWeight) || fontWeight === null)\n\t\t{\n\t\t\tthis.fontWeight = fontWeight;\n\t\t}\n\t}\n\n\tgetMaxWidth(): ?number\n\t{\n\t\tif (this.maxWidth !== null)\n\t\t{\n\t\t\treturn this.maxWidth;\n\t\t}\n\n\t\tif (this.getSelector().getTagMaxWidth() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagMaxWidth();\n\t\t}\n\n\t\treturn this.getEntityTagOption('maxWidth');\n\t}\n\n\tsetMaxWidth(width: ?number): void\n\t{\n\t\tif ((Type.isNumber(width) && width >= 0) || width === null)\n\t\t{\n\t\t\tthis.maxWidth = width;\n\t\t}\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.toggleClass(this.getContainer(), 'ui-tag-selector-tag-readonly', !flag);\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable === null ? this.getSelector().isDeselectable() : this.deselectable;\n\t}\n\n\tgetCustomData(): Map<string, any>\n\t{\n\t\treturn this.customData;\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\treturn this.link;\n\t}\n\n\tgetOnclick(): ?Function\n\t{\n\t\treturn this.onclick;\n\t}\n\n\tsetClickable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.clickable = flag;\n\t\t}\n\t}\n\n\tisClickable(): boolean\n\t{\n\t\tif (this.clickable !== null)\n\t\t{\n\t\t\treturn this.clickable;\n\t\t}\n\n\t\tif (this.getSelector().getTagClickable() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagClickable();\n\t\t}\n\n\t\tif (this.getEntityTagOption('clickable') !== null)\n\t\t{\n\t\t\treturn this.getEntityTagOption('clickable');\n\t\t}\n\n\t\tif (this.getEntityItemOption('clickable') !== null)\n\t\t{\n\t\t\treturn this.getEntityItemOption('clickable');\n\t\t}\n\n\t\treturn false;\n\t}\n\n\trender(): void\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\ttitleNode.renderTo(this.getTitleContainer());\n\n\t\t\tconst title = this.getTitleContainer().textContent;\n\t\t\tthis.getContentContainer().setAttribute('title', this.constructor.#sanitizeTitle(title));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().textContent = '';\n\t\t\tDom.attr(this.getContentContainer(), 'title', null);\n\t\t}\n\n\t\tconst avatar = this.getAvatar();\n\t\tconst bgImage = this.getAvatarOption('bgImage');\n\t\tif (Type.isStringFilled(avatar))\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', `url('${encodeUrl(avatar)}')`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', bgImage);\n\t\t}\n\n\t\tconst bgColor = this.getAvatarOption('bgColor');\n\t\tconst bgSize = this.getAvatarOption('bgSize');\n\t\tconst border = this.getAvatarOption('border');\n\t\tconst borderRadius = this.getAvatarOption('borderRadius');\n\t\tconst outline = this.getAvatarOption('outline');\n\t\tconst outlineOffset = this.getAvatarOption('outlineOffset');\n\n\t\tDom.clean(this.getAvatarContainer());\n\t\tDom.style(this.getAvatarContainer(), 'background-color', bgColor);\n\t\tDom.style(this.getAvatarContainer(), 'background-size', bgSize);\n\t\tDom.style(this.getAvatarContainer(), 'border', border);\n\t\tDom.style(this.getAvatarContainer(), 'border-radius', borderRadius);\n\t\tDom.style(this.getAvatarContainer(), 'outline', outline);\n\t\tDom.style(this.getAvatarContainer(), 'outline-offset', outlineOffset);\n\n\t\tconst icon = {\n\t\t\ticon: this.getAvatarOption('icon'),\n\t\t\tsize: bgSize ?? undefined,\n\t\t\tcolor: this.getAvatarOption('iconColor') ?? undefined,\n\t\t};\n\t\tif (Icon.isValid(icon))\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', 'none');\n\t\t\tDom.append(new Icon(icon).render(), this.getAvatarContainer());\n\t\t}\n\n\t\tconst hasAvatar = avatar || (bgColor && bgColor !== 'none') || (bgImage && bgImage !== 'none') || Icon.isValid(icon);\n\t\tif (hasAvatar)\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--has-avatar');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag--has-avatar');\n\t\t}\n\n\t\tconst maxWidth = this.getMaxWidth();\n\t\tif (maxWidth > 0)\n\t\t{\n\t\t\tDom.style(this.getContainer(), 'max-width', `${maxWidth}px`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getContainer(), 'max-width', null);\n\t\t}\n\n\t\tif (this.isDeselectable())\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag-readonly');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag-readonly');\n\t\t}\n\n\t\tDom.style(this.getTitleContainer(), 'color', this.getTextColor());\n\t\tDom.style(this.getTitleContainer(), 'font-weight', this.getFontWeight());\n\t\tDom.style(this.getContainer(), 'background-color', this.getBgColor());\n\n\t\tthis.rendered = true;\n\t}\n\n\tstatic #sanitizeTitle(text: string): string\n\t{\n\t\treturn text.replaceAll(/[\\t ]+/gm, ' ').replaceAll(/\\n+/gm, '\\n').trim();\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-item ui-tag-selector-tag\">\n\t\t\t\t\t${this.getContentContainer()}\n\t\t\t\t\t${this.getRemoveIcon()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('content-container', () => {\n\t\t\tif (Type.isStringFilled(this.getLink()))\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"ui-tag-selector-tag-content\"\n\t\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t\thref=\"${this.getLink()}\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tconst className = this.isClickable() || this.getOnclick() !== null ? ' ui-tag-selector-tag-content--clickable' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-tag-selector-tag-content${className}\"\n\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAvatarContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-avatar\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-title\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetRemoveIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('remove-icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-tag-selector-tag-remove ui-icon-set__scope\"\n\t\t\t\t\tonclick=\"${this.handleRemoveIconClick.bind(this)}\"\n\t\t\t\t\tdata-testid=\"ui-tag-selector-remove-item-button\"\n\t\t\t\t\tdata-item-entity-id=\"${this.getEntityId()}\"\n\t\t\t\t\tdata-item-id=\"${this.getId()}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetEntityTagOption(option: string): any\n\t{\n\t\treturn Entity.getTagOption(this.getEntityId(), option, this.getEntityType());\n\t}\n\n\tgetEntityItemOption(option: string): any\n\t{\n\t\treturn Entity.getItemOption(this.getEntityId(), option, this.getEntityType());\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getSelector() && this.getSelector().isRendered();\n\t}\n\n\tremove(animate: boolean = true): Promise\n\t{\n\t\tif (animate === false)\n\t\t{\n\t\t\tDom.remove(this.getContainer());\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tDom.style(this.getContainer(), 'width', `${this.getContainer().offsetWidth}px`);\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--remove');\n\t\t\tAnimation.handleAnimationEnd(this.getContainer(), 'ui-tag-selector-tag-remove').then(() => {\n\t\t\t\tDom.remove(this.getContainer());\n\t\t\t\tresolve();\n\t\t\t}).catch(() => {\n\t\t\t\t// Fail silently\n\t\t\t});\n\t\t});\n\t}\n\n\tshow(): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--show');\n\t\t\tAnimation.handleAnimationEnd(this.getContainer(), 'ui-tag-selector-tag-show').then(() => {\n\t\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag--show');\n\t\t\t\tresolve();\n\t\t\t}).catch(() => {\n\t\t\t\t// Fail silently\n\t\t\t});\n\t\t});\n\t}\n\n\thandleContainerClick(): void\n\t{\n\t\tconst fn = this.getOnclick();\n\t\tif (Type.isFunction(fn))\n\t\t{\n\t\t\tfn(this);\n\t\t}\n\n\t\tconst selector = this.getSelector();\n\t\tselector.emit('TagItem:onClick', { item: this });\n\t}\n\n\thandleRemoveIconClick(event: MouseEvent): void\n\t{\n\t\tevent.stopPropagation();\n\t\tif (this.isDeselectable())\n\t\t{\n\t\t\tthis.getSelector().removeTag(this);\n\t\t}\n\t}\n}\n","import { Cache, Dom, Tag, Text, Type, Loc, Browser } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport 'ui.icon-set.outline';\n\nimport Dialog from '../dialog/dialog';\nimport TagItem from './tag-item';\n\nimport type { TagSelectorOptions } from './tag-selector-options';\nimport type { ItemOptions } from '../item/item-options';\nimport type { TagItemOptions } from './tag-item-options';\nimport type { AvatarOptions } from '../item/avatar-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class TagSelector extends EventEmitter\n{\n\ttags: TagItem[] = [];\n\tcache = new Cache.MemoryCache();\n\trendered: false;\n\n\tmultiple: boolean = true;\n\treadonly: boolean = false;\n\tlocked: boolean = false;\n\tdeselectable: boolean = true;\n\n\taddButtonCaption: ?string = null;\n\taddButtonCaptionMore: ?string = null;\n\tcreateButtonCaption: ?string = null;\n\taddButtonVisible: boolean = true;\n\tcreateButtonVisible: boolean = false;\n\ttextBoxVisible: boolean = false;\n\ttextBoxWidth: string | number | null = null;\n\tmaxHeight: ?number = null;\n\n\tplaceholder: string = '';\n\ttextBoxAutoHide: boolean = false;\n\ttextBoxOldValue = '';\n\n\ttagAvatar: ?string = null;\n\ttagAvatarOptions: ?AvatarOptions = null;\n\ttagTextColor: ?string = null;\n\ttagBgColor: ?string = null;\n\ttagFontWeight: ?string = null;\n\ttagMaxWidth: ?number = null;\n\ttagClickable: boolean = null;\n\n\tdialog: ?Dialog = null;\n\n\tconstructor(selectorOptions: TagSelectorOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.TagSelector');\n\n\t\tconst options = Type.isPlainObject(selectorOptions) ? selectorOptions : {};\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : `ui-tag-selector-${Text.getRandom().toLowerCase()}`;\n\t\tthis.multiple = Type.isBoolean(options.multiple) ? options.multiple : true;\n\n\t\tthis.addButtonVisible = options.showAddButton !== false;\n\t\tthis.createButtonVisible = options.showCreateButton === true;\n\t\tthis.textBoxVisible = options.showTextBox === true;\n\n\t\tthis.setReadonly(options.readonly);\n\t\tthis.setLocked(options.locked);\n\t\tthis.setAddButtonCaption(options.addButtonCaption);\n\t\tthis.setAddButtonCaptionMore(options.addButtonCaptionMore);\n\t\tthis.setCreateButtonCaption(options.createButtonCaption);\n\t\tthis.setPlaceholder(options.placeholder);\n\t\tthis.setTextBoxAutoHide(options.textBoxAutoHide);\n\t\tthis.setTextBoxWidth(options.textBoxWidth);\n\t\tthis.setDeselectable(options.deselectable);\n\t\tthis.setMaxHeight(options.maxHeight);\n\n\t\tthis.setTagAvatar(options.tagAvatar);\n\t\tthis.setTagAvatarOptions(options.tagAvatarOptions);\n\t\tthis.setTagMaxWidth(options.tagMaxWidth);\n\t\tthis.setTagTextColor(options.tagTextColor);\n\t\tthis.setTagBgColor(options.tagBgColor);\n\t\tthis.setTagFontWeight(options.tagFontWeight);\n\t\tthis.setTagClickable(options.tagClickable);\n\n\t\tif (Type.isPlainObject(options.dialogOptions))\n\t\t{\n\t\t\tlet selectedItems = Type.isArray(options.items) ? options.items : [];\n\t\t\tif (Type.isArray(options.dialogOptions.selectedItems))\n\t\t\t{\n\t\t\t\tselectedItems = selectedItems.concat(options.dialogOptions.selectedItems);\n\t\t\t}\n\n\t\t\tconst dialogOptions = Object.assign(\n\t\t\t\t{},\n\t\t\t\toptions.dialogOptions,\n\t\t\t\t{\n\t\t\t\t\ttagSelectorOptions: null,\n\t\t\t\t\tselectedItems,\n\t\t\t\t\tmultiple: this.isMultiple(),\n\t\t\t\t\ttagSelector: this\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t(new Dialog(dialogOptions));\n\t\t}\n\t\telse if (Type.isArray(options.items))\n\t\t{\n\t\t\toptions.items.forEach((item) => {\n\t\t\t\tthis.addTag(item);\n\t\t\t});\n\t\t}\n\n\t\tthis.subscribeFromOptions(options.events);\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\t/**\n\t * @internal\n\t * @param dialog\n\t */\n\tsetDialog(dialog: ?Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tsetReadonly(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.readonly = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-tag-selector-container-readonly');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-tag-selector-container-readonly');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisReadonly(): boolean\n\t{\n\t\treturn this.readonly;\n\t}\n\n\tsetLocked(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.locked = flag;\n\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-tag-selector-container-locked');\n\t\t\t\tthis.getTextBox().disabled = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-tag-selector-container-locked');\n\t\t\t\tthis.getTextBox().disabled = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tlock(): void\n\t{\n\t\tif (!this.isLocked())\n\t\t{\n\t\t\tthis.setLocked(true);\n\t\t}\n\t}\n\n\tunlock(): void\n\t{\n\t\tif (this.isLocked())\n\t\t{\n\t\t\tthis.setLocked(false);\n\t\t}\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn this.multiple;\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tconst changed = this.deselectable !== flag;\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\tthis.updateTags();\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable;\n\t}\n\n\tgetTag(tagItem: TagItem | ItemOptions): ?TagItem\n\t{\n\t\tif (tagItem instanceof TagItem)\n\t\t{\n\t\t\treturn this.getTags().find(tag => tag === tagItem);\n\t\t}\n\t\telse if (Type.isPlainObject(tagItem))\n\t\t{\n\t\t\tconst { id, entityId } = tagItem;\n\t\t\treturn this.getTags().find((tag: TagItem) => tag.getId() === id && tag.getEntityId() === entityId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddTag(tagOptions: TagItemOptions): ?TagItem\n\t{\n\t\tif (!Type.isObjectLike(tagOptions))\n\t\t{\n\t\t\tthrow new Error('TagSelector.addTag: wrong item options.');\n\t\t}\n\n\t\tif (this.getTag(tagOptions))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst tag = new TagItem(tagOptions);\n\t\ttag.setSelector(this);\n\n\t\tconst event = new BaseEvent({ data: { tag } });\n\t\tthis.emit('onBeforeTagAdd', event);\n\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!this.isMultiple())\n\t\t{\n\t\t\tthis.removeTags();\n\t\t}\n\n\t\tthis.tags.push(tag);\n\n\t\tthis.emit('onTagAdd', { tag });\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\ttag.render();\n\t\t\tthis.getItemsContainer().insertBefore(tag.getContainer(), this.getTextBox());\n\n\t\t\tif (tagOptions.animate !== false)\n\t\t\t{\n\t\t\t\ttag.show().then(() => {\n\t\t\t\t\tthis.getContainer().scrollTop = this.getContainer().scrollHeight - this.getContainer().offsetHeight;\n\t\t\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t\t}\n\n\t\t\tthis.toggleAddButtonCaption();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t}\n\n\t\treturn tag;\n\t}\n\n\tremoveTag(item: TagItem | ItemOptions, animate = true): void\n\t{\n\t\tconst tagItem = this.getTag(item);\n\t\tif (!tagItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { tag: tagItem } });\n\t\tthis.emit('onBeforeTagRemove', event);\n\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tags = this.tags.filter(el => el !== tagItem);\n\n\t\tthis.emit('onTagRemove', { tag: tagItem });\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\ttagItem.remove(animate).then(() => {\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t\tthis.emit('onAfterTagRemove', { tag: tagItem });\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onAfterTagRemove', { tag: tagItem });\n\t\t}\n\t}\n\n\tremoveTags(): void\n\t{\n\t\tthis.getTags().forEach(tag => {\n\t\t\tthis.removeTag(tag, false);\n\t\t});\n\t}\n\n\tgetTags(): TagItem[]\n\t{\n\t\treturn this.tags;\n\t}\n\n\trenderTo(node: HTMLElement): void\n\t{\n\t\tthis.rendered = true;\n\n\t\tthis.getTags().forEach((tag: TagItem) => {\n\t\t\ttag.render();\n\t\t\tthis.getItemsContainer().insertBefore(tag.getContainer(), this.getTextBox());\n\t\t});\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tDom.append(this.getOuterContainer(), node);\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tupdateTags(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getTags().forEach((tag: TagItem) => {\n\t\t\t\ttag.render();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetOuterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\t\t\tlet className = this.isReadonly() ? ' ui-tag-selector-container-readonly' : '';\n\t\t\tclassName += this.isLocked() ? ' ui-tag-selector-container-locked' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-outer-container --air --ui-context-content-light${className}\">${this.getContainer()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst style =\n\t\t\t\tthis.getMaxHeight()\n\t\t\t\t\t? ` style=\"max-height: ${this.getMaxHeight()}px; -ms-overflow-style: -ms-autohiding-scrollbar;\"`\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-tag-selector-container\" \n\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t${style}\n\t\t\t\t>\n\t\t\t\t\t${this.getItemsContainer()}\n\t\t\t\t\t${this.getCreateButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('items-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-items\">\n\t\t\t\t\t${this.getTextBox()}\n\t\t\t\t\t${this.getAddButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTextBox(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('text-box', () => {\n\t\t\tconst className = this.textBoxVisible ? '' : ' ui-tag-selector-item-hidden';\n\t\t\tconst input = Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"ui-tag-selector-item ui-tag-selector-text-box${className}\" \n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\toninput=\"${this.handleTextBoxInput.bind(this)}\"\n\t\t\t\t\tonblur=\"${this.handleTextBoxBlur.bind(this)}\"\n\t\t\t\t\tonkeyup=\"${this.handleTextBoxKeyUp.bind(this)}\"\n\t\t\t\t\tonkeydown=\"${this.handleTextBoxKeyDown.bind(this)}\"\n\t\t\t\t\tvalue=\"\"\n\t\t\t\t>\n\t\t\t`;\n\n\t\t\tconst width = this.getTextBoxWidth();\n\t\t\tif (width !== null)\n\t\t\t{\n\t\t\t\tDom.style(input, 'min-width', Type.isStringFilled(width) ? width : `${width}px`);\n\t\t\t}\n\n\t\t\tif (this.isLocked())\n\t\t\t{\n\t\t\t\tinput.disabled = true;\n\t\t\t}\n\n\t\t\treturn input;\n\t\t});\n\t}\n\n\tgetItemsHeight(): number\n\t{\n\t\treturn this.getItemsContainer().scrollHeight;\n\t}\n\n\tcalcHeight(): number\n\t{\n\t\tif (this.getMaxHeight() !== null)\n\t\t{\n\t\t\treturn Math.min(this.getItemsHeight(), this.getMaxHeight());\n\t\t}\n\n\t\treturn Math.max(this.getItemsHeight(), this.getMinHeight());\n\t}\n\n\tgetTextBoxValue(): string\n\t{\n\t\treturn this.getTextBox().value;\n\t}\n\n\tclearTextBox(): void\n\t{\n\t\tthis.getTextBox().value = '';\n\t\tthis.textBoxOldValue = '';\n\t}\n\n\tshowTextBox(): void\n\t{\n\t\tthis.textBoxVisible = true;\n\t\tDom.removeClass(this.getTextBox(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideTextBox(): void\n\t{\n\t\tthis.textBoxVisible = false;\n\t\tDom.addClass(this.getTextBox(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tfocusTextBox(): void\n\t{\n\t\tthis.getTextBox().focus();\n\t}\n\n\tsetTextBoxAutoHide(autoHide: boolean): void\n\t{\n\t\tif (Type.isBoolean(autoHide))\n\t\t{\n\t\t\tthis.textBoxAutoHide = autoHide;\n\t\t}\n\t}\n\n\tgetTextBoxWidth(): string | number | null\n\t{\n\t\treturn this.textBoxWidth;\n\t}\n\n\tsetTextBoxWidth(width: string | number | null): void\n\t{\n\t\tif (Type.isStringFilled(width) || width === null)\n\t\t{\n\t\t\tthis.textBoxWidth = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getTextBox(), 'min-width', width);\n\t\t\t}\n\t\t}\n\t\telse if (Type.isNumber(width) && width > 0)\n\t\t{\n\t\t\tthis.textBoxWidth = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getTextBox(), 'min-width', `${width}px`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTagMaxWidth(): ?number\n\t{\n\t\treturn this.tagMaxWidth;\n\t}\n\n\tsetTagMaxWidth(width: ?number): void\n\t{\n\t\tif ((Type.isNumber(width) && width >= 0) || width === null)\n\t\t{\n\t\t\tthis.tagMaxWidth = width;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagAvatar(): ?string\n\t{\n\t\treturn this.tagAvatar;\n\t}\n\n\tsetTagAvatar(tagAvatar: ?string): void\n\t{\n\t\tif (Type.isString(tagAvatar) || tagAvatar === null)\n\t\t{\n\t\t\tthis.tagAvatar = tagAvatar;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagClickable(): boolean | null\n\t{\n\t\treturn this.tagClickable;\n\t}\n\n\tsetTagClickable(flag: boolean | null): void\n\t{\n\t\tif (Type.isBoolean(flag) || flag === null)\n\t\t{\n\t\t\tthis.tagClickable = flag;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagAvatarOptions(): ?AvatarOptions\n\t{\n\t\treturn this.tagAvatarOptions;\n\t}\n\n\tgetTagAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\tif (this.tagAvatarOptions !== null && !Type.isUndefined(this.tagAvatarOptions[option]))\n\t\t{\n\t\t\treturn this.tagAvatarOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetTagAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.tagAvatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.tagAvatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.tagAvatarOptions[option] = value;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tsetTagAvatarOptions(options: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setTagAvatarOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTagTextColor(): ?string\n\t{\n\t\treturn this.tagTextColor;\n\t}\n\n\tsetTagTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.tagTextColor = textColor;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagBgColor(): ?string\n\t{\n\t\treturn this.tagBgColor;\n\t}\n\n\tsetTagBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.tagBgColor = bgColor;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagFontWeight(): ?string\n\t{\n\t\treturn this.tagFontWeight;\n\t}\n\n\tsetTagFontWeight(fontWeight: ?string): void\n\t{\n\t\tif (Type.isString(fontWeight) || fontWeight === null)\n\t\t{\n\t\t\tthis.tagFontWeight = fontWeight;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn this.placeholder;\n\t}\n\n\tsetPlaceholder(placeholder: string): void\n\t{\n\t\tif (Type.isStringFilled(placeholder))\n\t\t{\n\t\t\tthis.placeholder = placeholder;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getTextBox().placeholder = placeholder;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMaxHeight(): ?number\n\t{\n\t\treturn this.maxHeight;\n\t}\n\n\tgetMinHeight(): number\n\t{\n\t\treturn 34;\n\t}\n\n\tsetMaxHeight(height: ?number): void\n\t{\n\t\tif ((Type.isNumber(height) && height > 0) || height === null)\n\t\t{\n\t\t\tthis.maxHeight = height;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'max-height', height > 0 ? `${height}px` : null);\n\t\t\t\tDom.style(this.getContainer(), '-ms-overflow-style', height > 0 ? '-ms-autohiding-scrollbar' : null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAddButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('add-button', () => {\n\t\t\tconst className = this.addButtonVisible ? '' : ' ui-tag-selector-item-hidden';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<span\n\t\t\t\t\tclass=\"ui-tag-selector-item ui-tag-selector-add-button${className}\"\n\t\t\t\t\tdata-testid=\"ui-tag-selector-add-item-button\"\n\t\t\t\t>\n\t\t\t\t\t${this.getAddButtonLink()}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddButtonLink(): HTMLElement\n\t{\n\t\treturn this.cache.remember('add-button-link', () => {\n\t\t\tconst caption = Text.encode(this.getActualButtonCaption());\n\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"ui-tag-selector-add-button-caption\" \n\t\t\t\t\tonclick=\"${this.handleAddButtonClick.bind(this)}\">${caption}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.addButtonCaption === null\n\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION')\n\t\t\t\t: this.addButtonCaption\n\t\t);\n\t}\n\n\tsetAddButtonCaption(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.addButtonCaption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAddButtonCaptionMore(): ?string\n\t{\n\t\treturn (\n\t\t\tthis.addButtonCaptionMore === null\n\t\t\t\t? this.isMultiple()\n\t\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION')\n\t\t\t\t\t: Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION_SINGLE')\n\t\t\t\t: this.addButtonCaptionMore\n\t\t);\n\t}\n\n\tsetAddButtonCaptionMore(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.addButtonCaptionMore = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggleAddButtonCaption(): void\n\t{\n\t\tif (this.getAddButtonCaptionMore() === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getAddButtonLink().textContent = this.getActualButtonCaption();\n\t}\n\n\tgetActualButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.getTags().length > 0 && this.getAddButtonCaptionMore() !== null\n\t\t\t\t? this.getAddButtonCaptionMore()\n\t\t\t\t: this.getAddButtonCaption()\n\t\t);\n\t}\n\n\tshowAddButton(): void\n\t{\n\t\tthis.addButtonVisible = true;\n\t\tDom.removeClass(this.getAddButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideAddButton(): void\n\t{\n\t\tthis.addButtonVisible = false;\n\t\tDom.addClass(this.getAddButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tgetCreateButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('create-button', () => {\n\t\t\tconst className = this.createButtonVisible ? '' : ' ui-tag-selector-item-hidden';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-create-button${className}\">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-tag-selector-create-button-caption\"\n\t\t\t\t\t\tonclick=\"${this.handleCreateButtonClick.bind(this)}\"\n\t\t\t\t\t>${Text.encode(this.getCreateButtonCaption())}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshowCreateButton(): void\n\t{\n\t\tthis.createButtonVisible = true;\n\t\tDom.removeClass(this.getCreateButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideCreateButton(): void\n\t{\n\t\tthis.createButtonVisible = false;\n\t\tDom.addClass(this.getCreateButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tgetCreateButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.createButtonCaption === null\n\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_CREATE_BUTTON_CAPTION')\n\t\t\t\t: this.createButtonCaption\n\t\t);\n\t}\n\n\tsetCreateButtonCaption(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.createButtonCaption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getCreateButton().children[0].textContent = caption;\n\t\t\t}\n\t\t}\n\t}\n\n\thandleContainerClick(event: MouseEvent): void\n\t{\n\t\tthis.emit('onContainerClick', { event });\n\t}\n\n\thandleTextBoxInput(event: InputEvent): void\n\t{\n\t\tconst newValue = this.getTextBoxValue();\n\t\tif (newValue !== this.textBoxOldValue)\n\t\t{\n\t\t\tthis.textBoxOldValue = newValue;\n\t\t\tthis.emit('onInput', { event });\n\t\t}\n\t}\n\n\thandleTextBoxBlur(event: FocusEvent): void\n\t{\n\t\tthis.emit('onBlur', { event });\n\n\t\tif (this.textBoxAutoHide)\n\t\t{\n\t\t\tthis.clearTextBox();\n\t\t\tthis.showAddButton();\n\t\t\tthis.hideTextBox();\n\t\t}\n\t}\n\n\thandleTextBoxKeyUp(event: KeyboardEvent): void\n\t{\n\t\tthis.emit('onKeyUp', { event });\n\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\tthis.emit('onEnter', { event });\n\n\t\t\tif (this.textBoxAutoHide)\n\t\t\t{\n\t\t\t\tthis.clearTextBox();\n\t\t\t\tthis.showAddButton();\n\t\t\t\tthis.hideTextBox();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleTextBoxKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.emit('onMetaEnter', { event });\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onKeyDown', { event });\n\t}\n\n\thandleAddButtonClick(event: MouseEvent): void\n\t{\n\t\tthis.hideAddButton();\n\t\tthis.showTextBox();\n\t\tthis.focusTextBox();\n\n\t\tthis.emit('onAddButtonClick', { event });\n\t}\n\n\thandleCreateButtonClick(event: MouseEvent): void\n\t{\n\t\tthis.emit('onCreateButtonClick', { event });\n\t}\n}\n","import { Event } from 'main.core';\nimport type ItemNode from '../item/item-node';\nimport type Tab from './tabs/tab';\nimport type Dialog from './dialog';\n\nexport default class Navigation\n{\n\tdialog: Dialog = null;\n\tlockedTab: Tab = null;\n\tenabled: boolean = false;\n\n\t// IE/Edge compatible event names\n\tstatic keyMap: Object<string, string> = {\n\t\t'Down': 'ArrowDown',\n\t\t'Up': 'ArrowUp',\n\t\t'Left': 'ArrowLeft',\n\t\t'Right': 'ArrowRight',\n\t\t'Spacebar': 'Space',\n\t\t' ': 'Space' // For all browsers\n\t};\n\n\tconstructor(dialog: Dialog)\n\t{\n\t\tthis.dialog = dialog;\n\n\t\tthis.dialog.subscribe('onShow', this.handleDialogShow.bind(this));\n\t\tthis.dialog.subscribe('onHide', this.handleDialogHide.bind(this));\n\t\tthis.dialog.subscribe('onDestroy', this.handleDialogDestroy.bind(this));\n\n\t\tthis.handleDocumentKeyDown = this.handleDocumentKeyDown.bind(this);\n\t\tthis.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this);\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tenable(): void\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\tthis.bindEvents();\n\t\t}\n\n\t\tthis.enabled = true;\n\t}\n\n\tdisable(): void\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\tthis.unlockTab();\n\t\t}\n\n\t\tthis.enabled = false;\n\t}\n\n\tisEnabled(): boolean\n\t{\n\t\treturn this.enabled;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEvent.bind(document, 'keydown', this.handleDocumentKeyDown);\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tEvent.unbind(document, 'keydown', this.handleDocumentKeyDown);\n\t}\n\n\tgetNextNode(): ?ItemNode\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet nextNode = null;\n\t\tlet currentNode = this.getActiveNode();\n\n\t\tif (currentNode.hasChildren() && currentNode.isOpen())\n\t\t{\n\t\t\tnextNode = currentNode.getFirstChild();\n\t\t}\n\n\t\twhile (nextNode === null && currentNode !== null)\n\t\t{\n\t\t\tnextNode = currentNode.getNextSibling();\n\t\t\tif (nextNode)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcurrentNode = currentNode.getParentNode();\n\t\t}\n\n\t\treturn nextNode;\n\t}\n\n\tgetPreviousNode(): ?ItemNode\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet previousNode = this.getActiveNode().getPreviousSibling();\n\t\tif (previousNode)\n\t\t{\n\t\t\twhile (previousNode.hasChildren() && previousNode.isOpen())\n\t\t\t{\n\t\t\t\tconst lastChild = previousNode.getLastChild();\n\t\t\t\tif (lastChild === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tpreviousNode = lastChild;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getActiveNode().getParentNode() && !this.getActiveNode().getParentNode().isRoot())\n\t\t\t{\n\t\t\t\tpreviousNode = this.getActiveNode().getParentNode();\n\t\t\t}\n\t\t}\n\n\t\treturn previousNode;\n\t}\n\n\tgetFirstNode(): ?ItemNode\n\t{\n\t\tconst tab = this.getDialog().getActiveTab();\n\t\treturn tab && tab.getRootNode().getFirstChild();\n\t}\n\n\tgetLastNode(): ?ItemNode\n\t{\n\t\tconst tab = this.getDialog().getActiveTab();\n\t\tif (!tab)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet lastNode = tab.getRootNode().getLastChild();\n\t\tif (lastNode !== null)\n\t\t{\n\t\t\twhile (lastNode.hasChildren() && lastNode.isOpen())\n\t\t\t{\n\t\t\t\tconst lastChild = lastNode.getLastChild();\n\t\t\t\tif (lastChild === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tlastNode = lastChild;\n\t\t\t}\n\t\t}\n\n\t\treturn lastNode;\n\t}\n\n\tgetActiveNode(): ?ItemNode\n\t{\n\t\treturn this.getDialog().getFocusedNode();\n\t}\n\n\tfocusOnNode(node: ItemNode): void\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.focus();\n\t\t\tnode.scrollIntoView();\n\t\t}\n\t}\n\n\tlockTab(): void\n\t{\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (this.lockedTab === activeTab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\telse if (this.lockedTab !== null)\n\t\t{\n\t\t\tthis.unlockTab();\n\t\t}\n\n\t\tthis.lockedTab = activeTab;\n\t\tthis.lockedTab.lock();\n\n\t\tEvent.bind(document, 'mousemove', this.handleDocumentMouseMove);\n\t}\n\n\tunlockTab(): void\n\t{\n\t\tif (this.lockedTab === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lockedTab.unlock();\n\t\tthis.lockedTab = null;\n\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t}\n\n\thandleDialogShow(): void\n\t{\n\t\tthis.enable();\n\t}\n\n\thandleDialogHide(): void\n\t{\n\t\tthis.disable();\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.disable();\n\t}\n\n\thandleDocumentMouseMove(): void\n\t{\n\t\tthis.unlockTab();\n\t}\n\n\thandleDocumentKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (!this.getDialog().isOpen())\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.metaKey || event.ctrlKey || event.altKey)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (!activeTab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst keyName = this.constructor.keyMap[event.key] || event.key;\n\t\tif (activeTab === this.getDialog().getSearchTab() && ['ArrowLeft', 'ArrowRight'].includes(keyName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler: ?Function = this[`handle${keyName}Press`];\n\t\tif (handler)\n\t\t{\n\t\t\thandler.call(this, event);\n\t\t\tthis.lockTab(activeTab);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\thandleArrowDownPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\tconst firstNode = this.getFirstNode();\n\t\t\tthis.focusOnNode(firstNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nextNode = this.getNextNode();\n\t\t\tif (nextNode)\n\t\t\t{\n\t\t\t\tthis.focusOnNode(nextNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst firstNode = this.getFirstNode();\n\t\t\t\tthis.focusOnNode(firstNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleArrowUpPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\tconst lastNode = this.getLastNode();\n\t\t\tthis.focusOnNode(lastNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst previousNode = this.getPreviousNode();\n\t\t\tif (previousNode)\n\t\t\t{\n\t\t\t\tthis.focusOnNode(previousNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastNode = this.getLastNode();\n\t\t\t\tthis.focusOnNode(lastNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleArrowRightPress(): void\n\t{\n\t\tif (this.getActiveNode())\n\t\t{\n\t\t\tthis.getActiveNode().expand();\n\t\t}\n\t}\n\n\thandleArrowLeftPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveNode().isOpen())\n\t\t{\n\t\t\tthis.getActiveNode().collapse();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst parentNode = this.getActiveNode().getParentNode();\n\t\t\tif (parentNode && !parentNode.isRoot())\n\t\t\t{\n\t\t\t\tthis.focusOnNode(parentNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEnterPress(): void\n\t{\n\t\tif (this.getActiveNode())\n\t\t{\n\t\t\tthis.getActiveNode().click();\n\t\t}\n\t}\n\n\t/*handleSpacePress(event: KeyboardEvent): void\n\t{\n\t\tconst searchQuery = this.getDialog().getTagSelector() && this.getDialog().getTagSelector().getTextBoxValue();\n\t\tif (this.getActiveNode() && !Type.isStringFilled(searchQuery))\n\t\t{\n\t\t\tthis.getActiveNode().click();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}*/\n\n\thandleTabPress(event: KeyboardEvent): void\n\t{\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (!activeTab)\n\t\t{\n\t\t\tthis.getDialog().selectFirstTab();\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey)\n\t\t{\n\t\t\tconst previousTab = this.getDialog().getPreviousTab();\n\t\t\tif (previousTab)\n\t\t\t{\n\t\t\t\tthis.getDialog().selectTab(previousTab.getId());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getDialog().selectLastTab();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nextTab = this.getDialog().getNextTab();\n\t\t\tif (nextTab)\n\t\t\t{\n\t\t\t\tthis.getDialog().selectTab(nextTab.getId());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t}\n\t\t}\n\t}\n}","import type { BaseEvent } from 'main.core.events';\nimport type Dialog from '../dialog';\n\nexport default class SliderIntegration\n{\n\tdialog: Dialog = null;\n\tsliders: Set = new Set();\n\n\tconstructor(dialog: Dialog)\n\t{\n\t\tthis.dialog = dialog;\n\n\t\tthis.dialog.subscribe('onShow', this.handleDialogShow.bind(this));\n\t\tthis.dialog.subscribe('onHide', this.handleDialogHide.bind(this));\n\t\tthis.dialog.subscribe('onDestroy', this.handleDialogDestroy.bind(this));\n\n\t\tthis.handleSliderOpen = this.handleSliderOpen.bind(this);\n\t\tthis.handleSliderClose = this.handleSliderClose.bind(this);\n\t\tthis.handleSliderDestroy = this.handleSliderDestroy.bind(this);\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tthis.unbindEvents();\n\n\t\tif (top.BX)\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onOpen', this.handleSliderOpen);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onDestroy', this.handleSliderDestroy);\n\t\t}\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tif (top.BX)\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.unsubscribe('SidePanel.Slider:onOpen', this.handleSliderOpen);\n\t\t\ttop.BX.Event.EventEmitter.unsubscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\t\ttop.BX.Event.EventEmitter.unsubscribe('SidePanel.Slider:onDestroy', this.handleSliderDestroy);\n\t\t}\n\t}\n\n\tisDialogInSlider(slider): boolean\n\t{\n\t\tif (slider.getFrameWindow())\n\t\t{\n\t\t\treturn slider.getFrameWindow().document.contains(this.getDialog().getContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn  slider.getContainer().contains(this.getDialog().getContainer());\n\t\t}\n\t}\n\n\thandleDialogShow(): void\n\t{\n\t\tthis.bindEvents();\n\t}\n\n\thandleDialogHide(): void\n\t{\n\t\tthis.sliders.clear();\n\t\tthis.unbindEvents();\n\t\tthis.getDialog().unfreeze();\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.sliders.clear();\n\t\tthis.unbindEvents();\n\t}\n\n\thandleSliderOpen(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tif (!this.isDialogInSlider(slider))\n\t\t{\n\t\t\tthis.sliders.add(slider);\n\t\t\tthis.getDialog().freeze();\n\t\t}\n\t}\n\n\thandleSliderClose(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tthis.sliders.delete(slider);\n\t\tif (this.sliders.size === 0)\n\t\t{\n\t\t\tthis.getDialog().unfreeze();\n\t\t}\n\t}\n\n\thandleSliderDestroy(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tif (this.isDialogInSlider(slider))\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\tthis.dialog.destroy();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.sliders.delete(slider);\n\t\t\tif (this.sliders.size === 0)\n\t\t\t{\n\t\t\t\tthis.getDialog().unfreeze();\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Dom, Tag, Type } from 'main.core';\nimport BaseHeader from './base-header';\nimport type Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { HeaderOptions } from './header-content';\n\nexport default class DefaultHeader extends BaseHeader\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(context: Dialog | Tab, options: HeaderOptions)\n\t{\n\t\tsuper(context, options);\n\n\t\tthis.setContent(this.getOption('content'));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst container = Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\n\t\tconst className = this.getOption('containerClass', 'ui-selector-header-default');\n\t\tconst containerStyles = this.getOption('containerStyles', {});\n\n\t\tDom.addClass(container, className);\n\t\tDom.style(container, containerStyles);\n\n\t\treturn container;\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.content;\n\t}\n\n\tsetContent(content: string | HTMLElement | HTMLElement[]): void\n\t{\n\t\tif (Type.isStringFilled(content) || Type.isDomNode(content) || Type.isArrayFilled(content))\n\t\t{\n\t\t\tthis.content = content;\n\t\t}\n\t}\n}","import { Dom, Tag, Type } from 'main.core';\nimport BaseFooter from './base-footer';\nimport type Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { FooterOptions } from './footer-content';\n\nexport default class DefaultFooter extends BaseFooter\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(context: Dialog | Tab, options: FooterOptions)\n\t{\n\t\tsuper(context, options);\n\n\t\tthis.setContent(this.getOption('content'));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst container = Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\n\t\tconst className = this.getOption('containerClass', 'ui-selector-footer-default');\n\t\tconst containerStyles = this.getOption('containerStyles', {});\n\n\t\tDom.addClass(container, className);\n\t\tDom.style(container, containerStyles);\n\n\t\treturn container;\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.content;\n\t}\n\n\tsetContent(content: string | HTMLElement | HTMLElement[]): void\n\t{\n\t\tif (Type.isStringFilled(content) || Type.isDomNode(content) || Type.isArrayFilled(content))\n\t\t{\n\t\t\tthis.content = content;\n\t\t}\n\t}\n}","import { Loc } from 'main.core';\nimport Tab from './tab';\nimport type { TabOptions } from './tab-options';\nimport type Dialog from '../dialog';\nimport { Outline } from 'ui.icon-set.api.core';\n\nexport default class RecentTab extends Tab\n{\n\tconstructor(dialog: Dialog, tabOptions: TabOptions)\n\t{\n\t\tconst defaults = {\n\t\t\ttitle: Loc.getMessage('UI_SELECTOR_RECENT_TAB_TITLE'),\n\t\t\titemOrder: { sort: 'asc' },\n\t\t\tvisible: !dialog.isDropdownMode(),\n\t\t\tstub: !dialog.isDropdownMode(),\n\t\t\ticon: Outline.SEARCH,\n\t\t};\n\n\t\tconst options: TabOptions = Object.assign({}, defaults, tabOptions);\n\t\toptions.id = 'recents';\n\n\t\tsuper(dialog, options);\n\t}\n}\n","import MatchField from './match-field';\n\nimport type MatchIndex from './match-index';\nimport type SearchField from './search-field';\nimport type Item from '../item/item';\n\nexport default class MatchResult\n{\n\titem: Item = null;\n\tmatchFields: Map<SearchField, MatchField> = new Map();\n\tsort: ?number = null;\n\n\tconstructor(item: Item, matchIndexes: MatchIndex[] = [])\n\t{\n\t\tthis.item = item;\n\t\tthis.addIndexes(matchIndexes);\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tgetMatchFields(): Map<SearchField, MatchField>\n\t{\n\t\treturn this.matchFields;\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\taddIndex(matchIndex: MatchIndex): void\n\t{\n\t\tlet matchField = this.matchFields.get(matchIndex.getField());\n\t\tif (!matchField)\n\t\t{\n\t\t\tmatchField = new MatchField(matchIndex.getField());\n\t\t\tthis.matchFields.set(matchIndex.getField(), matchField);\n\n\t\t\tconst fieldSort = matchIndex.getField().getSort();\n\t\t\tif (fieldSort !== null)\n\t\t\t{\n\t\t\t\tthis.sort = this.sort === null ? fieldSort : Math.min(this.sort, fieldSort);\n\t\t\t}\n\t\t}\n\n\t\tmatchField.addIndex(matchIndex);\n\t}\n\n\taddIndexes(matchIndexes: MatchIndex[]): void\n\t{\n\t\tmatchIndexes.forEach((matchIndex: MatchIndex) => {\n\t\t\tthis.addIndex(matchIndex);\n\t\t});\n\t}\n}\n","import MatchResult from './match-result';\nimport MatchIndex from './match-index';\n\nimport type SearchFieldIndex from './search-field-index';\nimport type Item from '../item/item';\nimport type SearchQuery from './search-query';\n\nconst collator = new Intl.Collator(undefined, { sensitivity: 'base' });\n\nexport type MatchOptions = {\n\tmatchAll: boolean,\n};\n\nexport default class SearchEngine\n{\n\tstatic matchItems(items: Item[], searchQuery: SearchQuery, options: MatchOptions = {}): MatchResult[]\n\t{\n\t\tconst matchResults = [];\n\t\tconst queryWords = searchQuery.getQueryWords();\n\t\tlet limit = searchQuery.getResultLimit();\n\n\t\tconst matchAll = options.matchAll === true;\n\n\t\tfor (let i = 0; i < items.length; i++)\n\t\t{\n\t\t\tif (limit === 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst item = items[i];\n\t\t\tif (item.isSelected() || !item.isSearchable() || item.isHidden() || !item.getEntity().isSearchable())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst matchResult = this.matchItem(item, queryWords);\n\t\t\tif (matchResult)\n\t\t\t{\n\t\t\t\tmatchResults.push(matchResult);\n\t\t\t\tlimit--;\n\t\t\t}\n\t\t\telse if (matchAll && item.getEntity().getDynamicSearchMatchMode() === 'all')\n\t\t\t{\n\t\t\t\tmatchResults.push(new MatchResult(item, []));\n\t\t\t\tlimit--;\n\t\t\t}\n\t\t}\n\n\t\treturn matchResults;\n\t}\n\n\tstatic matchItem(item: Item, queryWords: string[]): MatchResult\n\t{\n\t\tlet matches = [];\n\t\tfor (let i = 0; i < queryWords.length; i++)\n\t\t{\n\t\t\tconst queryWord = queryWords[i];\n\t\t\tconst results = this.matchWord(item, queryWord);\n\t\t\t//const match = this.matchWord(item, queryWord);\n\t\t\t//if (match === null)\n\t\t\tif (results.length === 0)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmatches = matches.concat(results);\n\t\t\t\t//matches.push(match);\n\t\t\t}\n\t\t}\n\n\t\tif (matches.length > 0)\n\t\t{\n\t\t\treturn new MatchResult(item, matches);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic matchWord(item: Item, queryWord: string): MatchIndex[]\n\t{\n\t\tconst searchIndexes = item.getSearchIndex().getIndexes();\n\t\tconst matches = [];\n\n\t\tfor (let i = 0; i < searchIndexes.length; i++)\n\t\t{\n\t\t\tconst fieldIndex: SearchFieldIndex = searchIndexes[i];\n\t\t\tconst indexes = fieldIndex.getIndexes();\n\t\t\tfor (let j = 0; j < indexes.length; j++)\n\t\t\t{\n\t\t\t\tconst index = indexes[j];\n\t\t\t\tconst word = index.getWord().substring(0, queryWord.length);\n\t\t\t\tif (collator.compare(queryWord, word) === 0)\n\t\t\t\t{\n\t\t\t\t\tmatches.push(new MatchIndex(fieldIndex.getField(), queryWord, index.getStartIndex()));\n\t\t\t\t\t//return new MatchIndex(field, queryWord, index[i][1]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (matches.length > 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\treturn matches;\n\t\t//return null;\n\t}\n}\n","import { Type } from 'main.core';\n\nexport default class SearchQuery\n{\n\tqueryWords: string[] = [];\n\tquery: string = '';\n\tcacheable: boolean = true;\n\tdynamicSearchEntities: string[] = [];\n\tresultLimit: number = 100;\n\n\tconstructor(query: string)\n\t{\n\t\tthis.query = query.trim().replace(/\\s\\s+/g, ' ');\n\t\tthis.queryWords = Type.isStringFilled(this.query) ? this.query.split(' ') : [];\n\t}\n\n\tgetQueryWords(): string[]\n\t{\n\t\treturn this.queryWords;\n\t}\n\n\tgetQuery(): string\n\t{\n\t\treturn this.query;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.getQueryWords().length === 0;\n\t}\n\n\tsetCacheable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.cacheable = flag;\n\t\t}\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetResultLimit(limit: number)\n\t{\n\t\tif (Type.isNumber(limit) && limit >= 0)\n\t\t{\n\t\t\tthis.resultLimit = limit;\n\t\t}\n\t}\n\n\tgetResultLimit(): number\n\t{\n\t\treturn this.resultLimit;\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\treturn this.getDynamicSearchEntities().length > 0;\n\t}\n\n\thasDynamicSearchEntity(entityId: string): boolean\n\t{\n\t\treturn this.getDynamicSearchEntities().includes(entityId);\n\t}\n\n\tsetDynamicSearchEntities(entities: string[]): void\n\t{\n\t\tif (Type.isArrayFilled(entities))\n\t\t{\n\t\t\tentities.forEach((entityId: string) => {\n\t\t\t\tif (Type.isStringFilled(entityId) && !this.hasDynamicSearchEntity(entityId))\n\t\t\t\t{\n\t\t\t\t\tthis.dynamicSearchEntities.push(entityId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.dynamicSearchEntities;\n\t}\n\n\tgetDynamicSearchEntities(): string[]\n\t{\n\t\treturn this.dynamicSearchEntities;\n\t}\n\n\tgetAjaxJson(): { [key: string]: any }\n\t{\n\t\treturn this.toJSON();\n\t}\n\n\ttoJSON(): { [key: string]: any }\n\t{\n\t\treturn {\n\t\t\tqueryWords: this.getQueryWords(),\n\t\t\tquery: this.getQuery(),\n\t\t\tdynamicSearchEntities: this.getDynamicSearchEntities(),\n\t\t};\n\t}\n}","import { Cache, Tag, Loc, Dom } from 'main.core';\nimport { Loader } from 'main.loader';\nimport type Tab from './tab';\n\nexport default class SearchLoader\n{\n\ttab: Tab = null;\n\tloader: Loader = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(tab: Tab)\n\t{\n\t\tthis.tab = tab;\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getIconContainer(),\n\t\t\t\tsize: 32\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader\">\n\t\t\t\t\t${this.getBoxContainer()}\n\t\t\t\t\t${this.getSpacerContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetBoxContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('box-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader-box\">\n\t\t\t\t\t${this.getIconContainer()}\n\t\t\t\t\t${this.getTextContainer()}\n\t\t\t\t</div>`;\n\t\t});\n\t}\n\n\tgetIconContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-search-loader-icon\"></div>`;\n\t\t});\n\t}\n\n\tgetTextContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('text', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader-text\">${\n\t\t\t\t\tLoc.getMessage('UI_SELECTOR_SEARCH_LOADER_TEXT')\n\t\t\t\t}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSpacerContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('spacer', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-search-loader-spacer\"></div>`;\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.getContainer().parentNode)\n\t\t{\n\t\t\tDom.append(this.getContainer(), this.getTab().getContainer());\n\t\t}\n\n\t\tvoid this.getLoader().show();\n\n\t\tDom.addClass(this.getContainer(), 'ui-selector-search-loader--show');\n\t\trequestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getContainer(), 'ui-selector-search-loader--animate');\n\t\t});\n\t}\n\n\thide(): void\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(\n\t\t\tthis.getContainer(),\n\t\t\t['ui-selector-search-loader--show', 'ui-selector-search-loader--animate']\n\t\t);\n\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.loader !== null && this.loader.isShown();\n\t}\n}","import { Tag, Browser, Loc, Type } from 'main.core';\nimport { Loader } from 'main.loader';\nimport BaseFooter from '../footer/base-footer';\n\nimport type { BaseEvent } from 'main.core.events';\nimport type Tab from '../tabs/tab';\nimport type { FooterOptions } from './footer-content';\n\nexport default class SearchTabFooter extends BaseFooter\n{\n\tloader: Loader = null;\n\n\tconstructor(tab: Tab, options: FooterOptions)\n\t{\n\t\tsuper(tab, options);\n\n\t\tthis.getDialog().subscribe('onSearch', this.handleOnSearch.bind(this));\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.subscribe('onMetaEnter', this.handleMetaEnter.bind(this));\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer\" onclick=\"${this.handleClick.bind(this)}\">\n\t\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t\t${this.getLabelContainer()}\n\t\t\t\t\t${this.getQueryContainer()}\n\t\t\t\t\t${this.getLoaderContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-selector-search-footer-cmd\">${\n\t\t\t\t\tBrowser.isMac() ? '&#8984;+Enter'  : 'Ctrl+Enter'\n\t\t\t\t}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getLoaderContainer(),\n\t\t\t\tsize: 17,\n\t\t\t\tcolor: 'rgba(82, 92, 105, 0.9)'\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tsetLabel(label: string)\n\t{\n\t\tif (Type.isString(label))\n\t\t{\n\t\t\tthis.getLabelContainer().textContent = label;\n\t\t}\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-label\">${\n\t\t\t\t\tthis.getOption('label', Loc.getMessage('UI_SELECTOR_CREATE_ITEM_LABEL'))\n\t\t\t}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLoaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-footer-loader\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tcreateItem(): void\n\t{\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector && tagSelector.isLocked())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst finalize = () => {\n\t\t\tthis.hideLoader();\n\t\t\tif (this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tthis.getDialog().getTagSelector().unlock();\n\t\t\t\tthis.getDialog().focusSearch();\n\t\t\t}\n\t\t};\n\n\t\tevent.preventDefault();\n\t\tthis.showLoader();\n\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.lock();\n\t\t}\n\n\t\tthis.getDialog()\n\t\t\t.emitAsync('Search:onItemCreateAsync', {\n\t\t\t\tsearchQuery: this.getTab().getLastSearchQuery()\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.getTab().clearResults();\n\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\tif (this.getDialog().getActiveTab() === this.getTab())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t\t}\n\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t;\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.createItem();\n\t}\n\n\thandleMetaEnter(event: BaseEvent): void\n\t{\n\t\tconst keyboardEvent: KeyboardEvent = event.getData().event;\n\t\tkeyboardEvent.stopPropagation();\n\n\t\tif (this.getDialog().getActiveTab() !== this.getTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.handleClick();\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\t\tthis.getQueryContainer().textContent = query;\n\t}\n}\n","import { Runtime, ajax as Ajax, Type, Loc, type AjaxResponse } from 'main.core';\nimport EntityErrorCollection from '../../entity/entity-error-collection';\nimport type { EntityErrorOptions } from '../../entity/entity-error-options';\n\nimport Tab from './tab';\nimport SearchEngine from '../../search/search-engine';\nimport MatchResult from '../../search/match-result';\nimport SearchQuery from '../../search/search-query';\nimport SearchLoader from './search-loader';\nimport SearchTabFooter from '../footer/search-tab-footer';\n\nimport type { ItemOptions } from '../../item/item-options';\nimport type { TabOptions } from './tab-options';\nimport type Entity from '../../entity/entity';\nimport type Dialog from '../dialog';\nimport type { SearchOptions } from '../search-options';\n\nexport default class SearchTab extends Tab\n{\n\tlastSearchQuery: ?SearchQuery = null;\n\tqueryCache = new Set();\n\tqueryXhr = null;\n\tsearchLoader: SearchLoader = new SearchLoader(this);\n\tallowCreateItem: boolean = false;\n\n\tconstructor(dialog: Dialog, tabOptions: TabOptions, searchOptions: SearchOptions)\n\t{\n\t\tconst defaults = {\n\t\t\ttitle: Loc.getMessage('UI_SELECTOR_SEARCH_TAB_TITLE'),\n\t\t\tvisible: false,\n\t\t\tstub: true,\n\t\t\tstubOptions: {\n\t\t\t\tautoShow: false,\n\t\t\t\ttitle: Loc.getMessage('UI_SELECTOR_SEARCH_STUB_TITLE'),\n\t\t\t\tsubtitle: Loc.getMessage('UI_SELECTOR_SEARCH_STUB_SUBTITLE_MSGVER_1'),\n\t\t\t},\n\t\t};\n\n\t\tconst options: TabOptions = { ...defaults, ...tabOptions };\n\t\toptions.id = 'search';\n\t\toptions.stubOptions.autoShow = false;\n\n\t\tsuper(dialog, options);\n\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tsearchOptions = Type.isPlainObject(searchOptions) ? searchOptions : {};\n\t\tthis.setAllowCreateItem(searchOptions.allowCreateItem, searchOptions.footerOptions);\n\n\t\tthis.loadWithDebounce = Runtime.debounce(() => {\n\t\t\tthis.load(this.getLastSearchQuery());\n\t\t}, 500);\n\t}\n\n\tsearch(query: string)\n\t{\n\t\tconst searchQuery = new SearchQuery(query);\n\t\tconst dynamicEntities = this.getDynamicEntities(searchQuery);\n\t\tsearchQuery.setDynamicSearchEntities(dynamicEntities);\n\n\t\tif (searchQuery.isEmpty())\n\t\t{\n\t\t\tthis.getSearchLoader().hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lastSearchQuery = searchQuery;\n\n\t\tconst matchResults = SearchEngine.matchItems(this.getDialog().getItems(), searchQuery);\n\t\tthis.clearResults();\n\t\tthis.appendResults(matchResults);\n\n\t\tif (this.getDialog().shouldFocusOnFirst())\n\t\t{\n\t\t\tthis.getDialog().focusOnFirstNode();\n\t\t}\n\n\t\tif (this.shouldLoad(searchQuery))\n\t\t{\n\t\t\tthis.loadWithDebounce();\n\t\t\tif (!this.isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.getStub().hide();\n\t\t\t}\n\t\t}\n\t\telse if (!this.getSearchLoader().isShown())\n\t\t{\n\t\t\tthis.toggleEmptyResult();\n\t\t}\n\t}\n\n\tgetLastSearchQuery(): ?SearchQuery\n\t{\n\t\treturn this.lastSearchQuery;\n\t}\n\n\tsetAllowCreateItem(flag: boolean, options?: { [option: string]: any }): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.allowCreateItem = flag;\n\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tthis.setFooter(SearchTabFooter, options);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setFooter(null);\n\t\t\t}\n\t\t}\n\t}\n\n\tcanCreateItem(): boolean\n\t{\n\t\treturn this.allowCreateItem;\n\t}\n\n\tappendResults(matchResults: MatchResult[]): void\n\t{\n\t\tmatchResults.sort((a: MatchResult, b: MatchResult) => {\n\t\t\tconst matchSortA = a.getSort();\n\t\t\tconst matchSortB = b.getSort();\n\n\t\t\tif (matchSortA !== null && matchSortB !== null && matchSortA !== matchSortB)\n\t\t\t{\n\t\t\t\treturn matchSortA - matchSortB;\n\t\t\t}\n\n\t\t\tif (matchSortA !== null && matchSortB === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif (matchSortA === null && matchSortB !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tconst contextSortA = a.getItem().getContextSort();\n\t\t\tconst contextSortB = b.getItem().getContextSort();\n\n\t\t\tif (contextSortA !== null && contextSortB === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif (contextSortA === null && contextSortB !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (contextSortA !== null && contextSortB !== null)\n\t\t\t{\n\t\t\t\treturn contextSortB - contextSortA;\n\t\t\t}\n\n\t\t\tconst globalSortA = a.getItem().getGlobalSort();\n\t\t\tconst globalSortB = b.getItem().getGlobalSort();\n\n\t\t\tif (globalSortA !== null && globalSortB === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif (globalSortA === null && globalSortB !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (globalSortA !== null && globalSortB !== null)\n\t\t\t{\n\t\t\t\treturn globalSortB - globalSortA;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t});\n\n\t\tthis.getRootNode().disableRender();\n\n\t\tmatchResults.forEach((matchResult: MatchResult) => {\n\t\t\tconst item = matchResult.getItem();\n\t\t\tif (!this.getRootNode().hasItem(item))\n\t\t\t{\n\t\t\t\tconst node = this.getRootNode().addItem(item);\n\t\t\t\tnode.setHighlights(matchResult.getMatchFields());\n\t\t\t}\n\t\t});\n\n\t\tthis.getRootNode().enableRender();\n\t\tthis.getRootNode().render(true);\n\t}\n\n\tgetDynamicEntities(searchQuery: SearchQuery): string[]\n\t{\n\t\tconst result = [];\n\n\t\tthis.getDialog().getEntities().forEach((entity: Entity) => {\n\t\t\tif (entity.isSearchable())\n\t\t\t{\n\t\t\t\tconst hasCacheLimit = entity.getSearchCacheLimits().some((pattern: RegExp) => {\n\t\t\t\t\treturn pattern.test(searchQuery.getQuery());\n\t\t\t\t});\n\n\t\t\t\tif (hasCacheLimit)\n\t\t\t\t{\n\t\t\t\t\tresult.push(entity.getId());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tisQueryCacheable(searchQuery: SearchQuery): boolean\n\t{\n\t\treturn searchQuery.isCacheable() && !searchQuery.hasDynamicSearch();\n\t}\n\n\tisQueryLoaded(searchQuery: SearchQuery): boolean\n\t{\n\t\tlet found = false;\n\t\tthis.queryCache.forEach((query) => {\n\t\t\tif (found === false && searchQuery.getQuery().startsWith(query))\n\t\t\t{\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\taddCacheQuery(searchQuery: SearchQuery): void\n\t{\n\t\tif (this.isQueryCacheable(searchQuery))\n\t\t{\n\t\t\tthis.queryCache.add(searchQuery.getQuery());\n\t\t}\n\t}\n\n\tremoveCacheQuery(searchQuery: SearchQuery): void\n\t{\n\t\tthis.queryCache.delete(searchQuery.getQuery());\n\t}\n\n\tshouldLoad(searchQuery: SearchQuery): boolean\n\t{\n\t\tif (!this.isQueryCacheable(searchQuery))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!this.getDialog().hasDynamicSearch())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !this.isQueryLoaded(searchQuery);\n\t}\n\n\tload(searchQuery: SearchQuery): void\n\t{\n\t\tif (!this.shouldLoad(searchQuery))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// if (this.queryXhr)\n\t\t// {\n\t\t// \tthis.queryXhr.abort();\n\t\t// }\n\n\t\tthis.addCacheQuery(searchQuery);\n\n\t\tthis.getStub().hide();\n\t\tthis.getSearchLoader().show();\n\n\t\tAjax.runAction('ui.entityselector.doSearch', {\n\t\t\tjson: {\n\t\t\t\tdialog: this.getDialog().getAjaxJson(),\n\t\t\t\tsearchQuery: searchQuery.getAjaxJson(),\n\t\t\t},\n\t\t\tonrequeststart: (xhr) => {\n\t\t\t\tthis.queryXhr = xhr;\n\t\t\t},\n\t\t\tgetParameters: {\n\t\t\t\tcontext: this.getDialog().getContext(),\n\t\t\t},\n\t\t})\n\t\t\t.then((response: AjaxResponse) => {\n\t\t\t\tthis.getSearchLoader().hide();\n\n\t\t\t\tif (!response || !response.data || !response.data.dialog || !response.data.dialog.items)\n\t\t\t\t{\n\t\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\t\tthis.toggleEmptyResult();\n\t\t\t\t\tthis.getDialog().emit('SearchTab:onLoad', { searchTab: this });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (response.data.searchQuery && response.data.searchQuery.cacheable === false)\n\t\t\t\t{\n\t\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\t\tif (this.getLastSearchQuery()?.getQuery() !== searchQuery.getQuery())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.loadWithDebounce();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(response.data.dialog.items))\n\t\t\t\t{\n\t\t\t\t\tconst items = new Set();\n\t\t\t\t\tresponse.data.dialog.items.forEach((itemOptions: ItemOptions) => {\n\t\t\t\t\t\tdelete itemOptions.tabs;\n\t\t\t\t\t\tdelete itemOptions.children;\n\n\t\t\t\t\t\tconst item = this.getDialog().addItem(itemOptions);\n\t\t\t\t\t\titems.add(item);\n\t\t\t\t\t});\n\n\t\t\t\t\tconst isTabEmpty = this.isEmptyResult();\n\n\t\t\t\t\tconst matchResults = SearchEngine.matchItems(\n\t\t\t\t\t\t[...items.values()],\n\t\t\t\t\t\tthis.getLastSearchQuery(),\n\t\t\t\t\t\t{ matchAll: true },\n\t\t\t\t\t);\n\t\t\t\t\tthis.appendResults(matchResults);\n\n\t\t\t\t\tif (isTabEmpty && this.getDialog().shouldFocusOnFirst())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getDialog().focusOnFirstNode();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(response.data.dialog.errors))\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().emitEntityErrors(response.data.dialog.errors);\n\t\t\t\t}\n\n\t\t\t\tthis.toggleEmptyResult();\n\n\t\t\t\tthis.getDialog().emit('SearchTab:onLoad', { searchTab: this });\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\tthis.getSearchLoader().hide();\n\t\t\t\tthis.toggleEmptyResult();\n\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}\n\n\tgetSearchLoader(): SearchLoader\n\t{\n\t\treturn this.searchLoader;\n\t}\n\n\tclearResults(): void\n\t{\n\t\tthis.getRootNode().removeChildren();\n\t}\n\n\tisEmptyResult(): boolean\n\t{\n\t\treturn !this.getRootNode().hasChildren();\n\t}\n\n\ttoggleEmptyResult(): void\n\t{\n\t\tif (this.isEmptyResult())\n\t\t{\n\t\t\tthis.getStub().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getStub().hide();\n\t\t}\n\t}\n}\n","// eslint-disable-next-line max-classes-per-file\nimport { Type, Text, Tag, Dom, ajax as Ajax, Cache, Loc, Runtime, Reflection, type JsonObject } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\nimport type { EntityErrorOptions } from '../entity/entity-error-options';\n\nimport Item from '../item/item';\nimport Tab from './tabs/tab';\nimport Entity from '../entity/entity';\nimport EntityErrorCollection from '../entity/entity-error-collection';\nimport TagSelector from '../tag-selector/tag-selector';\nimport Navigation from './navigation';\nimport SliderIntegration from './integration/slider-integration';\nimport Animation from '../common/animation';\nimport BaseHeader from './header/base-header';\nimport DefaultHeader from './header/default-header';\nimport BaseFooter from './footer/base-footer';\nimport DefaultFooter from './footer/default-footer';\n\nimport RecentTab from './tabs/recent-tab';\nimport SearchTab from './tabs/search-tab';\n\nimport type ItemNode from '../item/item-node';\nimport type { TabOptions } from './tabs/tab-options';\nimport type { DialogOptions } from './dialog-options';\nimport type { ItemOptions } from '../item/item-options';\nimport type { EntityOptions } from '../entity/entity-options';\nimport type { ItemId } from '../item/item-id';\nimport type { PopupOptions } from 'main.popup';\nimport type { HeaderOptions, HeaderContent } from './header/header-content';\nimport type { FooterOptions, FooterContent } from './footer/footer-content';\nimport type { ItemNodeOptions } from '../item/item-node-options';\nimport type { TagItemOptions } from '../tag-selector/tag-item-options';\n\nclass LoadState\n{\n\tstatic UNSENT: string = 'UNSENT';\n\tstatic LOADING: string = 'LOADING';\n\tstatic DONE: string = 'DONE';\n}\n\nclass TagSelectorMode\n{\n\tstatic INSIDE: string = 'INSIDE';\n\tstatic OUTSIDE: string = 'OUTSIDE';\n}\n\nconst instances = new Map();\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Dialog extends EventEmitter\n{\n\tid: string = null;\n\titems: Map<string, Map<string, Item>> = new Map();\n\ttabs: Map<string, Entity> = new Map();\n\tentities: Map<string, Entity> = new Map();\n\ttargetNode: HTMLElement = null;\n\tpopup: Popup = null;\n\tcache = new Cache.MemoryCache();\n\tmultiple: boolean = true;\n\thideOnSelect: boolean = null;\n\thideOnDeselect: boolean = null;\n\taddTagOnSelect: boolean = null;\n\tclearSearchOnSelect: boolean = true;\n\tcontext: string = null;\n\tselectedItems: Set<Item> = new Set();\n\tpreselectedItems: ItemId[] = [];\n\tundeselectedItems: ItemId[] = [];\n\tdropdownMode: boolean = false;\n\n\tfrozen: boolean = false;\n\tfrozenProps: { [propName: string]: any } = {};\n\n\thideByEsc: boolean = true;\n\tautoHide: boolean = true;\n\tautoHideHandler: Function = null;\n\toffsetTop: number = 5;\n\toffsetLeft: number = 0;\n\tcacheable: boolean = true;\n\n\twidth: number = 565;\n\theight: number = 420;\n\n\tmaxLabelWidth: number = 160;\n\tminLabelWidth: number = 38;\n\talwaysShowLabels: boolean = false;\n\n\tshowAvatars: boolean = true;\n\tcompactView: boolean = false;\n\n\tactiveTab: Tab = null;\n\trecentTab: Tab = null;\n\tsearchTab: Tab = null;\n\n\trendered: boolean = false;\n\n\tloadState: LoadState = LoadState.UNSENT;\n\tloader: ?Loader = null;\n\n\ttagSelector: ?TagSelector = null;\n\ttagSelectorMode: ?TagSelectorMode = null;\n\ttagSelectorHeight: ?number = null;\n\n\tsaveRecentItemsWithDebounce: Function = Runtime.debounce(this.saveRecentItems, 2000, this);\n\trecentItemsToSave = [];\n\trecentItemsLimit: ?number = null;\n\n\tnavigation: Navigation = null;\n\theader: BaseHeader = null;\n\tfooter: BaseFooter = null;\n\tpopupOptions: PopupOptions = {};\n\n\tfocusOnFirst: boolean = true;\n\tfocusedNode: ItemNode = null;\n\n\tclearUnavailableItems: boolean = false;\n\toverlappingObserver: MutationObserver = null;\n\toffsetAnimation: boolean = true;\n\tcustomData: JsonObject = Object.create(null);\n\n\tstatic getById(id: string): ?Dialog\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tstatic getInstances(): Dialog[]\n\t{\n\t\treturn Array.from(instances.values());\n\t}\n\n\tconstructor(dialogOptions: DialogOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.Dialog');\n\n\t\tconst options: DialogOptions = Type.isPlainObject(dialogOptions) ? dialogOptions : {};\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : `ui-selector-${Text.getRandom().toLowerCase()}`;\n\t\tthis.multiple = Type.isBoolean(options.multiple) ? options.multiple : true;\n\t\tthis.context = Type.isStringFilled(options.context) ? options.context : null;\n\t\tthis.clearUnavailableItems = options.clearUnavailableItems === true;\n\t\tthis.compactView = options.compactView === true;\n\t\tthis.dropdownMode = Type.isBoolean(options.dropdownMode) ? options.dropdownMode : false;\n\t\tthis.alwaysShowLabels = Type.isBoolean(options.alwaysShowLabels) ? options.alwaysShowLabels : false;\n\n\t\tif (Type.isArray(options.entities))\n\t\t{\n\t\t\toptions.entities.forEach((entity) => {\n\t\t\t\tthis.addEntity(entity);\n\t\t\t});\n\t\t}\n\n\t\tif (options.tagSelector instanceof TagSelector)\n\t\t{\n\t\t\tthis.tagSelectorMode = TagSelectorMode.OUTSIDE;\n\t\t\tthis.setTagSelector(options.tagSelector);\n\t\t}\n\t\telse if (options.enableSearch === true)\n\t\t{\n\t\t\tconst defaultOptions = {\n\t\t\t\tplaceholder: Loc.getMessage('UI_TAG_SELECTOR_SEARCH_PLACEHOLDER'),\n\t\t\t\tmaxHeight: 102, // three lines\n\t\t\t\ttextBoxWidth: 105,\n\t\t\t};\n\t\t\tconst customOptions = Type.isPlainObject(options.tagSelectorOptions) ? options.tagSelectorOptions : {};\n\t\t\tconst mandatoryOptions = {\n\t\t\t\tdialogOptions: null,\n\t\t\t\tshowTextBox: true,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tmultiple: this.isMultiple(),\n\t\t\t};\n\n\t\t\tconst tagSelectorOptions = Object.assign(defaultOptions, customOptions, mandatoryOptions);\n\t\t\tconst tagSelector = new TagSelector(tagSelectorOptions);\n\t\t\tthis.tagSelectorMode = TagSelectorMode.INSIDE;\n\t\t\tthis.setTagSelector(tagSelector);\n\t\t}\n\n\t\tthis.setTargetNode(options.targetNode);\n\t\tthis.setHideOnSelect(options.hideOnSelect);\n\t\tthis.setHideOnDeselect(options.hideOnDeselect);\n\t\tthis.setAddTagOnSelect(options.addTagOnSelect);\n\t\tthis.setClearSearchOnSelect(options.clearSearchOnSelect);\n\t\tthis.setWidth(options.width);\n\t\tvoid this.setHeight(options.height);\n\t\tthis.setAutoHide(options.autoHide);\n\t\tthis.setAutoHideHandler(options.autoHideHandler);\n\t\tthis.setHideByEsc(options.hideByEsc);\n\t\tthis.setOffsetLeft(options.offsetLeft);\n\t\tthis.setOffsetTop(options.offsetTop);\n\t\tthis.setCacheable(options.cacheable);\n\t\tthis.setFocusOnFirst(options.focusOnFirst);\n\t\tthis.setShowAvatars(options.showAvatars);\n\t\tthis.setRecentItemsLimit(options.recentItemsLimit);\n\t\tthis.setOffsetAnimation(options.offsetAnimation);\n\n\t\tthis.recentTab = new RecentTab(this, options.recentTabOptions);\n\t\tthis.searchTab = new SearchTab(this, options.searchTabOptions, options.searchOptions);\n\n\t\tthis.addTab(this.recentTab);\n\t\tthis.addTab(this.searchTab);\n\n\t\tthis.setPreselectedItems(options.preselectedItems);\n\t\tthis.setUndeselectedItems(options.undeselectedItems);\n\n\t\tthis.setOptions(options);\n\n\t\tconst preload = options.preload === true || this.getPreselectedItems().length > 0;\n\t\tif (preload)\n\t\t{\n\t\t\tthis.load();\n\t\t}\n\n\t\tif (Type.isPlainObject(options.popupOptions))\n\t\t{\n\t\t\tconst allowedOptions = new Set([\n\t\t\t\t'overlay',\n\t\t\t\t'bindOptions',\n\t\t\t\t'targetContainer',\n\t\t\t\t'zIndexOptions',\n\t\t\t\t'events',\n\t\t\t\t'animation',\n\t\t\t\t'className',\n\t\t\t]);\n\n\t\t\tconst popupOptions = {};\n\n\t\t\tObject.keys(options.popupOptions).forEach((option: string) => {\n\t\t\t\tif (allowedOptions.has(option))\n\t\t\t\t{\n\t\t\t\t\tpopupOptions[option] = options.popupOptions[option];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.popupOptions = popupOptions;\n\t\t}\n\n\t\tthis.navigation = new Navigation(this);\n\n\t\t(new SliderIntegration(this));\n\n\t\tthis.subscribe('ItemNode:onFocus', this.handleItemNodeFocus.bind(this));\n\t\tthis.subscribe('ItemNode:onUnfocus', this.handleItemNodeUnfocus.bind(this));\n\n\t\tthis.subscribeFromOptions(options.events);\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.load();\n\t\tthis.getPopup().show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.destroyed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.destroyed = true;\n\n\t\tthis.emit('onDestroy');\n\n\t\tthis.disconnectTabOverlapping();\n\t\tinstances.delete(this.getId());\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().destroy();\n\t\t}\n\n\t\tfor (const property in this)\n\t\t{\n\t\t\tif (this.hasOwnProperty(property))\n\t\t\t{\n\t\t\t\tdelete this[property];\n\t\t\t}\n\t\t}\n\n\t\tObject.setPrototypeOf(this, null);\n\n\t\tthis.destroyed = true;\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.popup && this.popup.isShown();\n\t}\n\n\tadjustPosition(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().adjustPosition();\n\t\t}\n\t}\n\n\tsearch(queryString: string): void\n\t{\n\t\tconst query = Type.isStringFilled(queryString) ? queryString.trim() : '';\n\n\t\tconst event = new BaseEvent({ data: { query } });\n\t\tthis.emit('onBeforeSearch', event);\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isStringFilled(query))\n\t\t{\n\t\t\tthis.selectFirstTab();\n\t\t\tif (this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.getSearchTab().clearResults();\n\t\t\t}\n\t\t}\n\t\telse if (this.getSearchTab())\n\t\t{\n\t\t\tthis.selectTab(this.getSearchTab().getId());\n\t\t\tthis.getSearchTab().search(query);\n\t\t}\n\n\t\tthis.emit('onSearch', { query });\n\t}\n\n\taddItem(options: ItemOptions): Item\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.addItem: wrong item options.');\n\t\t}\n\n\t\tlet item = this.getItem(options);\n\t\tif (!item)\n\t\t{\n\t\t\titem = new Item(options);\n\n\t\t\tconst undeselectable = this.getUndeselectedItems().some((itemId: ItemId) => {\n\t\t\t\treturn itemId[0] === item.getEntityId() && String(itemId[1]) === String(item.getId());\n\t\t\t});\n\n\t\t\tif (undeselectable)\n\t\t\t{\n\t\t\t\titem.setDeselectable(false);\n\t\t\t}\n\n\t\t\titem.setDialog(this);\n\n\t\t\tconst entity = this.getEntity(item.getEntityId());\n\t\t\tif (entity === null)\n\t\t\t{\n\t\t\t\tthis.addEntity({ id: item.getEntityId() });\n\t\t\t}\n\n\t\t\tlet entityItems = this.items.get(item.getEntityId());\n\t\t\tif (!entityItems)\n\t\t\t{\n\t\t\t\tentityItems = new Map();\n\t\t\t\tthis.items.set(item.getEntityId(), entityItems);\n\t\t\t}\n\n\t\t\tentityItems.set(String(item.getId()), item);\n\n\t\t\tif (item.isSelected())\n\t\t\t{\n\t\t\t\tthis.handleItemSelect(item);\n\t\t\t}\n\t\t}\n\n\t\tlet tabs = [];\n\t\tif (Type.isArray(options.tabs))\n\t\t{\n\t\t\ttabs = options.tabs;\n\t\t}\n\t\telse if (Type.isStringFilled(options.tabs))\n\t\t{\n\t\t\ttabs = [options.tabs];\n\t\t}\n\n\t\tconst children = Type.isArray(options.children) ? options.children : [];\n\n\t\ttabs.forEach((tabId) => {\n\t\t\tconst tab = this.getTab(tabId);\n\t\t\tif (tab)\n\t\t\t{\n\t\t\t\tconst itemNode = tab.getRootNode().addItem(item, options.nodeOptions);\n\t\t\t\titemNode.addChildren(children);\n\t\t\t}\n\t\t});\n\n\t\treturn item;\n\t}\n\n\tremoveItem(item: Item | ItemOptions): ?Item\n\t{\n\t\titem = this.getItem(item);\n\t\tif (item)\n\t\t{\n\t\t\tthis.handleItemDeselect(item);\n\n\t\t\titem.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.getParentNode().removeChild(node);\n\t\t\t});\n\n\t\t\tconst entityItems = this.getEntityItemsInternal(item.getEntityId());\n\t\t\tif (entityItems)\n\t\t\t{\n\t\t\t\tentityItems.delete(String(item.getId()));\n\t\t\t\tif (entityItems.size === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.items.delete(item.getEntityId());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tremoveItems(): void\n\t{\n\t\tthis.getItemsInternal().forEach((items: Map<string, Item>) => {\n\t\t\titems.forEach((item: Item) => {\n\t\t\t\tthis.removeItem(item);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetItem(item: ItemId | Item | ItemOptions): ?Item\n\t{\n\t\tlet id = null;\n\t\tlet entityId = null;\n\n\t\tif (Type.isArray(item) && item.length === 2)\n\t\t{\n\t\t\t[entityId, id] = item;\n\t\t}\n\t\telse if (item instanceof Item)\n\t\t{\n\t\t\tid = item.getId();\n\t\t\tentityId = item.getEntityId();\n\t\t}\n\t\telse if (Type.isObjectLike(item))\n\t\t{\n\t\t\t({ id, entityId } = item);\n\t\t}\n\n\t\tconst entityItems = this.getEntityItemsInternal(entityId);\n\t\tif (entityItems)\n\t\t{\n\t\t\treturn entityItems.get(String(id)) || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSelectedItems(): Item[]\n\t{\n\t\treturn Array.from(this.selectedItems);\n\t}\n\n\tgetItems(): Item[]\n\t{\n\t\tconst items = [];\n\t\tthis.getItemsInternal().forEach((entityItems: Map<string, Item>) => {\n\t\t\tArray.prototype.push.apply(items, Array.from(entityItems.values()));\n\t\t});\n\n\t\treturn items;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetItemsInternal(): Map<string, Map<string, Item>>\n\t{\n\t\treturn this.items;\n\t}\n\n\tgetEntityItems(entityId: string): Item[]\n\t{\n\t\tconst items = this.getEntityItemsInternal(entityId);\n\n\t\treturn items === null ? [] : Array.from(items.values());\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetEntityItemsInternal(entityId: string): Map<string, Item> | null\n\t{\n\t\treturn this.items.get(entityId) || null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tvalidateItemIds(itemIds: ItemId[]): ItemId[]\n\t{\n\t\tif (!Type.isArrayFilled(itemIds))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result = [];\n\t\titemIds.forEach((itemId: ItemId) => {\n\t\t\tif (!Type.isArray(itemId) || itemId.length !== 2)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst [entityId, id] = itemId;\n\n\t\t\tif (Type.isStringFilled(entityId) && (Type.isStringFilled(id) || Type.isNumber(id)))\n\t\t\t{\n\t\t\t\tresult.push(itemId);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\taddTab(tab: Tab | TabOptions): Tab\n\t{\n\t\tif (Type.isPlainObject(tab))\n\t\t{\n\t\t\ttab = new Tab(this, tab);\n\t\t}\n\n\t\tif (!(tab instanceof Tab))\n\t\t{\n\t\t\tthrow new Error('EntitySelector: a tab must be an instance of EntitySelector.Tab.');\n\t\t}\n\n\t\tif (this.getTab(tab.getId()))\n\t\t{\n\t\t\tconsole.error(`EntitySelector: the \"${tab.getId()}\" tab is already existed.`);\n\t\t\treturn tab;\n\t\t}\n\n\t\ttab.setDialog(this);\n\t\tthis.tabs.set(tab.getId(), tab);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.insertTab(tab);\n\t\t}\n\n\t\treturn tab;\n\t}\n\n\tgetTabs(): Tab[]\n\t{\n\t\treturn Array.from(this.tabs.values());\n\t}\n\n\tgetTab(id: string): ?Tab\n\t{\n\t\treturn this.tabs.get(id) || null;\n\t}\n\n\tgetRecentTab(): RecentTab\n\t{\n\t\treturn this.recentTab;\n\t}\n\n\tgetSearchTab(): SearchTab\n\t{\n\t\treturn this.searchTab;\n\t}\n\n\tselectTab(id: string): ?Tab\n\t{\n\t\tconst newActiveTab = this.getTab(id);\n\t\tif (!newActiveTab || newActiveTab === this.getActiveTab())\n\t\t{\n\t\t\treturn newActiveTab;\n\t\t}\n\n\t\tif (this.getActiveTab())\n\t\t{\n\t\t\tthis.getActiveTab().deselect();\n\t\t}\n\n\t\tthis.activeTab = newActiveTab;\n\t\tnewActiveTab.select();\n\n\t\tif (!newActiveTab.isRendered())\n\t\t{\n\t\t\tnewActiveTab.render();\n\t\t}\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.focusSearch();\n\t\t\t});\n\t\t});\n\n\t\tthis.clearNodeFocus();\n\t\tif (this.shouldFocusOnFirst())\n\t\t{\n\t\t\tthis.focusOnFirstNode();\n\t\t}\n\n\t\tthis.adjustHeader();\n\t\tthis.adjustFooter();\n\n\t\treturn newActiveTab;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tinsertTab(tab: Tab): void\n\t{\n\t\ttab.renderLabel();\n\t\ttab.renderContainer();\n\n\t\tDom.append(tab.getLabelContainer(), this.getLabelsContainer());\n\t\tDom.append(tab.getContainer(), this.getTabContentsContainer());\n\n\t\tif (tab.getHeader())\n\t\t{\n\t\t\tDom.append(tab.getHeader().getContainer(), this.getHeaderContainer());\n\t\t}\n\n\t\tif (tab.getFooter())\n\t\t{\n\t\t\tDom.append(tab.getFooter().getContainer(), this.getFooterContainer());\n\t\t}\n\t}\n\n\tselectFirstTab(onlyVisible = true): ?Tab\n\t{\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible === false || tab.isVisible())\n\t\t\t{\n\t\t\t\treturn this.selectTab(tab.getId());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDropdownMode())\n\t\t{\n\t\t\treturn this.selectTab(this.getRecentTab().getId());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tselectLastTab(onlyVisible = true): ?Tab\n\t{\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i = tabs.length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible === false || tab.isVisible())\n\t\t\t{\n\t\t\t\treturn this.selectTab(tab.getId());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDropdownMode())\n\t\t{\n\t\t\treturn this.selectTab(this.getRecentTab().getId());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetActiveTab(): ?Tab\n\t{\n\t\treturn this.activeTab;\n\t}\n\n\tgetNextTab(onlyVisible = true): ?Tab\n\t{\n\t\tlet nextTab = null;\n\t\tlet activeFound = false;\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i =  0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible && !tab.isVisible())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (tab === this.getActiveTab())\n\t\t\t{\n\t\t\t\tactiveFound = true;\n\t\t\t}\n\t\t\telse if (activeFound)\n\t\t\t{\n\t\t\t\tnextTab = tab;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn nextTab;\n\t}\n\n\tgetPreviousTab(onlyVisible = true): ?Tab\n\t{\n\t\tlet previousTab = null;\n\t\tlet activeFound = false;\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i = tabs.length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible && !tab.isVisible())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (tab === this.getActiveTab())\n\t\t\t{\n\t\t\t\tactiveFound = true;\n\t\t\t}\n\t\t\telse if (activeFound)\n\t\t\t{\n\t\t\t\tpreviousTab = tab;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn previousTab;\n\t}\n\n\tremoveTab(id: string): void\n\t{\n\t\tconst tab = this.getTab(id);\n\t\tif (!tab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttab.getRootNode().removeChildren();\n\n\t\tthis.tabs.delete(id);\n\n\t\tDom.remove(tab.getLabelContainer(), this.getLabelsContainer());\n\t\tDom.remove(tab.getContainer(), this.getTabContentsContainer());\n\n\t\tif (tab.getHeader())\n\t\t{\n\t\t\tDom.remove(tab.getHeader().getContainer(), this.getHeaderContainer());\n\t\t}\n\n\t\tif (tab.getFooter())\n\t\t{\n\t\t\tDom.remove(tab.getFooter().getContainer(), this.getFooterContainer());\n\t\t}\n\n\t\tthis.selectFirstTab();\n\t}\n\n\taddEntity(entity: Entity | EntityOptions): Entity\n\t{\n\t\tif (Type.isPlainObject(entity))\n\t\t{\n\t\t\tentity = new Entity(entity);\n\t\t}\n\n\t\tif (!(entity instanceof Entity))\n\t\t{\n\t\t\tthrow new Error('EntitySelector: an entity must be an instance of EntitySelector.Entity.');\n\t\t}\n\n\t\tif (this.hasEntity(entity.getId()))\n\t\t{\n\t\t\tconsole.error(`EntitySelector: the \"${entity.getId()}\" entity is already existed.`);\n\t\t\treturn entity;\n\t\t}\n\n\t\tthis.entities.set(entity.getId(), entity);\n\n\t\treturn entity;\n\t}\n\n\tgetEntity(id: string): ?Entity\n\t{\n\t\treturn this.entities.get(id) || null;\n\t}\n\n\thasEntity(id: string): boolean\n\t{\n\t\treturn this.entities.has(id);\n\t}\n\n\tgetEntities(): Entity[]\n\t{\n\t\treturn Array.from(this.entities.values());\n\t}\n\n\tremoveEntity(id: string): void\n\t{\n\t\tthis.removeEntityItems(id);\n\t\tthis.entities.delete(id);\n\t}\n\n\tremoveEntityItems(id: string): void\n\t{\n\t\tconst items = this.getEntityItemsInternal(id);\n\t\tif (items)\n\t\t{\n\t\t\titems.forEach((item: Item) => {\n\t\t\t\tthis.removeItem(item);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetHeader(): ?BaseHeader\n\t{\n\t\treturn this.header;\n\t}\n\n\tgetActiveHeader(): ?BaseHeader\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getActiveTab().getHeader())\n\t\t{\n\t\t\treturn this.getActiveTab().getHeader();\n\t\t}\n\n\t\treturn this.getHeader() && this.getActiveTab().canShowDefaultHeader() ? this.getHeader() : null;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tadjustHeader(): void\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveTab().getHeader())\n\t\t{\n\t\t\tif (this.getHeader())\n\t\t\t{\n\t\t\t\tthis.getHeader().hide();\n\t\t\t}\n\n\t\t\tthis.getActiveTab().getHeader().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getHeader())\n\t\t\t{\n\t\t\t\tif (this.getActiveTab().canShowDefaultHeader())\n\t\t\t\t{\n\t\t\t\t\tthis.getHeader().show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getHeader().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetHeader(headerContent: ?HeaderContent, headerOptions?: HeaderOptions): ?BaseHeader\n\t{\n\t\t/** @var {BaseHeader} */\n\t\tlet header = null;\n\t\tif (headerContent !== null)\n\t\t{\n\t\t\theader = this.constructor.createHeader(this, headerContent, headerOptions);\n\t\t\tif (header === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getHeader() !== null)\n\t\t{\n\t\t\tDom.remove(this.getHeader().getContainer());\n\t\t\tthis.adjustHeader();\n\t\t}\n\n\t\tthis.header = header;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.appendHeader(header);\n\t\t\tthis.adjustHeader();\n\t\t}\n\n\t\treturn header;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tappendHeader(header: BaseHeader): void\n\t{\n\t\tif (header instanceof BaseHeader)\n\t\t{\n\t\t\tDom.append(header.getContainer(), this.getHeaderContainer());\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tstatic createHeader(context: Dialog | Tab, headerContent: HeaderContent, headerOptions?: HeaderOptions): ?BaseHeader\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(headerContent) &&\n\t\t\t!Type.isArrayFilled(headerContent) &&\n\t\t\t!Type.isDomNode(headerContent) &&\n\t\t\t!Type.isFunction(headerContent)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t/** @var {BaseHeader} */\n\t\tlet header = null;\n\t\tconst options = Type.isPlainObject(headerOptions) ? headerOptions : {};\n\n\t\tif (Type.isFunction(headerContent) || Type.isString(headerContent))\n\t\t{\n\t\t\tconst className = Type.isString(headerContent) ? Reflection.getClass(headerContent) : headerContent;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\theader = new className(context, options);\n\t\t\t\tif (!(header instanceof BaseHeader))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: header is not an instance of BaseHeader.');\n\t\t\t\t\theader = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (headerContent !== null && !header)\n\t\t{\n\t\t\theader = new DefaultHeader(context, Object.assign({}, options, { content: headerContent }));\n\t\t}\n\n\t\treturn header;\n\t}\n\n\tgetFooter(): ?BaseFooter\n\t{\n\t\treturn this.footer;\n\t}\n\n\tgetActiveFooter(): ?BaseFooter\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getActiveTab().getFooter())\n\t\t{\n\t\t\treturn this.getActiveTab().getFooter();\n\t\t}\n\n\t\treturn this.getFooter() && this.getActiveTab().canShowDefaultFooter() ? this.getFooter() : null;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tadjustFooter(): void\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveTab().getFooter())\n\t\t{\n\t\t\tif (this.getFooter())\n\t\t\t{\n\t\t\t\tthis.getFooter().hide();\n\t\t\t}\n\n\t\t\tthis.getActiveTab().getFooter().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getFooter())\n\t\t\t{\n\t\t\t\tif (this.getActiveTab().canShowDefaultFooter())\n\t\t\t\t{\n\t\t\t\t\tthis.getFooter().show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getFooter().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetFooter(footerContent: ?FooterContent, footerOptions?: FooterOptions): ?BaseFooter\n\t{\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tif (footerContent !== null)\n\t\t{\n\t\t\tfooter = this.constructor.createFooter(this, footerContent, footerOptions);\n\t\t\tif (footer === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getFooter() !== null)\n\t\t{\n\t\t\tDom.remove(this.getFooter().getContainer());\n\t\t\tthis.adjustFooter();\n\t\t}\n\n\t\tthis.footer = footer;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.appendFooter(footer);\n\t\t\tthis.adjustFooter();\n\t\t}\n\n\t\treturn footer;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tappendFooter(footer: BaseFooter): void\n\t{\n\t\tif (footer instanceof BaseFooter)\n\t\t{\n\t\t\tDom.append(footer.getContainer(), this.getFooterContainer());\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tstatic createFooter(context: Dialog | Tab, footerContent: FooterContent, footerOptions?: FooterOptions): ?BaseFooter\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(footerContent) &&\n\t\t\t!Type.isArrayFilled(footerContent) &&\n\t\t\t!Type.isDomNode(footerContent) &&\n\t\t\t!Type.isFunction(footerContent)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tconst options = Type.isPlainObject(footerOptions) ? footerOptions : {};\n\n\t\tif (Type.isFunction(footerContent) || Type.isString(footerContent))\n\t\t{\n\t\t\tconst className = Type.isString(footerContent) ? Reflection.getClass(footerContent) : footerContent;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\tfooter = new className(context, options);\n\t\t\t\tif (!(footer instanceof BaseFooter))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: footer is not an instance of BaseFooter.');\n\t\t\t\t\tfooter = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (footerContent !== null && !footer)\n\t\t{\n\t\t\tfooter = new DefaultFooter(context, Object.assign({}, options, { content: footerContent }));\n\t\t}\n\n\t\treturn footer;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetContext(): ?string\n\t{\n\t\treturn this.context;\n\t}\n\n\tgetNavigation(): Navigation\n\t{\n\t\treturn this.navigation;\n\t}\n\n\tdeselectAll(): void\n\t{\n\t\tthis.getSelectedItems().forEach((item: Item) => {\n\t\t\titem.deselect();\n\t\t});\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn this.multiple;\n\t}\n\n\tsetTargetNode(node: HTMLElement | { left: number, top: number } | null | MouseEvent): void\n\t{\n\t\tif (!Type.isDomNode(node) && !Type.isNull(node) && !Type.isObject(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetNode = node;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().setBindElement(this.targetNode);\n\t\t\tthis.getPopup().adjustPosition();\n\t\t}\n\t}\n\n\tgetTargetNode(): ?HTMLElement\n\t{\n\t\tif (this.targetNode === null)\n\t\t{\n\t\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE)\n\t\t\t{\n\t\t\t\treturn this.getTagSelector().getOuterContainer();\n\t\t\t}\n\t\t}\n\n\t\treturn this.targetNode;\n\t}\n\n\tsetHideOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hideOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldHideOnSelect(): boolean\n\t{\n\t\tif (this.hideOnSelect !== null)\n\t\t{\n\t\t\treturn this.hideOnSelect;\n\t\t}\n\n\t\treturn !this.isMultiple();\n\t}\n\n\tsetHideOnDeselect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hideOnDeselect = flag;\n\t\t}\n\t}\n\n\tshouldHideOnDeselect(): boolean\n\t{\n\t\tif (this.hideOnDeselect !== null)\n\t\t{\n\t\t\treturn this.hideOnDeselect;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetClearSearchOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.clearSearchOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldClearSearchOnSelect(): boolean\n\t{\n\t\treturn this.clearSearchOnSelect;\n\t}\n\n\tsetAddTagOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.addTagOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldAddTagOnSelect(): boolean\n\t{\n\t\tif (this.addTagOnSelect !== null)\n\t\t{\n\t\t\treturn this.addTagOnSelect;\n\t\t}\n\n\t\treturn this.isMultiple() || this.isTagSelectorOutside();\n\t}\n\n\tsetShowAvatars(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.showAvatars = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getTabs().forEach((tab: Tab) => {\n\t\t\t\t\ttab.renderContainer();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldShowAvatars(): boolean\n\t{\n\t\treturn this.showAvatars;\n\t}\n\n\tsetRecentItemsLimit(recentItemsLimit: number): void\n\t{\n\t\tif (Type.isNumber(recentItemsLimit) && recentItemsLimit > 0)\n\t\t{\n\t\t\tthis.recentItemsLimit = recentItemsLimit;\n\t\t}\n\t}\n\n\tgetRecentItemsLimit(): ?number\n\t{\n\t\treturn this.recentItemsLimit;\n\t}\n\n\tsetOffsetAnimation(flag: boolean): any\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.offsetAnimation = flag;\n\n\t\t\tif (this.isRendered() && !this.offsetAnimation)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getPopup().getPopupContainer(), 'ui-selector-popup-offset-animation');\n\t\t\t}\n\t\t}\n\t}\n\n\tisCompactView(): boolean\n\t{\n\t\treturn this.compactView;\n\t}\n\n\tsetAutoHide(enable: boolean): void\n\t{\n\t\tif (Type.isBoolean(enable))\n\t\t{\n\t\t\tthis.autoHide = enable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setAutoHide(enable);\n\t\t\t}\n\t\t}\n\t}\n\n\tisAutoHide(): boolean\n\t{\n\t\treturn this.autoHide;\n\t}\n\n\tsetAutoHideHandler(handler?: (event: MouseEvent, dialog: Dialog) => boolean): void\n\t{\n\t\tif (Type.isFunction(handler) || handler === null)\n\t\t{\n\t\t\tthis.autoHideHandler = handler;\n\t\t}\n\t}\n\n\tsetHideByEsc(enable: boolean): void\n\t{\n\t\tif (Type.isBoolean(enable))\n\t\t{\n\t\t\tthis.hideByEsc = enable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setClosingByEsc(enable);\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldHideByEsc(): boolean\n\t{\n\t\treturn this.hideByEsc;\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn this.width;\n\t}\n\n\tsetWidth(width: number): void\n\t{\n\t\tif (Type.isNumber(width) && width > 0)\n\t\t{\n\t\t\tthis.width = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'width', `${width}px`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHeight(): number\n\t{\n\t\treturn this.height;\n\t}\n\n\tsetHeight(height: number): Promise\n\t{\n\t\tif (Type.isNumber(height) && height > 0)\n\t\t{\n\t\t\tthis.height = height;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'height', `${height}px`);\n\t\t\t\treturn Animation.handleTransitionEnd(this.getContainer(), 'height');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tgetOffsetLeft(): number\n\t{\n\t\treturn this.offsetLeft;\n\t}\n\n\tsetOffsetLeft(offset: number): void\n\t{\n\t\tif (Type.isNumber(offset) && offset >= 0)\n\t\t{\n\t\t\tthis.offsetLeft = offset;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setOffset({ offsetLeft: offset });\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffsetTop(): number\n\t{\n\t\treturn this.offsetTop;\n\t}\n\n\tsetOffsetTop(offset: number): void\n\t{\n\t\tif (Type.isNumber(offset) && offset >= 0)\n\t\t{\n\t\t\tthis.offsetTop = offset;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setOffset({ offsetTop: offset });\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetZindex(): number\n\t{\n\t\treturn this.getPopup().getZindex();\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetCacheable(cacheable: boolean): void\n\t{\n\t\tif (Type.isBoolean(cacheable))\n\t\t{\n\t\t\tthis.cacheable = cacheable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setCacheable(cacheable);\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldFocusOnFirst(): boolean\n\t{\n\t\treturn this.focusOnFirst;\n\t}\n\n\tsetFocusOnFirst(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.focusOnFirst = flag;\n\t\t}\n\t}\n\n\tfocusOnFirstNode(): ?ItemNode\n\t{\n\t\tif (this.getActiveTab())\n\t\t{\n\t\t\tconst itemNode = this.getActiveTab().getRootNode().getFirstChild();\n\t\t\tif (itemNode)\n\t\t\t{\n\t\t\t\titemNode.focus();\n\n\t\t\t\treturn itemNode;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetFocusedNode(): ?ItemNode\n\t{\n\t\treturn this.focusedNode;\n\t}\n\n\tclearNodeFocus(): void\n\t{\n\t\tif (this.focusedNode)\n\t\t{\n\t\t\tthis.focusedNode.unfocus();\n\t\t\tthis.focusedNode = null;\n\t\t}\n\t}\n\n\tisDropdownMode(): boolean\n\t{\n\t\treturn this.dropdownMode;\n\t}\n\n\tsetPreselectedItems(itemIds: ItemId[]): void\n\t{\n\t\tthis.preselectedItems = this.validateItemIds(itemIds);\n\t}\n\n\tgetPreselectedItems(): ItemId[]\n\t{\n\t\treturn this.preselectedItems;\n\t}\n\n\tsetUndeselectedItems(itemIds: ItemId[]): void\n\t{\n\t\tthis.undeselectedItems = this.validateItemIds(itemIds);\n\t}\n\n\tgetUndeselectedItems()\n\t{\n\t\treturn this.undeselectedItems;\n\t}\n\n\tsetCustomData(property: ?string | { [key: string]: any }, value?: any): void\n\t{\n\t\tif (Type.isNull(property))\n\t\t{\n\t\t\tthis.customData = Object.create(null);\n\t\t}\n\t\telse if (Type.isPlainObject(property))\n\t\t{\n\t\t\tObject.entries(property).forEach((item) => {\n\t\t\t\tconst [currentKey, currentValue] = item;\n\t\t\t\tthis.setCustomData(currentKey, currentValue);\n\t\t\t});\n\t\t}\n\t\telse if (Type.isString(property))\n\t\t{\n\t\t\tif (Type.isNull(value))\n\t\t\t{\n\t\t\t\tdelete this.customData[property];\n\t\t\t}\n\t\t\telse if (!Type.isUndefined(value))\n\t\t\t{\n\t\t\t\tthis.customData[property] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCustomData(property?: string): any\n\t{\n\t\tif (Type.isUndefined(property))\n\t\t{\n\t\t\treturn this.customData;\n\t\t}\n\n\t\tif (Type.isStringFilled(property))\n\t\t{\n\t\t\treturn this.customData[property];\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetOptions(dialogOptions: DialogOptions): void\n\t{\n\t\tconst options = Type.isPlainObject(dialogOptions) ? dialogOptions : {};\n\n\t\tthis.setCustomData(options.customData);\n\n\t\tif (Type.isArray(options.tabs))\n\t\t{\n\t\t\toptions.tabs.forEach((tab) => {\n\t\t\t\tthis.addTab(tab);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(options.selectedItems))\n\t\t{\n\t\t\toptions.selectedItems.forEach((itemOptions: ItemOptions) => {\n\t\t\t\tconst options = Object.assign({}, Type.isPlainObject(itemOptions) ? itemOptions : {});\n\t\t\t\toptions.selected = true;\n\t\t\t\tthis.addItem(options);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(options.items))\n\t\t{\n\t\t\toptions.items.forEach((itemOptions: ItemOptions) => {\n\t\t\t\tthis.addItem(itemOptions);\n\t\t\t});\n\t\t}\n\n\t\tthis.setHeader(options.header, options.headerOptions);\n\t\tthis.setFooter(options.footer, options.footerOptions);\n\t}\n\n\tgetMaxLabelWidth(): number\n\t{\n\t\treturn this.maxLabelWidth;\n\t}\n\n\tgetMinLabelWidth(): number\n\t{\n\t\treturn this.minLabelWidth;\n\t}\n\n\texpandLabels(animate: boolean = true): void\n\t{\n\t\tconst freeSpace = parseInt(this.getPopup().getPopupContainer().style.left, 10);\n\t\tif (freeSpace > this.getMinLabelWidth())\n\t\t{\n\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t\tif (animate)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\t\t\tDom.style(this.getLabelsContainer(), 'max-width', `${Math.min(freeSpace, this.getMaxLabelWidth())}px`);\n\t\t\t\tAnimation.handleTransitionEnd(this.getLabelsContainer(), 'max-width').then(() => {\n\t\t\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\t\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\t\t\t}).catch(() => {\n\t\t\t\t\t// fail silently\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.style(this.getLabelsContainer(), 'max-width', `${Math.min(freeSpace, this.getMaxLabelWidth())}px`);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\t}\n\t}\n\n\tcollapseLabels(animate: boolean = true): void\n\t{\n\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\tif (animate)\n\t\t{\n\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t\tAnimation.handleTransitionEnd(this.getLabelsContainer(), 'max-width').then(() => {\n\t\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t\t}).catch(() => {\n\t\t\t\t// fail silently\n\t\t\t});\n\t\t}\n\n\t\tDom.style(this.getLabelsContainer(), 'max-width', null);\n\t}\n\n\tgetTagSelector(): ?TagSelector\n\t{\n\t\treturn this.tagSelector;\n\t}\n\n\tgetTagSelectorMode(): ?TagSelectorMode\n\t{\n\t\treturn this.tagSelectorMode;\n\t}\n\n\tisTagSelectorInside(): boolean\n\t{\n\t\treturn this.getTagSelector() && this.getTagSelectorMode() === TagSelectorMode.INSIDE;\n\t}\n\n\tisTagSelectorOutside(): boolean\n\t{\n\t\treturn this.getTagSelector() && this.getTagSelectorMode() === TagSelectorMode.OUTSIDE;\n\t}\n\n\tgetTagSelectorQuery(): string\n\t{\n\t\treturn this.getTagSelector() ? this.getTagSelector().getTextBoxValue() : '';\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetTagSelector(tagSelector: TagSelector): void\n\t{\n\t\tthis.tagSelector = tagSelector;\n\n\t\tthis.tagSelector.subscribe('onInput', Runtime.debounce(this.handleTagSelectorInput, 200, this));\n\t\tthis.tagSelector.subscribe('onAddButtonClick', this.handleTagSelectorAddButtonClick.bind(this));\n\t\tthis.tagSelector.subscribe('onTagRemove', this.handleTagSelectorTagRemove.bind(this));\n\t\tthis.tagSelector.subscribe('onAfterTagRemove', this.handleTagSelectorAfterTagRemove.bind(this));\n\t\tthis.tagSelector.subscribe('onAfterTagAdd', this.handleTagSelectorAfterTagAdd.bind(this));\n\t\tthis.tagSelector.subscribe('onContainerClick', this.handleTagSelectorClick.bind(this));\n\n\t\tthis.tagSelector.setDialog(this);\n\t}\n\n\tfocusSearch(): void\n\t{\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tif (this.getActiveTab() !== this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.getTagSelector().clearTextBox();\n\t\t\t}\n\n\t\t\tthis.getTagSelector().focusTextBox();\n\t\t}\n\t}\n\n\tclearSearch(): void\n\t{\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().clearTextBox();\n\n\t\t\tif (this.getActiveTab() === this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.selectFirstTab();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getTabsContainer(),\n\t\t\t\tsize: 100\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tvoid this.getLoader().hide();\n\t\t}\n\t}\n\n\tdestroyLoader(): void\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tthis.getLoader().destroy();\n\t\t}\n\n\t\tthis.loader = null;\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (this.popup !== null)\n\t\t{\n\t\t\treturn this.popup;\n\t\t}\n\n\t\tthis.getTabs().forEach((tab: Tab) => {\n\t\t\tthis.insertTab(tab);\n\t\t});\n\n\t\tconst popupOptions = { ...this.popupOptions };\n\t\tconst userEvents = popupOptions.events;\n\t\tdelete popupOptions.events;\n\n\t\tthis.popup = new Popup({\n\t\t\tcontentPadding: 0,\n\t\t\tpadding: 0,\n\t\t\toffsetTop: this.getOffsetTop(),\n\t\t\toffsetLeft: this.getOffsetLeft(),\n\t\t\tanimation: {\n\t\t\t\tshowClassName: 'ui-selector-popup-animation-show',\n\t\t\t\tcloseClassName: 'ui-selector-popup-animation-close',\n\t\t\t\tcloseAnimationType: 'animation',\n\t\t\t},\n\t\t\tbindElement: this.getTargetNode(),\n\t\t\tbindOptions: {\n\t\t\t\tforceBindPosition: true,\n\t\t\t},\n\t\t\tautoHide: this.isAutoHide(),\n\t\t\tautoHideHandler: this.handleAutoHide.bind(this),\n\t\t\tcloseByEsc: this.shouldHideByEsc(),\n\t\t\tcacheable: this.isCacheable(),\n\t\t\tevents: {\n\t\t\t\tonFirstShow: this.handlePopupFirstShow.bind(this),\n\t\t\t\tonShow: this.handlePopupShow.bind(this),\n\t\t\t\tonAfterShow: this.handlePopupAfterShow.bind(this),\n\t\t\t\tonAfterClose: this.handlePopupAfterClose.bind(this),\n\t\t\t\tonDestroy: this.handlePopupDestroy.bind(this),\n\t\t\t},\n\t\t\tcontent: this.getContainer(),\n\t\t\t...popupOptions,\n\t\t});\n\n\t\tthis.popup.subscribeFromOptions(userEvents);\n\n\t\tthis.rendered = true;\n\n\t\tthis.selectFirstTab();\n\n\t\treturn this.popup;\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\n\t\t\tlet searchContainer = '';\n\t\t\tif (this.getTagSelectorMode() === TagSelectorMode.INSIDE)\n\t\t\t{\n\t\t\t\tsearchContainer = Tag.render`<div class=\"ui-selector-search\"></div>`;\n\n\t\t\t\tthis.getTagSelector().renderTo(searchContainer);\n\t\t\t}\n\n\t\t\tconst className = this.isCompactView() ? ' ui-selector-dialog--compact-view' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-selector-dialog${className}\"\n\t\t\t\t\tstyle=\"width:${this.getWidth()}px; height:${this.getHeight()}px;\"\n\t\t\t\t>\n\t\t\t\t\t${this.getHeaderContainer()}\n\t\t\t\t\t${searchContainer}\n\t\t\t\t\t${this.getTabsContainer()}\n\t\t\t\t\t${this.getFooterContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTabsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('tabs-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tabs\">\n\t\t\t\t\t${this.getTabContentsContainer()}\n\t\t\t\t\t${this.getLabelsContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTabContentsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('tab-contents', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-tab-contents\"></div>`;\n\t\t});\n\t}\n\n\tgetLabelsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('labels-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-selector-tab-labels\"\n\t\t\t\t\tonmouseenter=\"${this.alwaysShowLabels ? null : this.handleLabelsMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.alwaysShowLabels ? null : this.handleLabelsMouseLeave.bind(this)}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHeaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\tconst header = this.getHeader() && this.getHeader().getContainer();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-header-container\">${header ? header : ''}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFooterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('footer', () => {\n\t\t\tconst footer = this.getFooter() && this.getFooter().getContainer();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-footer-container\">${footer ? footer : ''}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tfreeze(): void\n\t{\n\t\tif (this.isFrozen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.frozenProps = {\n\t\t\tautoHide: this.isAutoHide(),\n\t\t\thideByEsc: this.shouldHideByEsc(),\n\t\t};\n\n\t\tthis.setAutoHide(false);\n\t\tthis.setHideByEsc(false);\n\n\t\tthis.getNavigation().disable();\n\t\tDom.addClass(this.getContainer(), 'ui-selector-dialog--freeze');\n\n\t\tthis.frozen = true;\n\t}\n\n\tunfreeze(): void\n\t{\n\t\tif (!this.isFrozen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setAutoHide(this.frozenProps.autoHide !== false);\n\t\tthis.setHideByEsc(this.frozenProps.hideByEsc !== false);\n\n\t\tthis.getNavigation().enable();\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-dialog--freeze');\n\n\t\tthis.frozen = false;\n\t}\n\n\tisFrozen(): boolean\n\t{\n\t\treturn this.frozen;\n\t}\n\n\thasRecentItems(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax\n\t\t\t\t.runAction('ui.entityselector.load', {\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tdialog: this.getAjaxJson()\n\t\t\t\t\t},\n\t\t\t\t\tgetParameters: {\n\t\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tresponse.data && response.data.dialog && Type.isArrayFilled(response.data.dialog.recentItems)\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\treject(error);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tload(): void\n\t{\n\t\tif (this.loadState !== LoadState.UNSENT || !this.hasDynamicLoad())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().lock();\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.destroyed)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isLoading())\n\t\t\t{\n\t\t\t\tthis.showLoader();\n\t\t\t}\n\t\t}, 400);\n\n\t\tthis.loadState = LoadState.LOADING;\n\n\t\tAjax.runAction('ui.entityselector.load', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this.getAjaxJson()\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (this.destroyed)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (response && response.data && Type.isPlainObject(response.data.dialog))\n\t\t\t\t{\n\t\t\t\t\tthis.loadState = LoadState.DONE;\n\n\t\t\t\t\tconst entities =\n\t\t\t\t\t\tType.isArrayFilled(response.data.dialog.entities)\n\t\t\t\t\t\t\t? response.data.dialog.entities\n\t\t\t\t\t\t\t: []\n\t\t\t\t\t;\n\n\t\t\t\t\tentities.forEach((entityOptions: EntityOptions) => {\n\t\t\t\t\t\tconst entity = this.getEntity(entityOptions.id);\n\t\t\t\t\t\tif (entity)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.setDynamicSearch(entityOptions.dynamicSearch);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.setOptions(response.data.dialog);\n\n\t\t\t\t\tthis.getPreselectedItems().forEach((preselectedItem: ItemId) => {\n\t\t\t\t\t\tconst item = this.getItem(preselectedItem);\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst recentItems = response.data.dialog.recentItems;\n\t\t\t\t\tif (Type.isArray(recentItems))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst nodeOptionsMap: Map<Item, ItemNodeOptions> = new Map();\n\t\t\t\t\t\tconst itemsOptions: ItemOptions[] = response.data.dialog.items;\n\t\t\t\t\t\tif (Type.isArray(itemsOptions))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemsOptions.forEach((itemOptions: ItemOptions) => {\n\t\t\t\t\t\t\t\tif (itemOptions.nodeOptions)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst item = this.getItem(itemOptions);\n\t\t\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tnodeOptionsMap.set(item, itemOptions.nodeOptions);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst items = recentItems.map((recentItem: ItemId) => {\n\t\t\t\t\t\t\tconst item = this.getItem(recentItem);\n\n\t\t\t\t\t\t\treturn [item, nodeOptionsMap.get(item)];\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.getRecentTab().getRootNode().addItems(items);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.getRecentTab().getRootNode().hasChildren() && this.getRecentTab().getStub())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getRecentTab().getStub().show();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.getTagSelector())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getTagSelector().unlock();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isRendered())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isDropdownMode() && this.getActiveTab() === this.getRecentTab())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectFirstTab();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (!this.getActiveTab())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectFirstTab();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.focusSearch();\n\t\t\t\t\tthis.destroyLoader();\n\n\t\t\t\t\tif (this.shouldFocusOnFirst())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusOnFirstNode();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isArrayFilled(response.data.dialog.errors))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emitEntityErrors(response.data.dialog.errors);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.emit('onLoad');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.loadState = LoadState.UNSENT;\n\n\t\t\t\tif (this.getTagSelector())\n\t\t\t\t{\n\t\t\t\t\tthis.getTagSelector().unlock();\n\t\t\t\t}\n\n\t\t\t\tthis.focusSearch();\n\t\t\t\tthis.destroyLoader();\n\n\t\t\t\tthis.emit('onLoadError', { error });\n\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}\n\n\tisLoaded(): boolean\n\t{\n\t\treturn this.loadState === LoadState.DONE;\n\t}\n\n\tisLoading(): boolean\n\t{\n\t\treturn this.loadState === LoadState.LOADING;\n\t}\n\n\thasDynamicLoad(): boolean\n\t{\n\t\tlet hasDynamicLoad = false;\n\t\tthis.entities.forEach((entity: Entity) => {\n\t\t\thasDynamicLoad = hasDynamicLoad || entity.hasDynamicLoad();\n\t\t});\n\n\t\treturn hasDynamicLoad;\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\tlet hasDynamicSearch = false;\n\t\tthis.entities.forEach((entity: Entity) => {\n\t\t\thasDynamicSearch = hasDynamicSearch || (entity.isSearchable() && entity.hasDynamicSearch());\n\t\t});\n\n\t\treturn hasDynamicSearch;\n\t}\n\n\tsaveRecentItem(item: Item): void\n\t{\n\t\tif (this.getContext() === null || !item.isSaveable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.recentItemsToSave.push(item);\n\t\tthis.saveRecentItemsWithDebounce();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsaveRecentItems(): void\n\t{\n\t\tif (!Type.isArrayFilled(this.recentItemsToSave))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tAjax.runAction('ui.entityselector.saveRecentItems', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this.getAjaxJson(),\n\t\t\t\t\trecentItems: this.recentItemsToSave.map((item: Item) => item.getAjaxJson())\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\n\t\tthis.recentItemsToSave = [];\n\t}\n\n\tshouldClearUnavailableItems(): boolean\n\t{\n\t\treturn this.clearUnavailableItems;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorInput(): void\n\t{\n\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE && !this.isOpen())\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\n\t\tconst query = this.getTagSelector().getTextBoxValue();\n\t\tthis.search(query);\n\n\t\tthis.adjustByTagSelector();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorAddButtonClick(): void\n\t{\n\t\tthis.show();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorTagRemove(event: BaseEvent): void\n\t{\n\t\tconst { tag } = event.getData();\n\n\t\tconst item = this.getItem({ id: tag.getId(), entityId: tag.getEntityId() });\n\t\tif (item)\n\t\t{\n\t\t\titem.deselect();\n\t\t}\n\n\t\tthis.focusSearch();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorAfterTagRemove(): void\n\t{\n\t\tthis.adjustByTagSelector();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorAfterTagAdd(): void\n\t{\n\t\tthis.adjustByTagSelector();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tadjustByTagSelector(): void\n\t{\n\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE)\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t}\n\t\telse if (this.getTagSelectorMode() === TagSelectorMode.INSIDE)\n\t\t{\n\t\t\tconst newTagSelectorHeight = this.getTagSelector().calcHeight();\n\t\t\tif (newTagSelectorHeight > 0)\n\t\t\t{\n\t\t\t\tconst offset = newTagSelectorHeight - (this.tagSelectorHeight || this.getTagSelector().getMinHeight());\n\t\t\t\tthis.tagSelectorHeight = newTagSelectorHeight;\n\t\t\t\tif (offset !== 0)\n\t\t\t\t{\n\t\t\t\t\tconst height = this.getHeight();\n\t\t\t\t\tthis.setHeight(height + offset).then(() => {\n\t\t\t\t\t\tthis.adjustPosition();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorClick(): void\n\t{\n\t\tthis.focusSearch();\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleItemSelect(item: Item, animate: boolean = true): void\n\t{\n\t\tconst shouldAnimate: boolean =\n\t\t\tthis.isMultiple()\n\t\t\t\t? animate\n\t\t\t\t: this.getSelectedItems().length === 0\n\t\t;\n\n\t\tif (!this.isMultiple())\n\t\t{\n\t\t\tthis.deselectAll();\n\n\t\t\tif (this.getSelectedItems().length > 0)\n\t\t\t{\n\t\t\t\tconsole.error('EntitySelector: some items are still selected.', this.getSelectedItems());\n\t\t\t}\n\t\t}\n\n\t\tif (this.getTagSelector() && this.shouldAddTagOnSelect())\n\t\t{\n\t\t\tconst tag: TagItemOptions = item.createTag();\n\t\t\ttag.animate = shouldAnimate;\n\t\t\tthis.getTagSelector().addTag(tag);\n\t\t}\n\n\t\tthis.selectedItems.add(item);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleItemDeselect(item: Item, animate: boolean = true): void\n\t{\n\t\tconst shouldAnimate: boolean = animate && this.isMultiple();\n\n\t\tthis.selectedItems.delete(item);\n\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().removeTag({\n\t\t\t\tid: item.getId(),\n\t\t\t\tentityId: item.getEntityId()\n\t\t\t}, shouldAnimate);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupAfterShow(): void\n\t{\n\t\tthis.focusSearch();\n\t\tthis.adjustByTagSelector();\n\n\t\tthis.emit('onShow');\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupFirstShow(): void\n\t{\n\t\tthis.emit('onFirstShow');\n\n\t\tthis.observeTabOverlapping();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupShow(): void\n\t{\n\t\tif (this.offsetAnimation)\n\t\t{\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tDom.addClass(this.getPopup().getPopupContainer(), 'ui-selector-popup-offset-animation');\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (this.alwaysShowLabels)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\t// We have to call the method after adjustPosition()\n\t\t\t\tthis.expandLabels(false);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide(event: MouseEvent): void\n\t{\n\t\tconst target = event.target;\n\t\tconst el = this.getPopup().getPopupContainer();\n\t\tif (target === el || el.contains(target))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tthis.isTagSelectorOutside()\n\t\t\t&& target === this.getTagSelector().getTextBox()\n\t\t\t&& Type.isStringFilled(this.getTagSelector().getTextBoxValue())\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.autoHideHandler !== null)\n\t\t{\n\t\t\tconst result = this.autoHideHandler(event, this);\n\t\t\tif (Type.isBoolean(result))\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tobserveTabOverlapping(): void\n\t{\n\t\tthis.disconnectTabOverlapping();\n\n\t\tthis.overlappingObserver = new MutationObserver(() => {\n\t\t\tif (this.getLabelsContainer().offsetWidth > 0)\n\t\t\t{\n\t\t\t\tconst left = parseInt(this.getPopup().getPopupContainer().style.left, 10);\n\t\t\t\tif (left < this.getMinLabelWidth())\n\t\t\t\t{\n\t\t\t\t\tDom.style(this.getPopup().getPopupContainer(), 'left', `${this.getMinLabelWidth()}px`);\n\t\t\t\t\tthis.collapseLabels(false);\n\t\t\t\t}\n\t\t\t\telse if (this.alwaysShowLabels)\n\t\t\t\t{\n\t\t\t\t\tthis.expandLabels(false);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.overlappingObserver.observe(this.getPopup().getPopupContainer(), {\n\t\t\tattributes: true,\n\t\t\tattributeFilter: ['style'],\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tdisconnectTabOverlapping(): void\n\t{\n\t\tif (this.overlappingObserver)\n\t\t{\n\t\t\tthis.overlappingObserver.disconnect();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupAfterClose(): void\n\t{\n\t\tif (this.isTagSelectorOutside())\n\t\t{\n\t\t\tif (this.getActiveTab() && this.getActiveTab() === this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.selectFirstTab();\n\t\t\t}\n\n\t\t\tthis.getTagSelector().clearTextBox();\n\t\t\tthis.getTagSelector().showAddButton();\n\t\t\tthis.getTagSelector().hideTextBox();\n\t\t}\n\n\t\tif (this.offsetAnimation)\n\t\t{\n\t\t\tDom.removeClass(this.getPopup().getPopupContainer(), 'ui-selector-popup-offset-animation');\n\t\t}\n\n\t\tthis.emit('onHide');\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupDestroy(): void\n\t{\n\t\tthis.destroy();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleLabelsMouseEnter(): void\n\t{\n\t\tthis.expandLabels();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleLabelsMouseLeave(): void\n\t{\n\t\tthis.collapseLabels();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleItemNodeFocus(event: BaseEvent): void\n\t{\n\t\tconst { node } = event.getData();\n\t\tif (this.focusedNode === node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearNodeFocus();\n\n\t\tthis.focusedNode = node;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleItemNodeUnfocus(): void\n\t{\n\t\tthis.clearNodeFocus();\n\t}\n\n\tgetAjaxJson(): { [key: string]: any }\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tcontext: this.getContext(),\n\t\t\tentities: this.getEntities(),\n\t\t\tpreselectedItems: this.getPreselectedItems(),\n\t\t\trecentItemsLimit: this.getRecentItemsLimit(),\n\t\t\tclearUnavailableItems: this.shouldClearUnavailableItems(),\n\t\t};\n\t}\n\n\t/** @internal */\n\temitEntityErrors(errorOptions: EntityErrorOptions[]): void\n\t{\n\t\tconst errorCollection = EntityErrorCollection.create(errorOptions);\n\n\t\tthis.emit('Entity:onError', { errors: [...errorCollection] });\n\n\t\tthis.getEntities().forEach((entity: Entity) => {\n\t\t\tconst entityId = entity.getId();\n\t\t\tthis.emit(`Entity:${entityId}:onError`, { errors: errorCollection.getByEntityId(entityId) });\n\t\t});\n\t}\n}\n","import Dialog from './dialog/dialog';\nimport EntityError from './entity/entity-error';\nimport Item from './item/item';\nimport ItemNode from './item/item-node';\nimport Tab from './dialog/tabs/tab';\nimport Entity from './entity/entity';\nimport TagSelector from './tag-selector/tag-selector';\nimport TagItem from './tag-selector/tag-item';\nimport BaseHeader from './dialog/header/base-header';\nimport DefaultHeader from './dialog/header/default-header';\nimport BaseFooter from './dialog/footer/base-footer';\nimport DefaultFooter from './dialog/footer/default-footer';\nimport BaseStub from './dialog/tabs/base-stub';\nimport DefaultStub from './dialog/tabs/default-stub';\n\nimport type { DialogOptions } from './dialog/dialog-options';\nimport type { TabOptions } from './dialog/tabs/tab-options';\nimport type { ItemOptions, ItemSelectOptions } from './item/item-options';\nimport type { EntityOptions } from './entity/entity-options';\nimport type { EntityFilterOptions } from './entity/entity-filter-options';\nimport type { EntityErrorOptions } from './entity/entity-error-options';\nimport type { EntityBadgeOptions } from './entity/entity-badge-options';\nimport type { TagSelectorOptions } from './tag-selector/tag-selector-options';\nimport type { ItemId } from './item/item-id';\nimport type { ItemBadgeOptions } from './item/item-badge-options';\nimport type { ItemNodeOptions } from './item/item-node-options';\nimport type { BadgesOptions } from './item/badges-options';\nimport type { AvatarOptions } from './item/avatar-options';\nimport type { CaptionOptions } from './item/caption-options';\nimport type { SearchOptions } from './dialog/search-options';\n\nimport './css/dialog.css';\nimport './css/tab.css';\nimport './css/item.css';\nimport './css/tag-selector.css';\n\nconst EntitySelector = {\n\tDialog,\n\tItem,\n\tTab,\n\tEntity,\n\tTagSelector,\n\tTagItem,\n\tBaseHeader,\n\tDefaultHeader,\n\tBaseFooter,\n\tDefaultFooter,\n\tBaseStub,\n\tDefaultStub,\n\tEntityError,\n};\n\n/**\n * @namespace BX.UI.EntitySelector\n */\nexport {\n\tEntitySelector,\n\tDialog,\n\tItem,\n\tTab,\n\tEntity,\n\tTagSelector,\n\tTagItem,\n\tBaseHeader,\n\tDefaultHeader,\n\tBaseFooter,\n\tDefaultFooter,\n\tBaseStub,\n\tDefaultStub,\n\tEntityError,\n};\n\nexport type {\n\tDialogOptions,\n\tTabOptions,\n\tItemOptions,\n\tItemSelectOptions,\n\tItemBadgeOptions,\n\tItemNodeOptions,\n\tEntityOptions,\n\tEntityFilterOptions,\n\tEntityErrorOptions,\n\tEntityBadgeOptions,\n\tTagSelectorOptions,\n\tItemId,\n\tItemNode,\n\tBadgesOptions,\n\tAvatarOptions,\n\tCaptionOptions,\n\tSearchOptions,\n};\n"],"names":["ItemNodeComparator","order","props","Object","keys","map","property","Text","capitalize","directions","values","forEach","element","direction","toLowerCase","trim","ascOrdering","nullsOrdering","push","numberOfProperties","length","nodeA","nodeB","i","result","propertyGetter","compareItemNodes","itemA","getItem","itemB","getCustomData","get","valueA","valueB","Type","isString","localeCompare","sortOrder","TextNodeType","type","HTML","TEXT","TextNode","options","isPlainObject","text","isValid","getText","getType","textContent","innerHTML","Highlighter","matches","encode","isStringFilled","count","offset","chunk","match","getStartIndex","substring","getEndIndex","ItemBadge","badgeOptions","WeakMap","setTitle","title","setTextColor","textColor","setBgColor","bgColor","setBorder","border","titleNode","getTitleNode","isNullable","target","container","containers","document","createElement","className","set","getContainer","renderTo","Dom","style","getTextColor","getBgColor","getBorder","append","SearchField","fieldOptions","name","Error","setType","setSystem","system","setSort","sort","setSearchable","searchable","isNumber","flag","isBoolean","isSystem","MatchIndex","field","queryWord","startIndex","endIndex","comparator","a","b","MatchField","indexes","OrderedArray","addIndexes","matchIndexes","matchIndex","add","isArray","addIndex","Animation","propertyName","properties","Set","Promise","resolve","handler","event","has","delete","size","Event","unbind","bind","animationName","regexp","isDataUri","str","encodeUrl","url","encodeURI","RenderMode","ItemNode","item","nodeOptions","Cache","MemoryCache","PARTIAL","Runtime","debounce","render","isObject","isFunction","itemOrder","makeMultipleComparator","children","renderMode","OVERRIDE","setSubtitle","setSupertitle","setCaption","setLinkTitle","avatar","avatarOptions","bgSize","bgImage","borderRadius","outline","outlineOffset","icon","iconColor","link","badges","captionOptions","fitContent","maxWidth","justifyContent","badgesOptions","subtitle","supertitle","caption","setCaptionOptions","setAvatar","setAvatarOptions","setLink","linkTitle","setBadges","setBadgesOptions","setDynamic","dynamic","setOpen","open","getParentNode","getTab","getDialog","tab","parentNode","siblings","getChildren","index","getIndex","getByIndex","childOptions","tabs","childItem","addItem","childNode","addChildren","child","isChildOf","childItems","setTab","setParentNode","isRendered","renderWithDebounce","isRoot","getDepthLevel","itemNode","createNode","addChild","items","disableRender","Item","enableRender","removeChildren","isFocused","unfocus","removeNode","remove","getOuterContainer","hasChildren","node","clear","Browser","isIE","clean","getChildrenContainer","parent","getFirst","getLast","isDynamic","dynamicPromise","Ajax","runAction","json","parentItem","getAjaxJson","dialog","getParameters","context","getContext","then","response","data","loaded","catch","error","console","isLoaded","setAutoOpen","autoOpen","loader","Loader","getIndicatorContainer","getLoader","show","addClass","hide","removeClass","destroy","isOpen","loadChildren","destroyLoader","expand","showLoader","requestAnimationFrame","scrollHeight","handleTransitionEnd","offsetHeight","appendChildren","renderRoot","getTitleContainer","supertitleNode","getSupertitleNode","getSupertitleContainer","subtitleNode","getSubtitleNode","getSubtitleContainer","captionNode","getCaptionNode","getCaptionContainer","captionFitContent","getCaptionOption","captionJustifyContent","flexGrow","textAlign","captionMaxWidth","color","removeProperty","getAvatarContainer","getAvatar","backgroundImage","getAvatarOption","backgroundColor","backgroundSize","undefined","Icon","getBadgeContainer","getBadges","badge","badgesFitContent","getBadgesOption","badgesJustifyContent","badgesMaxWidth","linkTitleNode","getLinkTitleNode","getLinkTextContainer","getItemMaxDepth","classList","contains","hasVisibleChild","getAll","some","isHidden","toggleVisibility","highlight","renderChildren","isAutoOpen","rendered","stub","getStub","isAutoShow","hasDynamicLoad","previousSibling","insertAfter","hidden","option","isUndefined","value","setCaptionOption","setAvatarOption","replaceMacros","getLink","setBadgesOption","cache","remember","isLocked","isSelected","div","appendChild","getItemsContainer","handleClick","handleMouseEnter","handleMouseLeave","getTitlesContainer","getLinkContainer","getTitleBoxContainer","anchor","href","handleLinkClick","span","highlights","getHighlights","matchField","getField","fieldName","getName","isCustom","mark","getMatches","focused","emit","collapse","isDeselectable","deselect","shouldHideOnDeselect","select","shouldClearSearchOnSelect","clearSearch","shouldHideOnSelect","focusSearch","tabContainer","nodeContainer","tabRect","getPosition","nodeRect","margin","top","scrollTop","bottom","click","stopPropagation","focus","showLink","hideLink","constructor","setAttribute","attr","offsetWidth","scrollWidth","replace","SearchFieldIndex","getIndexes","WordIndex","word","setWord","setStartIndex","rsAstralRange","rsComboMarksRange","reComboHalfMarksRange","rsComboSymbolsRange","rsComboMarksExtendedRange","rsComboMarksSupplementRange","rsComboRange","rsDingbatRange","rsLowerRange","rsMathOpRange","rsNonCharRange","rsPunctuationRange","rsSpaceRange","rsUpperRange","rsVarRange","rsBreakRange","rsApos","rsBreak","rsCombo","rsDigit","rsDingbat","rsLower","rsMisc","rsFitz","rsModifier","rsNonAstral","rsRegional","rsSurrPair","rsUpper","rsZWJ","rsMiscLower","rsMiscUpper","rsOptContrLower","rsOptContrUpper","reOptMod","rsOptVar","rsOptJoin","join","rsOrdLower","rsOrdUpper","rsSeq","rsEmoji","unicodeWordsRegExp","RegExp","asciiWordRegExp","hasUnicodeWordRegExp","nonWhitespaceRegExp","specialChars","specialCharsRegExp","SearchIndex","fieldIndex","entity","getEntity","isSearchable","searchFields","getSearchFields","textNode","stripTags","createIndex","getTitle","getSubtitle","getSupertitle","getCaption","customData","repeat","wordIndexes","splitText","isArrayFilled","fillComplexWords","fillNonCharWords","position","indexOf","substr","hasUnicodeWord","splitUnicodeText","splitAsciiText","splitTextInternal","test","regExp","lastIndex","exec","complexWord","currentIndex","currentArrayIndex","nextIndex","sameWord","getWord","char","includes","wordToIndex","EntityFilter","filterOptions","id","getId","getOptions","Entity","entityOptions","Map","defaultOptions","getEntityDefaultOptions","merge","JSON","parse","stringify","itemOptions","tagOptions","substituteEntityId","filters","addFilter","fieldA","fieldB","getSort","setDynamicLoad","dynamicLoad","setDynamicSearch","dynamicSearch","setDynamicSearchMatchMode","dynamicSearchMatchMode","setSearchFields","setSearchCacheLimits","searchCacheLimits","entityType","getOptionInternal","entityTypeBadges","getItemOption","getEntityType","conditions","condition","optionNodes","textNodes","itemOption","titleField","subtitleField","customFields","limits","limit","mode","Array","from","filter","hasDynamicSearch","getFilters","getSubstituteEntityId","getExtensions","extension","settings","Extension","getSettings","entities","extensions","entityId","getDefaultOptions","getItemOptions","getTagOptions","TypeUtils","entries","obj","isMap","key","_classPrivateMethodInitSpec","locked","selected","createMapFromOptions","setSaveable","saveable","setDeselectable","deselectable","setHidden","setContextSort","contextSort","setGlobalSort","globalSort","getEntityId","addEntity","resetSearchIndex","_classPrivateMethodGet","getEntityTextNode","getEntityItemOption","Loc","getMessage","nodes","selectOptions","emitEvents","animate","BaseEvent","isDefaultPrevented","handleItemSelect","getNodes","saveRecentItem","deselectOptions","handleItemDeselect","getTagSelector","tag","getTag","lock","unlock","searchIndex","create","isNull","currentKey","currentValue","getTagOption","getOptionTextNode","useItemOptions","fn","toPascalCase","getEntityTagOption","getTagGlobalOption","toJSON","getTagAvatar","getTagAvatarOptions","getTagLink","getTagMaxWidth","getTagTextColor","getTagBgColor","fontWeight","getTagFontWeight","onclick","isSaveable","getContextSort","getGlobalSort","convertMapToObject","BaseStub","autoShow","getOption","Tag","defaultValue","DefaultStub","getDefaultTitle","getIcon","iconOpacity","Math","min","max","iconStyle","arrow","getActiveFooter","titleContainer","BaseHeader","Dialog","BaseFooter","Tab","tabOptions","setDialog","showDefaultHeader","showDefaultFooter","rootNode","setVisible","visible","setItemMaxDepth","itemMaxDepth","setIcon","Outline","ARROW_RIGHT_L","setStub","stubOptions","setHeader","header","headerOptions","setFooter","footer","footerOptions","setShowAvatars","showAvatars","instance","Reflection","getClass","headerContent","createHeader","getHeader","adjustHeader","appendHeader","footerContent","createFooter","getFooter","adjustFooter","appendFooter","renderContainer","shouldShowAvatars","renderLabel","setProperty","state","getPropertyByState","states","labelState","isHovered","selectedHovered","hovered","default","depth","isVisible","handleLabelClick","handleLabelMouseEnter","handleLabelMouseLeave","getIconContainer","getRootNode","getPropertyByCurrentState","getLabelContainer","selectTab","hover","unhover","EntityError","BaseError","Symbol","iterator","EntityErrorCollection","_classPrivateFieldInitSpec","errorOptions","errorCollection","errorOption","setEntityId","message","setMessage","isNil","code","setCode","setCustomData","TagItem","setMaxWidth","setFontWeight","setClickable","clickable","selector","getSelector","selectorAvatarOption","getTagAvatarOption","entityTagAvatarOptions","entityItemAvatarOptions","width","toggleClass","getTagClickable","getContentContainer","hasAvatar","getMaxWidth","getFontWeight","getRemoveIcon","handleContainerClick","isClickable","getOnclick","handleRemoveIconClick","handleAnimationEnd","removeTag","replaceAll","TagSelector","selectorOptions","setEventNamespace","getRandom","multiple","addButtonVisible","showAddButton","createButtonVisible","showCreateButton","textBoxVisible","showTextBox","setReadonly","readonly","setLocked","setAddButtonCaption","addButtonCaption","setAddButtonCaptionMore","addButtonCaptionMore","setCreateButtonCaption","createButtonCaption","setPlaceholder","placeholder","setTextBoxAutoHide","textBoxAutoHide","setTextBoxWidth","textBoxWidth","setMaxHeight","maxHeight","setTagAvatar","tagAvatar","setTagAvatarOptions","tagAvatarOptions","setTagMaxWidth","tagMaxWidth","setTagTextColor","tagTextColor","setTagBgColor","tagBgColor","setTagFontWeight","tagFontWeight","setTagClickable","tagClickable","dialogOptions","selectedItems","concat","assign","tagSelectorOptions","isMultiple","tagSelector","addTag","subscribeFromOptions","events","getTextBox","disabled","changed","updateTags","tagItem","getTags","find","isObjectLike","setSelector","removeTags","tags","insertBefore","toggleAddButtonCaption","el","isDomNode","isReadonly","getMaxHeight","getCreateButton","getAddButton","input","getPlaceholder","handleTextBoxInput","handleTextBoxBlur","handleTextBoxKeyUp","handleTextBoxKeyDown","getTextBoxWidth","getItemsHeight","getMinHeight","textBoxOldValue","autoHide","setTagAvatarOption","height","getAddButtonLink","getActualButtonCaption","handleAddButtonClick","getAddButtonCaptionMore","getAddButtonCaption","handleCreateButtonClick","getCreateButtonCaption","newValue","getTextBoxValue","clearTextBox","hideTextBox","preventDefault","isMac","metaKey","ctrlKey","hideAddButton","focusTextBox","EventEmitter","Navigation","subscribe","handleDialogShow","handleDialogHide","handleDialogDestroy","handleDocumentKeyDown","handleDocumentMouseMove","isEnabled","bindEvents","enabled","unbindEvents","unlockTab","getActiveNode","nextNode","currentNode","getFirstChild","getNextSibling","previousNode","getPreviousSibling","lastChild","getLastChild","getActiveTab","lastNode","getFocusedNode","scrollIntoView","activeTab","lockedTab","enable","disable","altKey","keyName","keyMap","getSearchTab","call","lockTab","firstNode","getFirstNode","focusOnNode","getNextNode","getLastNode","getPreviousNode","selectFirstTab","shiftKey","previousTab","getPreviousTab","selectLastTab","nextTab","getNextTab","SliderIntegration","handleSliderOpen","handleSliderClose","handleSliderDestroy","BX","unsubscribe","slider","getFrameWindow","sliders","unfreeze","sliderEvent","getData","getSlider","isDialogInSlider","freeze","DefaultHeader","setContent","getContent","containerStyles","content","DefaultFooter","RecentTab","defaults","isDropdownMode","SEARCH","MatchResult","matchFields","fieldSort","collator","Intl","Collator","sensitivity","SearchEngine","searchQuery","matchResults","queryWords","getQueryWords","getResultLimit","matchAll","matchResult","matchItem","getDynamicSearchMatchMode","results","matchWord","searchIndexes","getSearchIndex","j","compare","SearchQuery","query","split","cacheable","resultLimit","getDynamicSearchEntities","hasDynamicSearchEntity","dynamicSearchEntities","getQuery","SearchLoader","getBoxContainer","getSpacerContainer","getTextContainer","isShown","SearchTabFooter","handleOnSearch","handleMetaEnter","getQueryContainer","getLoaderContainer","label","finalize","hideLoader","emitAsync","getLastSearchQuery","clearResults","createItem","keyboardEvent","SearchTab","searchOptions","setAllowCreateItem","allowCreateItem","loadWithDebounce","load","dynamicEntities","getDynamicEntities","setDynamicSearchEntities","isEmpty","getSearchLoader","lastSearchQuery","matchItems","getItems","appendResults","shouldFocusOnFirst","focusOnFirstNode","shouldLoad","isEmptyResult","toggleEmptyResult","matchSortA","matchSortB","contextSortA","contextSortB","globalSortA","globalSortB","hasItem","setHighlights","getMatchFields","getEntities","hasCacheLimit","getSearchCacheLimits","pattern","isCacheable","found","queryCache","startsWith","isQueryCacheable","isQueryLoaded","addCacheQuery","onrequeststart","xhr","queryXhr","removeCacheQuery","searchTab","isTabEmpty","errors","emitEntityErrors","searchLoader","LoadState","TagSelectorMode","instances","UNSENT","saveRecentItems","clearUnavailableItems","compactView","dropdownMode","alwaysShowLabels","tagSelectorMode","OUTSIDE","setTagSelector","enableSearch","customOptions","mandatoryOptions","INSIDE","setTargetNode","targetNode","setHideOnSelect","hideOnSelect","setHideOnDeselect","hideOnDeselect","setAddTagOnSelect","addTagOnSelect","setClearSearchOnSelect","clearSearchOnSelect","setWidth","setHeight","setAutoHide","setAutoHideHandler","autoHideHandler","setHideByEsc","hideByEsc","setOffsetLeft","offsetLeft","setOffsetTop","offsetTop","setCacheable","setFocusOnFirst","focusOnFirst","setRecentItemsLimit","recentItemsLimit","setOffsetAnimation","offsetAnimation","recentTab","recentTabOptions","searchTabOptions","addTab","setPreselectedItems","preselectedItems","setUndeselectedItems","undeselectedItems","setOptions","preload","getPreselectedItems","popupOptions","allowedOptions","navigation","handleItemNodeFocus","handleItemNodeUnfocus","getPopup","close","destroyed","disconnectTabOverlapping","hasOwnProperty","setPrototypeOf","popup","adjustPosition","queryString","search","undeselectable","getUndeselectedItems","itemId","String","entityItems","tabId","removeChild","getEntityItemsInternal","getItemsInternal","removeItem","prototype","apply","itemIds","insertTab","newActiveTab","clearNodeFocus","getLabelsContainer","getTabContentsContainer","getHeaderContainer","getFooterContainer","onlyVisible","getTabs","getRecentTab","activeFound","hasEntity","removeEntityItems","canShowDefaultHeader","canShowDefaultFooter","getSelectedItems","setBindElement","getTagSelectorMode","isTagSelectorOutside","getPopupContainer","setClosingByEsc","setOffset","getZindex","focusedNode","validateItemIds","maxLabelWidth","minLabelWidth","freeSpace","parseInt","left","getMinLabelWidth","getMaxLabelWidth","handleTagSelectorInput","handleTagSelectorAddButtonClick","handleTagSelectorTagRemove","handleTagSelectorAfterTagRemove","handleTagSelectorAfterTagAdd","handleTagSelectorClick","getTabsContainer","userEvents","Popup","contentPadding","padding","getOffsetTop","getOffsetLeft","animation","showClassName","closeClassName","closeAnimationType","bindElement","getTargetNode","bindOptions","forceBindPosition","isAutoHide","handleAutoHide","closeByEsc","shouldHideByEsc","onFirstShow","handlePopupFirstShow","onShow","handlePopupShow","onAfterShow","handlePopupAfterShow","onAfterClose","handlePopupAfterClose","onDestroy","handlePopupDestroy","searchContainer","isCompactView","getWidth","getHeight","handleLabelsMouseEnter","handleLabelsMouseLeave","isFrozen","frozenProps","getNavigation","frozen","reject","recentItems","loadState","setTimeout","isLoading","LOADING","DONE","preselectedItem","nodeOptionsMap","itemsOptions","recentItem","addItems","recentItemsToSave","saveRecentItemsWithDebounce","adjustByTagSelector","newTagSelectorHeight","calcHeight","tagSelectorHeight","shouldAnimate","deselectAll","shouldAddTagOnSelect","createTag","observeTabOverlapping","expandLabels","overlappingObserver","MutationObserver","collapseLabels","observe","attributes","attributeFilter","disconnect","getRecentItemsLimit","shouldClearUnavailableItems","getByEntityId","EntitySelector"],"mappings":"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"}