{"version":3,"file":"main.popup.bundle.js","sources":["../src/compatibility/button.js","../src/popup/position-event.js","../src/popup/popup-close-icon-size.js","../src/popup/popup.js","../src/popup/popup-manager.js","../src/menu/menu-item.js","../src/menu/menu.js","../src/menu/menu-manager.js","../src/compatibility/popup-window.js","../src/compatibility/popup-window-button.js","../src/compatibility/buttonlink.js","../src/compatibility/popup-window-button-link.js","../src/compatibility/custombutton.js","../src/compatibility/popup-window-custom-button.js","../src/compatibility/popup-menu-window.js","../src/compatibility/popup-menu-item.js","../src/compatibility/input-popup.js","../src/index.js"],"sourcesContent":["import { Type, Dom } from 'main.core';\n\ndeclare type ButtonOptions = {\n\tid?: string,\n\ttext?: string,\n\tclassName?: string,\n\tevents?: { [event: string]: (event) => {} }\n};\n\n/**\n * @memberOf BX.Main.Popup\n * @deprecated use BX.UI.Button\n */\nexport default class Button\n{\n\tconstructor(params: ButtonOptions)\n\t{\n\t\tthis.popupWindow = null;\n\n\t\tthis.params = params || {};\n\n\t\tthis.text = this.params.text || '';\n\t\tthis.id = this.params.id || '';\n\t\tthis.className = this.params.className || '';\n\t\tthis.events = this.params.events || {};\n\n\t\tthis.contextEvents = {};\n\t\tfor (let eventName in this.events)\n\t\t{\n\t\t\tif (Type.isFunction(this.events[eventName]))\n\t\t\t{\n\t\t\t\tthis.contextEvents[eventName] = this.events[eventName].bind(this);\n\t\t\t}\n\t\t}\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'popup-window-button' + (this.className.length > 0 ? ' ' + this.className : ''),\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\tevents: this.contextEvents,\n\t\t\t\ttext: this.text\n\t\t\t}\n\t\t);\n\t}\n\n\trender(): Element\n\t{\n\t\treturn this.buttonNode;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\treturn this.buttonNode;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.text;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.text = name || '';\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.clean(this.buttonNode);\n\t\t\tDom.adjust(this.buttonNode, { text: this.text });\n\t\t}\n\t}\n\n\tsetClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tif (Type.isString(this.className) && (this.className !== ''))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.buttonNode, this.className);\n\t\t\t}\n\n\t\t\tDom.addClass(this.buttonNode, className);\n\t\t}\n\n\t\tthis.className = className;\n\t}\n\n\taddClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.addClass(this.buttonNode, className);\n\t\t\tthis.className = this.buttonNode.className;\n\t\t}\n\t}\n\n\tremoveClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.removeClass(this.buttonNode, className);\n\t\t\tthis.className = this.buttonNode.className;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nexport default class PositionEvent extends BaseEvent\n{\n\t#left: number;\n\t#top: number;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tget left(): number\n\t{\n\t\treturn this.#left;\n\t}\n\n\tset left(value: number)\n\t{\n\t\tif (Type.isNumber(value))\n\t\t{\n\t\t\tthis.#left = value;\n\t\t}\n\t}\n\n\tget top(): number\n\t{\n\t\treturn this.#top;\n\t}\n\n\tset top(value: number): void\n\t{\n\t\tif (Type.isNumber(value))\n\t\t{\n\t\t\tthis.#top = value;\n\t\t}\n\t}\n}","/**\n * @namespace {BX.Main.Popup}\n */\nconst CloseIconSize = Object.freeze({\n\tLARGE: 'large',\n\tSMALL: 'small',\n})\n\nexport default CloseIconSize;","import Button from '../compatibility/button';\n\nimport { Type, Text, Tag, Event, Dom, Browser, Reflection } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport {\n\ttype PopupOptions,\n\ttype PopupTarget,\n\ttype PopupAnimationOptions,\n\ttype PopupOverlay,\n\ttype PopupDraggable,\n} from './popup-types';\nimport { ZIndexManager, ZIndexComponent } from 'main.core.z-index-manager';\nimport PositionEvent from './position-event';\nimport CloseIconSize from './popup-close-icon-size';\n\ndeclare type TargetPosition = {\n\tleft: number,\n\ttop: number,\n\tbottom: number,\n\twindowSize: number,\n\twindowScroll: number,\n\tpopupWidth: number,\n\tpopupHeight: number\n};\n\nconst aliases = {\n\tonPopupWindowInit: { namespace: 'BX.Main.Popup', eventName: 'onInit' },\n\tonPopupWindowIsInitialized: { namespace: 'BX.Main.Popup', eventName: 'onAfterInit' },\n\tonPopupFirstShow: { namespace: 'BX.Main.Popup', eventName: 'onFirstShow' },\n\tonPopupShow: { namespace: 'BX.Main.Popup', eventName: 'onShow' },\n\tonAfterPopupShow: { namespace: 'BX.Main.Popup', eventName: 'onAfterShow' },\n\tonPopupClose: { namespace: 'BX.Main.Popup', eventName: 'onClose' },\n\tonPopupAfterClose: { namespace: 'BX.Main.Popup', eventName: 'onAfterClose' },\n\tonPopupDestroy: { namespace: 'BX.Main.Popup', eventName: 'onDestroy' },\n\tonPopupFullscreenLeave: { namespace: 'BX.Main.Popup', eventName: 'onFullscreenLeave' },\n\tonPopupFullscreenEnter: { namespace: 'BX.Main.Popup', eventName: 'onFullscreenEnter' },\n\tonPopupDragStart: { namespace: 'BX.Main.Popup', eventName: 'onDragStart' },\n\tonPopupDrag: { namespace: 'BX.Main.Popup', eventName: 'onDrag' },\n\tonPopupDragEnd: { namespace: 'BX.Main.Popup', eventName: 'onDragEnd' },\n\tonPopupResizeStart: { namespace: 'BX.Main.Popup', eventName: 'onResizeStart' },\n\tonPopupResize: { namespace: 'BX.Main.Popup', eventName: 'onResize' },\n\tonPopupResizeEnd: { namespace: 'BX.Main.Popup', eventName: 'onResizeEnd' }\n};\n\nEventEmitter.registerAliases(aliases);\n\nconst disabledScrolls: WeakMap<HTMLElement, Set<Popup>> = new WeakMap();\n\n/**\n * @memberof BX.Main\n */\nexport default class Popup extends EventEmitter\n{\n\t/**\n\t * @private\n\t */\n\tstatic options = {};\n\n\t/**\n\t * @private\n\t */\n\tstatic defaultOptions = {\n\n\t\t//left offset for popup about target\n\t\tangleLeftOffset: 40,\n\n\t\t//when popup position is 'top' offset distance between popup body and target node\n\t\tpositionTopXOffset: -11,\n\n\t\t//offset distance between popup body and target node if use angle, sum with positionTopXOffset\n\t\tangleTopOffset: 10,\n\n\t\tpopupZindex: 1000,\n\t\tpopupOverlayZindex: 1100,\n\n\t\tangleMinLeft: 10,\n\t\tangleMaxLeft: 30,\n\n\t\tangleMinRight: 10,\n\t\tangleMaxRight: 30,\n\n\t\tangleMinBottom: 23,\n\t\tangleMaxBottom: 25,\n\n\t\tangleMinTop: 23,\n\t\tangleMaxTop: 25,\n\n\t\toffsetLeft: 0,\n\t\toffsetTop: 0\n\t};\n\n\tstatic setOptions(options: { [name: string]: any })\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let option in options)\n\t\t{\n\t\t\tthis.options[option] = options[option];\n\t\t}\n\t}\n\n\tstatic getOption(option: string, defaultValue?: any)\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.defaultOptions[option];\n\t\t}\n\t}\n\n\tconstructor(options?: PopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Popup');\n\n\t\tlet [popupId: string, bindElement: PopupTarget, params: PopupOptions] = arguments; //compatible arguments\n\n\t\tthis.compatibleMode = params && Type.isBoolean(params.compatibleMode) ? params.compatibleMode : true;\n\t\tif (Type.isPlainObject(options) && !bindElement && !params)\n\t\t{\n\t\t\tparams = options;\n\t\t\tpopupId = options.id;\n\t\t\tbindElement = options.bindElement;\n\t\t\tthis.compatibleMode = false;\n\t\t}\n\n\t\tparams = params || {};\n\t\tthis.params = params;\n\n\t\tif (!Type.isStringFilled(popupId))\n\t\t{\n\t\t\tpopupId = 'popup-window-' + Text.getRandom().toLowerCase();\n\t\t}\n\n\t\tthis.emit('onInit', new BaseEvent({ compatData: [popupId, bindElement, params] }));\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.uniquePopupId = popupId;\n\t\tthis.params.zIndex = Type.isNumber(params.zIndex) ? parseInt(params.zIndex) : 0;\n\t\tthis.params.zIndexAbsolute = Type.isNumber(params.zIndexAbsolute) ? parseInt(params.zIndexAbsolute) : 0;\n\t\tthis.buttons = params.buttons && Type.isArray(params.buttons) ? params.buttons : [];\n\t\tthis.offsetTop = Popup.getOption('offsetTop');\n\t\tthis.offsetLeft = Popup.getOption('offsetLeft');\n\t\tthis.firstShow = false;\n\t\tthis.bordersWidth = 20;\n\t\tthis.bindElementPos = null;\n\t\tthis.closeIcon = null;\n\t\tthis.resizeIcon = null;\n\t\tthis.angle = null;\n\t\tthis.angleArrowElement = null;\n\t\tthis.overlay = null;\n\t\tthis.titleBar = null;\n\t\tthis.bindOptions = typeof (params.bindOptions) === 'object' ? params.bindOptions : {};\n\t\tthis.autoHide = params.autoHide === true;\n\t\tthis.disableScroll = params.disableScroll === true || params.isScrollBlock === true;\n\t\tthis.autoHideHandler = Type.isFunction(params.autoHideHandler) ? params.autoHideHandler : null;\n\t\tthis.isAutoHideBinded = false;\n\t\tthis.closeByEsc = params.closeByEsc === true;\n\t\tthis.isCloseByEscBinded = false;\n\t\tthis.toFrontOnShow = true;\n\n\t\tthis.cacheable = true;\n\t\tthis.destroyed = false;\n\t\tthis.fixed = false;\n\n\t\tthis.width = null;\n\t\tthis.height = null;\n\t\tthis.minWidth = null;\n\t\tthis.minHeight = null;\n\t\tthis.maxWidth = null;\n\t\tthis.maxHeight = null;\n\n\t\tthis.padding = null;\n\t\tthis.contentPadding = null;\n\t\tthis.background = null;\n\t\tthis.contentBackground = null;\n\n\t\tthis.borderRadius = null;\n\t\tthis.contentBorderRadius = null;\n\n\t\tthis.setTargetContainer(params.targetContainer);\n\n\t\tthis.dragOptions = {\n\t\t\tcursor: '',\n\t\t\tcallback: function() {\n\t\t\t},\n\t\t\teventName: ''\n\t\t};\n\n\t\tthis.dragged = false;\n\t\tthis.dragPageX = 0;\n\t\tthis.dragPageY = 0;\n\n\t\tthis.animationShowClassName = null;\n\t\tthis.animationCloseClassName = null;\n\t\tthis.animationCloseEventType = null;\n\n\t\tthis.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this);\n\t\tthis.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this);\n\t\tthis.handleResizeWindow = this.handleResizeWindow.bind(this);\n\t\tthis.handleResize = this.handleResize.bind(this);\n\t\tthis.handleMove = this.handleMove.bind(this);\n\t\tthis.onTitleMouseDown = this.onTitleMouseDown.bind(this);\n\t\tthis.handleFullScreen = this.handleFullScreen.bind(this);\n\n\t\tthis.subscribeFromOptions(params.events);\n\n\t\tlet popupClassName = 'popup-window';\n\n\t\tif (params.titleBar)\n\t\t{\n\t\t\tpopupClassName += ' popup-window-with-titlebar';\n\t\t}\n\n\t\tif (params.className && Type.isStringFilled(params.className))\n\t\t{\n\t\t\tpopupClassName += ` ${params.className}`;\n\t\t}\n\n\t\tif (params.darkMode)\n\t\t{\n\t\t\tpopupClassName += ' popup-window-dark';\n\t\t}\n\n\t\tthis.designSystemContext = params.darkMode ? '--ui-context-content-dark' : '--ui-context-content-light';\n\t\tpopupClassName += ` ${this.designSystemContext}`;\n\n\t\tif (params.titleBar)\n\t\t{\n\t\t\tthis.titleBar = Tag.render`\n\t\t\t\t<div class=\"popup-window-titlebar\" id=\"popup-window-titlebar-${popupId}\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (params.closeIcon)\n\t\t{\n\t\t\tlet className = 'popup-window-close-icon'\n\t\t\t\t+ (params.titleBar ? ' popup-window-titlebar-close-icon' : '');\n\t\t\tif (Object.values(CloseIconSize).includes(params.closeIconSize) && params.closeIconSize !== CloseIconSize.SMALL)\n\t\t\t{\n\t\t\t\tclassName += ` --${params.closeIconSize}`;\n\t\t\t}\n\n\t\t\tthis.closeIcon = Tag.render`\n\t\t\t\t<span class=\"${className}\" onclick=\"${this.handleCloseIconClick.bind(this)}\"></span>\n\t\t\t`;\n\n\t\t\tif (Type.isPlainObject(params.closeIcon))\n\t\t\t{\n\t\t\t\tDom.style(this.closeIcon, params.closeIcon);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.contentContainer = Tag.render`\n\t\t\t<div id=\"popup-window-content-${popupId}\" class=\"popup-window-content\"></div>\n\t\t`;\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.popupContainer = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"${popupClassName}\"\n\t\t\t\tid=\"${popupId}\"\n\t\t\t\tstyle=\"display: none; position: absolute; left: 0; top: 0;\"\n\t\t\t>${[this.titleBar, this.contentContainer, this.closeIcon]}</div>\n\t\t`;\n\n\t\tthis.getTargetContainer().append(this.popupContainer);\n\n\t\tthis.zIndexComponent = ZIndexManager.register(this.popupContainer, params.zIndexOptions);\n\n\t\tthis.buttonsContainer = null;\n\n\t\tif (params.contentColor && Type.isStringFilled(params.contentColor))\n\t\t{\n\t\t\tif (\n\t\t\t\tparams.contentColor === 'white'\n\t\t\t\t|| params.contentColor === 'gray'\n\t\t\t)\n\t\t\t{\n\t\t\t\tpopupClassName += ' popup-window-content-' + params.contentColor;\n\t\t\t}\n\n\t\t\tthis.setContentColor(params.contentColor);\n\t\t}\n\n\t\tif (params.angle)\n\t\t{\n\t\t\tthis.setAngle(params.angle);\n\t\t}\n\n\t\tif (params.overlay)\n\t\t{\n\t\t\tthis.setOverlay(params.overlay);\n\t\t}\n\n\t\tthis.setOffset(params);\n\t\tthis.setBindElement(bindElement);\n\t\tthis.setTitleBar(params.titleBar);\n\t\tthis.setDraggable(params.draggable);\n\t\tthis.setContent(params.content);\n\t\tthis.setButtons(params.buttons);\n\t\tthis.setWidth(params.width);\n\t\tthis.setHeight(params.height);\n\t\tthis.setMinWidth(params.minWidth);\n\t\tthis.setMinHeight(params.minHeight);\n\t\tthis.setMaxWidth(params.maxWidth);\n\t\tthis.setMaxHeight(params.maxHeight);\n\t\tthis.setResizeMode(params.resizable);\n\t\tthis.setPadding(params.padding);\n\t\tthis.setContentPadding(params.contentPadding);\n\t\tthis.setBorderRadius(params.borderRadius);\n\t\tthis.setContentBorderRadius(params.contentBorderRadius);\n\t\tthis.setBackground(params.background);\n\t\tthis.setContentBackground(params.contentBackground);\n\t\tthis.setAnimation(params.animation);\n\t\tthis.setCacheable(params.cacheable);\n\t\tthis.setToFrontOnShow(params.toFrontOnShow);\n\t\tthis.setFixed(params.fixed);\n\t\tthis.setDesignSystemContext(params.designSystemContext);\n\n\t\t// Compatibility\n\t\tif (params.contentNoPaddings)\n\t\t{\n\t\t\tthis.setContentPadding(0);\n\t\t}\n\t\tif (params.noAllPaddings)\n\t\t{\n\t\t\tthis.setPadding(0);\n\t\t\tthis.setContentPadding(0);\n\t\t}\n\n\t\tif (params.bindOnResize !== false)\n\t\t{\n\t\t\tEvent.bind(window, 'resize', this.handleResizeWindow);\n\t\t}\n\n\t\tthis.emit('onAfterInit', new BaseEvent({ compatData: [popupId, this] }));\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsubscribeFromOptions(events): void\n\t{\n\t\tsuper.subscribeFromOptions(events, aliases);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.uniquePopupId;\n\t}\n\n\tisCompatibleMode(): boolean\n\t{\n\t\treturn this.compatibleMode;\n\t}\n\n\tsetContent(content: string | Element | Node)\n\t{\n\t\tif (!this.contentContainer || !content)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isElementNode(content))\n\t\t{\n\t\t\tDom.clean(this.contentContainer);\n\n\t\t\tconst hasParent = Type.isDomNode(content.parentNode);\n\t\t\tthis.contentContainer.appendChild(content);\n\t\t\tif (this.isCompatibleMode() || hasParent)\n\t\t\t{\n\t\t\t\tcontent.style.display = 'block';\n\t\t\t}\n\t\t}\n\t\telse if (Type.isString(content))\n\t\t{\n\t\t\tthis.contentContainer.innerHTML = content;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.contentContainer.innerHTML = '&nbsp;';\n\t\t}\n\t}\n\n\tsetButtons(buttons: [])\n\t{\n\t\tthis.buttons = buttons && Type.isArray(buttons) ? buttons : [];\n\n\t\tif (this.buttonsContainer)\n\t\t{\n\t\t\tDom.remove(this.buttonsContainer);\n\t\t}\n\n\t\tconst ButtonClass = Reflection.getClass('BX.UI.Button');\n\t\tif (this.buttons.length > 0 && this.contentContainer)\n\t\t{\n\t\t\tconst newButtons = [];\n\t\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t\t{\n\t\t\t\tconst button = this.buttons[i];\n\t\t\t\tif (button instanceof Button)\n\t\t\t\t{\n\t\t\t\t\tbutton.popupWindow = this;\n\t\t\t\t\tnewButtons.push(button.render());\n\t\t\t\t}\n\t\t\t\telse if (ButtonClass && (button instanceof ButtonClass))\n\t\t\t\t{\n\t\t\t\t\tbutton.setContext(this);\n\t\t\t\t\tnewButtons.push(button.render());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.buttonsContainer = this.contentContainer.parentNode.appendChild(\n\t\t\t\tTag.render`<div class=\"popup-window-buttons\">${newButtons}</div>`\n\t\t\t);\n\t\t}\n\t}\n\n\tgetButtons(): []\n\t{\n\t\treturn this.buttons;\n\t}\n\n\tgetButton(id: string)\n\t{\n\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t{\n\t\t\tconst button = this.buttons[i];\n\t\t\tif (button.getId() === id)\n\t\t\t{\n\t\t\t\treturn button;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetBindElement(bindElement: Element | { left: number, top: number } | null | MouseEvent)\n\t{\n\t\tif (bindElement === null)\n\t\t{\n\t\t\tthis.bindElement = null;\n\t\t}\n\t\telse if (typeof (bindElement) === 'object')\n\t\t{\n\t\t\tif (Type.isDomNode(bindElement) || (Type.isNumber(bindElement.top) && Type.isNumber(bindElement.left)))\n\t\t\t{\n\t\t\t\tthis.bindElement = bindElement;\n\t\t\t}\n\t\t\telse if (Type.isNumber(bindElement.clientX) && Type.isNumber(bindElement.clientY))\n\t\t\t{\n\t\t\t\tthis.bindElement = { left: bindElement.pageX, top: bindElement.pageY, bottom: bindElement.pageY };\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetBindElementPos(bindElement: HTMLElement | any): TargetPosition | DOMRect\n\t{\n\t\tif (Type.isDomNode(bindElement))\n\t\t{\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\treturn this.isFixed() ? bindElement.getBoundingClientRect() : Dom.getPosition(bindElement);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getPositionRelativeToTarget(bindElement);\n\t\t\t}\n\t\t}\n\t\telse if (bindElement && typeof (bindElement) === 'object')\n\t\t{\n\t\t\tif (!Type.isNumber(bindElement.bottom))\n\t\t\t{\n\t\t\t\tbindElement.bottom = bindElement.top;\n\t\t\t}\n\n\t\t\treturn bindElement;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst windowSize = this.getWindowSize();\n\t\t\tconst windowScroll = this.getWindowScroll();\n\n\t\t\tconst popupWidth = this.getPopupContainer().offsetWidth;\n\t\t\tconst popupHeight = this.getPopupContainer().offsetHeight;\n\n\t\t\tthis.bindOptions.forceTop = true;\n\n\t\t\treturn {\n\t\t\t\tleft: windowSize.innerWidth / 2 - popupWidth / 2 + windowScroll.scrollLeft,\n\t\t\t\ttop: windowSize.innerHeight / 2 - popupHeight / 2 + (this.isFixed() ? 0 : windowScroll.scrollTop),\n\t\t\t\tbottom: windowSize.innerHeight / 2 - popupHeight / 2 + (this.isFixed() ? 0 : windowScroll.scrollTop),\n\n\t\t\t\t//for optimisation purposes\n\t\t\t\twindowSize: windowSize,\n\t\t\t\twindowScroll: windowScroll,\n\t\t\t\tpopupWidth: popupWidth,\n\t\t\t\tpopupHeight: popupHeight\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetPositionRelativeToTarget(element: HTMLElement): DOMRect\n\t{\n\t\tlet offsetLeft = element.offsetLeft;\n\t\tlet offsetTop = element.offsetTop;\n\t\tlet offsetElement = element.offsetParent;\n\n\t\twhile (offsetElement && offsetElement !== this.getTargetContainer())\n\t\t{\n\t\t\toffsetLeft += offsetElement.offsetLeft;\n\t\t\toffsetTop += offsetElement.offsetTop;\n\t\t\toffsetElement = offsetElement.offsetParent;\n\t\t}\n\n\t\tconst elementRect = element.getBoundingClientRect();\n\n\t\treturn new DOMRect(\n\t\t\toffsetLeft,\n\t\t\toffsetTop,\n\t\t\telementRect.width,\n\t\t\telementRect.height\n\t\t);\n\t}\n\n\t// private\n\tgetWindowSize(): { innerWidth: number, innerHeight: number }\n\t{\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\treturn {\n\t\t\t\tinnerWidth: window.innerWidth,\n\t\t\t\tinnerHeight: window.innerHeight\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn {\n\t\t\t\tinnerWidth: this.getTargetContainer().offsetWidth,\n\t\t\t\tinnerHeight: this.getTargetContainer().offsetHeight\n\t\t\t};\n\t\t}\n\t}\n\n\t// private\n\tgetWindowScroll()\n\t{\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\treturn {\n\t\t\t\tscrollLeft: window.pageXOffset,\n\t\t\t\tscrollTop: window.pageYOffset\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn {\n\t\t\t\tscrollLeft: this.getTargetContainer().scrollLeft,\n\t\t\t\tscrollTop: this.getTargetContainer().scrollTop\n\t\t\t};\n\t\t}\n\t}\n\n\tsetAngle(params: { offset: number, position?: 'top' | 'bottom' | 'left' | 'right' })\n\t{\n\t\tif (params === false)\n\t\t{\n\t\t\tif (this.angle !== null)\n\t\t\t{\n\t\t\t\tDom.remove(this.angle.element);\n\t\t\t}\n\n\t\t\tthis.angle = null;\n\t\t\tthis.angleArrowElement = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst className = 'popup-window-angly';\n\t\tif (this.angle === null)\n\t\t{\n\t\t\tconst position = this.bindOptions.position && this.bindOptions.position === 'top' ? 'bottom' : 'top';\n\t\t\tconst angleMinLeft = Popup.getOption(position === 'top' ? 'angleMinTop' : 'angleMinBottom');\n\t\t\tlet defaultOffset = Type.isNumber(params.offset) ? params.offset : 0;\n\n\t\t\tconst angleLeftOffset = Popup.getOption('angleLeftOffset', null);\n\t\t\tif (defaultOffset > 0 && Type.isNumber(angleLeftOffset))\n\t\t\t{\n\t\t\t\tdefaultOffset += angleLeftOffset - Popup.defaultOptions.angleLeftOffset;\n\t\t\t}\n\n\t\t\tthis.angleArrowElement = Tag.render`<div class=\"popup-window-angly--arrow\"></div>`;\n\t\t\tif (this.background)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.background = this.background;\n\t\t\t}\n\n\t\t\tthis.angle = {\n\t\t\t\telement: Tag.render`\n\t\t\t\t\t<div class=\"${className} ${className}-${position}\">\n\t\t\t\t\t\t${this.angleArrowElement}\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tposition: position,\n\t\t\t\toffset: 0,\n\t\t\t\tdefaultOffset: Math.max(defaultOffset, angleMinLeft)\n\t\t\t\t//Math.max(Type.isNumber(params.offset) ? params.offset : 0, angleMinLeft)\n\t\t\t};\n\n\t\t\tthis.getPopupContainer().appendChild(this.angle.element);\n\t\t}\n\n\t\tif (typeof (params) === 'object' && params.position && ['top', 'right', 'bottom', 'left', 'hide'].includes(params.position))\n\t\t{\n\t\t\tDom.removeClass(this.angle.element, className + '-' + this.angle.position);\n\t\t\tDom.addClass(this.angle.element, className + '-' + params.position);\n\n\t\t\tthis.angle.position = params.position;\n\t\t}\n\n\t\tif (typeof (params) === 'object' && Type.isNumber(params.offset))\n\t\t{\n\t\t\tconst offset = params.offset;\n\t\t\tlet minOffset, maxOffset;\n\t\t\tif (this.angle.position === 'top')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinTop');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetWidth - Popup.getOption('angleMaxTop');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.left = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.marginLeft = 0;\n\t\t\t\tthis.angle.element.style.removeProperty('top');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'bottom')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinBottom');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetWidth - Popup.getOption('angleMaxBottom');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.marginLeft = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.left = 0;\n\t\t\t\tthis.angle.element.style.removeProperty('top');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'right')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinRight');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetHeight - Popup.getOption('angleMaxRight');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.top = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.removeProperty('left');\n\t\t\t\tthis.angle.element.style.removeProperty('margin-left');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'left')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinLeft');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetHeight - Popup.getOption('angleMaxLeft');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.top = this.angle.offset + 'px';\n\t\t\t\tthis.angle.element.style.removeProperty('left');\n\t\t\t\tthis.angle.element.style.removeProperty('margin-left');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn this.width;\n\t}\n\n\tsetWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('width', width);\n\t}\n\n\tgetHeight(): number\n\t{\n\t\treturn this.height;\n\t}\n\n\tsetHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('height', height);\n\t}\n\n\tgetMinWidth(): number\n\t{\n\t\treturn this.minWidth;\n\t}\n\n\tsetMinWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('minWidth', width);\n\t}\n\n\tgetMinHeight(): number\n\t{\n\t\treturn this.minHeight;\n\t}\n\n\tsetMinHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('minHeight', height);\n\t}\n\n\tgetMaxWidth(): number\n\t{\n\t\treturn this.maxWidth;\n\t}\n\n\tsetMaxWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('maxWidth', width);\n\t}\n\n\tgetMaxHeight(): number\n\t{\n\t\treturn this.maxHeight;\n\t}\n\n\tsetMaxHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('maxHeight', height);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetWidthProperty(property: string, width: number)\n\t{\n\t\tconst props = ['width', 'minWidth', 'maxWidth'];\n\t\tif (props.indexOf(property) === -1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(width) && width >= 0)\n\t\t{\n\t\t\tthis[property] = width;\n\t\t\tthis.getResizableContainer().style[property] = width + 'px';\n\t\t\tthis.getContentContainer().style.overflowX = 'auto';\n\t\t\tthis.getPopupContainer().classList.add('popup-window-fixed-width');\n\n\t\t\tif (this.getTitleContainer() && Browser.isIE11())\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().style[property] = width + 'px';\n\t\t\t}\n\t\t}\n\t\telse if (width === null || width === false)\n\t\t{\n\t\t\tthis[property] = null;\n\t\t\tthis.getResizableContainer().style.removeProperty(Text.toKebabCase(property));\n\n\t\t\tconst hasOtherProps = props.some(function(prop) {\n\t\t\t\treturn this.getResizableContainer().style.getPropertyValue(Text.toKebabCase(prop)) !== '';\n\t\t\t}, this);\n\n\t\t\tif (!hasOtherProps)\n\t\t\t{\n\t\t\t\tthis.getContentContainer().style.removeProperty('overflow-x');\n\t\t\t\tthis.getPopupContainer().classList.remove('popup-window-fixed-width');\n\t\t\t}\n\n\t\t\tif (this.getTitleContainer() && Browser.isIE11())\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().style.removeProperty(Text.toKebabCase(property));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetHeightProperty(property: string, height: number)\n\t{\n\t\tconst props = ['height', 'minHeight', 'maxHeight'];\n\t\tif (props.indexOf(property) === -1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(height) && height >= 0)\n\t\t{\n\t\t\tthis[property] = height;\n\t\t\tthis.getResizableContainer().style[property] = height + 'px';\n\t\t\tthis.getContentContainer().style.overflowY = 'auto';\n\t\t\tthis.getPopupContainer().classList.add('popup-window-fixed-height');\n\t\t}\n\t\telse if (height === null || height === false)\n\t\t{\n\t\t\tthis[property] = null;\n\t\t\tthis.getResizableContainer().style.removeProperty(Text.toKebabCase(property));\n\n\t\t\tconst hasOtherProps = props.some(function(prop) {\n\t\t\t\treturn this.getResizableContainer().style.getPropertyValue(Text.toKebabCase(prop)) !== '';\n\t\t\t}, this);\n\n\t\t\tif (!hasOtherProps)\n\t\t\t{\n\t\t\t\tthis.getContentContainer().style.removeProperty('overflow-y');\n\t\t\t\tthis.getPopupContainer().classList.remove('popup-window-fixed-height');\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPadding(padding: number)\n\t{\n\t\tif (Type.isNumber(padding) && padding >= 0)\n\t\t{\n\t\t\tthis.padding = padding;\n\t\t\tthis.getPopupContainer().style.padding = padding + 'px';\n\t\t}\n\t\telse if (padding === null)\n\t\t{\n\t\t\tthis.padding = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('padding');\n\t\t}\n\t}\n\n\tgetPadding(): number\n\t{\n\t\treturn this.padding;\n\t}\n\n\tsetContentPadding(padding: number)\n\t{\n\t\tif (Type.isNumber(padding) && padding >= 0)\n\t\t{\n\t\t\tthis.contentPadding = padding;\n\t\t\tthis.getContentContainer().style.padding = padding + 'px';\n\t\t}\n\t\telse if (padding === null)\n\t\t{\n\t\t\tthis.contentPadding = null;\n\t\t\tthis.getContentContainer().style.removeProperty('padding');\n\t\t}\n\t}\n\n\tgetContentPadding(): number\n\t{\n\t\treturn this.contentPadding;\n\t}\n\n\tsetBorderRadius(radius): void\n\t{\n\t\tif (Type.isStringFilled(radius))\n\t\t{\n\t\t\tthis.borderRadius = radius;\n\t\t\tthis.getPopupContainer().style.setProperty('--popup-window-border-radius', radius);\n\t\t}\n\t\telse if (radius === null)\n\t\t{\n\t\t\tthis.borderRadius = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('--popup-window-border-radius');\n\t\t}\n\t}\n\n\tsetContentBorderRadius(radius): void\n\t{\n\t\tif (Type.isStringFilled(radius))\n\t\t{\n\t\t\tthis.contentBorderRadius = radius;\n\t\t\tthis.getContentContainer().style.setProperty('--popup-window-content-border-radius', radius);\n\t\t}\n\t\telse if (radius === null)\n\t\t{\n\t\t\tthis.contentBorderRadius = null;\n\t\t\tthis.getContentContainer().style.removeProperty('--popup-window-content-border-radius');\n\t\t}\n\t}\n\n\tsetContentColor(color: string | null)\n\t{\n\t\tif (Type.isString(color) && this.contentContainer)\n\t\t{\n\t\t\tthis.contentContainer.style.backgroundColor = color;\n\t\t}\n\t\telse if (color === null)\n\t\t{\n\t\t\tthis.contentContainer.style.style.removeProperty('background-color');\n\t\t}\n\t}\n\n\tsetBackground(background: string | null)\n\t{\n\t\tif (Type.isStringFilled(background))\n\t\t{\n\t\t\tthis.background = background;\n\t\t\tthis.getPopupContainer().style.background = background;\n\n\t\t\tif (this.angleArrowElement)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.background = background;\n\t\t\t}\n\t\t}\n\t\telse if (background === null)\n\t\t{\n\t\t\tthis.background = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('background');\n\n\t\t\tif (this.angleArrowElement)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.removeProperty('background');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBackground(): string | null\n\t{\n\t\treturn this.background;\n\t}\n\n\tsetContentBackground(background: string | null)\n\t{\n\t\tif (Type.isStringFilled(background))\n\t\t{\n\t\t\tthis.contentBackground = background;\n\t\t\tthis.getContentContainer().style.background = background;\n\t\t}\n\t\telse if (background === null)\n\t\t{\n\t\t\tthis.contentBackground = null;\n\t\t\tthis.getContentContainer().style.removeProperty('background');\n\t\t}\n\t}\n\n\tgetContentBackground(): string | null\n\t{\n\t\treturn this.contentBackground;\n\t}\n\n\tisDestroyed(): boolean\n\t{\n\t\treturn this.destroyed;\n\t}\n\n\tsetCacheable(cacheable: boolean): void\n\t{\n\t\tthis.cacheable = cacheable !== false;\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetToFrontOnShow(flag: boolean): void\n\t{\n\t\tthis.toFrontOnShow = flag !== false;\n\t}\n\n\tshouldFrontOnShow(): boolean\n\t{\n\t\treturn this.toFrontOnShow;\n\t}\n\n\tsetFixed(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.fixed = flag;\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getPopupContainer(), '--fixed');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getPopupContainer(), '--fixed');\n\t\t\t}\n\t\t}\n\t}\n\n\tisFixed(): boolean\n\t{\n\t\treturn this.fixed;\n\t}\n\n\tsetResizeMode(mode: boolean): void\n\t{\n\t\tif (mode === true || Type.isPlainObject(mode))\n\t\t{\n\t\t\tif (!this.resizeIcon)\n\t\t\t{\n\t\t\t\tthis.resizeIcon = Tag.render`\n\t\t\t\t\t<div class=\"popup-window-resize\" onmousedown=\"${this.handleResizeMouseDown.bind(this)}\"></div>\n\t\t\t\t`;\n\n\t\t\t\tthis.getPopupContainer().appendChild(this.resizeIcon);\n\t\t\t}\n\n\t\t\t//Compatibility\n\t\t\tthis.setMinWidth(mode.minWidth);\n\t\t\tthis.setMinHeight(mode.minHeight);\n\t\t}\n\t\telse if (mode === false && this.resizeIcon)\n\t\t{\n\t\t\tDom.remove(this.resizeIcon);\n\t\t\tthis.resizeIcon = null;\n\t\t}\n\t}\n\n\tgetDesignSystemContext(): string\n\t{\n\t\treturn this.designSystemContext;\n\t}\n\n\tsetDesignSystemContext(context: string): void\n\t{\n\t\tif (Type.isString(context))\n\t\t{\n\t\t\tif (this.popupContainer !== null)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.popupContainer, this.designSystemContext);\n\t\t\t\tDom.addClass(this.popupContainer, context);\n\t\t\t}\n\n\t\t\tthis.designSystemContext = context;\n\t\t}\n\t}\n\n\tsetTargetContainer(targetContainer: HTMLElement): void\n\t{\n\t\tconst newTargetContainer = Type.isElementNode(targetContainer) ? targetContainer : document.body;\n\t\tif (newTargetContainer === this.targetContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetContainer = newTargetContainer;\n\t\tif (this.getPopupContainer())\n\t\t{\n\t\t\tZIndexManager.unregister(this.getPopupContainer());\n\t\t\tthis.getTargetContainer().append(this.getPopupContainer());\n\t\t\tZIndexManager.register(this.getPopupContainer());\n\t\t}\n\n\t\tif (this.overlay)\n\t\t{\n\t\t\tDom.append(this.overlay.element, this.getTargetContainer());\n\t\t}\n\t}\n\n\tgetTargetContainer(): HTMLElement\n\t{\n\t\treturn this.targetContainer;\n\t}\n\n\tisTargetDocumentBody(): boolean\n\t{\n\t\treturn this.getTargetContainer() === document.body;\n\t}\n\n\tgetPopupContainer(): Element\n\t{\n\t\treturn this.popupContainer;\n\t}\n\n\tgetContentContainer(): Element\n\t{\n\t\treturn this.contentContainer;\n\t}\n\n\tgetResizableContainer(): Element\n\t{\n\t\treturn Browser.isIE11() ? this.getContentContainer() : this.getPopupContainer();\n\t}\n\n\tgetTitleContainer(): Element\n\t{\n\t\treturn this.titleBar;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonTitleMouseDown(event: MouseEvent): void\n\t{\n\t\tthis._startDrag(\n\t\t\tevent,\n\t\t\t{\n\t\t\t\tcursor: 'move',\n\t\t\t\tcallback: this.handleMove,\n\t\t\t\teventName: 'Drag'\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResizeMouseDown(event): void\n\t{\n\t\tthis._startDrag(\n\t\t\tevent,\n\t\t\t{\n\t\t\t\tcursor: 'nwse-resize',\n\t\t\t\teventName: 'Resize',\n\t\t\t\tcallback: this.handleResize\n\t\t\t}\n\t\t);\n\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\tthis.resizeContentPos = Dom.getPosition(this.getResizableContainer());\n\t\t\tthis.resizeContentOffset =\n\t\t\t\tthis.resizeContentPos.left - Dom.getPosition(this.getPopupContainer()).left;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.resizeContentPos = this.getPositionRelativeToTarget(this.getResizableContainer());\n\t\t\tthis.resizeContentOffset =\n\t\t\t\tthis.resizeContentPos.left - this.getPositionRelativeToTarget(this.getPopupContainer()).left;\n\t\t}\n\n\t\tthis.resizeContentPos.offsetX = 0;\n\t\tthis.resizeContentPos.offsetY = 0;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResize(offsetX, offsetY, pageX, pageY): void\n\t{\n\t\tthis.resizeContentPos.offsetX += offsetX;\n\t\tthis.resizeContentPos.offsetY += offsetY;\n\n\t\tlet width = this.resizeContentPos.width + this.resizeContentPos.offsetX;\n\t\tlet height = this.resizeContentPos.height + this.resizeContentPos.offsetY;\n\n\t\tconst scrollWidth =\n\t\t\tthis.isTargetDocumentBody() ? document.documentElement.scrollWidth : this.getTargetContainer().scrollWidth\n\t\t;\n\n\t\tif (this.resizeContentPos.left + width + this.resizeContentOffset >= scrollWidth)\n\t\t{\n\t\t\twidth = scrollWidth - this.resizeContentPos.left - this.resizeContentOffset;\n\t\t}\n\n\t\twidth = Math.max(width, this.getMinWidth());\n\t\theight = Math.max(height, this.getMinHeight());\n\n\t\tif (this.getMaxWidth() !== null)\n\t\t{\n\t\t\twidth = Math.min(width, this.getMaxWidth());\n\t\t}\n\n\t\tif (this.getMaxHeight() !== null)\n\t\t{\n\t\t\theight = Math.min(height, this.getMaxHeight());\n\t\t}\n\n\t\tthis.setWidth(width);\n\t\tthis.setHeight(height);\n\t}\n\n\tisTopAngle(): boolean\n\t{\n\t\treturn this.angle !== null && this.angle.position === 'top';\n\t}\n\n\tisBottomAngle(): boolean\n\t{\n\t\treturn this.angle !== null && this.angle.position === 'bottom';\n\t}\n\n\tisTopOrBottomAngle(): boolean\n\t{\n\t\treturn this.angle !== null && (this.angle.position === 'top' || this.angle.position === 'bottom');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetAngleHeight(): number\n\t{\n\t\treturn (this.isTopOrBottomAngle() ? Popup.getOption('angleTopOffset') : 0);\n\t}\n\n\tsetOffset(params: { offsetTop: number, offsetLeft: number }): void\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(params.offsetLeft))\n\t\t{\n\t\t\tthis.offsetLeft = params.offsetLeft + Popup.getOption('offsetLeft');\n\t\t}\n\n\t\tif (Type.isNumber(params.offsetTop))\n\t\t{\n\t\t\tthis.offsetTop = params.offsetTop + Popup.getOption('offsetTop');\n\t\t}\n\t}\n\n\tsetTitleBar(params: string | { content: string }): void\n\t{\n\t\tif (!this.titleBar)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof (params) === 'object' && Type.isDomNode(params.content))\n\t\t{\n\t\t\tthis.titleBar.innerHTML = '';\n\t\t\tthis.titleBar.appendChild(params.content);\n\t\t}\n\t\telse if (typeof (params) === 'string')\n\t\t{\n\t\t\tthis.titleBar.innerHTML = '';\n\t\t\tthis.titleBar.appendChild(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'popup-window-titlebar-text'\n\t\t\t\t\t},\n\t\t\t\t\ttext: params\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tsetDraggable(draggable: PopupDraggable): void\n\t{\n\t\tthis.params.draggable = draggable;\n\t\tconst element = draggable?.element ?? this.titleBar;\n\t\tif (!draggable || !element)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(element, 'cursor', 'move');\n\t\tEvent.bind(element, 'mousedown', this.onTitleMouseDown);\n\t}\n\n\tsetClosingByEsc(enable: boolean): void\n\t{\n\t\tenable = Type.isBoolean(enable) ? enable : true;\n\t\tif (enable)\n\t\t{\n\t\t\tthis.closeByEsc = true;\n\t\t\tthis.bindClosingByEsc();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeByEsc = false;\n\t\t\tthis.unbindClosingByEsc();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindClosingByEsc(): void\n\t{\n\t\tif (this.closeByEsc && !this.isCloseByEscBinded)\n\t\t{\n\t\t\tEvent.bind(this.targetContainer.ownerDocument, 'keyup', this.handleDocumentKeyUp, true);\n\t\t\tthis.isCloseByEscBinded = true;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tunbindClosingByEsc(): void\n\t{\n\t\tif (this.isCloseByEscBinded)\n\t\t{\n\t\t\tEvent.unbind(this.targetContainer.ownerDocument, 'keyup', this.handleDocumentKeyUp, true);\n\t\t\tthis.isCloseByEscBinded = false;\n\t\t}\n\t}\n\n\tsetAutoHide(enable: boolean): void\n\t{\n\t\tenable = Type.isBoolean(enable) ? enable : true;\n\t\tif (enable)\n\t\t{\n\t\t\tthis.autoHide = true;\n\t\t\tthis.bindAutoHide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.autoHide = false;\n\t\t\tthis.unbindAutoHide();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindAutoHide(): void\n\t{\n\t\tif (this.autoHide && !this.isAutoHideBinded && this.isShown())\n\t\t{\n\t\t\tthis.isAutoHideBinded = true;\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tEvent.bind(this.getPopupContainer(), 'click', this.handleContainerClick);\n\t\t\t}\n\n\t\t\tif (!this.hasOverlay())\n\t\t\t{\n\t\t\t\tEvent.bind(\n\t\t\t\t\tthis.targetContainer.ownerDocument,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.handleAutoHide,\n\t\t\t\t\t!this.isCompatibleMode(),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tunbindAutoHide(): void\n\t{\n\t\tif (this.isAutoHideBinded)\n\t\t{\n\t\t\tthis.isAutoHideBinded = false;\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tEvent.unbind(this.getPopupContainer(), 'click', this.handleContainerClick);\n\t\t\t}\n\n\t\t\tif (!this.hasOverlay())\n\t\t\t{\n\t\t\t\tEvent.unbind(\n\t\t\t\t\tthis.targetContainer.ownerDocument,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.handleAutoHide,\n\t\t\t\t\t!this.isCompatibleMode(),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide = (event): void => {\n\t\tif (this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.autoHideHandler !== null)\n\t\t{\n\t\t\tif (this.autoHideHandler(event))\n\t\t\t{\n\t\t\t\tthis._tryCloseByEvent(event);\n\t\t\t}\n\t\t}\n\t\telse if (event.target !== this.getPopupContainer() && !this.getPopupContainer().contains(event.target))\n\t\t{\n\t\t\tthis._tryCloseByEvent(event);\n\t\t}\n\t};\n\n\t/**\n\t * @private\n\t */\n\t_tryCloseByEvent(event): void\n\t{\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tthis.tryCloseByEvent(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.tryCloseByEvent(event);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttryCloseByEvent(event): void\n\t{\n\t\tif (event.button === 0)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleOverlayClick(event): void\n\t{\n\t\tif (this.autoHide)\n\t\t{\n\t\t\tthis.tryCloseByEvent(event);\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\tsetOverlay(params: PopupOverlay): void\n\t{\n\t\tif (this.overlay === null)\n\t\t{\n\t\t\tthis.unbindAutoHide();\n\n\t\t\tthis.overlay = {\n\t\t\t\telement: Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"popup-window-overlay\" \n\t\t\t\t\t\tid=\"popup-window-overlay-${this.getId()}\"\n\t\t\t\t\t\tonclick=\"${this.handleOverlayClick.bind(this)}\"\n\t\t\t\t\t></div>\n\t\t\t\t`,\n\t\t\t};\n\n\t\t\tthis.resizeOverlay();\n\n\t\t\tDom.append(this.overlay.element, this.getTargetContainer());\n\t\t\tthis.getZIndexComponent().setOverlay(this.overlay.element);\n\t\t}\n\n\t\tif (Type.isNumber(params?.opacity) && params.opacity >= 0 && params.opacity <= 100)\n\t\t{\n\t\t\tDom.style(this.overlay.element, 'opacity', parseFloat(params.opacity / 100).toPrecision(3));\n\t\t}\n\n\t\tif (params?.backgroundColor)\n\t\t{\n\t\t\tDom.style(this.overlay.element, 'background-color', params.backgroundColor);\n\t\t}\n\n\t\tif (params?.blur)\n\t\t{\n\t\t\tDom.style(this.overlay.element, 'backdrop-filter', params.blur);\n\t\t}\n\t}\n\n\thasOverlay(): boolean\n\t{\n\t\treturn this.overlay !== null && this.overlay.element !== null;\n\t}\n\n\tremoveOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tDom.remove(this.overlay.element);\n\t\t\tthis.getZIndexComponent().setOverlay(null);\n\t\t}\n\n\t\tif (this.overlayTimeout)\n\t\t{\n\t\t\tclearInterval(this.overlayTimeout);\n\t\t\tthis.overlayTimeout = null;\n\t\t}\n\n\t\tthis.overlay = null;\n\t}\n\n\thideOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tif (this.overlayTimeout)\n\t\t\t{\n\t\t\t\tclearInterval(this.overlayTimeout);\n\t\t\t\tthis.overlayTimeout = null;\n\t\t\t}\n\n\t\t\tthis.overlay.element.style.display = 'none';\n\t\t}\n\t}\n\n\tshowOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tthis.overlay.element.style.display = 'block';\n\n\t\t\tlet popupHeight = this.getPopupContainer().offsetHeight;\n\t\t\tthis.overlayTimeout = setInterval(() => {\n\t\t\t\tif (popupHeight !== this.getPopupContainer().offsetHeight)\n\t\t\t\t{\n\t\t\t\t\tthis.resizeOverlay();\n\t\t\t\t\tpopupHeight = this.getPopupContainer().offsetHeight;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tresizeOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tlet scrollWidth;\n\t\t\tlet scrollHeight;\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\tscrollHeight = Math.max(\n\t\t\t\t\tdocument.body.scrollHeight, document.documentElement.scrollHeight,\n\t\t\t\t\tdocument.body.offsetHeight, document.documentElement.offsetHeight,\n\t\t\t\t\tdocument.body.clientHeight, document.documentElement.clientHeight\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscrollWidth = this.getTargetContainer().scrollWidth;\n\t\t\t\tscrollHeight = this.getTargetContainer().scrollHeight;\n\t\t\t}\n\n\t\t\tthis.overlay.element.style.width = scrollWidth + 'px';\n\t\t\tthis.overlay.element.style.height = scrollHeight + 'px';\n\t\t}\n\t}\n\n\tgetZindex(): number\n\t{\n\t\treturn this.getZIndexComponent().getZIndex();\n\t}\n\n\tgetZIndexComponent(): ZIndexComponent\n\t{\n\t\treturn this.zIndexComponent;\n\t}\n\n\tsetDisableScroll(flag: boolean): void\n\t{\n\t\tconst disable = Type.isBoolean(flag) ? flag : true;\n\t\tif (disable)\n\t\t{\n\t\t\tthis.disableScroll = true;\n\t\t\tthis.#disableTargetScroll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableScroll = false;\n\t\t\tthis.#enableTargetScroll();\n\t\t}\n\t}\n\n\t#disableTargetScroll(): void\n\t{\n\t\tconst target = this.getTargetContainer();\n\t\tlet popups: Set<Popup> = disabledScrolls.get(target);\n\t\tif (!popups)\n\t\t{\n\t\t\tpopups = new Set();\n\t\t\tdisabledScrolls.set(target, popups);\n\t\t}\n\n\t\tpopups.add(this);\n\n\t\tDom.addClass(target, 'popup-window-disable-scroll');\n\t}\n\n\t#enableTargetScroll(): void\n\t{\n\t\tconst target = this.getTargetContainer();\n\t\tconst popups: Set<Popup> = disabledScrolls.get(target) || null;\n\t\tif (popups)\n\t\t{\n\t\t\tpopups.delete(this);\n\t\t}\n\n\t\tif (popups === null || popups.size === 0)\n\t\t{\n\t\t\tDom.removeClass(target, 'popup-window-disable-scroll');\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.isShown() || this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onBeforeShow');\n\n\t\tthis.showOverlay();\n\t\tthis.getPopupContainer().style.display = 'block';\n\t\tDom.addClass(this.getPopupContainer(), '--open');\n\n\t\tif (this.shouldFrontOnShow())\n\t\t{\n\t\t\tthis.bringToFront();\n\t\t}\n\n\t\tif (!this.firstShow)\n\t\t{\n\t\t\tthis.emit('onFirstShow', new BaseEvent({ compatData: [this] }));\n\t\t\tthis.firstShow = true;\n\t\t}\n\n\t\tthis.emit('onShow', new BaseEvent({ compatData: [this] }));\n\n\t\tif (this.disableScroll)\n\t\t{\n\t\t\tthis.#disableTargetScroll();\n\t\t}\n\n\t\tthis.adjustPosition();\n\n\t\tthis.animateOpening(() => {\n\n\t\t\tif (this.isDestroyed())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.removeClass(this.getPopupContainer(), this.animationShowClassName);\n\t\t\tthis.emit('onAfterShow', new BaseEvent({ compatData: [this] }));\n\t\t});\n\n\t\tthis.bindClosingByEsc();\n\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.bindAutoHide();\n\t\t\t}, 100);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.bindAutoHide();\n\t\t}\n\t}\n\n\tclose(): void\n\t{\n\t\tif (this.isDestroyed() || !this.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onClose', new BaseEvent({ compatData: [this] }));\n\n\t\tif (this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.disableScroll)\n\t\t{\n\t\t\tthis.#enableTargetScroll();\n\t\t}\n\n\t\tthis.animateClosing(() => {\n\n\t\t\tif (this.isDestroyed())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hideOverlay();\n\n\t\t\tthis.getPopupContainer().style.display = 'none';\n\t\t\tDom.removeClass(this.getPopupContainer(), '--open');\n\n\t\t\tDom.removeClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\t\tthis.unbindClosingByEsc();\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.unbindAutoHide();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unbindAutoHide();\n\t\t\t}\n\n\t\t\tthis.emit('onAfterClose', new BaseEvent({ compatData: [this] }));\n\n\t\t\tif (!this.isCacheable())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\t\t\t}\n\n\t\t});\n\t}\n\n\tbringToFront(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tZIndexManager.bringToFront(this.getPopupContainer());\n\t\t}\n\t}\n\n\ttoggle(): void\n\t{\n\t\tthis.isShown() ? this.close() : this.show();\n\t}\n\n\t/**\n\t *\n\t * @private\n\t */\n\tanimateOpening(callback: Function): void\n\t{\n\t\tDom.removeClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\tif (this.animationShowClassName !== null)\n\t\t{\n\t\t\tDom.addClass(this.getPopupContainer(), this.animationShowClassName);\n\n\t\t\tif (this.animationCloseEventType !== null)\n\t\t\t{\n\t\t\t\tconst eventName = this.animationCloseEventType + 'end';\n\t\t\t\tconst className = this.animationShowClassName;\n\t\t\t\tthis.getPopupContainer().addEventListener(eventName, function handleTransitionEnd(event) {\n\t\t\t\t\tif (!Dom.hasClass(event.target, className))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.removeEventListener(eventName, handleTransitionEnd);\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tanimateClosing(callback: Function): void\n\t{\n\t\tDom.removeClass(this.getPopupContainer(), this.animationShowClassName);\n\n\t\tif (this.animationCloseClassName !== null)\n\t\t{\n\t\t\tDom.addClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\t\tif (this.animationCloseEventType !== null)\n\t\t\t{\n\t\t\t\tconst eventName = this.animationCloseEventType + 'end';\n\t\t\t\tconst className = this.animationCloseClassName;\n\t\t\t\tthis.getPopupContainer().addEventListener(eventName, function handleTransitionEnd(event) {\n\t\t\t\t\tif (!Dom.hasClass(event.target, className))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.removeEventListener(eventName, handleTransitionEnd);\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tsetAnimation(options: PopupAnimationOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.animationShowClassName = Type.isStringFilled(options.showClassName) ? options.showClassName : null;\n\t\t\tthis.animationCloseClassName = Type.isStringFilled(options.closeClassName) ? options.closeClassName : null;\n\t\t\tthis.animationCloseEventType =\n\t\t\t\toptions.closeAnimationType === 'animation' || options.closeAnimationType === 'transition'\n\t\t\t\t\t? options.closeAnimationType\n\t\t\t\t\t: null\n\t\t\t;\n\t\t}\n\t\telse if (Type.isStringFilled(options))\n\t\t{\n\t\t\tconst animationName = options;\n\t\t\tif (animationName === 'fading')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-opacity';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t\telse if (animationName === 'fading-slide')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-opacity-transform';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t\telse if (animationName === 'scale')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-scale';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t}\n\t\telse if (options === false || options === null)\n\t\t{\n\t\t\tthis.animationShowClassName = null;\n\t\t\tthis.animationCloseClassName = null;\n\t\t\tthis.animationCloseEventType = null;\n\t\t}\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn !this.isDestroyed() && this.getPopupContainer()?.style.display === 'block';\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.destroyed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.disableScroll)\n\t\t{\n\t\t\tthis.#enableTargetScroll();\n\t\t}\n\n\t\tthis.destroyed = true;\n\n\t\tthis.emit('onDestroy', new BaseEvent({ compatData: [this] }));\n\n\t\tthis.unbindClosingByEsc();\n\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.unbindAutoHide();\n\t\t\t}, 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unbindAutoHide();\n\t\t}\n\n\t\tEvent.unbindAll(this);\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.unbind(document, 'mouseup', this.handleDocumentMouseUp);\n\t\tEvent.unbind(window, 'resize', this.handleResizeWindow);\n\n\t\tthis.removeOverlay();\n\n\t\tZIndexManager.unregister(this.popupContainer);\n\t\tthis.zIndexComponent = null;\n\n\t\tDom.remove(this.popupContainer);\n\n\t\tthis.popupContainer = null;\n\t\tthis.contentContainer = null;\n\t\tthis.closeIcon = null;\n\t\tthis.titleBar = null;\n\t\tthis.buttonsContainer = null;\n\t\tthis.angle = null;\n\t\tthis.angleArrowElement = null;\n\t\tthis.resizeIcon = null;\n\t}\n\n\tadjustPosition(bindOptions: {\n\t\tforceBindPosition?: boolean,\n\t\tforceLeft?: boolean,\n\t\tforceTop?: boolean,\n\t\tposition?: 'top' | 'bootom'\n\t}): void\n\t{\n\t\tif (bindOptions && typeof (bindOptions) === 'object')\n\t\t{\n\t\t\tthis.bindOptions = bindOptions;\n\t\t}\n\n\t\tconst bindElementPos = this.getBindElementPos(this.bindElement);\n\n\t\tif (\n\t\t\t!this.bindOptions.forceBindPosition &&\n\t\t\tthis.bindElementPos !== null &&\n\t\t\tbindElementPos.top === this.bindElementPos.top &&\n\t\t\tbindElementPos.left === this.bindElementPos.left\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindElementVanished = (\n\t\t\tbindElementPos.top === 0\n\t\t\t&& bindElementPos.left === 0\n\t\t\t&& bindElementPos.width === 0\n\t\t\t&& bindElementPos.height === 0\n\t\t);\n\n\t\tthis.bindElementPos = bindElementVanished && this.bindElementPos !== null ? this.bindElementPos : bindElementPos;\n\n\t\tconst windowSize = bindElementPos.windowSize ? bindElementPos.windowSize : this.getWindowSize();\n\t\tconst windowScroll = bindElementPos.windowScroll ? bindElementPos.windowScroll : this.getWindowScroll();\n\n\t\tconst popupWidth = bindElementPos.popupWidth ? bindElementPos.popupWidth : this.popupContainer.offsetWidth;\n\t\tconst popupHeight = bindElementPos.popupHeight ? bindElementPos.popupHeight : this.popupContainer.offsetHeight;\n\n\t\tconst angleTopOffset = Popup.getOption('angleTopOffset');\n\n\t\tlet left =\n\t\t\tthis.bindElementPos.left + this.offsetLeft -\n\t\t\t(this.isTopOrBottomAngle() ? Popup.getOption('angleLeftOffset') : 0)\n\t\t;\n\n\t\tif (\n\t\t\t!this.bindOptions.forceLeft &&\n\t\t\t(left + popupWidth + this.bordersWidth) >= (windowSize.innerWidth + windowScroll.scrollLeft) &&\n\t\t\t(windowSize.innerWidth + windowScroll.scrollLeft - popupWidth - this.bordersWidth) > 0)\n\t\t{\n\t\t\tconst bindLeft = left;\n\t\t\tleft = windowSize.innerWidth + windowScroll.scrollLeft - popupWidth - this.bordersWidth;\n\t\t\tif (this.isTopOrBottomAngle())\n\t\t\t{\n\t\t\t\tthis.setAngle({ offset: bindLeft - left + this.angle.defaultOffset });\n\t\t\t}\n\t\t}\n\t\telse if (this.isTopOrBottomAngle())\n\t\t{\n\t\t\tthis.setAngle({ offset: this.angle.defaultOffset + (left < 0 ? left : 0) });\n\t\t}\n\n\t\tif (left < 0)\n\t\t{\n\t\t\tleft = 0;\n\t\t}\n\n\t\tlet top = 0;\n\n\t\tif (this.bindOptions.position && this.bindOptions.position === 'top')\n\t\t{\n\n\t\t\ttop = this.bindElementPos.top - popupHeight - this.offsetTop - (this.isBottomAngle() ? angleTopOffset : 0);\n\t\t\tif (top < 0 || (!this.bindOptions.forceTop && top < windowScroll.scrollTop))\n\t\t\t{\n\t\t\t\ttop = this.bindElementPos.bottom + this.offsetTop;\n\t\t\t\tif (this.angle !== null)\n\t\t\t\t{\n\t\t\t\t\ttop += angleTopOffset;\n\t\t\t\t\tthis.setAngle({ position: 'top' });\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.isTopAngle())\n\t\t\t{\n\t\t\t\ttop = top - angleTopOffset + Popup.getOption('positionTopXOffset');\n\t\t\t\tthis.setAngle({ position: 'bottom' });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop += Popup.getOption('positionTopXOffset');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttop = this.bindElementPos.bottom + this.offsetTop + this.getAngleHeight();\n\n\t\t\tif (\n\t\t\t\t!this.bindOptions.forceTop &&\n\t\t\t\t(top + popupHeight) > (windowSize.innerHeight + windowScroll.scrollTop) &&\n\t\t\t\t(this.bindElementPos.top - popupHeight - this.getAngleHeight()) >= 0) //Can we place the PopupWindow above the bindElement?\n\t\t\t{\n\t\t\t\t//The PopupWindow doesn't place below the bindElement. We should place it above.\n\t\t\t\ttop = this.bindElementPos.top - popupHeight;\n\n\t\t\t\tif (this.isTopOrBottomAngle())\n\t\t\t\t{\n\t\t\t\t\ttop -= angleTopOffset;\n\t\t\t\t\tthis.setAngle({ position: 'bottom' });\n\t\t\t\t}\n\n\t\t\t\ttop += Popup.getOption('positionTopXOffset');\n\n\t\t\t}\n\t\t\telse if (this.isBottomAngle())\n\t\t\t{\n\t\t\t\ttop += angleTopOffset;\n\t\t\t\tthis.setAngle({ position: 'top' });\n\t\t\t}\n\t\t}\n\n\t\tif (top < 0)\n\t\t{\n\t\t\ttop = 0;\n\t\t}\n\n\t\tconst event = new PositionEvent();\n\t\tevent.left = left;\n\t\tevent.top = top;\n\n\t\tthis.emit('onBeforeAdjustPosition', event);\n\n\t\tDom.adjust(this.popupContainer, {\n\t\t\tstyle: {\n\t\t\t\ttop: event.top + 'px',\n\t\t\t\tleft: event.left + 'px'\n\t\t\t}\n\t\t});\n\t}\n\n\tenterFullScreen(): void\n\t{\n\t\tif (Popup.fullscreenStatus)\n\t\t{\n\t\t\tif (document.cancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.cancelFullScreen();\n\t\t\t}\n\t\t\telse if (document.mozCancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.mozCancelFullScreen();\n\t\t\t}\n\t\t\telse if (document.webkitCancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.webkitCancelFullScreen();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.contentContainer.requestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.requestFullScreen();\n\t\t\t\tEvent.bind(window, 'fullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse if (this.contentContainer.mozRequestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.mozRequestFullScreen();\n\t\t\t\tEvent.bind(window, 'mozfullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse if (this.contentContainer.webkitRequestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.webkitRequestFullScreen();\n\t\t\t\tEvent.bind(window, 'webkitfullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.log('fullscreen mode is not supported');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleFullScreen(event): void\n\t{\n\t\tif (Popup.fullscreenStatus)\n\t\t{\n\t\t\tEvent.unbind(window, 'fullscreenchange', this.handleFullScreen);\n\t\t\tEvent.unbind(window, 'webkitfullscreenchange', this.handleFullScreen);\n\t\t\tEvent.unbind(window, 'mozfullscreenchange', this.handleFullScreen);\n\n\t\t\tPopup.fullscreenStatus = false;\n\n\t\t\tif (!this.isDestroyed())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.contentContainer, 'popup-window-fullscreen');\n\t\t\t\tthis.emit('onFullscreenLeave');\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tPopup.fullscreenStatus = true;\n\n\t\t\tif (!this.isDestroyed())\n\t\t\t{\n\t\t\t\tDom.addClass(this.contentContainer, 'popup-window-fullscreen');\n\t\t\t\tthis.emit('onFullscreenEnter');\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleCloseIconClick(event): void\n\t{\n\t\tthis.tryCloseByEvent(event);\n\t\tevent.stopPropagation();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleContainerClick(event): void\n\t{\n\t\tevent.stopPropagation();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentKeyUp = (event): void => {\n\t\tif (event.keyCode === 27)\n\t\t{\n\t\t\tcheckEscPressed(this.getZindex(), () => {\n\t\t\t\tthis.close();\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\t * @private\n\t */\n\thandleResizeWindow(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t\tif (this.overlay !== null)\n\t\t\t{\n\t\t\t\tthis.resizeOverlay();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleMove(offsetX: number, offsetY: number, pageX: number, pageY: number): void\n\t{\n\t\tlet left = parseInt(this.popupContainer.style.left) + offsetX;\n\t\tlet top = parseInt(this.popupContainer.style.top) + offsetY;\n\n\t\tif (typeof (this.params.draggable) === 'object' && this.params.draggable.restrict)\n\t\t{\n\t\t\t//Left side\n\t\t\tif (left < 0)\n\t\t\t{\n\t\t\t\tleft = 0;\n\t\t\t}\n\n\t\t\tlet scrollWidth;\n\t\t\tlet scrollHeight;\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\tscrollHeight = document.documentElement.scrollHeight;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscrollWidth = this.getTargetContainer().scrollWidth;\n\t\t\t\tscrollHeight = this.getTargetContainer().scrollHeight;\n\t\t\t}\n\n\t\t\t//Right side\n\t\t\tconst floatWidth = this.popupContainer.offsetWidth;\n\t\t\tconst floatHeight = this.popupContainer.offsetHeight;\n\n\t\t\tif (left > (scrollWidth - floatWidth))\n\t\t\t{\n\t\t\t\tleft = scrollWidth - floatWidth;\n\t\t\t}\n\n\t\t\tif (top > (scrollHeight - floatHeight))\n\t\t\t{\n\t\t\t\ttop = scrollHeight - floatHeight;\n\t\t\t}\n\n\t\t\t//Top side\n\t\t\tif (top < 0)\n\t\t\t{\n\t\t\t\ttop = 0;\n\t\t\t}\n\t\t}\n\n\t\tthis.popupContainer.style.left = left + 'px';\n\t\tthis.popupContainer.style.top = top + 'px';\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_startDrag(event: MouseEvent, options): void\n\t{\n\t\toptions = options || {};\n\t\tif (Type.isStringFilled(options.cursor))\n\t\t{\n\t\t\tthis.dragOptions.cursor = options.cursor;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.eventName))\n\t\t{\n\t\t\tthis.dragOptions.eventName = options.eventName;\n\t\t}\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.dragOptions.callback = options.callback;\n\t\t}\n\n\t\tthis.dragPageX = event.pageX;\n\t\tthis.dragPageY = event.pageY;\n\t\tthis.dragged = false;\n\n\t\tEvent.bind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.bind(document, 'mouseup', this.handleDocumentMouseUp);\n\n\t\tif (document.body.setCapture)\n\t\t{\n\t\t\tdocument.body.setCapture();\n\t\t}\n\n\t\tdocument.body.ondrag = () => false;\n\t\tdocument.body.onselectstart = () => false;\n\t\tdocument.body.style.cursor = this.dragOptions.cursor;\n\t\tdocument.body.style.MozUserSelect = 'none';\n\t\tthis.popupContainer.style.MozUserSelect = 'none';\n\n\t\tif (this.shouldFrontOnShow())\n\t\t{\n\t\t\tthis.bringToFront();\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentMouseMove(event): void\n\t{\n\t\tif (this.dragPageX === event.pageX && this.dragPageY === event.pageY)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dragOptions.callback(\n\t\t\tevent.pageX - this.dragPageX,\n\t\t\tevent.pageY - this.dragPageY,\n\t\t\tevent.pageX,\n\t\t\tevent.pageY\n\t\t);\n\n\t\tthis.dragPageX = event.pageX;\n\t\tthis.dragPageY = event.pageY;\n\n\t\tif (!this.dragged)\n\t\t{\n\t\t\tthis.emit(`on${this.dragOptions.eventName}Start`, new BaseEvent({ compatData: [this] }));\n\t\t\tthis.dragged = true;\n\t\t}\n\n\t\tthis.emit(`on${this.dragOptions.eventName}`, new BaseEvent({ compatData: [this] }));\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentMouseUp(event: MouseEvent): void\n\t{\n\t\tif (document.body.releaseCapture)\n\t\t{\n\t\t\tdocument.body.releaseCapture();\n\t\t}\n\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.unbind(document, 'mouseup', this.handleDocumentMouseUp);\n\n\t\tdocument.body.ondrag = null;\n\t\tdocument.body.onselectstart = null;\n\t\tdocument.body.style.cursor = '';\n\t\tdocument.body.style.MozUserSelect = '';\n\t\tthis.popupContainer.style.MozUserSelect = '';\n\n\t\tthis.emit(`on${this.dragOptions.eventName}End`, new BaseEvent({ compatData: [this] }));\n\t\tthis.dragged = false;\n\n\t\tevent.preventDefault();\n\t}\n}\n\nlet escCallbackIndex = -1;\nlet escCallback = null;\n\nfunction checkEscPressed(zIndex, callback)\n{\n\tif (zIndex === false)\n\t{\n\t\tif (escCallback && escCallback.length > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < escCallback.length; i++)\n\t\t\t{\n\t\t\t\tescCallback[i]();\n\t\t\t}\n\n\t\t\tescCallback = null;\n\t\t\tescCallbackIndex = -1;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (escCallback === null)\n\t\t{\n\t\t\tescCallback = [];\n\t\t\tescCallbackIndex = -1;\n\t\t\tsetTimeout(() => {\n\t\t\t\tcheckEscPressed(false);\n\t\t\t}, 10);\n\t\t}\n\n\t\tif (zIndex > escCallbackIndex)\n\t\t{\n\t\t\tescCallbackIndex = zIndex;\n\t\t\tescCallback = [callback];\n\t\t}\n\t\telse if (zIndex === escCallbackIndex)\n\t\t{\n\t\t\tescCallback.push(callback);\n\t\t}\n\t}\n}\n","import Popup from './popup';\nimport { type PopupOptions } from './popup-types';\nimport { Type } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\n\nexport default class PopupManager\n{\n\tstatic _popups: Popup[] = [];\n\tstatic _currentPopup: Popup = null;\n\n\tconstructor()\n\t{\n\t\tthrow new Error('You cannot make an instance of PopupManager.');\n\t}\n\n\tstatic create(options: PopupOptions): Popup\n\t{\n\t\tlet [popupId, bindElement, params] = arguments; //compatible arguments\n\n\t\tlet id = popupId;\n\t\tlet compatMode = true;\n\t\tif (Type.isPlainObject(popupId) && !bindElement && !params)\n\t\t{\n\t\t\tcompatMode = false;\n\t\t\tid = popupId.id;\n\t\t\tif (!Type.isStringFilled(id))\n\t\t\t{\n\t\t\t\tthrow new Error('BX.Main.Popup.Manager: \"id\" parameter is required.');\n\t\t\t}\n\t\t}\n\n\t\tlet popupWindow = this.getPopupById(id);\n\t\tif (popupWindow === null)\n\t\t{\n\t\t\tpopupWindow = compatMode ? new Popup(popupId, bindElement, params) : new Popup(options);\n\t\t\tpopupWindow.subscribe('onShow', this.handlePopupShow);\n\t\t\tpopupWindow.subscribe('onClose', this.handlePopupClose);\n\t\t}\n\n\t\treturn popupWindow;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handleOnAfterInit(event: BaseEvent)\n\t{\n\t\tevent.getTarget().subscribeOnce('onDestroy', this.handlePopupDestroy);\n\n\t\tthis._popups.forEach(popup => {\n\t\t\tif (popup.getId() === event.getTarget().getId())\n\t\t\t{\n\t\t\t\tconsole.error(`Duplicate id (${popup.getId()}) for the BX.Main.Popup instance.`);\n\t\t\t}\n\t\t});\n\n\t\tthis._popups.push(event.getTarget());\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupDestroy(event: BaseEvent)\n\t{\n\t\tthis._popups = this._popups.filter(popup => {\n\t\t\treturn popup !== event.getTarget();\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupShow(event: BaseEvent)\n\t{\n\t\tif (this._currentPopup !== null)\n\t\t{\n\t\t\tthis._currentPopup.close();\n\t\t}\n\n\t\tthis._currentPopup = event.getTarget();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupClose()\n\t{\n\t\tthis._currentPopup = null;\n\t}\n\n\tstatic getCurrentPopup(): Popup | null\n\t{\n\t\treturn this._currentPopup;\n\t}\n\n\tstatic isPopupExists(id): boolean\n\t{\n\t\treturn this.getPopupById(id) !== null;\n\t}\n\n\tstatic isAnyPopupShown(): boolean\n\t{\n\t\tfor (let i = 0, length = this._popups.length; i < length; i++)\n\t\t{\n\t\t\tif (this._popups[i].isShown())\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic getPopupById(id): Popup | null\n\t{\n\t\tfor (let i = 0; i < this._popups.length; i++)\n\t\t{\n\t\t\tif (this._popups[i].getId() === id)\n\t\t\t{\n\t\t\t\treturn this._popups[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic getMaxZIndex(): number\n\t{\n\t\tlet zIndex = 0;\n\n\t\tthis.getPopups().forEach((popup: Popup) => {\n\t\t\tzIndex = Math.max(zIndex, popup.getZindex());\n\t\t});\n\n\t\treturn zIndex;\n\t}\n\n\tstatic getPopups(): Popup[]\n\t{\n\t\treturn this._popups;\n\t}\n}\n\nPopupManager.handlePopupDestroy = PopupManager.handlePopupDestroy.bind(PopupManager);\nPopupManager.handlePopupShow = PopupManager.handlePopupShow.bind(PopupManager);\nPopupManager.handlePopupClose = PopupManager.handlePopupClose.bind(PopupManager);\nPopupManager.handleOnAfterInit = PopupManager.handleOnAfterInit.bind(PopupManager);\n\nEventEmitter.subscribe('BX.Main.Popup:onAfterInit', PopupManager.handleOnAfterInit);","import Menu from './menu';\nimport { Type, Text, Dom, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuItemOptions } from './menu-types';\n\nconst aliases = {\n\tonSubMenuShow: { namespace: 'BX.Main.Menu.Item', eventName: 'SubMenu:onShow' },\n\tonSubMenuClose: { namespace: 'BX.Main.Menu.Item', eventName: 'SubMenu:onClose' }\n};\n\nconst reEscape = /[<>'\"]/g;\nconst escapeEntities = {\n\t'<': '&lt;',\n\t'>': '&gt;',\n\t\"'\": '&#39;',\n\t'\"': '&quot;',\n};\n\nfunction encodeSafe(value: string): string\n{\n\tif (Type.isString(value))\n\t{\n\t\treturn value.replace(reEscape, item => escapeEntities[item]);\n\t}\n\n\treturn value;\n}\n\nEventEmitter.registerAliases(aliases);\n\nexport default class MenuItem extends EventEmitter\n{\n\tconstructor(options: MenuItemOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Menu.Item');\n\n\t\toptions = options || {};\n\t\tthis.options = options;\n\n\t\tthis.id = options.id || Text.getRandom();\n\n\t\tthis.text = '';\n\t\tthis.allowHtml = false;\n\t\tif (Type.isStringFilled(options.html) || Type.isElementNode(options.html))\n\t\t{\n\t\t\tthis.text = options.html;\n\t\t\tthis.allowHtml = true;\n\t\t}\n\t\telse if (Type.isStringFilled(options.text))\n\t\t{\n\t\t\tthis.text = options.text;\n\t\t\tif (this.text.match(/<[^>]+>/))\n\t\t\t{\n\t\t\t\tconsole.warn('BX.Main.MenuItem: use \"html\" option for the html item content.', this.getText());\n\t\t\t}\n\t\t}\n\n\t\tthis.title = Type.isStringFilled(options.title) ? options.title : '';\n\t\tthis.delimiter = options.delimiter === true;\n\t\tthis.href = Type.isStringFilled(options.href) ? options.href : null;\n\t\tthis.target = Type.isStringFilled(options.target) ? options.target : null;\n\t\tthis.dataset = Type.isPlainObject(options.dataset) ? options.dataset : null;\n\t\tthis.className = Type.isStringFilled(options.className) ? options.className : null;\n\t\tthis.menuShowDelay = Type.isNumber(options.menuShowDelay) ? options.menuShowDelay : 300;\n\t\tthis.subMenuOffsetX = Type.isNumber(options.subMenuOffsetX) ? options.subMenuOffsetX : 4;\n\t\tthis._items = Type.isArray(options.items) ? options.items : [];\n\t\tthis.disabled = options.disabled === true;\n\t\tthis.cacheable = options.cacheable === true;\n\n\t\t/**\n\t\t *\n\t\t * @type {function|string}\n\t\t */\n\t\tthis.onclick =\n\t\t\tType.isStringFilled(options.onclick) || Type.isFunction(options.onclick)\n\t\t\t\t? options.onclick\n\t\t\t\t: null\n\t\t;\n\n\t\tthis.subscribeFromOptions(options.events, aliases);\n\n\t\t/**\n\t\t *\n\t\t * @type {Menu}\n\t\t */\n\t\tthis.menuWindow = null;\n\n\t\t/**\n\t\t *\n\t\t * @type {Menu}\n\t\t */\n\t\tthis.subMenuWindow = null;\n\n\t\t/**\n\t\t *\n\t\t * @type {{item: HTMLElement, text: HTMLElement}}\n\t\t */\n\t\tthis.layout = {\n\t\t\titem: null,\n\t\t\ttext: null\n\t\t};\n\n\t\tthis.getLayout(); //compatibility\n\n\t\t//compatibility\n\t\t//now use this.options\n\t\tthis.events = {};\n\t\tthis.items = [];\n\t\tfor (let property in options)\n\t\t{\n\t\t\tif (options.hasOwnProperty(property) && typeof (this[property]) === 'undefined')\n\t\t\t{\n\t\t\t\tthis[property] = options[property];\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLayout(): Element\n\t{\n\t\tif (this.layout.item)\n\t\t{\n\t\t\treturn this.layout;\n\t\t}\n\n\t\tif (this.delimiter)\n\t\t{\n\t\t\tif (Type.isStringFilled(this.getText()))\n\t\t\t{\n\t\t\t\tthis.layout.item = Dom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: [\n\t\t\t\t\t\t\t'popup-window-delimiter-section',\n\t\t\t\t\t\t\tthis.className ? this.className : '',\n\t\t\t\t\t\t].join(' ')\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\t(this.layout.text = Tag.render`\n\t\t\t\t\t\t\t<span class=\"popup-window-delimiter-text\">${\n\t\t\t\t\t\t\t\tthis.allowHtml ? this.getText() : encodeSafe(this.getText())\n\t\t\t\t\t\t\t}</span>\n\t\t\t\t\t\t`)\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layout.item = Tag.render`<span class=\"popup-window-delimiter\">`;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.layout.item = Dom.create(this.href ? 'a' : 'span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: [\n\t\t\t\t\t\t'menu-popup-item',\n\t\t\t\t\t\t(this.className ? this.className : 'menu-popup-no-icon'),\n\t\t\t\t\t\t(this.hasSubMenu() ? 'menu-popup-item-submenu' : '')\n\t\t\t\t\t].join(' ')\n\t\t\t\t},\n\n\t\t\t\tattrs: {\n\t\t\t\t\ttitle: this.title,\n\t\t\t\t\tonclick: Type.isString(this.onclick) ? this.onclick : '', // compatibility\n\t\t\t\t\ttarget: this.target ? this.target : ''\n\t\t\t\t},\n\n\t\t\t\tdataset: this.dataset,\n\n\t\t\t\tevents:\n\t\t\t\t\tType.isFunction(this.onclick)\n\t\t\t\t\t\t? { click: this.onItemClick.bind(this) }\n\t\t\t\t\t\t: null\n\t\t\t\t,\n\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', { props: { className: 'menu-popup-item-icon' } }),\n\t\t\t\t\t(this.layout.text = Tag.render`\n\t\t\t\t\t\t<span class=\"menu-popup-item-text\">${\n\t\t\t\t\t\t\tthis.allowHtml ? this.getText() : encodeSafe(this.getText())\n\t\t\t\t\t\t}</span>\n\t\t\t\t\t`)\n\t\t\t\t]\n\t\t\t});\n\n\t\t\tif (this.href)\n\t\t\t{\n\t\t\t\tthis.layout.item.href = this.href;\n\t\t\t}\n\n\t\t\tif (this.isDisabled())\n\t\t\t{\n\t\t\t\tthis.disable();\n\t\t\t}\n\n\t\t\tEvent.bind(this.layout.item, 'mouseenter', this.onItemMouseEnter.bind(this));\n\t\t\tEvent.bind(this.layout.item, 'mouseleave', this.onItemMouseLeave.bind(this));\n\t\t}\n\n\t\treturn this.layout;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\treturn this.getLayout().item;\n\t}\n\n\tgetTextContainer(): Element\n\t{\n\t\treturn this.getLayout().text;\n\t}\n\n\tgetText(): string | HTMLElement\n\t{\n\t\treturn this.text;\n\t}\n\n\tsetText(text: string | HTMLElement, allowHtml = false)\n\t{\n\t\tif (Type.isString(text) || Type.isElementNode(text))\n\t\t{\n\t\t\tthis.allowHtml = allowHtml;\n\t\t\tthis.text = text;\n\n\t\t\tif (Type.isElementNode(text))\n\t\t\t{\n\t\t\t\tDom.clean(this.getTextContainer());\n\t\t\t\tif (this.allowHtml)\n\t\t\t\t{\n\t\t\t\t\tDom.append(text, this.getTextContainer());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getTextContainer().innerHTML = encodeSafe(text.outerHTML);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getTextContainer().innerHTML = this.allowHtml ? text : encodeSafe(text);\n\t\t\t}\n\t\t}\n\t}\n\n\thasSubMenu(): boolean\n\t{\n\t\treturn this.subMenuWindow !== null || this._items.length;\n\t}\n\n\tshowSubMenu(): void\n\t{\n\t\tif (!this.getMenuWindow().getPopupWindow().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addSubMenu(this._items);\n\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.addClass(this.layout.item, 'menu-popup-item-open');\n\n\t\t\tthis.closeSiblings();\n\t\t\tthis.closeChildren();\n\n\t\t\tconst popupWindow = this.subMenuWindow.getPopupWindow();\n\t\t\tif (!popupWindow.isShown())\n\t\t\t{\n\t\t\t\tthis.emit('SubMenu:onShow');\n\t\t\t\tpopupWindow.show();\n\t\t\t}\n\n\t\t\tthis.adjustSubMenu();\n\t\t}\n\t}\n\n\taddSubMenu(items: []): Menu\n\t{\n\t\tif (this.subMenuWindow !== null || !Type.isArray(items) || !items.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rootMenuWindow = this.getMenuWindow().getRootMenuWindow() || this.getMenuWindow();\n\t\tconst rootOptions = Object.assign({}, rootMenuWindow.params);\n\t\tdelete rootOptions.events;\n\n\t\tconst subMenuOptions =\n\t\t\tType.isPlainObject(rootMenuWindow.params.subMenuOptions) ? rootMenuWindow.params.subMenuOptions : {}\n\t\t;\n\n\t\tconst options = Object.assign({}, rootOptions, subMenuOptions);\n\n\t\t//Override root menu options\n\t\toptions.autoHide = false;\n\t\toptions.menuShowDelay = this.menuShowDelay;\n\t\toptions.cacheable = this.isCacheable();\n\t\toptions.targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\t\toptions.bindOptions = {\n\t\t\tforceTop: true,\n\t\t\tforceLeft: true,\n\t\t\tforceBindPosition: true\n\t\t};\n\n\t\tdelete options.angle;\n\t\tdelete options.overlay;\n\n\t\tthis.subMenuWindow = new Menu('popup-submenu-' + this.id, this.layout.item, items, options);\n\t\tthis.subMenuWindow.setParentMenuWindow(this.getMenuWindow());\n\t\tthis.subMenuWindow.setParentMenuItem(this);\n\n\t\tthis.subMenuWindow.getPopupWindow().subscribe('onDestroy', this.handleSubMenuDestroy.bind(this));\n\t\tDom.addClass(this.layout.item, 'menu-popup-item-submenu');\n\n\t\treturn this.subMenuWindow;\n\t}\n\n\tcloseSubMenu(): void\n\t{\n\t\tthis.clearSubMenuTimeout();\n\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.removeClass(this.layout.item, 'menu-popup-item-open');\n\n\t\t\tthis.closeChildren();\n\n\t\t\tconst popup = this.subMenuWindow.getPopupWindow();\n\t\t\tif (popup.isShown())\n\t\t\t{\n\t\t\t\tthis.emit('SubMenu:onClose');\n\t\t\t}\n\n\t\t\tthis.subMenuWindow.close();\n\t\t}\n\t}\n\n\tcloseSiblings(): void\n\t{\n\t\tconst siblings = this.menuWindow.getMenuItems();\n\t\tfor (let i = 0; i < siblings.length; i++)\n\t\t{\n\t\t\tif (siblings[i] !== this)\n\t\t\t{\n\t\t\t\tsiblings[i].closeSubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tcloseChildren(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tconst children = this.subMenuWindow.getMenuItems();\n\t\t\tfor (let i = 0; i < children.length; i++)\n\t\t\t{\n\t\t\t\tchildren[i].closeSubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySubMenu(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.removeClass(this.layout.item, 'menu-popup-item-open menu-popup-item-submenu');\n\t\t\tthis.destroyChildren();\n\t\t\tthis.subMenuWindow.destroy();\n\n\t\t\tthis.subMenuWindow = null;\n\t\t\tthis._items = [];\n\t\t}\n\t}\n\n\tdestroyChildren(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tconst children = this.subMenuWindow.getMenuItems();\n\t\t\tfor (let i = 0; i < children.length; i++)\n\t\t\t{\n\t\t\t\tchildren[i].destroySubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustSubMenu(): void\n\t{\n\t\tif (!this.subMenuWindow || !this.layout.item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst popupWindow = this.subMenuWindow.getPopupWindow();\n\t\tconst itemRect = this.getBoundingClientRect();\n\n\t\tlet offsetLeft = itemRect.width + this.subMenuOffsetX;\n\t\tlet offsetTop = itemRect.height + this.getPopupPadding();\n\t\tlet angleOffset = itemRect.height / 2 - this.getPopupPadding();\n\t\tlet anglePosition = 'left';\n\n\t\tconst popupWidth = popupWindow.getPopupContainer().offsetWidth;\n\t\tconst popupHeight = popupWindow.getPopupContainer().offsetHeight;\n\t\tconst popupBottom = itemRect.top + popupHeight;\n\n\t\tconst targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\t\tconst isGlobalContext = this.getMenuWindow().getPopupWindow().isTargetDocumentBody();\n\t\tconst clientWidth = isGlobalContext ? document.documentElement.clientWidth : targetContainer.offsetWidth;\n\t\tconst clientHeight = isGlobalContext ? document.documentElement.clientHeight : targetContainer.offsetHeight;\n\n\t\t// let's try to fit a submenu to the browser viewport\n\t\tconst exceeded = popupBottom - clientHeight;\n\t\tif (exceeded > 0)\n\t\t{\n\t\t\tlet roundOffset = Math.ceil(exceeded / itemRect.height) * itemRect.height;\n\t\t\tif (roundOffset > itemRect.top)\n\t\t\t{\n\t\t\t\t// it cannot be higher than the browser viewport.\n\t\t\t\troundOffset -= Math.ceil((roundOffset - itemRect.top) / itemRect.height) * itemRect.height;\n\t\t\t}\n\n\t\t\tif (itemRect.bottom > (popupBottom - roundOffset))\n\t\t\t{\n\t\t\t\t// let's sync bottom boundaries.\n\t\t\t\troundOffset -= itemRect.bottom - (popupBottom - roundOffset) + this.getPopupPadding();\n\t\t\t}\n\n\t\t\toffsetTop += roundOffset;\n\t\t\tangleOffset += roundOffset;\n\t\t}\n\n\t\tif ((itemRect.left + offsetLeft + popupWidth) > clientWidth)\n\t\t{\n\t\t\tconst left = itemRect.left - popupWidth - this.subMenuOffsetX;\n\t\t\tif (left > 0)\n\t\t\t{\n\t\t\t\toffsetLeft = -popupWidth - this.subMenuOffsetX;\n\t\t\t\tanglePosition = 'right';\n\t\t\t}\n\t\t}\n\n\t\tpopupWindow.setBindElement(this.layout.item);\n\t\tpopupWindow.setOffset({ offsetLeft: offsetLeft, offsetTop: -offsetTop });\n\t\tpopupWindow.setAngle({ position: anglePosition, offset: angleOffset });\n\t\tpopupWindow.adjustPosition();\n\t}\n\n\tgetBoundingClientRect(): DOMRect\n\t{\n\t\tconst popup = this.getMenuWindow().getPopupWindow();\n\t\tif (popup.isTargetDocumentBody())\n\t\t{\n\t\t\treturn this.layout.item.getBoundingClientRect();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rect = popup.getPositionRelativeToTarget(this.layout.item);\n\t\t\tconst targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\n\t\t\treturn new DOMRect(\n\t\t\t\trect.left - targetContainer.scrollLeft,\n\t\t\t\trect.top - targetContainer.scrollTop,\n\t\t\t\trect.width,\n\t\t\t\trect.height\n\t\t\t);\n\t\t}\n\t}\n\n\tgetPopupPadding(): number\n\t{\n\t\tif (!Type.isNumber(this.popupPadding))\n\t\t{\n\t\t\tif (this.subMenuWindow)\n\t\t\t{\n\t\t\t\tconst menuContainer = this.subMenuWindow.layout.menuContainer;\n\t\t\t\tthis.popupPadding = parseInt(Dom.style(menuContainer, 'paddingTop'), 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popupPadding = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn this.popupPadding;\n\t}\n\n\tgetSubMenu(): Menu | null\n\t{\n\t\treturn this.subMenuWindow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetMenuWindow(menu: Menu): string\n\t{\n\t\tthis.menuWindow = menu;\n\t}\n\n\tgetMenuWindow(): Menu | null\n\t{\n\t\treturn this.menuWindow;\n\t}\n\n\tgetMenuShowDelay(): number\n\t{\n\t\treturn this.menuShowDelay;\n\t}\n\n\tenable(): void\n\t{\n\t\tthis.disabled = false;\n\t\tthis.getContainer().classList.remove('menu-popup-item-disabled');\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis.disabled = true;\n\t\tthis.closeSubMenu();\n\t\tthis.getContainer().classList.add('menu-popup-item-disabled');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disabled;\n\t}\n\n\tsetCacheable(cacheable): void\n\t{\n\t\tthis.cacheable = cacheable !== false;\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemClick(event): void\n\t{\n\t\tthis.onclick.call(this.menuWindow, event, this); //compatibility\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemMouseEnter(mouseEvent: MouseEvent): void\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { mouseEvent } });\n\t\tEventEmitter.emit(this, 'onMouseEnter', event, { thisArg: this });\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearSubMenuTimeout();\n\n\t\tif (this.hasSubMenu())\n\t\t{\n\t\t\tthis.subMenuTimeout = setTimeout(function() {\n\t\t\t\tthis.showSubMenu();\n\t\t\t}.bind(this), this.menuShowDelay);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.subMenuTimeout = setTimeout(function() {\n\t\t\t\tthis.closeSiblings();\n\t\t\t}.bind(this), this.menuShowDelay);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemMouseLeave(mouseEvent: MouseEvent): void\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { mouseEvent } });\n\t\tEventEmitter.emit(this, 'onMouseLeave', event, { thisArg: this });\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearSubMenuTimeout();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tclearSubMenuTimeout(): void\n\t{\n\t\tif (this.subMenuTimeout)\n\t\t{\n\t\t\tclearTimeout(this.subMenuTimeout);\n\t\t}\n\n\t\tthis.subMenuTimeout = null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleSubMenuDestroy(): void\n\t{\n\t\tthis.subMenuWindow = null;\n\t}\n}","import MenuItem from './menu-item';\nimport Popup from '../popup/popup';\nimport { Type, Text, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { type MenuOptions, type MenuItemOptions } from './menu-types';\nimport { type PopupTargetOptions } from '../popup/popup-types';\n\n/**\n * @memberof BX.Main\n */\nexport default class Menu extends EventEmitter\n{\n\tconstructor(options: MenuOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Menu');\n\n\t\tlet [\n\t\t\tid: string,\n\t\t\tbindElement: PopupTargetOptions,\n\t\t\tmenuItems: MenuItemOptions[],\n\t\t\tparams: MenuOptions,\n\t\t] = arguments;\n\n\t\tif (Type.isPlainObject(options) && !bindElement && !menuItems && !params)\n\t\t{\n\t\t\tparams = options;\n\t\t\tparams.compatibleMode = false;\n\n\t\t\tid = options.id;\n\t\t\tbindElement = options.bindElement;\n\t\t\tmenuItems = options.items;\n\n\t\t\tif (!Type.isStringFilled(id))\n\t\t\t{\n\t\t\t\tid = `menu-popup-${Text.getRandom()}`;\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onInit', { id, bindElement, menuItems, params });\n\n\t\tthis.id = id;\n\t\tthis.bindElement = bindElement;\n\n\t\t/**\n\t\t *\n\t\t * @type {MenuItem[]}\n\t\t */\n\t\tthis.menuItems = [];\n\t\tthis.itemsContainer = null;\n\t\tthis.params = params && typeof (params) === 'object' ? params : {};\n\t\tthis.parentMenuWindow = null;\n\t\tthis.parentMenuItem = null;\n\n\t\tif (menuItems && Type.isArray(menuItems))\n\t\t{\n\t\t\tfor (let i = 0; i < menuItems.length; i++)\n\t\t\t{\n\t\t\t\tthis.addMenuItemInternal(menuItems[i], null);\n\t\t\t}\n\t\t}\n\n\t\tthis.layout = {\n\t\t\tmenuContainer: null,\n\t\t\titemsContainer: null\n\t\t};\n\n\t\tthis.popupWindow = this.__createPopup();\n\t}\n\n\t/**\n\t * @private\n\t */\n\t__createPopup(): Popup\n\t{\n\t\tconst domItems = [];\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\tconst itemLayout = item.getLayout();\n\t\t\tdomItems.push(itemLayout.item);\n\t\t}\n\n\t\tconst defaults = {\n\t\t\tcloseByEsc: false,\n\t\t\tangle: false,\n\t\t\tautoHide: true,\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 0,\n\t\t\tanimation: 'fading'\n\t\t};\n\n\t\tconst options = Object.assign(defaults, this.params);\n\n\t\t//Override user params\n\t\toptions.noAllPaddings = true;\n\t\toptions.darkMode = false;\n\t\toptions.autoHideHandler = this.handleAutoHide.bind(this);\n\n\t\tthis.layout.itemsContainer = Tag.render`\n\t\t\t<div class=\"menu-popup-items\">${domItems}</div>\n\t\t`;\n\n\t\tthis.layout.menuContainer = Tag.render`\n\t\t\t<div class=\"menu-popup\">${this.layout.itemsContainer}</div>\n\t\t`;\n\n\t\tthis.itemsContainer = this.layout.itemsContainer;\n\t\toptions.content = this.layout.menuContainer;\n\n\t\t//Make internal event handlers first in the queue.\n\t\toptions.events = {\n\t\t\tonClose: this.handlePopupClose.bind(this),\n\t\t\tonDestroy: this.handlePopupDestroy.bind(this)\n\t\t};\n\n\t\tconst id = options.compatibleMode === false ? this.getId() : 'menu-popup-' + this.getId();\n\t\tconst popup = new Popup(id, this.bindElement, options);\n\t\tif (this.params && this.params.events)\n\t\t{\n\t\t\tpopup.subscribeFromOptions(this.params.events);\n\t\t}\n\n\t\treturn popup;\n\t}\n\n\tgetPopupWindow(): Popup\n\t{\n\t\treturn this.popupWindow;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopupWindow().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getPopupWindow().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.getPopupWindow().destroy();\n\t}\n\n\ttoggle(): void\n\t{\n\t\tif (this.getPopupWindow().isShown())\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupClose(): void\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\titem.closeSubMenu();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupDestroy(): void\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\titem.destroySubMenu();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide(event): boolean\n\t{\n\t\treturn !this.containsTarget(event.target);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tcontainsTarget(target: Element): boolean\n\t{\n\t\tconst el = this.getPopupWindow().getPopupContainer();\n\t\tif (this.getPopupWindow().isShown() && (target === el || el.contains(target)))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.getMenuItems().some(function(item: MenuItem) {\n\n\t\t\treturn item.getSubMenu() && item.getSubMenu().containsTarget(target);\n\n\t\t});\n\t}\n\n\tsetParentMenuWindow(parentMenu: Menu): void\n\t{\n\t\tif (parentMenu instanceof Menu)\n\t\t{\n\t\t\tthis.parentMenuWindow = parentMenu;\n\t\t}\n\t}\n\n\tgetParentMenuWindow(): Menu | null\n\t{\n\t\treturn this.parentMenuWindow;\n\t}\n\n\tgetRootMenuWindow(): Menu | null\n\t{\n\t\tlet root = null;\n\t\tlet parent = this.getParentMenuWindow();\n\t\twhile (parent !== null)\n\t\t{\n\t\t\troot = parent;\n\t\t\tparent = parent.getParentMenuWindow();\n\t\t}\n\n\t\treturn root;\n\t}\n\n\tsetParentMenuItem(parentItem: MenuItem): void\n\t{\n\t\tif (parentItem instanceof MenuItem)\n\t\t{\n\t\t\tthis.parentMenuItem = parentItem;\n\t\t}\n\t}\n\n\tgetParentMenuItem(): MenuItem | null\n\t{\n\t\treturn this.parentMenuItem;\n\t}\n\n\taddMenuItem(menuItemJson: any, targetItemId: string): MenuItem\n\t{\n\t\tconst menuItem = this.addMenuItemInternal(menuItemJson, targetItemId);\n\t\tif (!menuItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst itemLayout = menuItem.getLayout();\n\t\tconst targetItem = this.getMenuItem(targetItemId);\n\t\tif (targetItem !== null)\n\t\t{\n\t\t\tconst targetLayout = targetItem.getLayout();\n\t\t\tthis.itemsContainer.insertBefore(itemLayout.item, targetLayout.item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.itemsContainer.appendChild(itemLayout.item);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\t/**\n\t * @private\n\t */\n\taddMenuItemInternal(menuItemJson: any, targetItemId: string): MenuItem\n\t{\n\t\tif (\n\t\t\t!menuItemJson ||\n\t\t\t(\n\t\t\t\t!menuItemJson.delimiter &&\n\t\t\t\t!Type.isStringFilled(menuItemJson.text) &&\n\t\t\t\t!Type.isStringFilled(menuItemJson.html) &&\n\t\t\t\t!Type.isElementNode(menuItemJson.html)\n\t\t\t) ||\n\t\t\t(menuItemJson.id && this.getMenuItem(menuItemJson.id) !== null)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isNumber(this.params.menuShowDelay))\n\t\t{\n\t\t\tmenuItemJson.menuShowDelay = this.params.menuShowDelay;\n\t\t}\n\n\t\tconst menuItem = new MenuItem(menuItemJson);\n\t\tmenuItem.setMenuWindow(this);\n\n\t\tconst position = this.getMenuItemPosition(targetItemId);\n\t\tif (position >= 0)\n\t\t{\n\t\t\tthis.menuItems.splice(position, 0, menuItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.menuItems.push(menuItem);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\tremoveMenuItem(itemId: string, options = {\n\t\tdestroyEmptyPopup: true,\n\t}): void\n\t{\n\t\tconst item = this.getMenuItem(itemId);\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let position = 0; position < this.menuItems.length; position++)\n\t\t{\n\t\t\tif (this.menuItems[position] === item)\n\t\t\t{\n\t\t\t\titem.destroySubMenu();\n\t\t\t\tthis.menuItems.splice(position, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.menuItems.length)\n\t\t{\n\t\t\tconst menuWindow = item.getMenuWindow();\n\t\t\tif (menuWindow)\n\t\t\t{\n\t\t\t\tconst parentMenuItem = menuWindow.getParentMenuItem();\n\t\t\t\tif (parentMenuItem)\n\t\t\t\t{\n\t\t\t\t\tparentMenuItem.destroySubMenu();\n\t\t\t\t}\n\t\t\t\telse if (options.destroyEmptyPopup)\n\t\t\t\t{\n\t\t\t\t\tmenuWindow.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\titem.layout.item.parentNode.removeChild(item.layout.item);\n\t\titem.layout = {\n\t\t\titem: null,\n\t\t\ttext: null\n\t\t};\n\t}\n\n\tgetMenuItem(itemId: string): MenuItem | null\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tif (this.menuItems[i].id && this.menuItems[i].id === itemId)\n\t\t\t{\n\t\t\t\treturn this.menuItems[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn this.menuItems;\n\t}\n\n\tgetMenuItemPosition(itemId: string): number\n\t{\n\t\tif (itemId)\n\t\t{\n\t\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t\t{\n\t\t\t\tif (this.menuItems[i].id && this.menuItems[i].id === itemId)\n\t\t\t\t{\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tgetMenuContainer()\n\t{\n\t\treturn this.getPopupWindow().getPopupContainer();\n\t}\n}\n","import Menu from './menu';\nimport { Type } from 'main.core';\nimport { MenuOptions } from './menu-types';\n\nexport default class MenuManager\n{\n\t/**\n\t * @private\n\t */\n\tstatic Data: { [id: string]: Menu } = {};\n\n\t/**\n\t * @private\n\t */\n\tstatic currentItem: ? Menu = null;\n\n\tconstructor()\n\t{\n\t\tthrow new Error('You cannot make an instance of MenuManager.');\n\t}\n\n\tstatic show(...args)\n\t{\n\t\tif (this.currentItem !== null)\n\t\t{\n\t\t\tthis.currentItem.popupWindow.close();\n\t\t}\n\n\t\tthis.currentItem = this.create.apply(this, args);\n\t\tthis.currentItem.popupWindow.show();\n\t}\n\n\tstatic create(options: MenuOptions)\n\t{\n\t\tlet menuId = null;\n\n\t\t//Compatibility\n\t\tconst bindElement = arguments[1];\n\t\tconst menuItems = arguments[2];\n\t\tconst params = arguments[3];\n\n\t\tif (Type.isPlainObject(options) && !bindElement && !menuItems && !params)\n\t\t{\n\t\t\tmenuId = options.id;\n\t\t\tif (!Type.isStringFilled(menuId))\n\t\t\t{\n\t\t\t\tthrow new Error('BX.Main.Menu.create: \"id\" parameter is required.');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenuId = options;\n\t\t}\n\n\t\tif (!this.Data[menuId])\n\t\t{\n\t\t\tconst menu = new Menu(options, bindElement, menuItems, params);\n\t\t\tmenu.getPopupWindow().subscribe('onDestroy', () => {\n\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t});\n\n\t\t\tthis.Data[menuId] = menu;\n\t\t}\n\n\t\treturn this.Data[menuId];\n\t}\n\n\tstatic getCurrentMenu(): Menu | null\n\t{\n\t\treturn this.currentItem;\n\t}\n\n\tstatic getMenuById(id): Menu | null\n\t{\n\t\treturn this.Data[id] ? this.Data[id] : null;\n\t}\n\n\t/**\n\t * compatibility\n\t * @private\n\t */\n\tstatic onPopupDestroy(popupMenuWindow: Menu)\n\t{\n\t\tthis.destroy(popupMenuWindow.id);\n\t}\n\n\tstatic destroy(id)\n\t{\n\t\tconst menu = this.getMenuById(id);\n\t\tif (menu)\n\t\t{\n\t\t\tif (this.currentItem === menu)\n\t\t\t{\n\t\t\t\tthis.currentItem = null;\n\t\t\t}\n\n\t\t\tdelete this.Data[id];\n\t\t\tmenu.getPopupWindow().destroy();\n\t\t}\n\t}\n}","import Popup from '../popup/popup';\n\n/**\n * @deprecated use Popup class instead: import { Popup } from 'main.popup'\n */\nexport default class PopupWindow extends Popup\n{\n\n}","import Button from './button';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowButton extends Button\n{\n\n}","import Button from './button';\nimport { Dom } from 'main.core';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class ButtonLink extends Button\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName:\n\t\t\t\t\t\t'popup-window-button popup-window-button-link' +\n\t\t\t\t\t\t(this.className.length > 0 ? ' ' + this.className : '')\n\t\t\t\t\t,\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\ttext: this.text,\n\t\t\t\tevents: this.contextEvents\n\t\t\t}\n\t\t);\n\t}\n}","import ButtonLink from './buttonlink';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowButtonLink extends ButtonLink\n{\n\n}","import Button from './button';\nimport { Dom } from 'main.core';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class CustomButton extends Button\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: (this.className.length > 0 ? this.className : ''),\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\tevents: this.contextEvents,\n\t\t\t\ttext: this.text\n\t\t\t}\n\t\t);\n\t}\n}","import CustomButton from './custombutton';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowCustomButton extends CustomButton\n{\n\n}","import Menu from '../menu/menu';\n\n/**\n * @deprecated use Menu class instead: import { Menu } from 'main.popup'\n */\nexport default class PopupMenuWindow extends Menu\n{\n\n}","import MenuItem from '../menu/menu-item';\n\n/**\n * @deprecated use Menu.Item class instead: import { MenuItem } from 'main.popup'\n */\nexport default class PopupMenuItem extends MenuItem\n{\n\n}","import { Dom } from 'main.core';\nimport Popup from '../popup/popup';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\n/**\n * @deprecated\n */\nexport default class InputPopup\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = params.id || 'bx-inp-popup-' + Math.round(Math.random() * 1000000);\n\t\tthis.handler = params.handler || false;\n\t\tthis.values = params.values || false;\n\t\tthis.pInput = params.input;\n\t\tthis.bValues = !!this.values;\n\t\tthis.defaultValue = params.defaultValue || '';\n\t\tthis.openTitle = params.openTitle || '';\n\t\tthis.className = params.className || '';\n\t\tthis.noMRclassName = params.noMRclassName || 'ec-no-rm';\n\t\tthis.emptyClassName = params.noMRclassName || 'ec-label';\n\n\t\tconst _this = this;\n\t\tthis.curInd = false;\n\n\t\tif (this.bValues)\n\t\t{\n\t\t\tthis.pInput.onfocus = this.pInput.onclick = function(e) {\n\t\t\t\tif (this.value == _this.defaultValue)\n\t\t\t\t{\n\t\t\t\t\tthis.value = '';\n\t\t\t\t\tthis.className = _this.className;\n\t\t\t\t}\n\t\t\t\t_this.ShowPopup();\n\t\t\t\treturn e.preventDefault();\n\t\t\t};\n\n\t\t\tthis.pInput.onblur = function() {\n\t\t\t\tif (_this.bShowed)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t_this.ClosePopup(true);\n\t\t\t\t\t}, 200);\n\t\t\t\t}\n\t\t\t\t_this.OnChange();\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pInput.className = this.noMRclassName;\n\t\t\tthis.pInput.onblur = this.OnChange.bind(this);\n\t\t}\n\t}\n\n\tShowPopup()\n\t{\n\t\tif (this.bShowed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst _this = this;\n\t\tif (!this.oPopup)\n\t\t{\n\t\t\tconst pWnd = Dom.create('DIV', { props: { className: 'bxecpl-loc-popup ' + this.className } });\n\n\t\t\tfor (let i = 0, l = this.values.length; i < l; i++)\n\t\t\t{\n\t\t\t\tconst pRow = pWnd.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: { id: 'bxecmr_' + i },\n\t\t\t\t\ttext: this.values[i].NAME,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tmouseover: function() {\n\t\t\t\t\t\t\tDom.addClass(this, 'bxecplloc-over');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmouseout: function() {\n\t\t\t\t\t\t\tDom.removeClass(this, 'bxecplloc-over');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\tconst ind = this.id.substr('bxecmr_'.length);\n\t\t\t\t\t\t\t_this.pInput.value = _this.values[ind].NAME;\n\t\t\t\t\t\t\t_this.curInd = ind;\n\t\t\t\t\t\t\t_this.OnChange();\n\t\t\t\t\t\t\t_this.ClosePopup(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tif (this.values[i].DESCRIPTION)\n\t\t\t\t{\n\t\t\t\t\tpRow.title = this.values[i].DESCRIPTION;\n\t\t\t\t}\n\t\t\t\tif (this.values[i].CLASS_NAME)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(pRow, this.values[i].CLASS_NAME);\n\t\t\t\t}\n\n\t\t\t\tif (this.values[i].URL)\n\t\t\t\t{\n\t\t\t\t\tpRow.appendChild(Dom.create('a', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\thref: this.values[i].URL,\n\t\t\t\t\t\t\tclassName: 'bxecplloc-view',\n\t\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t\t\ttitle: this.openTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.oPopup = new Popup(this.id, this.pInput, {\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetTop: 1,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcontent: pWnd,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: this.ClosePopup.bind(this)\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.oPopup.show();\n\t\tthis.pInput.select();\n\t\tthis.bShowed = true;\n\n\t\tEventEmitter.emit(this, 'onInputPopupShow', new BaseEvent({ compatData: [this] }));\n\t}\n\n\tClosePopup(bClosePopup)\n\t{\n\t\tthis.bShowed = false;\n\n\t\tif (this.pInput.value === '')\n\t\t{\n\t\t\tthis.OnChange();\n\t\t}\n\n\t\tEventEmitter.emit(this, 'onInputPopupClose', new BaseEvent({ compatData: [this] }));\n\n\t\tif (bClosePopup === true)\n\t\t{\n\t\t\tthis.oPopup.close();\n\t\t}\n\t}\n\n\tOnChange()\n\t{\n\t\tlet val = this.pInput.value;\n\t\tif (this.bValues)\n\t\t{\n\t\t\tif (this.pInput.value == '' || this.pInput.value == this.defaultValue)\n\t\t\t{\n\t\t\t\tthis.pInput.value = this.defaultValue;\n\t\t\t\tthis.pInput.className = this.emptyClassName;\n\t\t\t\tval = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pInput.className = '';\n\t\t\t}\n\t\t}\n\n\t\tif (isNaN(parseInt(this.curInd)) || this.curInd !== false && val != this.values[this.curInd].NAME)\n\t\t{\n\t\t\tthis.curInd = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.curInd = parseInt(this.curInd);\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\t'onInputPopupChanged',\n\t\t\tnew BaseEvent({ compatData: [this, this.curInd, val] })\n\t\t);\n\n\t\tif (this.handler && typeof this.handler == 'function')\n\t\t{\n\t\t\tthis.handler({ ind: this.curInd, value: val });\n\t\t}\n\t}\n\n\tSet(ind, val, bOnChange)\n\t{\n\t\tthis.curInd = ind;\n\t\tif (this.curInd !== false)\n\t\t{\n\t\t\tthis.pInput.value = this.values[this.curInd].NAME;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pInput.value = val;\n\t\t}\n\n\t\tif (bOnChange !== false)\n\t\t{\n\t\t\tthis.OnChange();\n\t\t}\n\t}\n\n\tGet(ind)\n\t{\n\t\tlet id = false;\n\t\tif (typeof ind == 'undefined')\n\t\t{\n\t\t\tind = this.curInd;\n\t\t}\n\n\t\tif (ind !== false && this.values[ind])\n\t\t{\n\t\t\tid = this.values[ind].ID;\n\t\t}\n\n\t\treturn id;\n\t}\n\n\tGetIndex(id)\n\t{\n\t\tfor (let i = 0, l = this.values.length; i < l; i++)\n\t\t{\n\t\t\tif (this.values[i].ID == id)\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tDeactivate(bDeactivate)\n\t{\n\t\tif (this.pInput.value == '' || this.pInput.value == this.defaultValue)\n\t\t{\n\t\t\tif (bDeactivate)\n\t\t\t{\n\t\t\t\tthis.pInput.value = '';\n\t\t\t\tthis.pInput.className = this.noMRclassName;\n\t\t\t}\n\t\t\telse if (this.oEC.bUseMR)\n\t\t\t{\n\t\t\t\tthis.pInput.value = this.defaultValue;\n\t\t\t\tthis.pInput.className = this.emptyClassName;\n\t\t\t}\n\t\t}\n\n\t\tthis.pInput.disabled = bDeactivate;\n\t}\n}","/*\n\n//ES6\nimport { Popup, PopupManager, CloseIconSize } from 'main.popup';\nconst popup = new Popup();\nPopupManager.create();\n\n//ES5\nvar popup = new BX.Main.Popup();\nBX.Main.PopupManager.create();\nBX.Main.Popup.CloseIconSize;\n\n//ES6\nimport { Menu, MenuItem, MenuManager } from 'main.popup';\nconst menu = new Menu();\nconst item = new MenuItem();\nMenuManager.create();\n\n//ES5\nvar menu = new BX.Main.Menu();\nvar item = new BX.Main.MenuItem();\nBX.Main.MenuManager.create();\n\n */\n\nimport Popup from './popup/popup';\nimport PopupManager from './popup/popup-manager';\nimport CloseIconSize from './popup/popup-close-icon-size';\nimport Menu from './menu/menu';\nimport MenuManager from './menu/menu-manager';\nimport MenuItem from './menu/menu-item';\nimport type { PopupOptions, PopupTarget, PopupTargetOptions, PopupAnimationOptions } from './popup/popup-types';\nimport { type MenuOptions, type MenuItemOptions } from './menu/menu-types';\nimport type PositionEvent from './popup/position-event';\n\nimport PopupWindow from './compatibility/popup-window';\nimport PopupWindowButton from './compatibility/popup-window-button';\nimport PopupWindowButtonLink from './compatibility/popup-window-button-link';\nimport PopupWindowCustomButton from './compatibility/popup-window-custom-button';\nimport PopupMenuWindow from './compatibility/popup-menu-window';\nimport PopupMenuItem from './compatibility/popup-menu-item';\nimport InputPopup from './compatibility/input-popup';\nimport Button from './compatibility/button';\nimport ButtonLink from './compatibility/buttonlink';\nimport CustomButton from './compatibility/custombutton';\n\nimport { Reflection } from 'main.core';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/popup.css';\n\nexport {\n\tPopup,\n\tMenu,\n\tMenuItem,\n\tPopupManager,\n\tMenuManager,\n\tCloseIconSize,\n};\n\nexport type {\n\tPopupOptions,\n\tPopupTarget,\n\tPopupTargetOptions,\n\tPopupAnimationOptions,\n\tMenuOptions,\n\tMenuItemOptions,\n\tPositionEvent,\n};\n\n//Compatibility\nexport {\n\tPopupWindow,\n\tPopupMenuWindow,\n\tPopupMenuItem,\n\tPopupManager as PopupWindowManager,\n\tMenuManager as PopupMenu,\n\tPopupWindowButton,\n\tPopupWindowButtonLink,\n\tPopupWindowCustomButton\n};\n\nconst BX = Reflection.namespace('BX');\n\n/** @deprecated use BX.Main.Popup or import { Popup } from 'main.popup' */\nBX.PopupWindow = Popup;\n\n/** @deprecated use BX.Main.PopupManager or import { PopupManager } from 'main.popup' */\nBX.PopupWindowManager = PopupManager;\n\n/** @deprecated use BX.Main.Menu or import { Menu } from 'main.popup' */\nBX.PopupMenuWindow = Menu;\n\n/** @deprecated use BX.Main.MenuManager or import { MenuManager } from 'main.popup' */\nBX.PopupMenu = MenuManager;\n\n/** @deprecated use BX.Main.MenuItem or import { MenuItem } from 'main.popup' */\nBX.PopupMenuItem = MenuItem;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowButton = Button;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowButtonLink = ButtonLink;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowCustomButton = CustomButton;\n\n/** @deprecated use another API */\nwindow.BXInputPopup = InputPopup;\n"],"names":["Button","params","popupWindow","text","id","className","events","contextEvents","eventName","Type","isFunction","bind","buttonNode","Dom","create","props","length","name","clean","adjust","isString","removeClass","addClass","PositionEvent","value","isNumber","BaseEvent","CloseIconSize","Object","freeze","LARGE","SMALL","aliases","onPopupWindowInit","namespace","onPopupWindowIsInitialized","onPopupFirstShow","onPopupShow","onAfterPopupShow","onPopupClose","onPopupAfterClose","onPopupDestroy","onPopupFullscreenLeave","onPopupFullscreenEnter","onPopupDragStart","onPopupDrag","onPopupDragEnd","onPopupResizeStart","onPopupResize","onPopupResizeEnd","EventEmitter","registerAliases","disabledScrolls","WeakMap","Popup","options","isPlainObject","option","defaultValue","isUndefined","defaultOptions","event","isDestroyed","autoHideHandler","_tryCloseByEvent","target","getPopupContainer","contains","keyCode","checkEscPressed","getZindex","close","setEventNamespace","arguments","popupId","bindElement","compatibleMode","isBoolean","isStringFilled","Text","getRandom","toLowerCase","emit","compatData","uniquePopupId","zIndex","parseInt","zIndexAbsolute","buttons","isArray","offsetTop","getOption","offsetLeft","firstShow","bordersWidth","bindElementPos","closeIcon","resizeIcon","angle","angleArrowElement","overlay","titleBar","bindOptions","autoHide","disableScroll","isScrollBlock","isAutoHideBinded","closeByEsc","isCloseByEscBinded","toFrontOnShow","cacheable","destroyed","fixed","width","height","minWidth","minHeight","maxWidth","maxHeight","padding","contentPadding","background","contentBackground","borderRadius","contentBorderRadius","setTargetContainer","targetContainer","dragOptions","cursor","callback","dragged","dragPageX","dragPageY","animationShowClassName","animationCloseClassName","animationCloseEventType","handleDocumentMouseMove","handleDocumentMouseUp","handleResizeWindow","handleResize","handleMove","onTitleMouseDown","handleFullScreen","subscribeFromOptions","popupClassName","darkMode","designSystemContext","Tag","render","values","includes","closeIconSize","handleCloseIconClick","style","contentContainer","popupContainer","getTargetContainer","append","zIndexComponent","ZIndexManager","register","zIndexOptions","buttonsContainer","contentColor","setContentColor","setAngle","setOverlay","setOffset","setBindElement","setTitleBar","setDraggable","draggable","setContent","content","setButtons","setWidth","setHeight","setMinWidth","setMinHeight","setMaxWidth","setMaxHeight","setResizeMode","resizable","setPadding","setContentPadding","setBorderRadius","setContentBorderRadius","setBackground","setContentBackground","setAnimation","animation","setCacheable","setToFrontOnShow","setFixed","setDesignSystemContext","contentNoPaddings","noAllPaddings","bindOnResize","Event","window","isElementNode","hasParent","isDomNode","parentNode","appendChild","isCompatibleMode","display","innerHTML","remove","ButtonClass","Reflection","getClass","newButtons","i","button","push","setContext","getId","top","left","clientX","clientY","pageX","pageY","bottom","isTargetDocumentBody","isFixed","getBoundingClientRect","getPosition","getPositionRelativeToTarget","windowSize","getWindowSize","windowScroll","getWindowScroll","popupWidth","offsetWidth","popupHeight","offsetHeight","forceTop","innerWidth","scrollLeft","innerHeight","scrollTop","element","offsetElement","offsetParent","elementRect","DOMRect","pageXOffset","pageYOffset","position","angleMinLeft","defaultOffset","offset","angleLeftOffset","Math","max","minOffset","maxOffset","min","marginLeft","removeProperty","setWidthProperty","setHeightProperty","property","indexOf","getResizableContainer","getContentContainer","overflowX","classList","add","getTitleContainer","Browser","isIE11","toKebabCase","hasOtherProps","some","prop","getPropertyValue","overflowY","radius","setProperty","color","backgroundColor","flag","mode","handleResizeMouseDown","context","newTargetContainer","document","body","unregister","_startDrag","resizeContentPos","resizeContentOffset","offsetX","offsetY","scrollWidth","documentElement","getMinWidth","getMinHeight","getMaxWidth","getMaxHeight","isTopOrBottomAngle","enable","bindClosingByEsc","unbindClosingByEsc","ownerDocument","handleDocumentKeyUp","unbind","bindAutoHide","unbindAutoHide","isShown","handleContainerClick","hasOverlay","handleAutoHide","tryCloseByEvent","setTimeout","stopPropagation","handleOverlayClick","resizeOverlay","getZIndexComponent","opacity","parseFloat","toPrecision","blur","overlayTimeout","clearInterval","setInterval","scrollHeight","clientHeight","getZIndex","disable","showOverlay","shouldFrontOnShow","bringToFront","adjustPosition","animateOpening","animateClosing","hideOverlay","isCacheable","destroy","show","addEventListener","handleTransitionEnd","hasClass","removeEventListener","showClassName","closeClassName","closeAnimationType","animationName","unbindAll","removeOverlay","getBindElementPos","forceBindPosition","bindElementVanished","angleTopOffset","forceLeft","bindLeft","isBottomAngle","isTopAngle","getAngleHeight","fullscreenStatus","cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","requestFullScreen","mozRequestFullScreen","webkitRequestFullScreen","console","log","restrict","floatWidth","floatHeight","setCapture","ondrag","onselectstart","MozUserSelect","preventDefault","releaseCapture","popups","get","Set","set","size","positionTopXOffset","popupZindex","popupOverlayZindex","angleMaxLeft","angleMinRight","angleMaxRight","angleMinBottom","angleMaxBottom","angleMinTop","angleMaxTop","escCallbackIndex","escCallback","PopupManager","Error","compatMode","getPopupById","subscribe","handlePopupShow","handlePopupClose","getTarget","subscribeOnce","handlePopupDestroy","_popups","forEach","popup","error","filter","_currentPopup","getPopups","handleOnAfterInit","onSubMenuShow","onSubMenuClose","reEscape","escapeEntities","encodeSafe","replace","item","MenuItem","allowHtml","html","match","warn","getText","title","delimiter","href","dataset","menuShowDelay","subMenuOffsetX","_items","items","disabled","onclick","menuWindow","subMenuWindow","layout","getLayout","hasOwnProperty","join","children","hasSubMenu","attrs","click","onItemClick","isDisabled","onItemMouseEnter","onItemMouseLeave","getTextContainer","outerHTML","getMenuWindow","getPopupWindow","addSubMenu","closeSiblings","closeChildren","adjustSubMenu","rootMenuWindow","getRootMenuWindow","rootOptions","assign","subMenuOptions","Menu","setParentMenuWindow","setParentMenuItem","handleSubMenuDestroy","clearSubMenuTimeout","siblings","getMenuItems","closeSubMenu","destroyChildren","destroySubMenu","itemRect","getPopupPadding","angleOffset","anglePosition","popupBottom","isGlobalContext","clientWidth","exceeded","roundOffset","ceil","rect","popupPadding","menuContainer","menu","getContainer","call","mouseEvent","data","thisArg","isDefaultPrevented","subMenuTimeout","showSubMenu","clearTimeout","menuItems","itemsContainer","parentMenuWindow","parentMenuItem","addMenuItemInternal","__createPopup","domItems","itemLayout","defaults","onClose","onDestroy","containsTarget","el","getSubMenu","parentMenu","root","parent","getParentMenuWindow","parentItem","menuItemJson","targetItemId","menuItem","targetItem","getMenuItem","targetLayout","insertBefore","setMenuWindow","getMenuItemPosition","splice","itemId","destroyEmptyPopup","getParentMenuItem","removeChild","MenuManager","currentItem","args","apply","menuId","Data","popupMenuWindow","getMenuById","PopupWindow","PopupWindowButton","ButtonLink","PopupWindowButtonLink","CustomButton","PopupWindowCustomButton","PopupMenuWindow","PopupMenuItem","InputPopup","round","random","handler","pInput","input","bValues","openTitle","noMRclassName","emptyClassName","_this","curInd","onfocus","e","ShowPopup","onblur","bShowed","ClosePopup","OnChange","oPopup","pWnd","l","pRow","NAME","mouseover","mouseout","ind","substr","DESCRIPTION","CLASS_NAME","URL","lightShadow","select","bClosePopup","val","isNaN","bOnChange","ID","bDeactivate","oEC","bUseMR","BX","PopupWindowManager","PopupMenu","BXInputPopup"],"mappings":"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"}