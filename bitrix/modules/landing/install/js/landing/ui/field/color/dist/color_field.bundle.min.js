this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};this.BX.Landing.UI=this.BX.Landing.UI||{};(function(e,t,i,s,o,a,n,r,l,c,h,u){"use strict";const g=/^rgba? ?\((\d{1,3})[, ]+(\d{1,3})[, ]+(\d{1,3})([, ]+([\d\.]{1,5}))?\)$/i;function d(e){return!!e.match(g)}const p=/^#([\da-f]{3}){1,2}$/i;function m(e){return!!e.trim().match(p)}const v=/^hsla?\((\d{1,3}), ?(\d{1,3})%, ?(\d{1,3})%(, ?([\d .]+))?\)/i;function f(e){return!!e.trim().match(v)}function C(e){if(e.length===4){const t=parseInt(`0x${e[1]}${e[1]}`,16);const i=parseInt(`0x${e[2]}${e[2]}`,16);const s=parseInt(`0x${e[3]}${e[3]}`,16);return{r:t,g:i,b:s}}if(e.length===7){const t=parseInt(`0x${e[1]}${e[2]}`,16);const i=parseInt(`0x${e[3]}${e[4]}`,16);const s=parseInt(`0x${e[5]}${e[6]}`,16);return{r:t,g:i,b:s}}return{r:255,g:255,b:255}}function b(e){const t=e.r/255;const i=e.g/255;const s=e.b/255;const o=Math.max(t,i,s);const a=Math.min(t,i,s);let n,r,l=(o+a)/2;if(o===a){n=r=0}else{const e=o-a;r=l>.5?e/(2-o-a):e/(o+a);switch(o){case t:n=(i-s)/e+(i<s?6:0);break;case i:n=(s-t)/e+2;break;case s:n=(t-i)/e+4;break}n*=.6}return{h:Math.round(n*100),s:Math.round(r*100),l:Math.round(l*100),a:"a"in e?e.a:1}}function y(e){const t=C(e.trim());return b(t)}function A(e){let t=e.r.toString(16);let i=e.g.toString(16);let s=e.b.toString(16);if(t.length===1){t="0"+t}if(i.length===1){i="0"+i}if(s.length===1){s="0"+s}return"#"+t+i+s}function E(e){const t=e.h;const i=e.s/100;const s=e.l/100;let o=(1-Math.abs(2*s-1))*i;let a=o*(1-Math.abs(t/60%2-1));let n=s-o/2;let r=0;let l=0;let c=0;if(0<=t&&t<60){r=o;l=a;c=0}else if(60<=t&&t<120){r=a;l=o;c=0}else if(120<=t&&t<180){r=0;l=o;c=a}else if(180<=t&&t<240){r=0;l=a;c=o}else if(240<=t&&t<300){r=a;l=0;c=o}else if(300<=t&&t<360){r=o;l=0;c=a}r=Math.round((r+n)*255);l=Math.round((l+n)*255);c=Math.round((c+n)*255);return{r:r,g:l,b:c}}function L(e){const t=E(e);return A(t)}function T(e){let t=e.trim().match(g);if(t.length>0){return b({r:u.Text.toNumber(t[1]),g:u.Text.toNumber(t[2]),b:u.Text.toNumber(t[3]),a:t[5]?u.Text.toNumber(t[5]):1})}}function P(e){let t=e.trim().match(v);if(t&&t.length>0){return{h:u.Text.toNumber(t[1]),s:u.Text.toNumber(t[2]),l:u.Text.toNumber(t[3]),a:t[5]?u.Text.toNumber(t[5]):1}}}const S=/^(var\()?((--[\w\d-]*?)(-opacity_([\d_]+)?)?)\)?$/i;function I(e){return!!e.trim().match(S)}function _(e){const t=e.trim().match(S);if(!!t){const e={full:t[2],name:t[3]};if(t[3]){const i="--primary-opacity-0_";const s="--primary-opacity-0";if(t[3].startsWith(s)&&!t[3].startsWith(i)){e.opacity=0}if(t[3].startsWith(i)){let s=t[3].substr(i.length);if(s.length===1&&s!==0){s=s/10}if(s.length===2){s=s/100}e.opacity=s}}if(t[5]){e.opacity=+parseFloat(t[5].replace("_",".")).toFixed(1)}return e}return null}const V={h:205,s:1,l:50,a:1};const O="cover";const N="scroll";const R=null;const D={url:null,size:O,attachment:N,overlay:R};class w{constructor(e){this.value=V;this.hex=null;this.cssVar=null;this.setValue(e)}getName(){if(this.hex){return this.getHex()+"_"+this.getOpacity()}const{h:e,s:t,l:i}=this.getHsl();return`${e}-${t}-${i}-${this.getOpacity()}`}setValue(e){if(u.Type.isObject(e)){if(e instanceof w){this.value=e.getHsla();this.cssVar=e.getCssVar();this.hex=e.getHexOriginal()}else{this.value={...this.value,...e}}}if(u.Type.isString(e)){if(f(e)){this.value=P(e)}else if(m(e)){this.value={...y(e),a:V.a};this.hex=e}else if(d(e)){this.value=T(e)}else if(I(e)){const t=_(e);const i="--primary";if(t!==null){this.cssVar=t.name;if("opacity"in t){this.cssVar=i;this.setValue(u.Dom.style(document.documentElement,this.cssVar));this.setOpacity(t.opacity)}else{this.setValue(u.Dom.style(document.documentElement,this.cssVar))}}}}this.value.h=Math.round(this.value.h);this.value.s=Math.round(this.value.s);this.value.l=Math.round(this.value.l);this.value.a=this.value.a.toFixed(2);const t=Math.round(this.value.a*100%5);if(t<3){this.value.a=(this.value.a*100-t)/100}else{this.value.a=(this.value.a*100-t+5)/100}return this}setOpacity(e){this.setValue({a:e});return this}lighten(e){this.value.l=Math.min(this.value.l+e,100);this.hex=null;return this}darken(e){this.value.l=Math.max(this.value.l-e,0);this.hex=null;return this}saturate(e){this.value.s=Math.min(this.value.s+e,100);this.hex=null;return this}desaturate(e){this.value.s=Math.max(this.value.s-e,0);this.hex=null;return this}adjustHue(e){this.value.h=(this.value.h+e)%360;return this}getHsl(){return{h:this.value.h,s:this.value.s,l:this.value.l}}getHsla(){const e=this.value.a||1;return{h:this.value.h,s:this.value.s,l:this.value.l,a:e}}getHex(){return this.hex||L(this.value)}getHexOriginal(){return this.hex}getOpacity(){var e;return(e=this.value.a)!=null?e:V.a}getCssVar(){return this.cssVar}getStyleString(){if(this.cssVar===null){if(this.hex&&this.getOpacity()===V.a){return this.hex}const{h:e,s:t,l:i,a:s}=this.value;return`hsla(${e}, ${t}%, ${i}%, ${s})`}else{let e=this.cssVar;if(this.value.a!==V.a){e=e+"-opacity-"+String(this.value.a).replace(".","_")}return`var(${e})`}}getStyleStringForOpacity(){const{h:e,s:t,l:i}=this.value;return`linear-gradient(to right, hsla(${e}, ${t}%, ${i}%, 0) 0%, hsla(${e}, ${t}%, ${i}%, 1) 100%)`}static compare(e,t){return e.getHsla().h===t.getHsla().h&&e.getHsla().s===t.getHsla().s&&e.getHsla().l===t.getHsla().l&&e.getHsla().a===t.getHsla().a&&e.cssVar===t.cssVar}static getMedian(e,t){return new w({h:(e.getHsla().h+t.getHsla().h)/2,s:(e.getHsla().s+t.getHsla().s)/2,l:(e.getHsla().l+t.getHsla().l)/2,a:(e.getHsla().a+t.getHsla().a)/2})}getContrast(){let e=60;let t=this.getHsl().h*Math.PI/180;e+=Math.sin(t)*10+5;let i=e-45*this.getHsl().l/100;return new w(this.value).setValue({l:(this.getHsl().l+i)%100})}getLighten(){let{h:e,s:t,l:i}=this.getHsl();if(t>0){t+=(i-50)/100*60;t=Math.min(100,Math.max(0,i))}i+=10+20*i/100;i=Math.min(100,i);return new w({h:e,s:t,l:i})}}let B=e=>e,x;class k extends n.EventEmitter{constructor(e){super();this.cache=new u.Cache.MemoryCache}getLayout(){return this.cache.remember("layout",(()=>this.buildLayout()))}buildLayout(){return u.Tag.render(x||(x=B`
			<div class="landing-ui-field-base-control">
				Base control
			</div>
		`))}getValue(){return this.cache.remember("value",(()=>new w))}isNeedSetValue(e){return e!==this.getValue()}setValue(e){this.cache.set("value",e)}onChange(e){this.cache.delete("value");this.emit("onChange",{color:this.getValue()})}setActive(){u.Dom.addClass(this.getLayout(),k.ACTIVE_CLASS)}unsetActive(){u.Dom.removeClass(this.getLayout(),k.ACTIVE_CLASS)}isActive(){return u.Dom.hasClass(this.getLayout(),k.ACTIVE_CLASS)}}k.ACTIVE_CLASS="active";let F=e=>e,M,H,G,U;class $ extends k{constructor(){super();this.setEventNamespace("BX.Landing.UI.Field.Color.Hex");this.onInput=u.Runtime.debounce(this.onInput.bind(this),300);this.previewMode=false}buildLayout(){u.Event.bind(this.getInput(),"input",this.onInput);this.adjustColors($.DEFAULT_COLOR,$.DEFAULT_BG);const e=this.previewMode?"--preview":"--base";return u.Tag.render(M||(M=F`
			<div class="landing-ui-field-color-hex ${0}">
				${0}
				${0}
				${0}
			</div>
		`),e,this.getPreview(),this.getInput(),this.previewMode?this.getButton():"")}getPreview(){return this.cache.remember("preview",(()=>u.Tag.render(H||(H=F`<div class="landing-ui-field-color-hex-preview"></div>`))))}getInput(){return this.cache.remember("input",(()=>u.Tag.render(G||(G=F`<input type="text" name="hexInput" value="${0}" class="landing-ui-field-color-hex-input">`),$.DEFAULT_TEXT)))}onInput(){let e=this.getInput().value.replaceAll(/[^\da-f]/gi,"");e=e.slice(0,6);this.getInput().value=`#${e.toLowerCase()}`;if(this.getInput().value.length===7){this.emit("onValidInput",{value:e})}this.onChange()}onChange(e){const t=this.getInput().value.length===7&&m(this.getInput().value)?new w(this.getInput().value):null;this.setValue(t);this.cache.delete("value");this.emit("onChange",{color:t})}adjustColors(e,t){if(this.previewMode===true){u.Dom.style(this.getInput(),"color",e);u.Dom.style(this.getButton(),"fill",e);u.Dom.style(this.getInput(),"background","transparent");u.Dom.style(this.getPreview(),"display","none")}else{u.Dom.style(this.getPreview(),"background-color",t)}}focus(){if(this.getValue()===null){this.getInput().value="#"}this.getInput().focus()}unFocus(){this.getInput().blur()}getValue(){return this.cache.remember("value",(()=>this.getInput().value===$.DEFAULT_TEXT?null:new w(this.getInput().value)))}setValue(e){if(this.isNeedSetValue(e)){super.setValue(e);if(e===null){this.adjustColors($.DEFAULT_COLOR,$.DEFAULT_BG);this.unsetActive()}else{this.adjustColors(e.getContrast().getHex(),e.getHex());this.setActive()}if(h.PageObject.getRootWindow().document.activeElement!==this.getInput()){this.getInput().value=e===null?$.DEFAULT_TEXT:e.getHex()}this.emit("onSetValue",{color:e===null?$.DEFAULT_BG:e.getHex()})}}setActive(){u.Dom.addClass(this.getInput(),$.ACTIVE_CLASS)}unsetActive(){u.Dom.removeClass(this.getInput(),$.ACTIVE_CLASS)}isActive(){return u.Dom.hasClass(this.getInput(),$.ACTIVE_CLASS)}setPreviewMode(e){this.previewMode=e}isPreviewMode(){return Boolean(this.previewMode)}getButton(){return this.cache.remember("editButton",(()=>u.Tag.render(U||(U=F`
				<svg class="landing-ui-field-color-hex-preview-btn" width="9" height="9" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M7.108 0l1.588 1.604L2.486 7.8.896 6.194 7.108 0zM.006 8.49a.166.166 0 00.041.158.161.161 0 00.16.042l1.774-.478L.484 6.715.006 8.49z"
						fill-rule="evenodd"/>
				</svg>
			`))))}}$.DEFAULT_TEXT="#hex";$.DEFAULT_COLOR="#000000";$.DEFAULT_BG="#eeeeee";let X=e=>e,Y,z;class j extends k{constructor(e){super();this.setEventNamespace("BX.Landing.UI.Field.Color.Spectrum");this.onPickerDragStart=this.onPickerDragStart.bind(this);this.onPickerDragMove=this.onPickerDragMove.bind(this);this.onPickerDragEnd=this.onPickerDragEnd.bind(this);this.onScroll=this.onScroll.bind(this);this.scrollContext=e.contentRoot;u.Event.bind(this.getLayout(),"mousedown",this.onPickerDragStart)}buildLayout(){return u.Tag.render(Y||(Y=X`
			<div class="landing-ui-field-color-spectrum">
				${0}
			</div>
		`),this.getPicker())}getPicker(){return this.cache.remember("picker",(()=>u.Tag.render(z||(z=X`<div class="landing-ui-field-color-spectrum-picker"></div>`))))}getPickerPos(){return{x:u.Text.toNumber(u.Dom.style(this.getPicker(),"left")),y:u.Text.toNumber(u.Dom.style(this.getPicker(),"top"))}}onPickerDragStart(e){if(e.ctrlKey||e.metaKey||e.button){return}const t=this.getLayout().ownerDocument.body;u.Event.bind(this.scrollContext,"scroll",this.onScroll);u.Event.bind(this.getLayout(),"mousemove",this.onPickerDragMove);u.Event.bind(this.getLayout(),"mouseup",this.onPickerDragEnd);u.Dom.addClass(t,"landing-ui-field-color-draggable");this.onScroll();this.showPicker();this.emit("onPickerDragStart",{color:this.getValue()});this.onPickerDragMove(e)}onPickerDragMove(e){if(e.target===this.getPicker()){return}this.setPickerPos(e.pageX,e.pageY);this.onChange()}onPickerDragEnd(){const e=this.getLayout().ownerDocument.body;u.Event.unbind(this.scrollContext,"scroll",this.onScroll);u.Event.unbind(this.getLayout(),"mousemove",this.onPickerDragMove);u.Event.unbind(this.getLayout(),"mouseup",this.onPickerDragEnd);u.Dom.removeClass(e,"landing-ui-field-color-draggable");this.emit("onPickerDragEnd",{color:this.getValue()})}onScroll(){this.cache.delete("layoutSize")}getLayoutRect(){const e=this.getLayout().ownerDocument;return this.cache.remember("layoutSize",(()=>{const t=this.getLayout().getBoundingClientRect();const i=e.documentElement.scrollTop||0;return{width:t.width,height:t.height,left:t.left,top:t.top+i}}))}setPickerPos(e,t){const{width:i,height:s,top:o,left:a}=this.getLayoutRect();let n=Math.min(Math.max(e-a,0),i);n=n>i/j.HUE_RANGE*j.HUE_RANGE_GRAY_THRESHOLD?i/j.HUE_RANGE*j.HUE_RANGE_GRAY_MIDDLE:n;u.Dom.style(this.getPicker(),{left:`${n}px`,top:`${Math.min(Math.max(t-o,0),s)}px`})}getValue(){return this.cache.remember("value",(()=>{if(u.Dom.hasClass(this.getPicker(),j.HIDE_CLASS)){return null}const e=this.getLayout().getBoundingClientRect().width;const t=this.getPickerPos().x/e*j.HUE_RANGE;const i=this.getLayout().getBoundingClientRect().height;const s=(1-this.getPickerPos().y/i)*100;if(isNaN(t)||isNaN(s)){return null}return new w({h:Math.min(t,j.HUE_RANGE_GRAY_THRESHOLD),s:t>=j.HUE_RANGE_GRAY_THRESHOLD?0:j.DEFAULT_SATURATION,l:s})}))}setValue(e){super.setValue(e);if(e!==null&&j.isSpectrumValue(e)){const{h:t,s:i,l:s}=e.getHsl();const o=i===0?j.HUE_RANGE_GRAY_MIDDLE/j.HUE_RANGE*100:t/j.HUE_RANGE*100;u.Dom.style(this.getPicker(),"left",`${o}%`);const a=100-s;u.Dom.style(this.getPicker(),"top",`${a}%`);this.showPicker()}else{this.hidePicker()}}hidePicker(){u.Dom.addClass(this.getPicker(),j.HIDE_CLASS)}showPicker(){u.Dom.removeClass(this.getPicker(),j.HIDE_CLASS)}isActive(){return this.getValue()!==null&&j.isSpectrumValue(this.getValue())}static isSpectrumValue(e){return e!==null&&(e.getHsl().s===j.DEFAULT_SATURATION||e.getHsl().s===0)}}j.DEFAULT_SATURATION=100;j.HUE_RANGE=375;j.HUE_RANGE_GRAY_THRESHOLD=360;j.HUE_RANGE_GRAY_MIDDLE=367;j.HIDE_CLASS="hidden";let W=e=>e,Z;class q extends n.EventEmitter{constructor(e={}){super();this.cache=new u.Cache.MemoryCache;this.setEventNamespace("BX.Landing.UI.Field.Color.Primary");u.Event.bind(this.getLayout(),"click",(()=>this.onClick()));if(e.content&&e.content==="var(--primary)"){this.setActive()}}getLayout(){return this.cache.remember("layout",(()=>u.Tag.render(Z||(Z=W`
				<div class="landing-ui-field-color-primary">
					<i class="landing-ui-field-color-primary-preview"></i>
					<span class="landing-ui-field-color-primary-text">
						${0}
					</span>
				</div>
			`),u.Loc.getMessage("LANDING_FIELD_COLOR-PRIMARY_TITLE"))))}getValue(){return this.cache.remember("value",(()=>new w(q.CSS_VAR)))}onClick(){this.setActive();this.emit("onChange",{color:this.getValue()})}setActive(){u.Dom.addClass(this.getLayout(),q.ACTIVE_CLASS)}unsetActive(){u.Dom.removeClass(this.getLayout(),q.ACTIVE_CLASS)}isActive(){return u.Dom.hasClass(this.getLayout(),q.ACTIVE_CLASS)}isPrimaryValue(e){return e!==null&&this.getValue().getCssVar()===e.getCssVar()}}q.ACTIVE_CLASS="active";q.CSS_VAR="--primary";function K(e){return new RegExp(J(e))}function J(e){return e.source.replace(/(^\^)|(\$$)/g,"")}const Q=/^(linear|radial)-gradient\(.*\)$/i;const ee=/^(linear|radial)-gradient\(.*?((\d)+deg).*?\)$/gi;const te=J(p);const ie=new RegExp("((rgba|hsla)?\\([\\d% .,]+\\)|transparent|"+te+")+","ig");function se(e){return!!e.trim().match(Q)}class oe{constructor(e){this.value={from:new w("#ffffff"),to:new w(q.CSS_VAR),angle:oe.DEFAULT_ANGLE,type:oe.DEFAULT_TYPE};this.setValue(e)}getName(){return this.value.from.getName()+"_"+this.value.to.getName()+"_"+this.getAngle()+"_"+this.getType()}setValue(e){if(u.Type.isObject(e)){if(e instanceof oe){this.value.from=new w(e.getFrom());this.value.to=new w(e.getTo());this.value.angle=e.getAngle();this.value.type=e.getType()}else{if("from"in e){this.value.from=new w(e.from)}if("to"in e){this.value.to=new w(e.to)}if("angle"in e){this.value.angle=u.Text.toNumber(e.angle)}if("type"in e){this.value.type=e.type}}}else if(u.Type.isString(e)&&se(e)){this.parseGradientString(e)}return this}setOpacity(e){this.value.from.setOpacity(e);this.value.to.setOpacity(e);return this}parseGradientString(e){const t=e.trim().match(Q);if(!!t){this.setValue({type:t[1]})}const i=e.trim().match(ee);if(!!i){this.setValue({angle:i[2]})}const s=e.trim().match(ie);if(s&&s.length>0){this.setValue({from:new w(s[0])});this.setValue({to:new w(s[s.length-1])})}}getFrom(){return this.value.from}getTo(){return this.value.to}getAngle(){return this.value.angle}setAngle(e){if(u.Type.isNumber(e)){this.value.angle=Math.min(Math.max(e,0),360)}return this}getType(){return this.value.type}setType(e){if(e===oe.TYPE_RADIAL||e===oe.TYPE_LINEAR){this.value.type=e}return this}getOpacity(){var e;return(e=(this.value.from.getOpacity()+this.value.to.getOpacity())/2)!=null?e:V.a}getStyleString(){const e=this.value.angle;const t=this.value.type;const i=this.value.from.getStyleString();const s=this.value.to.getStyleString();return t==="linear"?`linear-gradient(${e}deg, ${i} 0%, ${s} 100%)`:`radial-gradient(circle farthest-side at 50% 50%, ${i} 0%, ${s} 100%)`}getStyleStringForOpacity(){return`radial-gradient(at top left, ${this.value.from.getHex()}, transparent)`+`, radial-gradient(at bottom left, ${this.value.to.getHex()}, transparent)`}static compare(e,t,i=true){const s=w.compare(e.getFrom(),t.getFrom())&&w.compare(e.getTo(),t.getTo())||w.compare(e.getTo(),t.getFrom())&&w.compare(e.getFrom(),t.getTo());const o=i?e.getAngle()===t.getAngle()&&e.getType()===t.getType():true;return s&&o}}oe.TYPE_RADIAL="radial";oe.TYPE_LINEAR="linear";oe.DEFAULT_ANGLE=180;oe.DEFAULT_TYPE="linear";const ae="color";const ne="gradient";class re{static getDefaultPresets(){return re.cache.remember("default",(()=>{const e=[];re.defaultPresets.forEach((t=>{e.push({id:t.id,type:"color",items:t.items.map((e=>new w(y(e))))})}));return e}))}static getPrimaryColorPreset(){return this.cache.remember("primary",(()=>{const e={id:"defaultPrimary",items:[]};const t=new w(u.Dom.style(document.documentElement,"--primary").trim());e.items.push(new w(t));if(t.getHsl().s<=10){const i=t.getHsl().l>50?Math.ceil(t.getHsl().l/100*5):Math.floor(t.getHsl().l/100*5);const s=5-i;const o=t.getHsl().l/(i+1);const a=(100-t.getHsl().l)/(s+1);for(let s=1;s<=i;s++){e.items.push(new w(t).darken(o*s))}for(let i=1;i<=s;i++){e.items.push(new w(t).lighten(a*i))}const n=15;const r=15;const l=new w(re.BITRIX_COLOR);e.items[6]=new w(l);e.items[7]=new w(l.darken(n).saturate(r));e.items[8]=new w(l.darken(n).saturate(r));l.lighten(n*2).desaturate(r*2);e.items[9]=new w(l.lighten(n).desaturate(r));e.items[10]=new w(l.lighten(n).desaturate(r));l.darken(n*2).saturate(r*2);e.items[11]=new w(l).adjustHue(180)}else{const i=(90-t.getHsl().l)/3;const s=(t.getHsl().l-10)/3;const o=(90-t.getHsl().s)/3;const a=(t.getHsl().s-10)/3;e.items[1]=new w(t.darken(s).saturate(o));e.items[2]=new w(t.darken(s).saturate(o));e.items[3]=new w(t.darken(s).saturate(o));t.lighten(s*3).desaturate(o*3);e.items[4]=new w(t.desaturate(a).lighten(i));e.items[5]=new w(t.desaturate(a).lighten(i));e.items[11]=new w(t.desaturate(a).lighten(i));t.saturate(a*3).darken(i*3);e.items[7]=new w(t.adjustHue(40));e.items[8]=new w(t.adjustHue(-80));e.items[9]=new w(t.adjustHue(180));e.items[6]=new w(t.adjustHue(40));e.items[10]=new w(t.adjustHue(40))}return e}))}static getGradientByColorOptions(e){const t=[];const i=[[1,2],[1,4],[5,12],[1,8],[8,9],[1,9],[10,7],[7,11]];i.forEach((i=>{t.push(new oe({from:new w(e.items[i[0]-1]),to:new w(e.items[i[1]-1]),angle:oe.DEFAULT_ANGLE,type:oe.DEFAULT_TYPE}))}));return{type:ne,items:t}}}re.BITRIX_COLOR="#2fc6f6";re.cache=new u.Cache.MemoryCache;re.defaultPresets=[{id:"blackAndWhite",items:["#ffffff","#f2f2f2","#dbdbdb","#b5b5b5","#919191","#808080","#6e6e6e","#5c5c5c","#4a4a4a","#242424","#171717","#000000"]},{id:"agency",items:["#ff6366","#40191a","#803233","#bf4b4d","#e65a5c","#ffc1c2","#363643","#57dca3","#ee76ba","#ffa864","#eaeaec","#fadbdc"]},{id:"accounting",items:["#a5c33c","#384215","#6f8228","#8fa834","#b0cf40","#dae6ae","#4c4c4c","#5d84e6","#cd506b","#fe6466","#dfdfdf","#e9f0cf"]},{id:"app",items:["#4fd2c2","#1f524c","#379187","#46b8aa","#54dece","#c8f1ec","#6639b6","#e81c62","#9a69ca","#6279d8","#ffc337","#e9faf8"]},{id:"architecture",items:["#c94645","#4a1919","#8a2f2f","#b03c3c","#d64949","#eec3c3","#363643","#446d90","#a13773","#c98145","#eaeaec","#f9e8e7"]},{id:"business",items:["#3949a0","#232c61","#313e87","#3e4fad","#556ced","#d8d7dc","#14122c","#1d1937","#a03949","#2f295a","#c87014","#f4f4f5"]},{id:"charity",items:["#f5f219","#f58419","#f5cc19","#a8e32a","#f9f76a","#fcfbb6","#000000","#262e37","#74797f","#e569b1","#edeef0","#fefedf"]},{id:"construction",items:["#f7b70b","#382a02","#785905","#b88907","#dea509","#fdf1d1","#111111","#a3a3a3","#f7410b","#f70b4b","#d6dde9","#fef9ea"]},{id:"consulting",items:["#21a79b","#38afa5","#14665f","#1c8c83","#30f2e2","#a9ddd9","#ec4672","#58d400","#f0ac00","#2d6faf","#2da721","#e6f5f4"]},{id:"corporate",items:["#6ab8ee","#31556e","#4e86ad","#5fa3d4","#70c1fa","#d2e9f8","#36e2c0","#ffaa3c","#ee6a76","#ffa468","#5feb99","#ebf4fb"]},{id:"courses",items:["#6bda95","#2c593d","#4b9969","#5ebf83","#70e69d","#c2f0d3","#31556e","#ff947d","#738ed3","#f791ab","#ffb67d","#e2f8eb"]},{id:"event",items:["#f73859","#380d14","#781c2b","#b82a42","#de334f","#fdbbc6","#151726","#ffb553","#30d59b","#b265e0","#edeef0","#ffeaed"]},{id:"gym",items:["#6b7de0","#2f3661","#4d5aa1","#5f6fc7","#7284ed","#e4e8fa","#333333","#ffd367","#a37fe8","#e06b7d","#6dc1e0","#f4f6fd"]},{id:"lawyer",items:["#e74c3c","#69231b","#a8382c","#cf4536","#f55240","#f9d0cb","#4e4353","#5a505e","#e7863c","#38a27f","#e2e1e3","#fdeeec"]},{id:"photography",items:["#f7a700","#382600","#785200","#b87d00","#de9800","#fde8ba","#333333","#0b5aa0","#e93d18","#06c4ed","#3672a8","#fff6e3"]},{id:"restaurant",items:["#e6125d","#660829","#a60d43","#cc1052","#f21361","#facfde","#0eb88e","#00946f","#e04292","#9b12e6","#bfde00","#fef2f6"]},{id:"shipping",items:["#ff0000","#400000","#800000","#bf0000","#e60000","#ffb4b4","#333333","#ff822a","#d63986","#00ac6b","#ffb800","#fff3f3"]},{id:"spa",items:["#9dba04","#313b01","#667a02","#86a103","#a6c704","#e4ecb9","#ba7c04","#cf54bb","#049dba","#1d7094","#eead2f","#f2f6dd"]},{id:"travel",items:["#ee4136","#6e1f19","#ad3128","#d43c31","#fa4639","#fef1f0","#31353e","#3e434d","#ee8036","#428abc","#eaebec","#c3c4c7"]},{id:"wedding",items:["#d65779","#572431","#963e55","#bd4d6b","#e35d81","#f7dfe5","#af58a7","#6bc34b","#ec8c60","#50a098","#57b9d6","#fdf4f6"]}];let le=e=>e,ce,he;class ue extends n.EventEmitter{constructor(e){super();this.cache=new u.Cache.MemoryCache;this.setEventNamespace("BX.Landing.UI.Field.Color.Preset");this.id=e.id;this.type=e.type||ae;this.items=e.items;this.activeItem=null}getId(){return this.id}getGradientPreset(){const e=this.type===ne?{type:ne,items:this.items}:re.getGradientByColorOptions({items:this.items});return new ue(e)}getLayout(){return this.cache.remember("layout",(()=>u.Tag.render(ce||(ce=le`
				<div class="landing-ui-field-color-preset">
					${0}
				</div>
			`),this.items.map((e=>this.getItemLayout(e.getName()))))))}getItemLayout(e){return this.cache.remember(e,(()=>{const t=this.getItemByName(e);const i=u.Type.isString(t)?t:t.getStyleString();const s=u.Tag.render(he||(he=le`
				<div
					class="landing-ui-field-color-preset-item"
					style="background: ${0}"
					data-name="${0}"
				></div>
			`),i,e);u.Event.bind(s,"click",this.onItemClick.bind(this));return s}))}getItemByName(e){return this.items.find((t=>e===t.getName()))||null}isPresetValue(e){if(e===null){return false}return this.items.some((t=>{if(t instanceof w&&e instanceof w){return w.compare(t,new w(e).setOpacity(1))}else if(t instanceof oe&&e instanceof oe){return oe.compare(t,e,false)}return false}))}onItemClick(e){this.setActiveItem(e.currentTarget.dataset.name);let t=null;if(this.activeItem!==null){t=this.activeItem instanceof oe?new oe(this.activeItem):new w(this.activeItem)}this.emit("onChange",{color:t})}setActiveItem(e){this.activeItem=this.getItemByName(e);this.items.forEach((t=>{const i=t.getName();if(e===i){u.Dom.addClass(this.getItemLayout(i),ue.ACTIVE_CLASS)}else{u.Dom.removeClass(this.getItemLayout(i),ue.ACTIVE_CLASS)}}))}setActiveValue(e){if(e!==null){if(e instanceof oe){this.setActiveItem(new oe(e).setAngle(oe.DEFAULT_ANGLE).setType(oe.DEFAULT_TYPE).getName())}else{this.setActiveItem(new w(e).setOpacity(1).getName())}}}setActiveHex(e){this.items.forEach((t=>{const i=t.getHex();if(e===i){this.setActiveItem(t.getName())}}))}unsetActive(){this.items.forEach((e=>{u.Dom.removeClass(this.getItemLayout(e.getName()),ue.ACTIVE_CLASS)}))}isActive(){return this.items.some((e=>u.Dom.hasClass(this.getItemLayout(e.getName()),ue.ACTIVE_CLASS)))}}ue.ACTIVE_CLASS="active";let ge=e=>e,de,pe,me,ve,fe;class Ce extends n.EventEmitter{constructor(e){super();this.presets={};this.activeId=null;this.cache=new u.Cache.MemoryCache;this.setEventNamespace("BX.Landing.UI.Field.Color.PresetCollection");this.popupId="presets-popup_"+u.Text.getRandom();this.popupTargetContainer=e.contentRoot;this.onPresetClick=this.onPresetClick.bind(this);u.Event.bind(this.getOpenButton(),"click",(()=>{this.getPopup().toggle()}));this.onPresetChangeGlobal=this.onPresetChangeGlobal.bind(this);n.EventEmitter.subscribe("BX.Landing.UI.Field.Color.PresetCollection:onChange",this.onPresetChangeGlobal)}addDefaultPresets(){this.addPreset(re.getPrimaryColorPreset());re.getDefaultPresets().map((e=>{this.addPreset(e)}))}addPreset(e){this.cache.delete("popupLayout");if(!Object.keys(this.presets).length||!(e.id in this.presets)){this.presets[e.id]=e}}getGlobalActiveId(){return Ce.globalActiveId}getActiveId(){return this.getGlobalActiveId()||this.getDefaultPreset().getId()}getActivePreset(){return this.getPresetById(this.getActiveId())}getDefaultPreset(){return Object.keys(this.presets).length?this.getPresetById(Object.keys(this.presets)[0]):null}getPresetById(e){if(e in this.presets){return this.cache.remember(e,(()=>new ue(this.presets[e])))}else{return null}}getAllPresets(){return Object.keys(this.presets).map((e=>this.getPresetById(e))).filter(Boolean)}getPresetByItemValue(e){if(e===null){return null}for(let t in this.presets){const i=this.getPresetById(t);if(i&&e instanceof w){if(i.isPresetValue(e)){return i}}else if(i&&e instanceof oe){if(i.getGradientPreset().isPresetValue(e)){return i}}}return null}getLayout(){return this.cache.remember("value",(()=>u.Tag.render(de||(de=ge`
				<div class="landing-ui-field-color-presets">
					<div class="landing-ui-field-color-presets-left">
						<span class="landing-ui-field-color-presets-title">
							${0}
						</span>
					</div>
					<div class="landing-ui-field-color-presets-right">${0}</div>
				</div>
			`),u.Loc.getMessage("LANDING_FIELD_COLOR-PRESETS_TITLE"),this.getOpenButton())))}getOpenButton(){return this.cache.remember("openButton",(()=>u.Tag.render(pe||(pe=ge`<span class="landing-ui-field-color-presets-open">
				${0}
			</span>`),u.Loc.getMessage("LANDING_FIELD_COLOR-PRESETS_MORE"))))}getTitleContainer(){return this.cache.remember("titleContainer",(()=>this.getLayout().querySelector(".landing-ui-field-color-presets-left")))}getPopup(){return this.cache.remember("popup",(()=>s.PopupManager.create({id:this.popupId,className:"presets-popup",autoHide:true,bindElement:this.getOpenButton(),bindOptions:{forceTop:true,forceLeft:true},width:280,offsetLeft:-200,content:this.getPopupLayout(),closeByEsc:true,targetContainer:this.popupTargetContainer})))}getPopupLayout(){return this.cache.remember("popupLayout",(()=>{const e=u.Tag.render(me||(me=ge`<div class="landing-ui-field-color-presets-popup">
				<div class="landing-ui-field-color-presets-popup-title">
					${0}
				</div>
				<div class="landing-ui-field-color-presets-popup-inner"></div>
			</div>`),u.Loc.getMessage("LANDING_FIELD_COLOR-PRESETS_MORE_COLORS"));const t=e.querySelector(".landing-ui-field-color-presets-popup-inner");for(const e in this.presets){const i=this.getPresetLayout(e);if(e===this.getActiveId()){u.Dom.addClass(i,Ce.ACTIVE_CLASS);this.activeId=e}u.Event.bind(i,"click",this.onPresetClick);u.Dom.append(i,t)}return e}))}getPresetLayout(e){return this.cache.remember(e+"layout",(()=>u.Tag.render(ve||(ve=ge`
				<div class="landing-ui-field-color-presets-preset" data-id="${0}">
					${0}
				</div>
			`),e,this.presets[e].items.map((e=>u.Tag.render(fe||(fe=ge`<div
								class="landing-ui-field-color-presets-preset-item"
								style="background: ${0}"
							></div>`),u.Type.isString(e)?e:e.getStyleString()))))))}onPresetClick(e){this.getPopup().close();this.setActiveItem(e.currentTarget.dataset.id);this.emit("onChange",{presetId:this.getActiveId()})}onPresetChangeGlobal(e){if(e.getData().presetId!==this.activeId){this.setActiveItem(e.getData().presetId);this.emit("onChange",e)}}setActiveItem(e){if(e!==null&&e!==this.activeId){Ce.globalActiveId=e;this.activeId=e;for(const t in this.presets){u.Dom.removeClass(this.getPresetLayout(t),Ce.ACTIVE_CLASS);if(t===e){u.Dom.addClass(this.getPresetLayout(t),Ce.ACTIVE_CLASS)}}}}unsetActive(){for(const e in this.presets){u.Dom.removeClass(this.getPresetLayout(e),Ce.ACTIVE_CLASS)}}}Ce.globalActiveId=null;Ce.ACTIVE_CLASS="active";let be=e=>e,ye,Ae;class Ee extends n.EventEmitter{constructor(){super();this.cache=new u.Cache.MemoryCache;this.setEventNamespace("BX.Landing.UI.Field.Color.Recent")}getLayout(){return this.getLayoutContainer()}getLayoutContainer(){return this.cache.remember("layout",(()=>u.Tag.render(ye||(ye=be`<div class="landing-ui-field-color-recent"></div>`))))}static initItems(){return new Promise((e=>{if(Ee.itemsLoaded){e()}else{l.Backend.getInstance().action("Utils::getUserOption",{name:Ee.USER_OPTION_NAME}).then((t=>{if(t&&u.Type.isString(t.items)){Ee.items=[];t.items.split(",").forEach((e=>{if(m(e)&&Ee.items.length<Ee.MAX_ITEMS){Ee.items.push(e)}}));Ee.itemsLoaded=true}e()}))}}))}buildItemsLayout(e=null){if(e){this.activeHex=e}u.Dom.clean(this.getLayoutContainer());this.itemElements=[];Ee.items.forEach((e=>{if(m(e)){const t=this.activeHex===e;const i=u.Tag.render(Ae||(Ae=be`
					<div 
						class="landing-ui-field-color-recent-item${0}"
						style="background:${0}"
						data-value="${0}"
					></div>
				`),t?" active":"",e,e);this.itemElements.push(i);u.Event.bind(i,"click",(()=>this.onItemClick(event,i)));u.Dom.append(i,this.getLayoutContainer())}}));return this}onItemClick(e,t){this.itemElements.forEach((e=>BX.Dom.removeClass(e,"active")));BX.Dom.addClass(t,"active");this.activeHex=t.dataset.value;this.emit("onChange",{hex:e.currentTarget.dataset.value})}addItem(e){if(m(e)){const t=Ee.items.indexOf(e);if(t!==-1){Ee.items.splice(t,1)}Ee.items.unshift(e);if(Ee.items.length>Ee.MAX_ITEMS){Ee.items.splice(Ee.MAX_ITEMS)}this.buildItemsLayout();this.saveItems()}return this}saveItems(){if(Ee.items.length>0){BX.userOptions.save("landing",Ee.USER_OPTION_NAME,"items",Ee.items)}return this}}Ee.USER_OPTION_NAME="color_field_recent_colors";Ee.MAX_ITEMS=24;Ee.items=[];Ee.itemsLoaded=false;let Le=e=>e,Te,Pe,Se,Ie,_e,Ve,Oe,Ne;class Re extends n.EventEmitter{constructor(){super();this.setEventNamespace("BX.Landing.UI.Field.Color.Favourite");this.cache=new u.Cache.MemoryCache;this.itemsContainer=null;this.isEditMode=false;this.activeHex=null;this.itemElements=[];this.buttonChange=null;this.buttonSave=null}getLayout(){return this.getLayoutContainer()}getLayoutContainer(){this.buttonChange=u.Tag.render(Te||(Te=Le`
			<div class="landing-ui-field-color-favourite-head-button-change">
				${0}
			</div>
		`),u.Loc.getMessage("LANDING_FIELD_COLOR_FAVOURITES_BUTTON_CHANGE"));this.buttonSave=u.Tag.render(Pe||(Pe=Le`
			<div class="landing-ui-field-color-favourite-head-button-save" hidden>
				${0}
			</div>
		`),u.Loc.getMessage("LANDING_FIELD_COLOR_FAVOURITES_BUTTON_SAVE"));u.Event.bind(this.buttonChange,"click",(()=>this.onChangeButtonClick()));u.Event.bind(this.buttonSave,"click",(()=>this.onSaveButtonClick()));return this.cache.remember("layout",(()=>{this.itemsContainer=u.Tag.render(Se||(Se=Le`<div class="landing-ui-field-color-favourite-colors view-mode"></div>`));u.Dom.append(this.getItemsLayout(),this.itemsContainer);return u.Tag.render(Ie||(Ie=Le`
				<div>
					<div class="landing-ui-field-color-favourite-head">
						<div class="landing-ui-field-color-favourite-head-title">
							${0}
						</div>
						<div class="landing-ui-field-color-favourite-head-buttons">
							${0}
							${0}
						</div>
					</div>
					${0}
				</div>
			`),u.Loc.getMessage("LANDING_FIELD_COLOR_FAVOURITES_TITLE"),this.buttonChange,this.buttonSave,this.itemsContainer)}))}static initItems(){return new Promise((e=>{if(Re.itemsLoaded){e()}else{l.Backend.getInstance().action("Utils::getUserOption",{name:Re.USER_OPTION_NAME}).then((t=>{if(t&&u.Type.isString(t.items)){Re.items=[];t.items.split(",").forEach((e=>{if(m(e)&&Re.items.length<Re.MAX_ITEMS){Re.items.push(e)}}));Re.itemsLoaded=true}e()})).catch((()=>{e()}))}}))}getItemsLayout(e=null){const t=u.Tag.render(_e||(_e=Le`
			<div class="landing-ui-field-color-favourite-item-container">
				<div class="landing-ui-field-color-favourite-item-add"></div>
			</div>
		`));u.Event.bind(t,"click",(()=>this.onAddButtonClick()));if(e){this.setActiveHex(e)}this.itemElements=[];const i=u.Tag.render(Ve||(Ve=Le`<div class="landing-ui-field-color-favourite-items-container"></div>`));u.Dom.append(t,i);Re.items.forEach((e=>{if(m(e)){const t=this.activeHex===e;const s=u.Tag.render(Oe||(Oe=Le`
					<div class="landing-ui-field-color-favourite-item-remove-button"${0}></div>
				`),this.isEditMode?"":" hidden");const o=u.Tag.render(Ne||(Ne=Le`
					<div class="landing-ui-field-color-favourite-item-container ${0}">
						<div 
							class="landing-ui-field-color-favourite-item"
							style="background:${0}"
							data-value="${0}"
						></div>
						${0}
					</div>
				`),t?" active":"",e,e,s);this.itemElements.push(o);const a=o.querySelector(".landing-ui-field-color-favourite-item");if(a){u.Event.bind(a,"click",(e=>this.onItemClick(e,o)))}if(s){u.Event.bind(s,"click",(t=>this.onRemoveButtonClick(t,e,o)))}u.Dom.append(o,i)}}));return i}buildItemsLayout(e=null){if(e){this.setActiveHex(e)}if(this.itemsContainer){u.Dom.clean(this.itemsContainer);u.Dom.append(this.getItemsLayout(),this.itemsContainer)}}onItemClick(e,t){this.itemElements.forEach((e=>BX.Dom.removeClass(e,"active")));BX.Dom.addClass(t,"active");this.setActiveHex(t.dataset.value);this.emit("onSelectColor",{hex:e.currentTarget.dataset.value})}onAddButtonClick(){if(this.activeHex!==null){this.addItem(this.activeHex)}this.emit("onAddColor",{hex:this.activeHex})}onRemoveButtonClick(e,t){e.stopPropagation();this.removeItem(t);this.emit("onRemoveColor",{hex:t})}onChangeButtonClick(){this.emit("onEditColors");this.isEditMode=true;BX.Dom.removeClass(this.itemsContainer,Re.MODE_CLASSES.VIEW);BX.Dom.addClass(this.itemsContainer,Re.MODE_CLASSES.EDIT);if(this.buttonChange&&this.buttonSave){this.buttonChange.setAttribute("hidden","true");this.buttonSave.removeAttribute("hidden")}const e=this.itemsContainer?this.itemsContainer.querySelectorAll(".landing-ui-field-color-favourite-item-remove-button"):[];e.forEach((e=>e.removeAttribute("hidden")))}onSaveButtonClick(){this.emit("onSaveColors");this.isEditMode=false;BX.Dom.addClass(this.itemsContainer,Re.MODE_CLASSES.VIEW);BX.Dom.removeClass(this.itemsContainer,Re.MODE_CLASSES.EDIT);if(this.buttonChange&&this.buttonSave){this.buttonSave.setAttribute("hidden","true");this.buttonChange.removeAttribute("hidden")}const e=this.itemsContainer?this.itemsContainer.querySelectorAll(".landing-ui-field-color-favourite-item-remove-button"):[];e.forEach((e=>e.setAttribute("hidden","")))}addItem(e){if(m(e)){const t=Re.items.indexOf(e);if(t!==-1){Re.items.splice(t,1)}Re.items.unshift(e);if(Re.items.length>Re.MAX_ITEMS){Re.items.splice(Re.MAX_ITEMS)}this.buildItemsLayout(e);this.saveItems()}return this}removeItem(e){if(m(e)){const t=Re.items.indexOf(e);if(t!==-1){Re.items.splice(t,1)}this.buildItemsLayout();this.saveItems()}return this}saveItems(){if(Re.items.length>0){BX.userOptions.save("landing",Re.USER_OPTION_NAME,"items",Re.items)}return this}setActiveHex(e){this.activeHex=e}}Re.USER_OPTION_NAME="color_field_favourite_colors";Re.MAX_ITEMS=80;Re.items=[];Re.itemsLoaded=false;Re.MODE_CLASSES={VIEW:"view-mode",EDIT:"edit-mode"};let De=e=>e,we,Be,xe,ke,Fe,Me,He,Ge,Ue;class $e extends k{constructor(e){super();this.options=e;this.hexPreview=e.hexPreview;this.isHexPreviewMode=e.hexPreviewMode;this.isNeedCalcPopupOffset=e.isNeedCalcPopupOffset;this.isNeedResetPopupWhenOpen=e.isNeedResetPopupWhenOpen;this.popupId=`colorpopup_${u.Text.getRandom()}`;this.popupTargetContainer=e.contentRoot;this.activeTab=$e.TABS.RECENT;if(this.hexPreview){this.bindElement=this.hexPreview.getLayout();this.hexPreview.subscribe("onValidInput",this.onHexPreviewValidInput.bind(this))}if(this.options.bindElement){this.bindElement=this.options.bindElement}if(this.options.bindElement){this.targetContainer=this.options.targetContainer}this.tabButtons={};this.tabContents={};this.init();this.initAnalytics(e.analytics)}init(){this.hex=new $;this.hex.subscribe("onChange",this.onHexChange.bind(this));this.recent=new Ee;this.recent.subscribe("onChange",this.onRecentChange.bind(this));this.spectrum=new j(this.options);this.spectrum.subscribe("onChange",this.onSpectrumChange.bind(this));this.spectrum.subscribe("onPickerDragStart",this.onSpectrumDragStart.bind(this));this.spectrum.subscribe("onPickerDragEnd",this.onSpectrumDragEnd.bind(this));this.presetCollection=new Ce(this.options);this.presetCollection.addDefaultPresets();this.presets=this.presetCollection.getAllPresets();this.presets.forEach((e=>{e.subscribe("onChange",this.onPresetChange.bind(this))}));this.favourite=new Re;this.favourite.subscribe("onSelectColor",this.onFavouriteSelect.bind(this));this.favourite.subscribe("onAddColor",this.onAddFavouriteColor.bind(this));this.favourite.subscribe("onRemoveColor",this.onRemoveFavouriteColor.bind(this));this.favourite.subscribe("onEditColors",this.onEditFavouriteColors.bind(this));this.favourite.subscribe("onSaveColors",this.onSaveFavouriteColors.bind(this))}initAnalytics(e){this.analyticsCategory=$e.ANALYTICS.CATEGORY_DESIGN;if(this.hexPreview){this.analyticsCElement=this.isHexPreviewMode?$e.ANALYTICS.COLOR_TYPE_GRADIENT:$e.ANALYTICS.COLOR_TYPE_SOLID}this.analyticsCSubSection=this.options.style;if(e){if(e.category){this.analyticsCategory=e.category}if(e.c_sub_section){this.analyticsCSubSection=e.c_sub_section}if(e.p1){this.analyticsP1=e.p1}}}getPopup(){let e=0;let t=3;const i=287;const o=BX.Landing.UI.Panel.EditorPanel.getInstance().currentElement;if(o!==null&&o.ownerDocument!==BX.Landing.PageObject.getRootWindow().document&&!this.hexPreview){t-=66}if(this.bindElement&&this.isNeedCalcPopupOffset!==false){const t=this.bindElement.getBoundingClientRect();const s=320;const o=12;e=s-i-o-t.x}return this.cache.remember("popup",(()=>{var o;return s.PopupManager.create({id:this.popupId,className:"landing-ui-field-color-popup",autoHide:true,autoHideHandler:e=>{const t=e.target;if(!this.hexPreview){return!(t&&t.closest(".popup-window-content"))}return t!==this.hexPreview.getInput()&&!this.getPopup().contentContainer.contains(t)},bindElement:this.bindElement,bindOptions:{forceTop:true,forceLeft:true},padding:0,contentPadding:16,width:i,offsetTop:t,offsetLeft:e,content:this.getPopupContent(),closeByEsc:true,targetContainer:(o=this.popupTargetContainer)!=null?o:null,events:{onPopupClose:()=>{this.favourite.onSaveButtonClick();this.emit("onPopupClose")},onPopupShow:()=>{this.emit("onPopupShow")}}})}))}getPopupContent(){var e;const t=[{key:$e.TABS.RECENT,label:u.Loc.getMessage("LANDING_FIELD_COLOR_TAB_RECENT")},{key:$e.TABS.SPECTRUM,label:u.Loc.getMessage("LANDING_FIELD_COLOR_TAB_SPECTRUM")},{key:$e.TABS.PRESET,label:u.Loc.getMessage("LANDING_FIELD_COLOR_TAB_PRESETS")}];const i=u.Tag.render(we||(we=De`
			<div class="landing-ui-field-color-popup-tabs"></div>
		`));t.forEach((e=>{const t=u.Tag.render(Be||(Be=De`
				<button 
					class="landing-ui-field-color-popup-tab-btn"
					data-tab="${0}"
					type="button"
				>${0}</button>
			`),e.key,e.label);BX.Dom.append(t,i);this.tabButtons[e.key]=t;u.Event.bind(t,"click",(()=>this.setActiveTab(e.key,true)))}));const s=u.Tag.render(xe||(xe=De`
			<div class="landing-ui-field-color-popup-container-recent">
				${0}
			</div>
		`),this.recent.getLayout());const o=u.Tag.render(ke||(ke=De`
			<div class="landing-ui-field-color-popup-container-spectrum" hidden>
				${0}
			</div>
		`),this.spectrum.getLayout());const a=u.Tag.render(Fe||(Fe=De`
			<div class="landing-ui-field-color-popup-container-presets" hidden>
				${0}
			</div>
		`),this.getPresetsLayout());this.tabContents={recent:s,spectrum:o,preset:a};const n=u.Tag.render(Me||(Me=De`
			<div class="landing-ui-field-color-popup-favourite-colors">
				${0}
			</div>
		`),this.favourite.getLayout());if(!this.hexPreview){this.colorPickerPopup=this.getColorPickerPopupLayout();u.Event.bind(this.colorPickerPopup,"input",this.onColorPopupInput.bind(this))}const r=u.Tag.render(He||(He=De`
			<div class="landing-ui-field-color-popup-container">
				${0}
				${0}
				${0}
				${0}
				${0}
				${0}
			</div>
		`),(e=this.colorPickerPopup)!=null?e:null,i,s,o,a,n);u.Event.bind(r,"click",(e=>{e.preventDefault();e.stopPropagation()}));this.setActiveTab(this.activeTab);return r}onPopupOpenClick(e,t=null){if(t!==null){this.bindElement=t}if(!this.hexPreview&&this.isNeedResetPopupWhenOpen!==false){this.resetPopupValue()}Promise.all([Ee.initItems(),Re.initItems()]).then((()=>{const t=this.getPopup();if(this.hexPreview&&!t.isShown()){if(e.target===this.hexPreview.getLayout()){this.setActiveTab($e.TABS.RECENT)}if(e.target===this.hexPreview.getInput()){this.setActiveTab($e.TABS.SPECTRUM)}}if(Ee.items.length===0){this.setActiveTab($e.TABS.PRESET)}if(!t.isShown()){this.sendAnalytics($e.ANALYTICS.EVENTS.OPEN_POPUP);t.show();this.hex.focus()}this.recent.buildItemsLayout();this.favourite.buildItemsLayout()}))}resetPopupValue(){this.resetColorPickerPopupValue();this.unsetActivePresets();this.recent.buildItemsLayout($e.HEX_DEFAULT_TEXT);this.favourite.buildItemsLayout($e.HEX_DEFAULT_TEXT);this.spectrum.hidePicker()}onChangeColor(e){this.emit("onColorPopupChange",e);if(!this.hexPreview){const t=u.Type.isString(e)&&m(e)?e:e&&u.Type.isFunction(e.getHex)?e.getHex():null;this.updateColorPickerPopup(t);this.emit("onHexColorPopupChange",t)}}setValue(e){if(!e){return}this.spectrum.setValue(e);this.hex.setValue(e);const t=e.getHex();this.currentHexValue=t;this.presets.forEach((e=>{e.setActiveHex(t)}));this.recent.buildItemsLayout(t);this.favourite.buildItemsLayout(t);this.updateColorPickerPopup(t)}setHexValue(e){this.setValue(new w(e))}getValue(){return this.spectrum.getValue()}getPresetsLayout(){return u.Tag.render(Ge||(Ge=De`
			<div class="landing-ui-field-color-presets-list">
				${0}
			</div>
		`),this.presets.map((e=>e.getLayout())))}getColorPickerPopupLayout(){this.colorPickerPopupId=`colorpicket_${u.Text.getRandom()}`;let e=$e.HEX_DEFAULT_TEXT;let t="#eeeeee";if(this.currentHexValue){e=this.currentHexValue;t=this.currentHexValue}return u.Tag.render(Ue||(Ue=De`
			<div class="landing-ui-field-color-popup-picker">
				<div class="landing-ui-field-color-popup-picker-preview" style="background-color: ${0};"></div>
				<input id="${0}" type="text" value="${0}" class="landing-ui-field-color-popup-picker-input">
			</div>
		`),t,this.colorPickerPopupId,e)}updateColorPickerPopup(e){if(!this.colorPickerPopup){return}const t=this.colorPickerPopup.querySelector(".landing-ui-field-color-popup-picker-preview");if(t){BX.Dom.style(t,"background-color",e)}const i=this.colorPickerPopup.querySelector(".landing-ui-field-color-popup-picker-input");if(i){i.value=e}}resetColorPickerPopupValue(){if(!this.colorPickerPopup){return}const e=this.colorPickerPopup.querySelector(".landing-ui-field-color-popup-picker-preview");if(e){BX.Dom.style(e,"background-color","#eeeeee")}const t=this.colorPickerPopup.querySelector(".landing-ui-field-color-popup-picker-input");if(t){t.value=$e.HEX_DEFAULT_TEXT}}onColorPopupInput(){const e=this.colorPickerPopup.querySelector(".landing-ui-field-color-popup-picker-input");if(this.colorPopupInputTimeout){clearTimeout(this.colorPopupInputTimeout)}this.colorPopupInputTimeout=setTimeout((()=>{let t=e.value.replaceAll(/[^\da-f]/gi,"");t=t.slice(0,6);const i=`#${t.toLowerCase()}`;e.value=i;const s=/^#([\da-f]{6})$/;if(s.test(i)){this.sendAnalytics($e.ANALYTICS.EVENTS.SELECT_COLOR,{type:$e.ANALYTICS.TYPE_COLORS.HEX});const t=new w(i);this.recent.addItem(i);this.recent.buildItemsLayout();this.setValue(t);this.onChangeColor(i);e.focus()}}),333)}setActiveTab(e,t=false){if(t===true&&e!==this.activeTab){this.sendAnalytics($e.ANALYTICS.EVENTS.CHANGE_TAB,{type:e})}this.activeTab=e;if(this.activeTab===$e.TABS.RECENT){this.recent.buildItemsLayout()}Object.entries(this.tabContents).forEach((([t,i])=>{i.hidden=t!==e}));Object.entries(this.tabButtons).forEach((([t,i])=>{if(t===e){BX.Dom.addClass(i,"active")}else{BX.Dom.removeClass(i,"active")}}))}onHexChange(e){this.unsetActivePresets();const t=e.getData().color;if(t){this.recent.addItem(t.getHex())}this.setValue(t);this.onChange(e)}onSpectrumChange(e){const t=e.getData().color;this.unsetActivePresets();this.hex.unFocus();this.setValue(t);this.onChangeColor(t)}onSpectrumDragStart(e){h.PageObject.getRootWindow().document.activeElement.blur()}onSpectrumDragEnd(e){this.sendAnalytics($e.ANALYTICS.EVENTS.SELECT_COLOR,{type:$e.ANALYTICS.TYPE_COLORS.SPECTRUM});const t=e.getData().color;this.recent.addItem(t.getHex())}onPresetChange(e){this.sendAnalytics($e.ANALYTICS.EVENTS.SELECT_COLOR,{type:$e.ANALYTICS.TYPE_COLORS.PRESET});const t=e.target.id;this.unsetActivePresets(t);const i=e.getData().color;this.recent.addItem(i.getHex());this.setValue(i);this.onChangeColor(i)}onRecentChange(e){this.sendAnalytics($e.ANALYTICS.EVENTS.SELECT_COLOR,{type:$e.ANALYTICS.TYPE_COLORS.RECENT});this.unsetActivePresets();const t=new w(e.getData().hex);this.setValue(t);this.onChangeColor(t)}unsetActivePresets(e=null){this.presets.forEach((t=>{if(e!==t.id){t.unsetActive()}}))}onFavouriteSelect(e){this.sendAnalytics($e.ANALYTICS.EVENTS.SELECT_COLOR,{type:$e.ANALYTICS.TYPE_COLORS.MY});this.unsetActivePresets();const t=new w(e.getData().hex);const i=e.getData().hex;this.recent.addItem(i);this.setValue(t);this.onChangeColor(t)}onAddFavouriteColor(e){this.sendAnalytics($e.ANALYTICS.EVENTS.ADD_MY_COLOR)}onHexPreviewValidInput(e){const t=e.getData().value;if(t){this.recent.addItem(`#${t}`);this.recent.buildItemsLayout();this.sendAnalytics($e.ANALYTICS.EVENTS.SELECT_COLOR,{type:$e.ANALYTICS.TYPE_COLORS.HEX})}}onRemoveFavouriteColor(e){}onEditFavouriteColors(e){}onSaveFavouriteColors(e){}getAnalyticsCategory(){return this.analyticsCategory}getAnalyticsCSubSection(){return this.analyticsCSubSection}getAnalyticsCElement(){var e;return(e=this.analyticsCElement)!=null?e:null}getAnalyticsP1(){var e;return(e=this.analyticsP1)!=null?e:null}sendAnalytics(e,t={}){const i={event:e,tool:BX.Landing.Main.getAnalyticsCategoryByType(),category:(t==null?void 0:t.category)||this.getAnalyticsCategory(),c_sub_section:(t==null?void 0:t.c_sub_section)||this.getAnalyticsCSubSection(),p1:(t==null?void 0:t.p1)||this.getAnalyticsP1()};if(t&&t.type){i.type=t.type}const s=this.getAnalyticsCElement();if(s!==null){i.c_element=s}BX.UI.Analytics.sendData(i)}}$e.TABS={RECENT:"recent",SPECTRUM:"spectrum",PRESET:"preset"};$e.ANALYTICS={CATEGORY_DESIGN:"design_slider",COLOR_TYPE_GRADIENT:"gradient",COLOR_TYPE_SOLID:"solid",EVENTS:{OPEN_POPUP:"open_color_popup",CHANGE_TAB:"change_color_tab",SELECT_COLOR:"select_color",ADD_MY_COLOR:"add_my_color"},TYPE_COLORS:{RECENT:"recent",SPECTRUM:"spectrum",PRESET:"preset",MY:"my",HEX:"hex"}};$e.HEX_DEFAULT_TEXT="#hex";let Xe=e=>e,Ye;class ze extends n.EventEmitter{constructor(e){super();this.cache=new u.Cache.MemoryCache;this.property="color";this.options=e;this.pseudoClass=null;this.setEventNamespace("BX.Landing.UI.Field.Processor.BaseProcessor")}getProperty(){return u.Type.isArray(this.property)?this.property:[this.property]}getVariableName(){return u.Type.isArray(this.variableName)?this.variableName:[this.variableName]}isNullValue(e){return u.Type.isNull(e)}getNullValue(){return new w}getPseudoClass(){return this.pseudoClass}getLayout(){return this.cache.remember("layout",(()=>this.buildLayout()))}buildLayout(){return u.Tag.render(Ye||(Ye=Xe`<div>Base processor</div>`))}getClassName(){return[this.className]}getValue(){}getStyle(){if(u.Type.isNull(this.getValue())){return{[this.getVariableName()]:null}}return{[this.getVariableName()]:this.getValue().getStyleString()}}setProcessorValue(e){const t=this.getVariableName()[this.getVariableName().length-1];this.cache.delete("value");this.setValue(e[t])}setDefaultValue(e){if(!u.Type.isNull(e)){const t=this.getProperty()[this.getProperty().length-1];if(t in e){this.setValue(e[t]);this.cache.delete("value");this.unsetActive();return}}this.setValue(null);this.cache.set("value",null)}setValue(e){}unsetActive(){}onChange(){this.cache.delete("value");this.emit("onChange")}defineActiveControl(e,t){}setActiveControl(e){}prepareProcessorValue(e,t,i){return e}}let je=e=>e,We;class Ze extends k{constructor(e){super();this.options=e;this.setEventNamespace("BX.Landing.UI.Field.Color.Colorpicker");this.popupId=`colorpicker_popup_${u.Text.getRandom()}`;this.popupTargetContainer=e.contentRoot;this.isHexPreviewMode=e.hexPreviewMode;this.hexPreview=new $;if(e.hexPreviewMode===true){this.hexPreview.setPreviewMode(true)}this.options.hexPreview=this.hexPreview;this.colorPopup=new $e(this.options);this.colorPopup.subscribe("onColorPopupChange",this.onColorPopupChange.bind(this));this.hex=new $;this.spectrum=new j(e);this.presetCollection=new Ce(e);this.presetCollection.addDefaultPresets();this.presets=this.presetCollection.getAllPresets();this.initLoader();u.Event.bind(this.hexPreview.getLayout(),"click",(e=>{if(!this.colorPopup.getPopup().isShown()){BX.Dom.style(this.hexPreview.getButton(),"opacity",".5");this.loader.show()}this.colorPopup.onPopupOpenClick(e)}));this.colorPopup.subscribe("onPopupShow",(e=>{this.loader.hide();BX.Dom.style(this.hexPreview.getButton(),"opacity","1")}));this.hexPreview.subscribe("onValidInput",this.onValidInput.bind(this));this.hexPreview.subscribe("onChange",this.onHexChange.bind(this));this.tabButtons={};this.tabContents={}}initLoader(){this.loader=new BX.Loader({target:this.hexPreview.getLayout()});const e=this.loader.layout;if(e){BX.Dom.style(e,"width","28px");BX.Dom.style(e,"height","28px");BX.Dom.style(e,"left","unset");BX.Dom.style(e,"right","0");BX.Dom.style(e,"transform","translate(0, -50%)")}}buildLayout(){return u.Tag.render(We||(We=je`
			<div class="landing-ui-field-color-colorpicker">
				${0}
			</div>
		`),this.hexPreview.getLayout())}getHexPreviewObject(){return this.hexPreview}getValue(){return this.cache.remember("value",(()=>this.spectrum.getValue()))}onColorPopupChange(e){const t=e.getData();if(t){this.setValue(t)}this.onChange(new n.BaseEvent({data:{color:t}}))}onHexChange(e){const t=e.getData().color;this.setValue(t);this.onChange(e)}onValidInput(e){const t=`#${e.getData().value}`;if(t){this.emit("onValidInput",{color:t})}}setValue(e){if(this.isNeedSetValue(e)){super.setValue(e);this.spectrum.setValue(e);this.hex.setValue(e);this.hexPreview.setValue(e);this.colorPopup.setValue(e);if(e){const t=e.getHex();this.presets.forEach((e=>{e.setActiveHex(t)}))}}this.setActivity(e)}setActivity(e){if(e!==null){if(this.spectrum.isActive()){this.hex.unsetActive()}else{this.hex.setActive()}this.hexPreview.setActive()}}unsetActive(){this.hex.unsetActive();this.hexPreview.unsetActive()}isActive(){return this.hex.isActive()||this.hexPreview.isActive()}}Ze.TABS={RECENT:"recent",SPECTRUM:"spectrum",PRESET:"preset"};let qe=e=>e,Ke,Je;class Qe extends k{constructor(e){super();this.options=e;this.setEventNamespace("BX.Landing.UI.Field.Color.ColorSet");this.colorpicker=new Ze(e);this.colorpicker.subscribe("onChange",(e=>{this.preset.unsetActive();const t=e.getData().color;if(this.preset.isPresetValue(t)){this.preset.setActiveValue(t);this.colorpicker.unsetActive()}this.onChange(e)}));this.presets=new Ce(e);this.presets.subscribe("onChange",(e=>{this.setPreset(this.presets.getPresetById(e.getData().presetId))}));this.presets.addDefaultPresets();const t=this.presets.getActivePreset();if(t){this.setPreset(t)}}buildLayout(){return u.Tag.render(Ke||(Ke=qe`
			<div class="landing-ui-field-color-colorset">
				<div class="landing-ui-field-color-colorset-bottom">
					${0}
				</div>
			</div>
		`),this.colorpicker.getLayout())}getTitleLayout(){return this.cache.remember("titleLayout",(()=>this.getLayout().querySelector(".landing-ui-field-color-colorset-title")))}getPresetContainer(){return this.cache.remember("presetContainer",(()=>u.Tag.render(Je||(Je=qe`<div class="landing-ui-field-color-colorset-preset-container"></div>`))))}setPreset(e){this.preset=e;this.preset.unsetActive();if(this.getValue()!==null&&this.preset.isPresetValue(this.getValue())){this.unsetActive();this.preset.setActiveValue(this.getValue())}else{this.unsetActive();this.colorpicker.setValue(this.getValue())}if(this.getValue()===null&&this.options.content){this.setColorFromContent()}this.preset.subscribe("onChange",(e=>{this.onPresetItemChange(e)}));u.Dom.clean(this.getPresetContainer());u.Dom.append(e.getLayout(),this.getPresetContainer());this.emit("onPresetChange",{preset:e})}getPreset(){return this.preset}getPresetsCollection(){return this.presets}onPresetItemChange(e){this.colorpicker.setValue(e.getData().color);this.colorpicker.unsetActive();this.onChange(e)}onChange(e){this.cache.set("value",e.getData().color);this.emit("onChange",e)}getValue(){return this.cache.remember("value",(()=>this.colorpicker.getValue()))}setValue(e){if(this.isNeedSetValue(e)){super.setValue(e);this.colorpicker.setValue(e);const t=this.presets.getGlobalActiveId()?this.presets.getPresetById(this.presets.getGlobalActiveId()):this.presets.getPresetByItemValue(e);if(t!==null){this.setPreset(t);this.presets.setActiveItem(t.getId())}}}unsetActive(){this.preset.unsetActive();this.colorpicker.unsetActive()}isActive(){return this.preset.isActive()||this.colorpicker.isActive()}setColorFromContent(){const e=this.options.content;let t="";if(e.startsWith("#")){t=y(e)}if(e.startsWith("hsl")){t=P(e)}if(u.Type.isObject(t)){const e=new w({h:t.h,s:t.s,l:t.l,a:t.a});this.unsetActive();this.colorpicker.setValue(e)}}}let et=e=>e,tt,it,st;class ot extends k{constructor(e){super();this.setEventNamespace("BX.Landing.UI.Field.Color.Opacity");this.defaultOpacity=u.Type.isObject(e)&&Reflect.has(e,"defaultOpacity")?e.defaultOpacity:ot.DEFAULT_OPACITY;this.document=h.PageObject.getRootWindow().document;this.onPickerDragStart=this.onPickerDragStart.bind(this);this.onPickerDragMove=this.onPickerDragMove.bind(this);this.onPickerDragEnd=this.onPickerDragEnd.bind(this);this.layout=this.getLayout();this.pickerControl=this.layout.querySelector(".landing-ui-field-color-opacity");this.rangeControl=this.layout.querySelector(".landing-ui-field-color-opacity-range-output");this.arrowsUp=this.rangeControl.querySelector(".landing-ui-field-color-opacity-range-output-arrows-up");this.arrowsDown=this.rangeControl.querySelector(".landing-ui-field-color-opacity-range-output-arrows-down");this.rangeInput=this.rangeControl.querySelector(".landing-ui-field-color-opacity-range-output-input");u.Event.bind(this.arrowsUp,"click",this.onArrowClick.bind(this,"up"));u.Event.bind(this.arrowsDown,"click",this.onArrowClick.bind(this,"down"));u.Event.bind(this.pickerControl,"mousedown",this.onPickerDragStart)}buildLayout(){const e=this.defaultOpacity*100;const t=u.Tag.render(tt||(tt=et`
			<div class="landing-ui-field-color-opacity-container">
				<div class="landing-ui-field-color-opacity">
					${0}
					${0}
				</div>
				<div class="landing-ui-field-color-opacity-range-output">
					<div 
						class="landing-ui-field-color-opacity-range-output-input"
						title="${0}">
						${0}
					</div>
					<div class="landing-ui-field-color-opacity-range-output-arrows">
						<div class="landing-ui-field-color-opacity-range-output-arrows-up"></div>
						<div class="landing-ui-field-color-opacity-range-output-arrows-down"></div>
					</div>
				</div>
			</div>
		`),this.getPicker(),this.getColorLayout(),e,e);this.setPickerPosByOpacity(this.defaultOpacity);return t}onPickerDragStart(e){if(e.ctrlKey||e.metaKey||e.button){return}u.Event.bind(this.document,"mousemove",this.onPickerDragMove);u.Event.bind(this.document,"mouseup",this.onPickerDragEnd);u.Dom.addClass(this.document.body,"landing-ui-field-color-draggable");this.onPickerDragMove(e)}onPickerDragMove(e){if(e.target===this.getPicker()){return}this.setPickerPos(e.pageX);this.onChange();this.onRangeControlChange()}onPickerDragEnd(){u.Event.unbind(this.document,"mousemove",this.onPickerDragMove);u.Event.unbind(this.document,"mouseup",this.onPickerDragEnd);u.Dom.removeClass(this.document.body,"landing-ui-field-color-draggable")}setPickerPos(e){const t=Math.max(Math.min(e-this.getLayoutRect().left,this.getLayoutRect().width),0);u.Dom.style(this.getPicker(),{left:`${t}px`})}setPickerPosByOpacity(e){e=Math.min(1,Math.max(0,e));u.Dom.style(this.getPicker(),{left:`${e*100}%`})}getLayoutRect(){return this.cache.remember("layoutSize",(()=>{const e=this.pickerControl.getBoundingClientRect();return{width:e.width,left:e.left}}))}getColorLayout(){return this.cache.remember("colorLayout",(()=>u.Tag.render(it||(it=et`
				<div class="landing-ui-field-color-opacity-color"></div>
			`))))}getPicker(){return this.cache.remember("picker",(()=>u.Tag.render(st||(st=et`
				<div class="landing-ui-field-color-opacity-picker">
					<div class="landing-ui-field-color-opacity-picker-item">
						<div class="landing-ui-field-color-opacity-picker-item-circle"></div>
					</div>
				</div>`))))}getDefaultValue(){return this.cache.remember("default",(()=>new w(ot.DEFAULT_COLOR).setOpacity(this.defaultOpacity)))}getValue(){return this.cache.remember("value",(()=>{const e=u.Text.toNumber(u.Dom.style(this.getPicker(),"left"));const t=u.Text.toNumber(this.pickerControl.getBoundingClientRect().width);return this.getDefaultValue().setOpacity(e/t)}))}setValue(e){const t=!u.Type.isNull(e)?e:this.getDefaultValue();super.setValue(t);if(!u.Type.isNull(e)){u.Dom.style(this.getColorLayout(),{background:t.getStyleStringForOpacity()});this.setPickerPosByOpacity(t.getOpacity());this.onRangeControlChange()}else{u.Dom.style(this.getColorLayout(),{background:"none"})}}onRangeControlChange(){const e=parseInt(this.getValue().getOpacity()*100);this.rangeInput.title=e;this.rangeInput.innerHTML=e}onArrowClick(e){let t;const i=this.getValue().getOpacity();const s=parseInt(i*100);if(e==="up"){if(s<100){t=(s+5)/100}else{t=s/100}}if(e==="down"){if(s>0){t=(s-5)/100}else{t=s/100}}this.rangeInput.title=parseInt(t*100);this.rangeInput.innerHTML=parseInt(t*100);const o=this.pickerControl.getBoundingClientRect().width;const a=o-o*(1-t);u.Dom.style(this.getPicker(),{left:`${a}px`});this.onChange()}}ot.DEFAULT_COLOR="#cccccc";ot.DEFAULT_OPACITY=1;let at=e=>e,nt,rt,lt,ct,ht,ut;class gt extends n.EventEmitter{constructor(){super();this.setEventNamespace("BX.Landing.UI.Field.Color.Tabs");this.tabs=[];this.cache=new u.Cache.MemoryCache;this.multiple=true;this.isBig=false;this.onToggle=this.onToggle.bind(this)}setMultiple(e){this.multiple=e;return this}setBig(e){this.isBig=e;this.multiple=false;return this}appendTab(e,t,i){const s=new dt({id:e,title:t,items:u.Type.isArray(i)?i:[i]});this.tabs.push(s);this.bindEvents(s);this.cache.delete("layout");return this}prependTab(e,t,i){const s=new dt({id:e,title:t,items:u.Type.isArray(i)||[i]});this.tabs.unshift(s);this.bindEvents(s);this.cache.delete("layout");return this}bindEvents(e){e.subscribe("onToggle",this.onToggle);e.subscribe("onShow",this.onToggle);e.subscribe("onHide",this.onToggle)}onToggle(e){this.emit("onToggle",e)}showTab(e){if(!this.multiple){this.tabs.forEach((e=>{e.hide()}))}const t=this.getTabById(e);if(t){t.show()}return this}getTabById(e){return this.tabs.find((t=>t.id===e))}getLayout(){return this.cache.remember("layout",(()=>{const e=this.isBig?" landing-ui-field-color-tabs--big":"";const t=u.Tag.render(nt||(nt=at`<div class="landing-ui-field-color-tabs${0}"></div>`),e);if(this.isBig){const e=u.Tag.render(rt||(rt=at`
					<div class="landing-ui-field-color-tabs-head landing-ui-field-color-tabs-head--big"></div>
				`));const i=u.Tag.render(lt||(lt=at`
					<div class="landing-ui-field-color-tabs-content landing-ui-field-color-tabs-content--big"></div>
				`));this.tabs.forEach((t=>{u.Dom.append(t.getTitle(),e);u.Dom.append(t.getLayout(),i)}));u.Dom.append(e,t);u.Dom.append(i,t)}else{this.tabs.forEach((e=>{const i=u.Tag.render(ct||(ct=at`<div class="landing-ui-field-color-tabs-tab">
						${0}${0}
					</div>`),e.getTitle(),e.getLayout());u.Dom.append(i,t)}))}this.tabs.forEach((e=>{u.Event.bind(e.getTitle(),"click",(()=>{if(!this.multiple){this.tabs.forEach((e=>{e.hide()}))}e.toggle()}))}));return t}))}}class dt extends n.EventEmitter{constructor(e){super();this.id=e.id;this.title=e.title;this.items=e.items;this.cache=new u.Cache.MemoryCache}getId(){return this.id}getTitle(){return this.cache.remember("title",(()=>u.Tag.render(ht||(ht=at`
				<span class="landing-ui-field-color-tabs-tab-toggler">
					<span class="landing-ui-field-color-tabs-tab-toggler-icon"></span>
					<span class="landing-ui-field-color-tabs-tab-toggler-name">${0}</span>
				</span>
			`),this.title)))}getLayout(){return this.cache.remember("layout",(()=>u.Tag.render(ut||(ut=at`
				<div class="landing-ui-field-color-tabs-tab-content">
					${0}
				</div>
			`),this.items.map((e=>e.getLayout())))))}toggle(){u.Dom.toggleClass(this.getLayout(),dt.SHOW_CLASS);u.Dom.toggleClass(this.getTitle(),dt.SHOW_CLASS);this.emit("onToggle",{tab:this.title});return this}show(){u.Dom.addClass(this.getLayout(),dt.SHOW_CLASS);u.Dom.addClass(this.getTitle(),dt.SHOW_CLASS);this.emit("onShow",{tab:this.title});return this}hide(){u.Dom.removeClass(this.getLayout(),dt.SHOW_CLASS);u.Dom.removeClass(this.getTitle(),dt.SHOW_CLASS);this.emit("onHide",{tab:this.title});return this}}dt.SHOW_CLASS="show";let pt=e=>e,mt;class vt extends n.EventEmitter{constructor(e){super();this.options=e;this.cache=new u.Cache.MemoryCache;this.setEventNamespace("BX.Landing.UI.Field.Color.Zeroing");u.Event.bind(this.getLayout(),"click",(()=>this.onClick()))}getLayout(){let e="LANDING_FIELD_COLOR-ZEROING_TITLE_2";if(this.options){if(!this.options.styleNode){return null}if(this.options.textCode){e=this.options.textCode}}return this.cache.remember("layout",(()=>u.Tag.render(mt||(mt=pt`<div class="landing-ui-field-color-zeroing">
				<div class="landing-ui-field-color-zeroing-preview">
					<div class="landing-ui-field-color-zeroing-state"></div>
				</div>
				<span class="landing-ui-field-color-primary-text">
					${0}
				</span>
			</div>`),u.Loc.getMessage(e))))}onClick(){this.emit("onChange",{color:null})}setActive(){u.Dom.addClass(this.getLayout(),vt.ACTIVE_CLASS)}unsetActive(){u.Dom.removeClass(this.getLayout(),vt.ACTIVE_CLASS)}isActive(){return u.Dom.hasClass(this.getLayout(),vt.ACTIVE_CLASS)}}vt.ACTIVE_CLASS="active";let ft=e=>e,Ct;class bt extends ze{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.Color");this.property="color";this.variableName="--color";this.className="g-color";this.colorSet=new Qe(e);this.colorSet.subscribe("onChange",this.onColorSetChange.bind(this));this.opacity=new ot;this.opacity.subscribe("onChange",this.onOpacityChange.bind(this));const t={styleNode:e.styleNode};this.zeroing=new vt(t);this.zeroing.subscribe("onChange",this.onZeroingChange.bind(this));this.primary=new q(e);this.primary.subscribe("onChange",this.onPrimaryChange.bind(this));this.tabs=(new gt).appendTab("Opacity",u.Loc.getMessage("LANDING_FIELD_COLOR-TAB_OPACITY"),this.opacity)}isNullValue(e){return e===null||e==="none"||e==="rgba(0, 0, 0, 0)"}getNullValue(){return new w("rgba(0, 0, 0, 0)")}buildLayout(){return u.Tag.render(Ct||(Ct=ft`
			<div class="landing-ui-field-color-color">
				${0}
				${0}
				${0}
				${0}
			</div>
		`),this.colorSet.getLayout(),this.primary.getLayout(),this.zeroing.getLayout(),this.tabs.getLayout())}onColorSetChange(e){this.primary.unsetActive();this.zeroing.unsetActive();const t=e.getData().color;if(t!==null){t.setOpacity(this.opacity.getValue().getOpacity())}this.opacity.setValue(t);this.onChange()}onOpacityChange(){this.onChange()}onPrimaryChange(e){this.colorSet.setValue(e.getData().color);this.onColorSetChange(e);this.colorSet.unsetActive();this.zeroing.unsetActive();this.primary.setActive()}onZeroingChange(e){this.colorSet.unsetActive();this.primary.unsetActive();this.zeroing.setActive();this.setValue(e.getData().color);this.onChange(e)}unsetActive(){this.colorSet.unsetActive();this.primary.unsetActive()}setValue(e){const t=e!==null?new w(e):null;this.colorSet.setValue(t);this.opacity.setValue(t);if(this.primary.isPrimaryValue(t)){this.primary.setActive();this.colorSet.unsetActive()}if(e!==null&&t.getOpacity()<1){this.tabs.showTab("Opacity")}}getValue(){return this.cache.remember("value",(()=>{const e=this.primary.isActive()?this.primary.getValue():this.colorSet.getValue();return e===null?null:e.setOpacity(this.opacity.getValue().getOpacity())}))}setDefaultValue(e){this.zeroing.setActive();if(!u.Type.isNull(e)){this.colorSet.colorpicker.hex.setActive()}super.setDefaultValue(e)}setActiveControl(e){if(e==="primary"){this.primary.setActive()}if(e==="hex"){this.colorSet.colorpicker.hexPreview.setActive()}}defineActiveControl(e,t){if(!u.Type.isUndefined(t)){let i;let s;const o=t.getNode();if(o.length>0){e.forEach((e=>{if(u.Dom.hasClass(o[0],e.value)){i=e.value}}));if(i){const e=/g-[a-z]+-[a-z0-9-]+/i;const t=i.match(e);if(t){const e=/primary/i;const t=i.match(e);this.zeroing.unsetActive();if(t){s="primary"}else{s="hex"}}}if(s){this.setActiveControl(s)}}}}}bt.PRIMARY_VAR="var(--primary)";class yt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.ColorHover");this.property="color";this.variableName="--color-hover";this.className="g-color--hover";this.pseudoClass=":hover"}}let At=e=>e,Et,Lt,Tt,Pt,St,It,_t;class Vt extends k{constructor(e){super();this.ROTATE_STEP=45;this.setEventNamespace("BX.Landing.UI.Field.Color.Gradient");this.options=e;this.options.hexPreviewMode=true;this.popupId=`gradient_popup_${u.Text.getRandom()}`;this.popupTargetContainer=e.contentRoot;this.colorpickerFrom=new Ze(this.options);this.colorpickerFrom.subscribe("onChange",(e=>{this.onColorChange(e.getData().color,null)}));this.colorpickerTo=new Ze(this.options);this.colorpickerTo.subscribe("onChange",(e=>{this.onColorChange(null,e.getData().color)}));u.Event.bind(this.getPopupButton(),"click",this.onPopupOpen.bind(this));u.Event.bind(this.getRotateButton(),"click",this.onRotate.bind(this));u.Event.bind(this.getSwitchTypeButton(),"click",this.onSwitchType.bind(this));u.Event.bind(this.getSwapButton(),"click",this.onSwap.bind(this));this.preset=null}onColorChange(e,t){if(e===null&&t===null){return}const i=this.getValue()||new oe;const s=e||i.getFrom()||(new oe).getFrom();const o=t||i.getTo()||(new oe).getTo();i.setValue({from:s,to:o});this.setValue(i);this.preset.unsetActive();this.onChange()}onPopupOpen(){this.getPopup().toggle()}onRotate(e){if(!Vt.isButtonEnable(e.target)){return}const t=this.getValue();if(t!==null){t.setValue({angle:(t.getAngle()+this.ROTATE_STEP)%360});this.setValue(t);this.onChange()}this.getPopup().close()}onSwitchType(e){if(!Vt.isButtonEnable(e.target)){return}const t=this.getValue();if(t!==null){if(t.getType()===oe.TYPE_LINEAR){t.setValue({type:oe.TYPE_RADIAL});Vt.disableButton(this.getRotateButton())}else{t.setValue({type:oe.TYPE_LINEAR});Vt.enableButton(this.getRotateButton())}this.setValue(t);this.onChange()}this.getPopup().close()}onSwap(e){if(!Vt.isButtonEnable(e.target)){return}const t=this.getValue();if(t!==null){t.setValue({to:t.getFrom(),from:t.getTo()});this.setValue(t);this.onChange()}this.getPopup().close()}static disableButton(e){u.Dom.addClass(e,Vt.DISABLE_CLASS)}static enableButton(e){u.Dom.removeClass(e,Vt.DISABLE_CLASS)}static isButtonEnable(e){return!u.Dom.hasClass(e,Vt.DISABLE_CLASS)}correctColorpickerColors(){const e=this.getValue();if(e!==null){const t=e.getAngle();const i=this.colorpickerFrom.getHexPreviewObject();const s=this.colorpickerTo.getHexPreviewObject();const o=e.getFrom();const a=e.getTo();if(e.getType()===oe.TYPE_LINEAR){if(t===270||t===90){const e=w.getMedian(o,a).getContrast().getHex();i.adjustColors(e,"transparent");s.adjustColors(e,"transparent")}else if(t>=135&&t<=225){i.adjustColors(o.getContrast().getHex(),"transparent");s.adjustColors(a.getContrast().getHex(),"transparent")}else{i.adjustColors(a.getContrast().getHex(),"transparent");s.adjustColors(o.getContrast().getHex(),"transparent")}}else if(e.getType()===oe.TYPE_RADIAL){i.adjustColors(a.getContrast().getHex(),"transparent");s.adjustColors(a.getContrast().getHex(),"transparent")}}}getPopup(){return this.cache.remember("popup",(()=>s.PopupManager.create({id:this.popupId,className:"landing-ui-field-color-gradient-preset-popup",autoHide:true,bindElement:this.getPopupButton(),bindOptions:{forceTop:true,forceLeft:true},offsetLeft:15,angle:{offset:-5},padding:0,contentPadding:7,content:this.getPopupContent(),closeByEsc:true,targetContainer:this.popupTargetContainer})))}getPopupContent(){return this.cache.remember("popupContainer",(()=>u.Tag.render(Et||(Et=At`
				<div class="landing-ui-field-color-gradient-preset-popup-container">
					${0}
					${0}
				</div>
			`),this.getRotateButton(),this.getSwapButton())))}buildLayout(){if(this.preset){u.Dom.clean(this.getPresetContainer());u.Dom.append(this.preset.getLayout(),this.getPresetContainer())}return u.Tag.render(Lt||(Lt=At`
			<div class="landing-ui-field-color-gradient">
				<div class="landing-ui-field-color-gradient-container-main">
					${0}
					<div class="landing-ui-field-color-gradient-container">
						<div class="landing-ui-field-color-gradient-from">${0}</div>
						${0}
						<div class="landing-ui-field-color-gradient-to">${0}</div>
					</div>
				</div>
				<div class="landing-ui-field-color-gradient-switch-type-container">
					${0}
				</div>
			</div>
		`),this.getPresetContainer(),this.colorpickerFrom.getLayout(),this.getPopupButton(),this.colorpickerTo.getLayout(),this.getSwitchTypeButton())}getContainerLayout(){return this.getLayout().querySelector(".landing-ui-field-color-gradient-container")}getPresetContainer(){return this.cache.remember("presetContainer",(()=>u.Tag.render(Tt||(Tt=At`<div class="landing-ui-field-color-gradient-preset-container"></div>`))))}getPopupButton(){return this.cache.remember("popupButton",(()=>u.Tag.render(Pt||(Pt=At`<span class="landing-ui-field-color-gradient-open-popup"></span>`))))}getSwitchTypeButton(){return this.cache.remember("switchTypeButton",(()=>u.Tag.render(St||(St=At`
				<span
					class="landing-ui-field-color-gradient-switch-type"
					title="${0}"
				></span>
			`),u.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_SWITCH_TYPE"))))}getRotateButton(){return this.cache.remember("rotateButton",(()=>u.Tag.render(It||(It=At`
				<span
					class="landing-ui-field-color-gradient-rotate"
					title="${0}"
				></span>
			`),u.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_ROTATE"))))}getSwapButton(){return this.cache.remember("swapButton",(()=>u.Tag.render(_t||(_t=At`
				<span
					class="landing-ui-field-color-gradient-swap"
					title="${0}"
				></span>
			`),u.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_SWAP"))))}setPreset(e){this.preset=e;this.preset.unsetActive();this.preset.subscribe("onChange",(e=>{this.setValue(e.getData().color);this.unsetColorpickerActive();this.onChange(e)}));u.Dom.clean(this.getPresetContainer());u.Dom.append(e.getLayout(),this.getPresetContainer())}getPreset(){return this.preset}getValue(){return this.cache.remember("value",(()=>{if(this.colorpickerFrom.getValue()===null||this.colorpickerTo.getValue()===null){return null}let e=this.getRotateButton().dataset.rotate;e=e?u.Text.toNumber(e):0;const t=this.getSwitchTypeButton().dataset.type||oe.TYPE_LINEAR;return new oe({from:this.colorpickerFrom.getValue(),to:this.colorpickerTo.getValue(),angle:e,type:t})}))}setValue(e){super.setValue(e);if(e===null){this.colorpickerFrom.setValue(null);this.colorpickerTo.setValue(null);this.unsetActive();u.Dom.style(this.getContainerLayout(),"background",(new oe).getStyleString());Vt.disableButton(this.getRotateButton());Vt.disableButton(this.getSwitchTypeButton());Vt.disableButton(this.getSwapButton())}else{this.colorpickerFrom.setValue(e.getFrom());this.colorpickerTo.setValue(e.getTo());this.correctColorpickerColors();this.getRotateButton().dataset.rotate=e.getAngle();this.getSwitchTypeButton().dataset.type=e.getType();u.Dom.style(this.getRotateButton(),"transform",`rotate(${e.getAngle()}deg)`);u.Dom.style(this.getContainerLayout(),"background",this.getValue().getStyleString());Vt.enableButton(this.getSwitchTypeButton());Vt.enableButton(this.getSwapButton());if(e.getType()===oe.TYPE_RADIAL){Vt.disableButton(this.getRotateButton());this.getSwitchTypeButton().innerText=u.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_DO_LINEAR")}else{Vt.enableButton(this.getRotateButton());this.getSwitchTypeButton().innerText=u.Loc.getMessage("LANDING_FIELD_COLOR-GRADIENT_DO_RADIAL")}this.setActive()}}onChange(e){this.cache.delete("value");this.emit("onChange",{gradient:this.getValue()})}setActive(){const e=this.getValue();if(this.preset.isPresetValue(e)){this.preset.setActiveValue(e);this.unsetColorpickerActive()}else{this.preset.unsetActive();this.setColorpickerActive()}}unsetActive(){this.preset.unsetActive();this.unsetColorpickerActive()}setColorpickerActive(){u.Dom.addClass(this.getContainerLayout(),Vt.ACTIVE_CLASS)}unsetColorpickerActive(){this.colorpickerFrom.unsetActive();this.colorpickerTo.unsetActive();u.Dom.removeClass(this.getContainerLayout(),Vt.ACTIVE_CLASS)}}Vt.DISABLE_CLASS="disable";class Ot extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BgColor");this.property=["background-image","background-color"];this.variableName="--bg";this.className="g-bg";this.activeControl=null;this.gradient=new Vt(e);this.gradient.subscribe("onChange",this.onGradientChange.bind(this));this.tabs.prependTab("Gradient",u.Loc.getMessage("LANDING_FIELD_COLOR-TAB_GRADIENT"),this.gradient);this.setGradientPreset(this.colorSet.getPreset());this.colorSet.subscribe("onPresetChange",(e=>{this.setGradientPreset(e.getData().preset)}));this.tabs.subscribe("onToggle",this.onTabsToggle.bind(this))}setGradientPreset(e){const t=e.getGradientPreset();this.gradient.setPreset(t);t.subscribe("onChange",(()=>{this.activeControl=this.gradient;this.onChange()}));const i=this.getValue();if(i!==null&&i instanceof oe&&this.gradient.getPreset().isPresetValue(i)){this.colorSet.getPreset().unsetActive();this.gradient.getPreset().setActiveValue(i);this.gradient.unsetColorpickerActive()}}onColorSetChange(e){this.activeControl=this.colorSet;this.gradient.unsetActive();super.onColorSetChange(e)}onGradientChange(e){this.activeControl=this.gradient;this.colorSet.unsetActive();const t=e.getData().gradient;if(t!==null){this.opacity.setValue(t.setOpacity(this.opacity.getValue().getOpacity()))}this.onChange()}onOverlayOpacityChange(){this.onChange()}onTabsToggle(){this.gradient.getPopup().close()}unsetActive(){this.colorSet.unsetActive();this.gradient.unsetActive();this.primary.unsetActive()}setValue(e){this.colorSet.setValue(null);this.gradient.setValue(null);this.unsetActive();this.activeControl=null;if(u.Type.isNil(e));else if(d(e)||m(e)||f(e)||I(e)){super.setValue(e);this.activeControl=this.colorSet}else if(se(e)){this.activeControl=this.gradient;const t=new oe(e);this.gradient.setValue(t);this.opacity.setValue(t);const i=this.colorSet.getPresetsCollection();const s=i.getGlobalActiveId()?i.getPresetById(i.getGlobalActiveId()):i.getPresetByItemValue(t);if(s!==null&&s!==this.colorSet.getPreset()){this.colorSet.setPreset(s);this.setGradientPreset(s)}this.tabs.showTab("Gradient");if(t.getOpacity()<1){this.tabs.showTab("Opacity")}}}getValue(){return this.cache.remember("value",(()=>{if(this.activeControl===null){return null}if(this.activeControl===this.gradient){const e=this.gradient.getValue();return e===null?e:e.setOpacity(this.opacity.getValue().getOpacity())}return super.getValue()}))}}const Nt=/url\(['"]?([^ '"]*)['"]?\)([\w \/]*)/i;function Rt(e){if(!!e.trim().match(Nt)){return true}return!!e.trim().match(Dt())}function Dt(){const e=J(Nt);const t=J(Q);return new RegExp(`^${t},${e}`)}class wt{constructor(e){this.value=D;this.setValue(e)}getName(){return`\n\t\t\t${this.value.url.replace(/[^\w\d]/g,"")}_${this.value.size}_${this.value.attachment}\n\t\t`}setValue(e){if(u.Type.isObject(e)){if(e instanceof wt){this.value.url=e.getUrl();this.value.url2x=e.getUrl2x();this.value.fileId=e.getFileId();this.value.fileId2x=e.getFileId2x();this.value.size=e.getSize();this.value.attachment=e.getAttachment()}else{this.value={...this.value,...e}}}if(u.Type.isString(e)&&Rt(e)){this.parseBgString(e)}return this}parseBgString(e){const t=D;const i=e.trim().match(K(Nt));if(!!i){t.url=i[1];t.size=i[2].indexOf("auto")===-1?O:"auto";t.attachment=i[2].indexOf("fixed")===-1?N:"fixed"}const s=e.trim().match(K(ie));if(!!e.trim().match(K(Q))&&!!s){t.overlay=new w(s[0])}this.setValue(t)}setOpacity(e){return this}setUrl(e){this.setValue({url:e});return this}setUrl2x(e){this.setValue({url2x:e});return this}setFileId(e){this.setValue({fileId:e});return this}setFileId2x(e){this.setValue({fileId2x:e});return this}setSize(e){this.setValue({size:e});return this}setAttachment(e){this.setValue({attachment:e});return this}setOverlay(e){this.setValue({overlay:e});return this}getUrl(){return this.value.url}getUrl2x(){return this.value.url2x}getFileId(){return this.value.fileId}getFileId2x(){return this.value.fileId2x}getSize(){return this.value.size}getAttachment(e=false){return e?this.value.attachment==="fixed":this.value.attachment}getOverlay(){return this.value.overlay}getOpacity(){return 1}getStyleString(){let e="";if(this.value.overlay!==null){e=`linear-gradient(${this.value.overlay.getStyleString()},${this.value.overlay.getStyleString()})`}const{url:t,url2x:i,size:s,attachment:o}=this.value;const a=`center / ${s} ${o}`;if(t!==null){e=e.length?e+",":"";if(i!==null){e+=`-webkit-image-set(url('${t}') 1x, url('${i}') 2x) ${a},`;e+=`image-set(url('${t}') 1x, url('${i}') 2x) ${a},`}e+=`url('${t}') ${a}`}return e}getStyleStringForOpacity(){return""}static getSizeItemsForButtons(){return[{name:u.Loc.getMessage("LANDING_FIELD_COLOR-BG_COVER"),value:"cover"},{name:u.Loc.getMessage("LANDING_FIELD_COLOR-BG_MOSAIC"),value:"auto"}]}static getAttachmentValueByBool(e){return e?"fixed":"scroll"}}let Bt=e=>e,xt;class kt extends k{constructor(e){super();this.setEventNamespace("BX.Landing.UI.Field.Color.Image");this.options=e;this.imgField=new r.Image({id:"landing_ui_color_image_"+u.Text.getRandom().toLowerCase(),className:"landing-ui-field-color-image-image",contextType:r.Image.CONTEXT_TYPE_STYLE,compactMode:true,disableLink:true,disableAltField:true,allowClear:true,isAiImageAvailable:c.Env.getInstance().getOptions()["ai_image_available"],isAiImageActive:c.Env.getInstance().getOptions()["ai_image_active"],aiUnactiveInfoCode:c.Env.getInstance().getOptions()["ai_unactive_info_code"],dimensions:{width:1920},uploadParams:{action:"Block::uploadFile",block:this.options.block.id},contentRoot:this.options.contentRoot});this.imgField.subscribe("change",this.onImageChange.bind(this));this.sizeField=new BX.Landing.UI.Field.Dropdown({id:"landing_ui_color_image_size_"+u.Text.getRandom().toLowerCase(),title:u.Loc.getMessage("LANDING_FIELD_COLOR-BG_SIZE_TITLE"),className:"landing-ui-field-color-image-size",items:wt.getSizeItemsForButtons(),onChange:this.onSizeChange.bind(this),contentRoot:this.options.contentRoot});this.attachmentField=new BX.Landing.UI.Field.Checkbox({id:"landing_ui_color_image_attach_"+u.Text.getRandom().toLowerCase(),className:"landing-ui-field-color-image-attachment",multiple:false,compact:true,items:[{name:u.Loc.getMessage("LANDING_FIELD_COLOR-BG_FIXED"),value:"fixed"}],onChange:this.onAttachmentChange.bind(this),value:[this.getAttachmentValue()]})}buildLayout(){return u.Tag.render(xt||(xt=Bt`
			<div class="landing-ui-field-color-image">
				${0}
				${0}
				${0}
			</div>
		`),this.imgField.getLayout(),this.sizeField.getLayout(),this.attachmentField.getLayout())}onImageChange(e){const t=this.getValue()||new wt;if(e.getData().value.src){t.setUrl(e.getData().value.src);t.setFileId(e.getData().value.id);if(e.getData().value.src2x){t.setUrl2x(e.getData().value.src2x);t.setFileId2x(e.getData().value.id2x)}}else{t.setUrl(null);t.setFileId(null);t.setUrl2x(null);t.setFileId2x(null)}this.setValue(t);this.onChange();this.saveNode(t)}saveNode(e){const t=this.options.styleNode;const i=this.options.block;let s;if(t.selector===i.selector||t.selector===i.makeAbsoluteSelector(i.selector)){s="#wrapper"}else if(!t.isSelectGroup()){s=BX.Landing.Utils.join(t.selector.split("@")[0],"@",t.getElementIndex(t.getNode()[0]))}else{s=t.selector.split("@")[0]}const o={[s]:{}};o[s].id=e.getFileId()||-1;o[s].id2x=e.getFileId2x()||-1;l.Backend.getInstance().action("Landing\\Block::updateNodes",{lid:this.options.block.lid,block:this.options.block.id,data:o})}onSizeChange(e){if(u.Type.isString(e)){const t=this.getValue()||new wt;t.setSize(e);this.setValue(t);this.onChange()}}onAttachmentChange(e){if(e instanceof n.BaseEvent){const e=this.getValue()||new wt;e.setAttachment(wt.getAttachmentValueByBool(this.attachmentField.getValue()));this.setValue(e);this.onChange()}}onChange(e){this.cache.delete("value");this.emit("onChange",{data:{image:this.getValue()}})}getValue(){return this.cache.remember("value",(()=>{const e=this.imgField.getValue();const t=e.src;if(t===null){return null}else{const i=new wt({url:t,fileId:e.id});if(e.src2x){i.setUrl2x(e.src2x);i.setFileId2x(e.fileId2x)}const s=this.sizeField.getValue();if(s!==null){i.setSize(s)}i.setAttachment(wt.getAttachmentValueByBool(this.attachmentField.getValue()));return i}}))}setValue(e){if(this.isNeedSetValue(e)){super.setValue(e);if(e===null){this.imgField.setValue({src:""},true)}else{if(e.getUrl()!==null){this.setActive()}const t={type:"image",src:e.getUrl(),id:e.getFileId()};if(e.getUrl2x()){t.src2x=e.getUrl2x();t.id2x=e.getFileId2x()}this.imgField.setValue(t,true);this.sizeField.setValue(this.getSizeValue(),true);this.attachmentField.setValue([this.getAttachmentValue()])}}}setActive(){u.Dom.addClass(this.imgField.getLayout(),kt.ACTIVE_CLASS)}unsetActive(){u.Dom.removeClass(this.imgField.getLayout(),kt.ACTIVE_CLASS)}getAttachmentValue(){if(this.options&&this.options.block&&this.options.block.content&&u.Dom.hasClass(this.options.block.content,"g-bg-image")){const e=window.getComputedStyle(this.options.block.content);const t=e.getPropertyValue("background-attachment");return t.includes("fixed")?"fixed":"scroll"}return"scroll"}getSizeValue(){if(this.options&&this.options.block&&this.options.block.content&&u.Dom.hasClass(this.options.block.content,"g-bg-image")){const e=window.getComputedStyle(this.options.block.content);const t=e.getPropertyValue("background-size");return t.includes("cover")?"cover":"auto"}return"cover"}}function Ft(e){const t=/\d{1,3}(\.\d+)?/g;const i=e.match(t);const s=i[0]?i[0]:null;const o=i[1]?i[1]:null;const a=i[2]?i[2]:null;if(s===null||o===null||a===null){return null}return Mt(s,o,a)}function Mt(e,t,i){return"rgb("+e+","+t+","+i+")"}let Ht=e=>e,Gt;class Ut extends Ot{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.Bg");this.styleNode=e.styleNode;this.parentVariableName=this.variableName;this.variableName=[this.parentVariableName,Ut.BG_URL_VAR,Ut.BG_URL_2X_VAR,Ut.BG_OVERLAY_VAR,Ut.BG_SIZE_VAR,Ut.BG_ATTACHMENT_VAR,Ut.BG_IMAGE];this.parentClassName=this.className;this.className="g-bg-image";this.image=new kt(e);this.image.subscribe("onChange",this.onImageChange.bind(this));this.overlay=new Qe(e);this.overlay.subscribe("onChange",this.onOverlayColorChange.bind(this));this.overlayOpacity=new ot({defaultOpacity:.5});this.overlayOpacity.subscribe("onChange",this.onOverlayOpacityChange.bind(this));this.overlayPrimary=new q;this.overlayPrimary.subscribe("onChange",this.onOverlayPrimaryChange.bind(this));const t={textCode:"LANDING_FIELD_COLOR_OVERLAY_ZEROING_TITLE_2",styleNode:e.styleNode};this.overlayZeroing=new vt(t);this.overlayZeroing.subscribe("onChange",this.overlayZeroingChange.bind(this));this.imageTabs=(new gt).appendTab("Overlay",u.Loc.getMessage("LANDING_FIELD_COLOR-BG_OVERLAY"),[this.overlay,this.overlayPrimary,this.overlayZeroing,this.overlayOpacity]);this.bigTabs=(new gt).setBig(true).appendTab("Color",u.Loc.getMessage("LANDING_FIELD_COLOR-BG_COLOR"),[this.colorSet,this.primary,this.zeroing,this.tabs]).appendTab("Image",u.Loc.getMessage("LANDING_FIELD_COLOR-BG_IMAGE"),[this.image,this.imageTabs])}buildLayout(){return u.Tag.render(Gt||(Gt=Ht`
			<div class="landing-ui-field-color-color">
				${0}
			</div>
		`),this.bigTabs.getLayout())}onColorSetChange(e){this.image.unsetActive();this.overlay.unsetActive();super.onColorSetChange(e)}onGradientChange(e){this.image.unsetActive();this.overlay.unsetActive();super.onGradientChange(e)}onImageChange(){this.unsetActive();this.activeControl=this.image;this.image.setActive();this.modifyStyleNode(this.styleNode)}onOverlayChange(e){const t=e.getData().color;if(t!==null){t.setOpacity(this.overlayOpacity.getValue().getOpacity())}this.overlayOpacity.setValue(t);const i=this.image.getValue();if(i!==null){this.image.setValue(i.setOverlay(t));this.activeControl=this.image;this.image.setActive();this.colorSet.unsetActive();this.gradient.unsetActive()}this.modifyStyleNode(this.styleNode)}onOverlayOpacityChange(){this.modifyStyleNode(this.styleNode)}onOverlayColorChange(e){this.overlayPrimary.unsetActive();this.overlayZeroing.unsetActive();this.onOverlayChange(e)}onOverlayPrimaryChange(e){this.overlay.unsetActive();this.overlayZeroing.unsetActive();this.onOverlayChange(e)}overlayZeroingChange(e){this.overlay.unsetActive();this.overlayPrimary.unsetActive();this.overlayZeroing.setActive();this.onOverlayChange(e)}unsetActive(){super.unsetActive();this.image.unsetActive()}setProcessorValue(e){this.cache.delete("value");this.setValue(e)}setValue(e){this.image.setValue(null);this.bigTabs.showTab("Color");if(u.Type.isNull(e)){super.setValue(e)}else if(u.Type.isString(e)){super.setValue(e)}else if(this.parentVariableName in e&&u.Type.isString(e[this.parentVariableName])){super.setValue(e[this.parentVariableName])}else if(u.Type.isObject(e)){const t=new wt;if(Ut.BG_URL_VAR in e){t.setUrl(e[Ut.BG_URL_VAR].replace(/url\(["']/i,"").replace(/['"]\)/i,""))}if(Ut.BG_URL_2X_VAR in e){t.setUrl2x(e[Ut.BG_URL_2X_VAR].replace(/url\(["']/i,"").replace(/['"]\)/i,""))}if(Ut.BG_SIZE_VAR in e){t.setSize(e[Ut.BG_SIZE_VAR])}if(Ut.BG_ATTACHMENT_VAR in e){t.setAttachment(e[Ut.BG_ATTACHMENT_VAR])}if(Ut.BG_OVERLAY_VAR in e){t.setOverlay(new w(e[Ut.BG_OVERLAY_VAR]))}this.image.setValue(t);this.bigTabs.showTab("Image");this.activeControl=this.image;this.imageTabs.showTab("Overlay");if(Ut.BG_OVERLAY_VAR in e){const t=new w(e[Ut.BG_OVERLAY_VAR]);this.overlay.setValue(t);this.overlayOpacity.setValue(t);if(e[Ut.BG_OVERLAY_VAR].startsWith("var(--primary")||e["isPrimaryBasedColor"]===true){this.overlayPrimary.setActive();this.overlay.unsetActive()}}else{this.overlayZeroing.setActive()}}}getValue(){return this.cache.remember("value",(()=>{if(this.activeControl===this.image){const e=this.image.getValue();let t;let i=false;if(this.overlay.isActive()){t=this.overlay.getValue();i=true}if(this.overlayPrimary.isActive()){t=this.overlayPrimary.getValue();i=true}if(this.overlayZeroing.isActive()){t=null}if(e!==null&&t!==null&&i){t.setOpacity(this.overlayOpacity.getValue().getOpacity());e.setOverlay(t)}return e}else{return super.getValue()}}))}getClassName(){const e=this.getValue();if(e===null||e instanceof w||e instanceof oe){return[this.parentClassName]}return[this.className]}getStyle(){if(this.getValue()===null){return{[this.parentVariableName]:null,[Ut.BG_URL_VAR]:null,[Ut.BG_URL_2X_VAR]:null,[Ut.BG_OVERLAY_VAR]:null,[Ut.BG_SIZE_VAR]:null,[Ut.BG_ATTACHMENT_VAR]:null}}const e=this.getValue();let t=null;let i=null;let s=null;let o=null;let a=null;let n=null;const r="";if(e instanceof w||e instanceof oe){t=e.getStyleString()}else{i=e.getUrl()?`url('${e.getUrl()}')`:"";s=e.getUrl2x()?`url('${e.getUrl2x()}')`:"";o=e.getOverlay()?e.getOverlay().getStyleString():"rgba(0, 0, 0, 0)";a=e.getSize();n=e.getAttachment()}return{[this.parentVariableName]:t,[Ut.BG_URL_VAR]:i,[Ut.BG_URL_2X_VAR]:s?s:i,[Ut.BG_OVERLAY_VAR]:o,[Ut.BG_SIZE_VAR]:a,[Ut.BG_ATTACHMENT_VAR]:n,[Ut.BG_IMAGE]:r}}modifyStyleNode(e){u.Dom.style(e.getNode()[0],Ut.BG_IMAGE,"");this.onChange()}prepareProcessorValue(e,t){if(t&&t.hasOwnProperty(Ut.BG_IMAGE)){const i=/url\(/i;const s=t[Ut.BG_IMAGE].match(i);if(s!==null){e[Ut.BG_IMAGE]="";e[Ut.BG_SIZE_VAR]=O;e[Ut.BG_ATTACHMENT_VAR]=N;const i=/image-set\(url\(/i;const s=t[Ut.BG_IMAGE].match(i);if(s!==null){const i=/["'](https?:\/)?\/[\S]*["']/gi;const s=t[Ut.BG_IMAGE].match(i);if(s){const t=/["']/g;e[Ut.BG_URL_VAR]=s[0].replaceAll(t,"");if(s.length===2){e[Ut.BG_URL_2X_VAR]=s[1].replaceAll(t,"")}else{e[Ut.BG_URL_2X_VAR]=s[0].replaceAll(t,"")}}}else{e[Ut.BG_URL_VAR]=t[Ut.BG_IMAGE];e[Ut.BG_URL_2X_VAR]=t[Ut.BG_IMAGE]}const o=getComputedStyle(this.styleNode.getNode()[0],":after");if(!e[Ut.BG_OVERLAY_VAR]){e[Ut.BG_OVERLAY_VAR]=o.backgroundColor}const a=Ft(o.backgroundColor);const n=Ft(o.getPropertyValue("--primary-opacity-0"));if(a!==null&&n!==null&&a===n){e["isPrimaryBasedColor"]=true}}}return e}}Ut.BG_URL_VAR="--bg-url";Ut.BG_URL_2X_VAR="--bg-url-2x";Ut.BG_OVERLAY_VAR="--bg-overlay";Ut.BG_SIZE_VAR="--bg-size";Ut.BG_ATTACHMENT_VAR="--bg-attachment";Ut.BG_IMAGE="background-image";class $t extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BorderColor");this.property="border-color";this.variableName="--border-color";this.className="g-border-color"}}class Xt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BorderColorHover");this.property="border-color";this.variableName="--border-color--hover";this.className="g-border-color--hover";this.pseudoClass=":hover"}}class Yt extends Ot{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BgColorHover");this.property=["background-image","background-color"];this.variableName="--bg-hover";this.className="g-bg--hover";this.pseudoClass=":hover"}}class zt extends Ot{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BgColorAfter");this.property=["background-image","background-color"];this.variableName="--bg--after";this.className="g-bg--after";this.pseudoClass=":after";const t=this.getValue()||new w;this.opacity.setValue(t.setOpacity(.5));this.tabs.showTab("Opacity")}}class jt extends Ot{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BgColorBefore");this.property=["background-image","background-color"];this.variableName="--bg--before";this.className="g-bg--before";this.pseudoClass=":before";const t=this.getValue()||new w;this.opacity.setValue(t.setOpacity(.5));this.tabs.showTab("Opacity")}}class Wt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColor");this.property="color";this.variableName="--navbar-color";this.className="u-navbar-color"}}class Zt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColorHover");this.property="color";this.variableName="--navbar-color--hover";this.className="u-navbar-color--hover";this.pseudoClass=":hover"}}class qt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColorFixMoment");this.property="color";this.variableName="--navbar-color--fix-moment";this.className="u-navbar-color--fix-moment"}}class Kt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarColorFixMomentHover");this.property="color";this.variableName="--navbar-color--fix-moment--hover";this.className="u-navbar-color--fix-moment--hover";this.pseudoClass=":hover"}}class Jt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarBgColor");this.property="background-color";this.variableName="--navbar-bg-color";this.className="u-navbar-bg"}}class Qt extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarBgColorHover");this.property="background-color";this.variableName="--navbar-bg-color--hover";this.className="u-navbar-bg--hover";this.pseudoClass=":hover"}}class ei extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.BorderColorTop");this.property="border-top-color";this.variableName="--border-color-top";this.className="g-border-color-top"}}class ti extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.FillColor");this.property="fill";this.pseudoClass=":before";this.variableName="--fill-first";this.className="g-fill-first"}}class ii extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.FillColorSecond");this.property="fill";this.pseudoClass=":after";this.variableName="--fill-second";this.className="g-fill-second"}}class si extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.ButtonColor");this.property="background-color";this.variableName=[si.COLOR_CONTRAST_VAR,si.COLOR_HOVER_VAR,si.COLOR_LIGHT_VAR,si.COLOR_VAR];this.className="g-button-color"}getStyle(){if(this.getValue()===null){return{[si.COLOR_CONTRAST_VAR]:null,[si.COLOR_HOVER_VAR]:null,[si.COLOR_LIGHT_VAR]:null,[si.COLOR_VAR]:null}}const e=this.getValue();const t=e.getContrast().lighten(10);const i=new w(e).lighten(10);const s=e.getLighten();return{[si.COLOR_CONTRAST_VAR]:t.getStyleString(),[si.COLOR_HOVER_VAR]:i.getStyleString(),[si.COLOR_LIGHT_VAR]:s.getStyleString(),[si.COLOR_VAR]:e.getStyleString()}}}si.COLOR_CONTRAST_VAR="--button-color-contrast";si.COLOR_HOVER_VAR="--button-color-hover";si.COLOR_LIGHT_VAR="--button-color-light";si.COLOR_VAR="--button-color";class oi extends bt{constructor(e){super(e);this.setEventNamespace("BX.Landing.UI.Field.Processor.NavbarCollapseBgColor");this.property="background-color";this.variableName="--navbar-collapse-bg-color";this.className="u-navbar-collapse-bg"}}class ai extends t.BaseField{constructor(e){super(e);this.items="items"in e&&e.items?e.items:[];this.postfix=typeof e.postfix==="string"?e.postfix:"";this.frame=typeof e.frame==="object"?e.frame:null;const t={block:e.block,style:e.style,styleNode:e.styleNode,selector:e.selector,contentRoot:this.contentRoot,content:e.content};this.changeHandler=typeof e.onChange==="function"?e.onChange:()=>{};this.valueChangeHandler=typeof e.onValueChange==="function"?e.onValueChange:()=>{};switch(e.subtype){case"color":this.processor=new bt(t);break;case"color-hover":this.processor=new yt(t);break;case"bg":this.processor=new Ut(t);break;case"bg-color":this.processor=new Ot(t);break;case"bg-color-hover":this.processor=new Yt(t);break;case"bg-color-after":this.processor=new zt(t);break;case"bg-color-before":this.processor=new jt(t);break;case"border-color":this.processor=new $t(t);break;case"border-color-hover":this.processor=new Xt(t);break;case"border-color-top":this.processor=new ei(t);break;case"navbar-color":this.processor=new Wt(t);break;case"navbar-color-hover":this.processor=new Zt(t);break;case"navbar-color-fix-moment":this.processor=new qt(t);break;case"navbar-color-fix-moment-hover":this.processor=new Kt(t);break;case"navbar-bg-color":this.processor=new Jt(t);break;case"navbar-bg-color-hover":this.processor=new Qt(t);break;case"navbar-collapse-bg-color":this.processor=new oi(t);break;case"fill-color":this.processor=new ti(t);break;case"fill-color-second":this.processor=new ii(t);break;case"button-color":this.processor=new si(t);break;default:break}if(!this.processor){return}this.property=this.processor.getProperty()[this.processor.getProperty().length-1];this.processor.getClassName().forEach((e=>this.items.push({name:e,value:e})));u.Dom.remove(this.input);this.layout.classList.add("landing-ui-field-color");u.Dom.append(this.processor.getLayout(),this.layout);this.processor.subscribe("onChange",this.onChange.bind(this))}getInlineProperties(){return this.processor.getVariableName()}prepareInlineProperties(e){e.push("background-image");return e}getComputedProperties(){return this.processor.getProperty()}getPseudoElement(){return this.processor.getPseudoClass()}onChange(){this.changeHandler({className:this.processor.getClassName(),style:this.processor.getStyle()},this.items,this.postfix,this.property);const e=this.getValue();let t="";if(e instanceof w){t=e.getStyleString()}else if(e instanceof wt){t=e.getUrl()}else if(e instanceof oe){t=e.getStyleString()}this.valueChangeHandler(new i.TextField({selector:this.selector,attribute:this.attribute,content:t,textOnly:true}));this.emit("onChange")}getValue(){return this.processor.getValue()||this.processor.getNullValue()}setValue(e){let t=null;this.prepareInlineProperties(this.getInlineProperties()).forEach((i=>{if(i in e&&!this.processor.isNullValue(e[i])){if(!u.Type.isObject(t)){t={}}t[i]=e[i]}}));let i=null;this.getComputedProperties().forEach((t=>{if(t in e&&!this.processor.isNullValue(e[t])){if(!u.Type.isObject(i)){i={}}i[t]=e[t]}}));t=this.processor.prepareProcessorValue(t,i);if(t!==null){this.processor.setProcessorValue(t)}else{this.processor.setDefaultValue(i);this.processor.defineActiveControl(this.items,this.data.styleNode)}}onFrameLoad(){const e=this.data.styleNode.getValue(true);this.setValue(e.style)}createPopup(e){this.colorPopup=new $e(e)}}e.ColorField=ai})(this.BX.Landing.UI.Field=this.BX.Landing.UI.Field||{},BX.Landing.UI.Field,BX.Landing.UI.Field,BX.Main,BX,BX,BX.Event,BX.Landing.UI.Field,BX.Landing,BX.Landing,BX.Landing,BX);
//# sourceMappingURL=color_field.bundle.map.js