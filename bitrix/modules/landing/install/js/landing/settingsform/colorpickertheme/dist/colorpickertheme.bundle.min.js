this.BX=this.BX||{};(function(e,t,a){"use strict";var r=/^rgba? ?\((\d{1,3})[, ]+(\d{1,3})[, ]+(\d{1,3})([, ]+([\d\.]{1,5}))?\)$/i;function i(e){return!!e.match(r)}var s=/^#([\da-f]{3}){1,2}$/i;function n(e){return!!e.trim().match(s)}var l=/^hsla?\((\d{1,3}), ?(\d{1,3})%, ?(\d{1,3})%(, ?([\d .]+))?\)/i;function u(e){return!!e.trim().match(l)}function o(e){if(e.length===4){var t=parseInt("0x".concat(e[1]).concat(e[1]),16);var a=parseInt("0x".concat(e[2]).concat(e[2]),16);var r=parseInt("0x".concat(e[3]).concat(e[3]),16);return{r:t,g:a,b:r}}if(e.length===7){var i=parseInt("0x".concat(e[1]).concat(e[2]),16);var s=parseInt("0x".concat(e[3]).concat(e[4]),16);var n=parseInt("0x".concat(e[5]).concat(e[6]),16);return{r:i,g:s,b:n}}return{r:255,g:255,b:255}}function h(e){var t=e.r/255;var a=e.g/255;var r=e.b/255;var i=Math.max(t,a,r);var s=Math.min(t,a,r);var n,l,u=(i+s)/2;if(i===s){n=l=0}else{var o=i-s;l=u>.5?o/(2-i-s):o/(i+s);switch(i){case t:n=(a-r)/o+(a<r?6:0);break;case a:n=(r-t)/o+2;break;case r:n=(t-a)/o+4;break}n*=.6}return{h:Math.round(n*100),s:Math.round(l*100),l:Math.round(u*100),a:"a"in e?e.a:1}}function c(e){var t=o(e.trim());return h(t)}function v(e){var t=e.r.toString(16);var a=e.g.toString(16);var r=e.b.toString(16);if(t.length===1){t="0"+t}if(a.length===1){a="0"+a}if(r.length===1){r="0"+r}return"#"+t+a+r}function f(e){var t=e.h;var a=e.s/100;var r=e.l/100;var i=(1-Math.abs(2*r-1))*a;var s=i*(1-Math.abs(t/60%2-1));var n=r-i/2;var l=0;var u=0;var o=0;if(0<=t&&t<60){l=i;u=s;o=0}else if(60<=t&&t<120){l=s;u=i;o=0}else if(120<=t&&t<180){l=0;u=i;o=s}else if(180<=t&&t<240){l=0;u=s;o=i}else if(240<=t&&t<300){l=s;u=0;o=i}else if(300<=t&&t<360){l=i;u=0;o=s}l=Math.round((l+n)*255);u=Math.round((u+n)*255);o=Math.round((o+n)*255);return{r:l,g:u,b:o}}function p(e){var t=f(e);return v(t)}function g(e){var t=e.trim().match(r);if(t.length>0){return h({r:a.Text.toNumber(t[1]),g:a.Text.toNumber(t[2]),b:a.Text.toNumber(t[3]),a:t[5]?a.Text.toNumber(t[5]):1})}}function d(e){var t=e.trim().match(l);if(t&&t.length>0){return{h:a.Text.toNumber(t[1]),s:a.Text.toNumber(t[2]),l:a.Text.toNumber(t[3]),a:t[5]?a.Text.toNumber(t[5]):1}}}var m=/^(var\()?((--[\w\d-]*?)(-opacity_([\d_]+)?)?)\)?$/i;function y(e){return!!e.trim().match(m)}function b(e){var t=e.trim().match(m);if(!!t){var a={full:t[2],name:t[3]};if(t[3]){var r="--primary-opacity-0_";var i="--primary-opacity-0";if(t[3].startsWith(i)&&!t[3].startsWith(r)){a.opacity=0}if(t[3].startsWith(r)){var s=t[3].substr(r.length);if(s.length===1&&s!==0){s=s/10}if(s.length===2){s=s/100}a.opacity=s}}if(t[5]){a.opacity=+parseFloat(t[5].replace("_",".")).toFixed(1)}return a}return null}var C={h:205,s:1,l:50,a:1};function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=function(){function e(t){babelHelpers.classCallCheck(this,e);this.value=C;this.hex=null;this.cssVar=null;this.setValue(t)}babelHelpers.createClass(e,[{key:"getName",value:function e(){if(this.hex){return this.getHex()+"_"+this.getOpacity()}var t=this.getHsl(),a=t.h,r=t.s,i=t.l;return"".concat(a,"-").concat(r,"-").concat(i,"-").concat(this.getOpacity())}},{key:"setValue",value:function t(r){if(a.Type.isObject(r)){if(r instanceof e){this.value=r.getHsla();this.cssVar=r.getCssVar();this.hex=r.getHexOriginal()}else{this.value=H(H({},this.value),r)}}if(a.Type.isString(r)){if(u(r)){this.value=d(r)}else if(n(r)){this.value=H(H({},c(r)),{},{a:C.a});this.hex=r}else if(i(r)){this.value=g(r)}else if(y(r)){var s=b(r);var l="--primary";if(s!==null){this.cssVar=s.name;if("opacity"in s){this.cssVar=l;this.setValue(a.Dom.style(document.documentElement,this.cssVar));this.setOpacity(s.opacity)}else{this.setValue(a.Dom.style(document.documentElement,this.cssVar))}}}}this.value.h=Math.round(this.value.h);this.value.s=Math.round(this.value.s);this.value.l=Math.round(this.value.l);this.value.a=this.value.a.toFixed(2);var o=Math.round(this.value.a*100%5);if(o<3){this.value.a=(this.value.a*100-o)/100}else{this.value.a=(this.value.a*100-o+5)/100}return this}},{key:"setOpacity",value:function e(t){this.setValue({a:t});return this}},{key:"lighten",value:function e(t){this.value.l=Math.min(this.value.l+t,100);this.hex=null;return this}},{key:"darken",value:function e(t){this.value.l=Math.max(this.value.l-t,0);this.hex=null;return this}},{key:"saturate",value:function e(t){this.value.s=Math.min(this.value.s+t,100);this.hex=null;return this}},{key:"desaturate",value:function e(t){this.value.s=Math.max(this.value.s-t,0);this.hex=null;return this}},{key:"adjustHue",value:function e(t){this.value.h=(this.value.h+t)%360;return this}},{key:"getHsl",value:function e(){return{h:this.value.h,s:this.value.s,l:this.value.l}}},{key:"getHsla",value:function e(){var t=this.value.a||1;return{h:this.value.h,s:this.value.s,l:this.value.l,a:t}}},{key:"getHex",value:function e(){return this.hex||p(this.value)}},{key:"getHexOriginal",value:function e(){return this.hex}},{key:"getOpacity",value:function e(){var t;return(t=this.value.a)!==null&&t!==void 0?t:C.a}},{key:"getCssVar",value:function e(){return this.cssVar}},{key:"getStyleString",value:function e(){if(this.cssVar===null){if(this.hex&&this.getOpacity()===C.a){return this.hex}var t=this.value,a=t.h,r=t.s,i=t.l,s=t.a;return"hsla(".concat(a,", ").concat(r,"%, ").concat(i,"%, ").concat(s,")")}else{var n=this.cssVar;if(this.value.a!==C.a){n=n+"-opacity-"+String(this.value.a).replace(".","_")}return"var(".concat(n,")")}}},{key:"getStyleStringForOpacity",value:function e(){var t=this.value,a=t.h,r=t.s,i=t.l;return"linear-gradient(to right, hsla(".concat(a,", ").concat(r,"%, ").concat(i,"%, 0) 0%, hsla(").concat(a,", ").concat(r,"%, ").concat(i,"%, 1) 100%)")}},{key:"getContrast",value:function t(){var a=60;var r=this.getHsl().h*Math.PI/180;a+=Math.sin(r)*10+5;var i=a-45*this.getHsl().l/100;return new e(this.value).setValue({l:(this.getHsl().l+i)%100})}},{key:"getLighten",value:function t(){var a=this.getHsl(),r=a.h,i=a.s,s=a.l;if(i>0){i+=(s-50)/100*60;i=Math.min(100,Math.max(0,s))}s+=10+20*s/100;s=Math.min(100,s);return new e({h:r,s:i,l:s})}}],[{key:"compare",value:function e(t,a){return t.getHsla().h===a.getHsla().h&&t.getHsla().s===a.getHsla().s&&t.getHsla().l===a.getHsla().l&&t.getHsla().a===a.getHsla().a&&t.cssVar===a.cssVar}},{key:"getMedian",value:function t(a,r){return new e({h:(a.getHsla().h+r.getHsla().h)/2,s:(a.getHsla().s+r.getHsla().s)/2,l:(a.getHsla().l+r.getHsla().l)/2,a:(a.getHsla().a+r.getHsla().a)/2})}}]);return e}();var x=function(e){babelHelpers.inherits(a,e);function a(e,t,r){var i;var s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};babelHelpers.classCallCheck(this,a);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(a).call(this));i.setEventNamespace("BX.Landing.ColorPickerTheme");i.element=e;i.loader=new BX.Loader({target:e,size:43});i.input=i.element.firstElementChild;i.allColors=t;i.currentColor=r;i.initMetrika(s);i.init();return i}babelHelpers.createClass(a,[{key:"initMetrika",value:function e(t){this.metrikaParams=t}},{key:"init",value:function e(){var t=this;var a=this.initPreviewColor();var r=this.isActive();this.element.style.backgroundColor=a;this.element.dataset.value=a;this.element.classList.add("landing-colorpicker-theme");if(r){this.input.setAttribute("value",a);this.element.classList.add("active")}this.colorField=new BX.Landing.UI.Field.ColorField({subtype:"color"});this.colorField.createPopup({contentRoot:null,isNeedCalcPopupOffset:false,isNeedResetPopupWhenOpen:false,analytics:this.getMetrikaParams()});this.colorField.colorPopup.subscribe("onHexColorPopupChange",(function(e){t.onColorSelected(e.data)}));this.colorField.colorPopup.subscribe("onPopupShow",(function(e){t.loader.hide()}));BX.bind(this.element,"click",this.open.bind(this))}},{key:"initPreviewColor",value:function e(){var t;if(this.currentColor){if(this.isHex(this.currentColor)){t=this.isBaseColor()?a.DEFAULT_COLOR_PICKER_COLOR:this.currentColor}else{t=a.DEFAULT_COLOR_PICKER_COLOR}}else{t=a.DEFAULT_COLOR_PICKER_COLOR}return t}},{key:"isActive",value:function e(){if(!this.isHex(this.currentColor)){return false}return!this.isBaseColor()}},{key:"isBaseColor",value:function e(){return this.allColors.includes(this.currentColor)}},{key:"getSelectedColor",value:function e(){var t;if(this.element.dataset.value){t=this.element.dataset.value}t=this.prepareColor(t);if(!this.isHex(t)){t=""}return t}},{key:"onColorSelected",value:function e(a){this.element.classList.add("ui-colorpicker-selected");this.element.dataset.value=a.substr(1);this.element.style.backgroundColor=a;var r=new t.BaseEvent({data:{color:a,node:this.element}});this.emit("onSelectColor",r);this.emit("onSelectCustomColor",r);this.input.setAttribute("value",a)}},{key:"open",value:function e(){this.loader.show();this.colorField.colorPopup.setValue(new O(this.getSelectedColor()));this.colorField.colorPopup.onPopupOpenClick(event,this.element)}},{key:"prepareColor",value:function e(t){if(t[0]!=="#"){t="#"+t}return t}},{key:"isHex",value:function e(t){var r=false;if(t.length===4||t.length===7){if(t.match(a.MATCH_HEX)){r=true}}return r}},{key:"getMetrikaParams",value:function e(){var t,a;return{category:"settings",c_sub_section:"primary",p1:(t=(a=this.metrikaParams)===null||a===void 0?void 0:a.p1)!==null&&t!==void 0?t:null}}}]);return a}(t.EventEmitter);babelHelpers.defineProperty(x,"DEFAULT_COLOR_PICKER_COLOR","#f25a8f");babelHelpers.defineProperty(x,"MATCH_HEX",/#?([0-9A-F]{3}){1,2}$/i);e.ColorPickerTheme=x})(this.BX.Landing=this.BX.Landing||{},BX.Event,BX);
//# sourceMappingURL=colorpickertheme.bundle.map.js