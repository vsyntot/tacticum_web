{"version":3,"file":"colorpickertheme.bundle.js","sources":["../../../ui/field/color/src/internal/is-rgb-string.js","../../../ui/field/color/src/internal/is-hex.js","../../../ui/field/color/src/internal/is-hsl-string.js","../../../ui/field/color/src/internal/hex-to-rgb.js","../../../ui/field/color/src/internal/rgb-to-hsl.js","../../../ui/field/color/src/internal/hex-to-hsl.js","../../../ui/field/color/src/internal/rgb-to-hex.js","../../../ui/field/color/src/internal/hsl-to-rgb.js","../../../ui/field/color/src/internal/hsl-to-hex.js","../../../ui/field/color/src/internal/rgb-string-to-hsl.js","../../../ui/field/color/src/internal/hsl-string-to-hsl.js","../../../ui/field/color/src/internal/css-var.js","../../../ui/field/color/src/types/color_value_options.js","../../../ui/field/color/src/color_value.js","../src/colorpickertheme.js"],"sourcesContent":["export const matcher = /^rgba? ?\\((\\d{1,3})[, ]+(\\d{1,3})[, ]+(\\d{1,3})([, ]+([\\d\\.]{1,5}))?\\)$/i;\n\nexport default function isRgbString(rgbString: string): boolean\n{\n\treturn !!rgbString.match(matcher);\n}\n","export const matcherHex = /^#([\\da-f]{3}){1,2}$/i;\n\nexport default function isHex(hex: string)\n{\n\treturn !!hex.trim().match(matcherHex);\n}","export const matcherHsl = /^hsla?\\((\\d{1,3}), ?(\\d{1,3})%, ?(\\d{1,3})%(, ?([\\d .]+))?\\)/i;\n\nexport default function isHslString(hsla: string)\n{\n\treturn !!hsla.trim().match(matcherHsl);\n}","export default function hexToRgb(hex: string)\n{\n\tif (hex.length === 4)\n\t{\n\t\tconst r = parseInt(`0x${hex[1]}${hex[1]}`, 16);\n\t\tconst g = parseInt(`0x${hex[2]}${hex[2]}`, 16);\n\t\tconst b = parseInt(`0x${hex[3]}${hex[3]}`, 16);\n\n\t\treturn {r, g, b};\n\t}\n\n\tif (hex.length === 7)\n\t{\n\t\tconst r = parseInt(`0x${hex[1]}${hex[2]}`, 16);\n\t\tconst g = parseInt(`0x${hex[3]}${hex[4]}`, 16);\n\t\tconst b = parseInt(`0x${hex[5]}${hex[6]}`, 16);\n\n\t\treturn {r, g, b};\n\t}\n\n\treturn {r: 255, g: 255, b: 255};\n}","export default function rgbToHsla(\n\trgb: {r: number, g: number, b: number, a?: number}\n): {h: number, s: number, l: number, a: number}\n{\n\tconst r = rgb.r / 255;\n\tconst g = rgb.g / 255;\n\tconst b = rgb.b / 255;\n\n\tconst max = Math.max(r, g, b);\n\tconst min = Math.min(r, g, b);\n\tlet h, s, l = (max + min) / 2;\n\t// let l = h;\n\t// let s;\n\n\tif (max === min)\n\t{\n\t\th = s = 0;\n\t}\n\telse\n\t{\n\t\tconst d = max - min;\n\t\ts = l > 0.5\n\t\t\t? d / (2 - max - min)\n\t\t\t: d / (max + min);\n\n\t\tswitch (max)\n\t\t{\n\t\t\tcase r:\n\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\n\t\t\t\tbreak;\n\t\t\tcase g:\n\t\t\t\th = (b - r) / d + 2;\n\t\t\t\tbreak;\n\t\t\tcase b:\n\t\t\t\th = (r - g) / d + 4;\n\t\t\t\tbreak;\n\t\t}\n\n\t\th *= 0.6;\n\t}\n\n\treturn {\n\t\th: Math.round(h * 100),\n\t\ts: Math.round(s * 100),\n\t\tl: Math.round(l * 100),\n\t\ta: ('a' in rgb) ? rgb.a : 1,\n\t};\n}\n\n// \tconst v = Math.max(r, g, b);\n// \tconst diff = v - Math.min(r, g, b);\n// \tconst diffc = (c) => {\n// \t\treturn (v - c) / 6 / diff + 1 / 2;\n// \t};\n//\n// \tif (diff === 0)\n// \t{\n// \t\th = 0;\n// \t\ts = 0;\n// \t}\n// \telse\n// \t{\n// \t\ts = diff / v;\n// \t\trdif = diffc(r);\n// \t\tgdif = diffc(g);\n// \t\tbdif = diffc(b);\n//\n// \t\tif (r === v)\n// \t\t{\n// \t\t\th = bdif - gdif;\n// \t\t}\n// \t\telse if (g === v)\n// \t\t{\n// \t\t\th = (1 / 3) + rdif - bdif;\n// \t\t}\n// \t\telse if (b === v)\n// \t\t{\n// \t\t\th = (2 / 3) + gdif - rdif;\n// \t\t}\n//\n// \t\tif (h < 0)\n// \t\t{\n// \t\t\th += 1;\n// \t\t}\n// \t\telse if (h > 1)\n// \t\t{\n// \t\t\th -= 1;\n// \t\t}\n// \t}\n//\n// \treturn {\n// \t\th: h * 360,\n// \t\ts: s * 100,\n// \t\tl: v * 100,\n// \t\ta: rgb.a || 1,\n// \t};\n// }","import hexToRgb from './hex-to-rgb';\nimport rgbToHsla from './rgb-to-hsl';\n\nexport default function hexToHsl(hex: string): {h: number, s: number, l: number, a: number}\n{\n\tconst rgb = hexToRgb(hex.trim());\n\n\treturn rgbToHsla(rgb);\n}","export default function rgbToHex(rgb: {r: number, g: number, b: number}): string\n{\n\tlet r = rgb.r.toString(16);\n\tlet g = rgb.g.toString(16);\n\tlet b = rgb.b.toString(16);\n\n\tif (r.length === 1)\n\t{\n\t\tr = \"0\" + r;\n\t}\n\tif (g.length === 1)\n\t{\n\t\tg = \"0\" + g;\n\t}\n\tif (b.length === 1)\n\t{\n\t\tb = \"0\" + b;\n\t}\n\n\treturn \"#\" + r + g + b;\n}","export default function hslToRgb(hsl: {h: number, s: number, l: number}): {r: number, g: number, b: number}\n{\n\t// todo: a little not equal with reverce conversion :-/\n\t// todo: f.e. hsl(73.53.50) it 166,195,60 and #a5c33c,\n\t// todo: but in reverse #a5c33c => 165,195,60\n\t// todo: because we save ColorValue in hsl can be some differences\n\tconst h = hsl.h;\n\tconst s = hsl.s / 100;\n\tconst l = hsl.l / 100;\n\n\tlet c = (1 - Math.abs(2 * l - 1)) * s;\n\tlet x = c * (1 - Math.abs((h / 60) % 2 - 1));\n\tlet m = l - c / 2;\n\tlet r = 0;\n\tlet g = 0;\n\tlet b = 0;\n\n\tif (0 <= h && h < 60)\n\t{\n\t\tr = c;\n\t\tg = x;\n\t\tb = 0;\n\t}\n\telse if (60 <= h && h < 120)\n\t{\n\t\tr = x;\n\t\tg = c;\n\t\tb = 0;\n\t}\n\telse if (120 <= h && h < 180)\n\t{\n\t\tr = 0;\n\t\tg = c;\n\t\tb = x;\n\t}\n\telse if (180 <= h && h < 240)\n\t{\n\t\tr = 0;\n\t\tg = x;\n\t\tb = c;\n\t}\n\telse if (240 <= h && h < 300)\n\t{\n\t\tr = x;\n\t\tg = 0;\n\t\tb = c;\n\t}\n\telse if (300 <= h && h < 360)\n\t{\n\t\tr = c;\n\t\tg = 0;\n\t\tb = x;\n\t}\n\tr = Math.round((r + m) * 255);\n\tg = Math.round((g + m) * 255);\n\tb = Math.round((b + m) * 255);\n\n\treturn {r: r, g: g, b: b};\n}","import rgbToHex from './rgb-to-hex';\nimport hslToRgb from './hsl-to-rgb';\n\nexport default function hslToHex(hsl: {h: number, s: number, l: number}): string\n{\n\tconst rgb = hslToRgb(hsl);\n\n\treturn rgbToHex(rgb);\n}","import {Text} from 'main.core';\nimport rgbToHsla from '../internal/rgb-to-hsl';\nimport {matcher} from './is-rgb-string';\n\nexport default function rgbStringToHsla(rgbString: string): { h: number, s: number, l: number, a: number}\n{\n\tlet matches = rgbString.trim().match(matcher);\n\tif (matches.length > 0)\n\t{\n\t\treturn rgbToHsla({\n\t\t\tr: Text.toNumber(matches[1]),\n\t\t\tg: Text.toNumber(matches[2]),\n\t\t\tb: Text.toNumber(matches[3]),\n\t\t\ta: matches[5] ? Text.toNumber(matches[5]) : 1,\n\t\t});\n\t}\n}","import {Text} from 'main.core';\nimport {matcherHsl} from './is-hsl-string';\n\nexport default function hslStringToHsl(hslString: string): { h: number, s: number, l: number, a: number}\n{\n\tlet matches = hslString.trim().match(matcherHsl);\n\tif (matches && matches.length > 0)\n\t{\n\t\treturn {\n\t\t\th: Text.toNumber(matches[1]),\n\t\t\ts: Text.toNumber(matches[2]),\n\t\t\tl: Text.toNumber(matches[3]),\n\t\t\ta: matches[5] ? Text.toNumber(matches[5]) : 1,\n\t\t};\n\t}\n}","const matcher = /^(var\\()?((--[\\w\\d-]*?)(-opacity_([\\d_]+)?)?)\\)?$/i;\n\nexport function isCssVar(css: string): boolean\n{\n\treturn !!css.trim().match(matcher);\n}\n\ntype cssVar = {\n\tfull: string,\n\tname: string,\n\topacity: number,\n};\n\nexport function parseCssVar(css: string): ?cssVar\n{\n\tconst matches = css.trim().match(matcher);\n\tif (!!matches)\n\t{\n\t\tconst cssVar = {\n\t\t\tfull: matches[2],\n\t\t\tname: matches[3],\n\t\t};\n\n\t\tif (matches[3])\n\t\t{\n\t\t\tconst cssVarWithOpacity = '--primary-opacity-0_';\n\t\t\tconst cssVarWithOpacity0 = '--primary-opacity-0';\n\t\t\tif (matches[3].startsWith(cssVarWithOpacity0) && !matches[3].startsWith(cssVarWithOpacity))\n\t\t\t{\n\t\t\t\tcssVar.opacity = 0;\n\t\t\t}\n\t\t\tif (matches[3].startsWith(cssVarWithOpacity))\n\t\t\t{\n\t\t\t\tlet newOpacity = matches[3].substr(cssVarWithOpacity.length);\n\t\t\t\tif (newOpacity.length === 1 && newOpacity !== 0)\n\t\t\t\t{\n\t\t\t\t\tnewOpacity = newOpacity / 10;\n\t\t\t\t}\n\t\t\t\tif (newOpacity.length === 2)\n\t\t\t\t{\n\t\t\t\t\tnewOpacity = newOpacity / 100;\n\t\t\t\t}\n\t\t\t\tcssVar.opacity = newOpacity;\n\t\t\t}\n\t\t}\n\t\tif(matches[5])\n\t\t{\n\t\t\tcssVar.opacity = +parseFloat(matches[5].replace('_', '.')).toFixed(1);\n\t\t}\n\n\t\treturn cssVar;\n\t}\n\n\treturn null;\n}\n","import ColorValue from \"../color_value\";\n\nexport type ColorValueOptions = {\n\th?: number,\n\ts?: number,\n\tl?: number,\n\ta?: number,\n};\nexport const defaultColorValueOptions: ColorValueOptions = {\n\th: 205,\n\ts: 1,\n\tl: 50,\n\ta: 1,\n};\n\nexport type GradientValueOptions = {\n\tfrom: ColorValue,\n\tto: ColorValue,\n\tangle: number,\n\ttype: 'linear' | 'radial'\n};\n\nexport type BgImageValueOptions = {\n\turl: ?string,\n\turl2x: ?string,\n\tfileId: ?number,\n\tfileId2x: ?number,\n\tsize: 'cover' | 'auto',\n\tattachment: 'scroll' | 'fixed',\n\toverlay: ?ColorValue,\n};\nexport const defaultBgImageSize = 'cover';\nexport const defaultBgImageAttachment = 'scroll';\nexport const defaultOverlay = null;\nexport const defaultBgImageValueOptions: BgImageValueOptions = {\n\turl: null,\n\tsize: defaultBgImageSize,\n\tattachment: defaultBgImageAttachment,\n\toverlay: defaultOverlay,\n};\n","import {Dom, Type} from 'main.core';\n\nimport isRgbString from './internal/is-rgb-string';\nimport isHex from './internal/is-hex';\nimport isHslString from './internal/is-hsl-string';\nimport hexToHsl from './internal/hex-to-hsl';\nimport hslToHex from './internal/hsl-to-hex';\nimport rgbStringToHsla from './internal/rgb-string-to-hsl';\nimport hslStringToHsl from './internal/hsl-string-to-hsl';\nimport {isCssVar, parseCssVar} from \"./internal/css-var\";\nimport {ColorValueOptions, defaultColorValueOptions} from \"./types/color_value_options\";\nimport {IColorValue} from './types/i_color_value';\n\nexport default class ColorValue implements IColorValue\n{\n\tvalue: ColorValueOptions;\n\t/**\n\t * For preserve differences between hsl->rgb and rgb->hsl conversions we can save hex\n\t * @type {?string}\n\t */\n\thex: ?string;\n\t/**\n\t * if set css variable value - save them in '--var-name' format\n\t * @type {?string}\n\t */\n\tcssVar: ?string;\n\n\tconstructor(value: ColorValueOptions | ColorValue | string)\n\t{\n\t\tthis.value = defaultColorValueOptions;\n\t\tthis.hex = null;\n\t\tthis.cssVar = null;\n\t\tthis.setValue(value);\n\t}\n\n\tgetName(): string\n\t{\n\t\tif (this.hex)\n\t\t{\n\t\t\treturn this.getHex() + '_' + this.getOpacity();\n\t\t}\n\t\tconst {h, s, l} = this.getHsl();\n\t\treturn `${h}-${s}-${l}-${this.getOpacity()}`;\n\t}\n\n\tsetValue(value: ColorValueOptions | ColorValue | string): ColorValue\n\t{\n\t\tif (Type.isObject(value))\n\t\t{\n\t\t\tif (value instanceof ColorValue)\n\t\t\t{\n\t\t\t\tthis.value = value.getHsla();\n\t\t\t\tthis.cssVar = value.getCssVar();\n\t\t\t\tthis.hex = value.getHexOriginal();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.value = {...this.value, ...value};\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(value))\n\t\t{\n\t\t\tif (isHslString(value))\n\t\t\t{\n\t\t\t\tthis.value = hslStringToHsl(value);\n\t\t\t}\n\t\t\telse if (isHex(value))\n\t\t\t{\n\t\t\t\tthis.value = {...hexToHsl(value), a: defaultColorValueOptions.a};\n\t\t\t\tthis.hex = value;\n\t\t\t}\n\t\t\telse if (isRgbString(value))\n\t\t\t{\n\t\t\t\tthis.value = rgbStringToHsla(value);\n\t\t\t}\n\t\t\telse if (isCssVar(value))\n\t\t\t{\n\t\t\t\tconst cssVar = parseCssVar(value);\n\t\t\t\tconst cssPrimaryVarName = '--primary';\n\t\t\t\tif (cssVar !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.cssVar = cssVar.name;\n\t\t\t\t\tif ('opacity' in cssVar)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.cssVar = cssPrimaryVarName;\n\t\t\t\t\t\tthis.setValue(Dom.style(document.documentElement, this.cssVar));\n\t\t\t\t\t\tthis.setOpacity(cssVar.opacity);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setValue(Dom.style(document.documentElement, this.cssVar));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.value.h = Math.round(this.value.h);\n\t\tthis.value.s = Math.round(this.value.s);\n\t\tthis.value.l = Math.round(this.value.l);\n\t\tthis.value.a = this.value.a.toFixed(2);\n\t\tconst offsetFromCorrectValue = Math.round((this.value.a * 100) % 5);\n\t\tif (offsetFromCorrectValue < 3)\n\t\t{\n\t\t\tthis.value.a = (this.value.a * 100 - offsetFromCorrectValue) / 100;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.value.a = (this.value.a * 100 - offsetFromCorrectValue + 5) / 100;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetOpacity(opacity: number): ColorValue\n\t{\n\t\tthis.setValue({a: opacity});\n\n\t\treturn this;\n\t}\n\n\tlighten(percent: number): ColorValue\n\t{\n\t\tthis.value.l = Math.min(this.value.l + percent, 100);\n\t\tthis.hex = null;\n\n\t\treturn this;\n\t}\n\n\tdarken(percent: number): ColorValue\n\t{\n\t\tthis.value.l = Math.max(this.value.l - percent, 0);\n\t\tthis.hex = null;\n\n\t\treturn this;\n\t}\n\n\tsaturate(percent: number): ColorValue\n\t{\n\t\tthis.value.s = Math.min(this.value.s + percent, 100);\n\t\tthis.hex = null;\n\n\t\treturn this;\n\t}\n\n\tdesaturate(percent: number): ColorValue\n\t{\n\t\tthis.value.s = Math.max(this.value.s - percent, 0);\n\t\tthis.hex = null;\n\n\t\treturn this;\n\t}\n\n\tadjustHue(degree: number): ColorValue\n\t{\n\t\tthis.value.h = (this.value.h + degree) % 360;\n\n\t\treturn this;\n\t}\n\n\tgetHsl(): {h: number, s: number, l: number}\n\t{\n\t\treturn {\n\t\t\th: this.value.h,\n\t\t\ts: this.value.s,\n\t\t\tl: this.value.l,\n\t\t};\n\t}\n\n\tgetHsla(): ColorValueOptions\n\t{\n\t\tconst a = this.value.a || 1;\n\t\treturn {\n\t\t\th: this.value.h,\n\t\t\ts: this.value.s,\n\t\t\tl: this.value.l,\n\t\t\ta,\n\t\t};\n\t}\n\n\t/**\n\t * Return original hex-string or convert value to hex (w.o. alpha)\n\t * @returns {string}\n\t */\n\tgetHex(): string\n\t{\n\t\treturn this.hex || hslToHex(this.value);\n\t}\n\n\t/**\n\t * Return hex only if value created from hex-string\n\t */\n\tgetHexOriginal(): string\n\t{\n\t\treturn this.hex;\n\t}\n\n\tgetOpacity(): number\n\t{\n\t\treturn this.value.a ?? defaultColorValueOptions.a;\n\t}\n\n\tgetCssVar(): ?string\n\t{\n\t\treturn this.cssVar;\n\t}\n\n\t/**\n\t * Get style string for set inline css var.\n\t * Set hsla value or primary css var with opacity in format --var-name-opacity_12_3\n\t * @returns {string}\n\t */\n\tgetStyleString(): string\n\t{\n\t\tif (this.cssVar === null)\n\t\t{\n\t\t\tif (this.hex && this.getOpacity() === defaultColorValueOptions.a)\n\t\t\t{\n\t\t\t\treturn this.hex\n\t\t\t}\n\n\t\t\tconst {h, s, l, a} = this.value;\n\n\t\t\treturn `hsla(${h}, ${s}%, ${l}%, ${a})`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet fullCssVar = this.cssVar;\n\t\t\tif (this.value.a !== defaultColorValueOptions.a)\n\t\t\t{\n\t\t\t\tfullCssVar = fullCssVar + '-opacity-' + String(this.value.a).replace('.', '_');\n\t\t\t}\n\t\t\treturn `var(${fullCssVar})`;\n\t\t}\n\t}\n\n\tgetStyleStringForOpacity(): string\n\t{\n\t\tconst {h, s, l} = this.value;\n\n\t\treturn `linear-gradient(to right, hsla(${h}, ${s}%, ${l}%, 0) 0%, hsla(${h}, ${s}%, ${l}%, 1) 100%)`;\n\t}\n\n\tstatic compare(color1: ColorValue, color2: ColorValue): boolean\n\t{\n\t\treturn color1.getHsla().h === color2.getHsla().h\n\t\t\t&& color1.getHsla().s === color2.getHsla().s\n\t\t\t&& color1.getHsla().l === color2.getHsla().l\n\t\t\t&& color1.getHsla().a === color2.getHsla().a\n\t\t\t&& color1.cssVar === color2.cssVar;\n\t}\n\n\tstatic getMedian(color1: ColorValue, color2: ColorValue): ColorValue\n\t{\n\t\treturn new ColorValue({\n\t\t\th: (color1.getHsla().h + color2.getHsla().h) / 2,\n\t\t\ts: (color1.getHsla().s + color2.getHsla().s) / 2,\n\t\t\tl: (color1.getHsla().l + color2.getHsla().l) / 2,\n\t\t\ta: (color1.getHsla().a + color2.getHsla().a) / 2,\n\t\t});\n\t}\n\n\t/**\n\t * Special formula for contrast. Not only color invert!\n\t * @returns {string}\n\t */\n\tgetContrast(): ColorValue\n\t{\n\t\tlet k = 60;\n\t\t// math h range to 0-2pi radian and add modifier by sinus\n\t\tlet rad = this.getHsl().h * Math.PI / 180;\n\t\tk += (Math.sin(rad) * 10) + 5;\t// 10 & 5 is approximate coefficients\n\t\t// lighten by started light\n\t\tlet deltaL = k - (45 * this.getHsl().l / 100);\n\n\t\treturn new ColorValue(this.value).setValue({l: (this.getHsl().l + deltaL) % 100});\n\t}\n\n\t/**\n\t * Special formula for lighten, good for dark and light colors\n\t */\n\tgetLighten(): ColorValue\n\t{\n\t\tlet {h, s, l} = this.getHsl();\n\n\t\tif (s > 0)\n\t\t{\n\t\t\ts += (l - 50) / 100 * 60;\n\t\t\ts = Math.min(100, Math.max(0, l));\n\t\t}\n\n\t\tl += 10 + 20 * l / 100;\n\t\tl = Math.min(100, l);\n\n\t\treturn new ColorValue({h, s, l});\n\t}\n}\n","import './css/style.css';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport ColorValue from '../../../ui/field/color/src/color_value';\n\n/**\n * ColorPicker for Theme site.\n */\nexport class ColorPickerTheme extends EventEmitter\n{\n\tstatic DEFAULT_COLOR_PICKER_COLOR = '#f25a8f';\n\tstatic MATCH_HEX = /#?([0-9A-F]{3}){1,2}$/i;\n\n\tconstructor(node: HTMLElement, allColors, currentColor, metrikaParams = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Landing.ColorPickerTheme');\n\n\t\tthis.element = node;\n\n\t\tthis.loader = new BX.Loader({\n\t\t\ttarget: node,\n\t\t\tsize: 43,\n\t\t});\n\n\t\tthis.input = this.element.firstElementChild;\n\t\tthis.allColors = allColors;\n\t\tthis.currentColor = currentColor;\n\t\tthis.initMetrika(metrikaParams);\n\t\tthis.init();\n\t}\n\n\tinitMetrika(metrikaParams)\n\t{\n\t\tthis.metrikaParams = metrikaParams;\n\t}\n\n\tinit()\n\t{\n\t\tconst color = this.initPreviewColor();\n\t\tconst active = this.isActive();\n\n\t\tthis.element.style.backgroundColor = color;\n\t\tthis.element.dataset.value = color;\n\t\tthis.element.classList.add('landing-colorpicker-theme');\n\t\tif (active)\n\t\t{\n\t\t\tthis.input.setAttribute('value', color);\n\t\t\tthis.element.classList.add('active');\n\t\t}\n\n\t\tthis.colorField = new BX.Landing.UI.Field.ColorField({\n\t\t\tsubtype: 'color',\n\t\t});\n\t\tthis.colorField.createPopup({\n\t\t\tcontentRoot: null,\n\t\t\tisNeedCalcPopupOffset: false,\n\t\t\tisNeedResetPopupWhenOpen: false,\n\t\t\tanalytics: this.getMetrikaParams(),\n\t\t});\n\t\tthis.colorField.colorPopup.subscribe('onHexColorPopupChange', (e) => {\n\t\t\tthis.onColorSelected(e.data);\n\t\t});\n\t\tthis.colorField.colorPopup.subscribe('onPopupShow', (e) => {\n\t\t\tthis.loader.hide();\n\t\t});\n\n\t\tBX.bind(this.element, 'click', this.open.bind(this));\n\t}\n\n\tinitPreviewColor(): string\n\t{\n\t\tlet color;\n\n\t\tif (this.currentColor)\n\t\t{\n\t\t\tif (this.isHex(this.currentColor))\n\t\t\t{\n\t\t\t\tcolor = (this.isBaseColor())\n\t\t\t\t\t? ColorPickerTheme.DEFAULT_COLOR_PICKER_COLOR\n\t\t\t\t\t: this.currentColor;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcolor = ColorPickerTheme.DEFAULT_COLOR_PICKER_COLOR;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcolor = ColorPickerTheme.DEFAULT_COLOR_PICKER_COLOR;\n\t\t}\n\n\t\treturn color;\n\t}\n\n\tisActive(): boolean\n\t{\n\t\tif (!this.isHex(this.currentColor))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn !this.isBaseColor();\n\t}\n\n\tisBaseColor(): boolean\n\t{\n\t\treturn this.allColors.includes(this.currentColor);\n\t}\n\n\tgetSelectedColor(): string\n\t{\n\t\tlet color;\n\t\tif (this.element.dataset.value)\n\t\t{\n\t\t\tcolor = this.element.dataset.value;\n\t\t}\n\t\tcolor = this.prepareColor(color);\n\t\tif (!this.isHex(color))\n\t\t{\n\t\t\tcolor = '';\n\t\t}\n\n\t\treturn color;\n\t}\n\n\tonColorSelected(color): void\n\t{\n\t\tthis.element.classList.add('ui-colorpicker-selected');\n\t\tthis.element.dataset.value = color.substr(1);\n\t\tthis.element.style.backgroundColor = color;\n\n\t\tconst event = new BaseEvent({data: {color: color, node: this.element}});\n\t\tthis.emit('onSelectColor', event);\n\t\tthis.emit('onSelectCustomColor', event);\n\n\t\tthis.input.setAttribute('value', color);\n\t}\n\n\topen(): void\n\t{\n\t\tthis.loader.show();\n\t\tthis.colorField.colorPopup.setValue(new ColorValue(this.getSelectedColor()));\n\t\tthis.colorField.colorPopup.onPopupOpenClick(event, this.element);\n\t}\n\n\tprepareColor(color): string\n\t{\n\t\tif (color[0] !== '#')\n\t\t{\n\t\t\tcolor = '#' + color;\n\t\t}\n\n\t\treturn color;\n\t}\n\n\tisHex(color): boolean\n\t{\n\t\tlet isCorrect = false;\n\t\tif (color.length === 4 || color.length === 7)\n\t\t{\n\t\t\tif (color.match(ColorPickerTheme.MATCH_HEX))\n\t\t\t{\n\t\t\t\tisCorrect = true;\n\t\t\t}\n\t\t}\n\n\t\treturn isCorrect;\n\t}\n\n\tgetMetrikaParams()\n\t{\n\t\treturn {\n\t\t\tcategory: 'settings',\n\t\t\tc_sub_section: 'primary',\n\t\t\tp1: this.metrikaParams?.p1 ?? null,\n\t\t};\n\t}\n}"],"names":["matcher","isRgbString","rgbString","match","matcherHex","isHex","hex","trim","matcherHsl","isHslString","hsla","hexToRgb","length","r","parseInt","g","b","rgbToHsla","rgb","max","Math","min","h","s","l","d","round","a","hexToHsl","rgbToHex","toString","hslToRgb","hsl","c","abs","x","m","hslToHex","rgbStringToHsla","matches","Text","toNumber","hslStringToHsl","hslString","isCssVar","css","parseCssVar","cssVar","full","name","cssVarWithOpacity","cssVarWithOpacity0","startsWith","opacity","newOpacity","substr","parseFloat","replace","toFixed","defaultColorValueOptions","ColorValue","value","setValue","getHex","getOpacity","getHsl","Type","isObject","getHsla","getCssVar","getHexOriginal","isString","cssPrimaryVarName","Dom","style","document","documentElement","setOpacity","offsetFromCorrectValue","percent","degree","fullCssVar","String","k","rad","PI","sin","deltaL","color1","color2","ColorPickerTheme","node","allColors","currentColor","metrikaParams","setEventNamespace","element","loader","BX","Loader","target","size","input","firstElementChild","initMetrika","init","color","initPreviewColor","active","isActive","backgroundColor","dataset","classList","add","setAttribute","colorField","Landing","UI","Field","ColorField","subtype","createPopup","contentRoot","isNeedCalcPopupOffset","isNeedResetPopupWhenOpen","analytics","getMetrikaParams","colorPopup","subscribe","e","onColorSelected","data","hide","bind","open","isBaseColor","DEFAULT_COLOR_PICKER_COLOR","includes","prepareColor","event","BaseEvent","emit","show","getSelectedColor","onPopupOpenClick","isCorrect","MATCH_HEX","category","c_sub_section","p1","EventEmitter"],"mappings":"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"}