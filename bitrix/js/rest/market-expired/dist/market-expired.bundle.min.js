this.BX=this.BX||{};(function(e,t,s,i,r,a,o,n,l,c,p,u,d){"use strict";let _=e=>e,P,b,h;var T=babelHelpers.classPrivateFieldLooseKey("name");var v=babelHelpers.classPrivateFieldLooseKey("icon");class g{constructor(e){Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e.name;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=e.icon}getContainer(){return d.Tag.render(P||(P=_`
			<span class="rest-market-item">
				${0}
				<span class="rest-market-item__name" title="${0}">${0}</span>
			</span>
		`),this.renderIcon(),this.getName(),this.getName())}renderTo(e){d.Dom.append(this.getContainer(),e)}getName(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T]}renderIcon(){if(!babelHelpers.classPrivateFieldLooseBase(this,v)[v]){return d.Tag.render(b||(b=_`
				<div class="rest-market-item__icon-container">
					<div class="ui-icon-set --cube-plus rest-market-item__icon"></div>
				</div>
			`))}return d.Tag.render(h||(h=_`
			<div class="rest-market-item__icon-container" 
				style="
					background-image: url(${0});
					background-size: cover;
				">
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,v)[v])}}let R=e=>e,E,I;var L=babelHelpers.classPrivateFieldLooseKey("items");var B=babelHelpers.classPrivateFieldLooseKey("title");var m=babelHelpers.classPrivateFieldLooseKey("link");var S=babelHelpers.classPrivateFieldLooseKey("count");var A=babelHelpers.classPrivateFieldLooseKey("onClick");var y=babelHelpers.classPrivateFieldLooseKey("renderList");class O{constructor(e){Object.defineProperty(this,y,{value:k});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});Object.defineProperty(this,m,{writable:true,value:void 0});Object.defineProperty(this,S,{writable:true,value:void 0});Object.defineProperty(this,A,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=d.Type.isArray(e.items)?e.items:[];babelHelpers.classPrivateFieldLooseBase(this,B)[B]=e.title;babelHelpers.classPrivateFieldLooseBase(this,m)[m]=e.link;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=e.count;babelHelpers.classPrivateFieldLooseBase(this,A)[A]=e.onClick}render(){return d.Tag.render(E||(E=R`
			<div class="rest-market-list">
				<div class="rest-market-list__header">
					<span class="rest-market-list__title">${0}</span>
					<a class="rest-market-list__link" href="${0}" onclick="${0}">
						${0}
					</a>
				</div>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,B)[B],babelHelpers.classPrivateFieldLooseBase(this,m)[m],babelHelpers.classPrivateFieldLooseBase(this,A)[A],d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_MARKET_LIST_LINK",{"#COUNT#":babelHelpers.classPrivateFieldLooseBase(this,S)[S]}),babelHelpers.classPrivateFieldLooseBase(this,y)[y]())}}function k(){if(babelHelpers.classPrivateFieldLooseBase(this,L)[L].length===0){return""}const e=d.Tag.render(I||(I=R`
			<div class="rest-market-list__container"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,L)[L].forEach((t=>{t.renderTo(e)}));return e}class N{getContainer(){throw new Error("Not implemented")}}class f{}f.FINAL="FINAL";f.WARNING="WARNING";class F{}F.TRANSITION="transition";F.SUBSCRIPTION="subscription";F.TRIAL="trial";var M=babelHelpers.classPrivateFieldLooseKey("send");var C=babelHelpers.classPrivateFieldLooseKey("getType");var D=babelHelpers.classPrivateFieldLooseKey("getP1");class H{constructor(e){Object.defineProperty(this,D,{value:K});Object.defineProperty(this,C,{value:x});Object.defineProperty(this,M,{value:U});this.context=e}sendShow(){babelHelpers.classPrivateFieldLooseBase(this,M)[M]({tool:"infohelper",category:"market",event:"show_popup"})}sendClickButton(e){babelHelpers.classPrivateFieldLooseBase(this,M)[M]({tool:"infohelper",category:"market",event:"click_button",c_element:e})}sendDemoActivated(){babelHelpers.classPrivateFieldLooseBase(this,M)[M]({tool:"intranet",category:"demo",event:"market_demo_activated"})}}function U(e){c.sendData({...e,type:babelHelpers.classPrivateFieldLooseBase(this,C)[C](),p1:babelHelpers.classPrivateFieldLooseBase(this,D)[D]()})}function x(){let e=this.context.popupType===f.WARNING?"pre_disconnection_alert":"post_disconnection_notice";if(this.context.popupCategory===F.TRIAL){e=`${e}_demo`}return e}function K(){return`discount_${this.context.withDiscount?"Y":"N"}`}let X=e=>e,w,$,j,G;var W=babelHelpers.classPrivateFieldLooseKey("popup");var Y=babelHelpers.classPrivateFieldLooseKey("container");var z=babelHelpers.classPrivateFieldLooseKey("appList");var q=babelHelpers.classPrivateFieldLooseKey("integrationList");var V=babelHelpers.classPrivateFieldLooseKey("analytic");var Q=babelHelpers.classPrivateFieldLooseKey("getContent");var J=babelHelpers.classPrivateFieldLooseKey("getContainer");var Z=babelHelpers.classPrivateFieldLooseKey("renderCloseIcon");var ee=babelHelpers.classPrivateFieldLooseKey("renderMarketList");class te extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,ee,{value:ae});Object.defineProperty(this,Z,{value:re});Object.defineProperty(this,J,{value:ie});Object.defineProperty(this,Q,{value:se});Object.defineProperty(this,W,{writable:true,value:null});Object.defineProperty(this,Y,{writable:true,value:null});Object.defineProperty(this,z,{writable:true,value:void 0});Object.defineProperty(this,q,{writable:true,value:void 0});Object.defineProperty(this,V,{writable:true,value:void 0});this.setEventNamespace("Rest.MarketExpired:Popup");this.expireDate=e.expireDate;babelHelpers.classPrivateFieldLooseBase(this,z)[z]=e.appList;babelHelpers.classPrivateFieldLooseBase(this,q)[q]=e.integrationList;this.withDemo=e.withDemo;this.olWidgetCode=e.olWidgetCode;babelHelpers.classPrivateFieldLooseBase(this,V)[V]=e.analytic;this.type=e.type;this.expireDays=e.expireDays;this.discountEar=e.discountEar;this.isRenamedMarket=e.isRenamedMarket}getTitle(){throw new Error("Not implemented")}getCategory(){throw new Error("Not implemented")}show(){var e,s,i,r;(s=(e=babelHelpers.classPrivateFieldLooseBase(this,W))[W])!=null?s:e[W]=t.PopupWindowManager.create(`marketExpiredPopup_${this.getCategory()}_${this.type}`,null,{animation:{showClassName:"rest-market-expired-popup__show",closeAnimationType:"animation"},overlay:true,content:babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](),disableScroll:true,padding:0,className:"rest-market-expired-popup-wrapper",closeByEsc:true,events:{onClose:this.onClose.bind(this),onShow:this.onOpen.bind(this)}});const a=(e,t)=>{e.forEach((e=>{if(!e.isIntersecting){babelHelpers.classPrivateFieldLooseBase(this,W)[W].setDisableScroll(false);t.unobserve(e.target)}}))};const o=new IntersectionObserver(a,{root:null,rootMargin:"0px",threshold:[0,1]});o.observe(babelHelpers.classPrivateFieldLooseBase(this,W)[W].getContentContainer().querySelector(".rest-market-expired-popup__close-icon"));o.observe(babelHelpers.classPrivateFieldLooseBase(this,W)[W].getContentContainer().querySelector(".rest-market-expired-popup__button-container"));(i=babelHelpers.classPrivateFieldLooseBase(this,W)[W])==null?void 0:i.show();(r=babelHelpers.classPrivateFieldLooseBase(this,V)[V])==null?void 0:r.sendShow();if(this.discountEar){if(babelHelpers.classPrivateFieldLooseBase(this,W)[W].getContentContainer().querySelector(".rest-market-expired-popup__content-wrapper").offsetHeight<window.innerHeight){d.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,J)[J](),{maxHeight:`${this.discountEar.getContainer().offsetHeight}px`})}else{d.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,W)[W].getContentContainer().parentNode,{"backdrop-filter":"none","-webkit-backdrop-filter":"none"})}babelHelpers.classPrivateFieldLooseBase(this,W)[W].adjustPosition()}}close(){babelHelpers.classPrivateFieldLooseBase(this,W)[W].close()}onClose(){this.emit("onClose")}onOpen(){this.emit("onOpen")}renderDescription(){return null}renderButtons(){return null}renderAboutLink(){return""}getAnalytic(){return babelHelpers.classPrivateFieldLooseBase(this,V)[V]}}function se(){return d.Tag.render(w||(w=X`
			<div class="rest-market-expired-popup">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,J)[J]())}function ie(){var e,t,s;(t=(e=babelHelpers.classPrivateFieldLooseBase(this,Y))[Y])!=null?t:e[Y]=d.Tag.render($||($=X`
			<div class="rest-market-expired-popup__container">
				${0}
				<div class="rest-market-expired-popup__content-wrapper">
					<div class="rest-market-expired-popup__content">
						<span class="rest-market-expired-popup__title">${0}</span>
						${0}
						${0}
						${0}
					</div>
					${0}
					${0}
				</div>
			</div>
		`),(s=this.discountEar)==null?void 0:s.getContainer(),this.getTitle(),this.renderDescription(),this.renderAboutLink(),this.renderButtons(),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee](),babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]());return babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]}function re(){const e=()=>{var e;babelHelpers.classPrivateFieldLooseBase(this,W)[W].close();(e=babelHelpers.classPrivateFieldLooseBase(this,V)[V])==null?void 0:e.sendClickButton("cancel")};return d.Tag.render(j||(j=X`
			<div class="rest-market-expired-popup__close-icon ui-icon-set --cross-30" onclick="${0}"></div>
		`),e)}function ae(){var e,t;return d.Tag.render(G||(G=X`
			<aside class="rest-market-expired-popup__aside">
				${0}
				${0}
			</aside>
		`),(e=babelHelpers.classPrivateFieldLooseBase(this,z)[z])==null?void 0:e.render(),(t=babelHelpers.classPrivateFieldLooseBase(this,q)[q])==null?void 0:t.render())}class oe extends i.EventEmitter{constructor(e){super();this.setEventNamespace("BX.Rest.MarketExpired.Button");this.text=e.text;this.onSuccess=e.onSuccess}render(){return this.getButton().render()}getButtonConfig(){return{}}onClick(){var e;(e=this.onSuccess)==null?void 0:e.call(this)}getButton(){var e;(e=this.button)!=null?e:this.button=new u.Button({...this.getButtonConfig(),className:"rest-market-expired-popup__button",text:this.text,onclick:this.onClick.bind(this)});return this.button}}var ne=babelHelpers.classPrivateFieldLooseKey("getSubscribeLink");class le extends oe{constructor(...e){super(...e);Object.defineProperty(this,ne,{value:ce})}getButtonConfig(){return{id:"marketExpiredPopup_button_subscribe",size:u.Button.Size.MEDIUM,color:u.Button.Color.SUCCESS,noCaps:true,round:true,tag:u.Button.Tag.LINK,link:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]()}}onClick(){var e;(e=this.analytic)==null?void 0:e.sendClickButton("buy");super.onClick()}}function ce(){var e,t;return(e=(t=d.Extension.getSettings("rest.market-expired"))==null?void 0:t.marketSubscriptionUrl)!=null?e:""}class pe extends oe{getButtonConfig(){return{id:"marketExpiredPopup_button_hide",size:u.Button.Size.EXTRA_SMALL,color:u.Button.Color.LINK,noCaps:true}}onClick(){var e;(e=this.analytic)==null?void 0:e.sendClickButton("ok");super.onClick()}}let ue=e=>e,de,_e,Pe;var be=babelHelpers.classPrivateFieldLooseKey("getSubscribeButton");var he=babelHelpers.classPrivateFieldLooseKey("getHideButton");class Te extends te{constructor(...e){super(...e);Object.defineProperty(this,he,{value:ge});Object.defineProperty(this,be,{value:ve})}getCategory(){return F.TRIAL}renderDescription(){return d.Tag.render(de||(de=ue`
			<div class="rest-market-expired-popup__description">
				<p class="rest-market-expired-popup__description-text">
					${0}
				</p>
			</div>
		`),this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_TRIAL_BITRIX_GPT"):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_TRIAL_MARKET_PLUS"))}getTitle(){const e={"#DAYS#":this.expireDays};if(this.type===f.FINAL){return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_TRIAL_FINAL_BITRIX_GPT",e):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_TRIAL_FINAL_MARKET_PLUS",e)}return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_TRIAL_WARNING_BITRIX_GPT",e):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_TRIAL_WARNING_MARKET_PLUS",e)}renderButtons(){return d.Tag.render(_e||(_e=ue`
			<div class="rest-market-expired-popup__buttons-wrapper">
				<div class="rest-market-expired-popup__button-container">
					${0}
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,be)[be]().render(),babelHelpers.classPrivateFieldLooseBase(this,he)[he]().render())}onOpen(){if(this.type===f.FINAL){BX.userOptions.save("rest","marketSubscriptionPopupDismiss",null,"Y")}else{BX.userOptions.save("rest","marketSubscriptionPopupTs",null,Math.floor(Date.now()/1e3))}super.onOpen()}renderAboutLink(){const e=()=>{var e;BX.Helper.show("redirect=detail&code=17451118");(e=this.getAnalytic())==null?void 0:e.sendClickButton("details")};return d.Tag.render(Pe||(Pe=ue`
			<span class="rest-market-expired-popup__details">
				<a
					class="ui-link rest-market-expired-popup__link"
					href="#"
					onclick="${0}"
				>
					${0}
				</a>
			</span>
		`),e,d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DETAILS"))}}function ve(){return new le({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_SUBSCRIBE"),analytic:this.getAnalytic()})}function ge(){return new pe({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_NEVER_SHOW_AGAIN"),onSuccess:()=>{BX.userOptions.save("rest","marketSubscriptionPopupDismiss",null,"Y");this.close()},analytic:this.getAnalytic()})}let Re=e=>e,Ee,Ie,Le;var Be=babelHelpers.classPrivateFieldLooseKey("getDescription");var me=babelHelpers.classPrivateFieldLooseKey("getSubscribeButton");var Se=babelHelpers.classPrivateFieldLooseKey("getHideButton");class Ae extends te{constructor(...e){super(...e);Object.defineProperty(this,Se,{value:ke});Object.defineProperty(this,me,{value:Oe});Object.defineProperty(this,Be,{value:ye})}getCategory(){return F.SUBSCRIPTION}getTitle(){const e={"#DAYS#":this.expireDays};if(this.type===f.FINAL){return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_SUBSCRIPTION_FINAL_BITRIX_GPT",e):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_SUBSCRIPTION_FINAL_MARKET_PLUS",e)}return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_SUBSCRIPTION_WARNING_BITRIX_GPT",e):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_SUBSCRIPTION_WARNING_MARKET_PLUS",e)}renderDescription(){return d.Tag.render(Ee||(Ee=Re`
			<div class="rest-market-expired-popup__description">
				<p class="rest-market-expired-popup__description-text">
					${0}
				</p>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]())}renderButtons(){return d.Tag.render(Ie||(Ie=Re`
			<div class="rest-market-expired-popup__buttons-wrapper">
				<div class="rest-market-expired-popup__button-container">
					${0}
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,me)[me]().render(),babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]().render())}onOpen(){if(this.type===f.FINAL){BX.userOptions.save("rest","marketSubscriptionPopupDismiss",null,"Y")}else{BX.userOptions.save("rest","marketSubscriptionPopupTs",null,Math.floor(Date.now()/1e3))}super.onOpen()}renderAboutLink(){const e=()=>{var e;BX.Helper.show("redirect=detail&code=17451118");(e=this.getAnalytic())==null?void 0:e.sendClickButton("details")};return d.Tag.render(Le||(Le=Re`
			<span class="rest-market-expired-popup__details">
				<a
					class="ui-link rest-market-expired-popup__link"
					href="#"
					onclick="${0}"
				>
					${0}
				</a>
			</span>
		`),e,d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DETAILS"))}}function ye(){const e={"#DATE#":this.expireDate};if(this.type===f.FINAL){return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_SUBSCRIPTION_FINAL_BITRIX_GPT",e):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_SUBSCRIPTION_FINAL_MARKET_PLUS",e)}return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_SUBSCRIPTION_WARNING_BITRIX_GPT",e):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_SUBSCRIPTION_WARNING_MARKET_PLUS",e)}function Oe(){return new le({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_RENEW_SUBSCRIPTION"),analytic:this.getAnalytic()})}function ke(){return new pe({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_NEVER_SHOW_AGAIN"),onSuccess:()=>{BX.userOptions.save("rest","marketSubscriptionPopupDismiss",null,"Y");this.close()},analytic:this.getAnalytic()})}let Ne=e=>e,fe,Fe,Me;var Ce=babelHelpers.classPrivateFieldLooseKey("getDescription");var De=babelHelpers.classPrivateFieldLooseKey("renderDiscountPercent");var He=babelHelpers.classPrivateFieldLooseKey("renderTermsOfPromotion");class Ue extends N{constructor(e){var t,s,i;super(e);Object.defineProperty(this,He,{value:Xe});Object.defineProperty(this,De,{value:Ke});Object.defineProperty(this,Ce,{value:xe});this.discountPercentage=(t=e==null?void 0:e.discountPercentage)!=null?t:null;this.termsUrl=(s=e==null?void 0:e.termsUrl)!=null?s:null;this.isRenamedMarket=(i=e==null?void 0:e.isRenamedMarket)!=null?i:false}getContainer(){var e;(e=this.container)!=null?e:this.container=d.Tag.render(fe||(fe=Ne`
			<aside class="rest-market-expired-popup__discount rest-market-expired-popup__discount--subscription">
				${0}
				<p class="rest-market-expired-popup__discount-description">
					${0}
				</p>
				${0}
			</aside>
		`),babelHelpers.classPrivateFieldLooseBase(this,De)[De](),babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce](),babelHelpers.classPrivateFieldLooseBase(this,He)[He]());return this.container}}function xe(){return this.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DISCOUNT_SUBSCRIPTION_DESCRIPTION_BITRIX_GPT"):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DISCOUNT_SUBSCRIPTION_DESCRIPTION_MARKET_PLUS")}function Ke(){if(this.discountPercentage){return d.Tag.render(Fe||(Fe=Ne`
				<p class="rest-market-expired-popup__discount-percentage">
					- ${0}%
				</p>
			`),this.discountPercentage)}return""}function Xe(){if(this.termsUrl){return d.Tag.render(Me||(Me=Ne`
				<a href="${0}" target="_blank" class="ui-link rest-market-expired-popup__discount-terms">
					${0}
				</a>
			`),this.termsUrl,d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TERMS_OF_PROMOTION"))}return""}let we=e=>e,$e;class je extends N{getContainer(){var e;(e=this.container)!=null?e:this.container=d.Tag.render($e||($e=we`
			<aside class="rest-market-expired-popup__discount">
				<p class="rest-market-expired-popup__discount-description">
					${0}
				</p>
			</aside>
		`),d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DISCOUNT_DESCRIPTION",{"[white-span]":'<span class="rest-market-expired-popup__discount-description-white">',"[/white-span]":"</span>"}));return this.container}}class Ge extends oe{getButtonConfig(){return{id:"marketExpiredPopup_button_demo",size:u.Button.Size.MEDIUM,color:u.Button.Color.LIGHT_BORDER,noCaps:true,round:true}}onClick(){var e;this.getButton().unbindEvent("click");this.getButton().setState(u.Button.State.WAITING);(e=this.analytic)==null?void 0:e.sendClickButton("demo");d.ajax({url:"/bitrix/tools/rest.php",method:"POST",dataType:"json",data:{sessid:BX.bitrix_sessid(),action:"activate_demo"},onsuccess:e=>{this.onSuccess();if(e.error){r.UI.Notification.Center.notify({content:e.error,category:"demo_subscribe_error",position:"top-right"})}else{var t;(t=this.analytic)==null?void 0:t.sendDemoActivated();a.FeaturePromotersRegistry.getPromoter({code:"limit_market_trial_active"}).show()}}})}}let We=e=>e,Ye,ze,qe,Ve,Qe,Je,Ze;var et=babelHelpers.classPrivateFieldLooseKey("getDemoButton");var tt=babelHelpers.classPrivateFieldLooseKey("getSubscribeButton");var st=babelHelpers.classPrivateFieldLooseKey("getHideButton");var it=babelHelpers.classPrivateFieldLooseKey("renderButtonsForWarning");var rt=babelHelpers.classPrivateFieldLooseKey("renderButtonsForFinal");var at=babelHelpers.classPrivateFieldLooseKey("getFeatureCode");var ot=babelHelpers.classPrivateFieldLooseKey("showOpenLinesWidget");class nt extends te{constructor(...e){super(...e);Object.defineProperty(this,ot,{value:Pt});Object.defineProperty(this,at,{value:_t});Object.defineProperty(this,rt,{value:dt});Object.defineProperty(this,it,{value:ut});Object.defineProperty(this,st,{value:pt});Object.defineProperty(this,tt,{value:ct});Object.defineProperty(this,et,{value:lt})}getCategory(){return F.TRANSITION}getTitle(){return this.type===f.FINAL?d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_FINAL"):d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_TITLE_WARNING")}renderDescription(){const e=d.Tag.render(Ye||(Ye=We`
			<div class="rest-market-expired-popup__description">
				<p class="rest-market-expired-popup__description-text">
					${0}
				</p>
				<p class="rest-market-expired-popup__description-text">
					${0}
				</p>
				<p class="rest-market-expired-popup__description-text">
					${0}
				</p>
			</div>
		`),d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_1"),d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_2"),d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_3"));if(this.type==="FINAL"){d.Dom.append(d.Tag.render(ze||(ze=We`
					<p class="rest-market-expired-popup__description-text">
						${0}
					</p>
				`),d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DESCRIPTION_FINAL")),e)}d.Dom.append(d.Tag.render(qe||(qe=We`
				<p class="rest-market-expired-popup__description-text">
					${0}
				</p>
			`),d.Loc.getMessage(`REST_MARKET_EXPIRED_POPUP_${this.type}_DESCRIPTION${this.withDemo?"_DEMO":""}`,{"#DATE#":this.expireDate})),e);return e}renderButtons(){if(this.type===f.WARNING){return babelHelpers.classPrivateFieldLooseBase(this,it)[it]()}return babelHelpers.classPrivateFieldLooseBase(this,rt)[rt]()}show(){super.show();if(d.Type.isStringFilled(this.olWidgetCode)&&(!this.withDemo||this.type==="FINAL")){babelHelpers.classPrivateFieldLooseBase(this,ot)[ot](window,document,`https://bitrix24.team/upload/crm/site_button/loader_${this.olWidgetCode}.js`)}}onClose(){var e;(e=BX.SiteButton)==null?void 0:e.hide();BX.userOptions.save("rest","marketTransitionPopupTs",null,Math.floor(Date.now()/1e3));super.onClose()}renderAboutLink(){const e=()=>{var e;(e=this.getAnalytic())==null?void 0:e.sendClickButton("details")};return d.Tag.render(Ve||(Ve=We`
			<span class="rest-market-expired-popup__details">
				<a
					class="ui-link rest-market-expired-popup__link"
					href="FEATURE_PROMOTER=${0}"
					onclick="${0}"
				>
					${0}
				</a>
			</span>
		`),babelHelpers.classPrivateFieldLooseBase(this,at)[at](),e,d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_DETAILS"))}}function lt(){return new Ge({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_DEMO"),onSuccess:this.close.bind(this),analytic:this.getAnalytic()})}function ct(){return new le({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_SUBSCRIBE"),analytic:this.getAnalytic()})}function pt(){return new pe({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_HIDE"),onSuccess:()=>{BX.userOptions.save("rest","marketTransitionPopupDismiss",null,"Y");this.close()},analytic:this.getAnalytic()})}function ut(){return d.Tag.render(Qe||(Qe=We`
			<div class="rest-market-expired-popup__buttons-wrapper">
				<div class="rest-market-expired-popup__button-container">
					${0}
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,tt)[tt]().render(),this.withDemo?babelHelpers.classPrivateFieldLooseBase(this,et)[et]().render():"")}function dt(){if(this.withDemo){return d.Tag.render(Je||(Je=We`
				<div class="rest-market-expired-popup__buttons-wrapper">
					${0}
					<div class="rest-market-expired-popup__button-container">
						${0}
						${0}
					</div>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,tt)[tt]().render(),babelHelpers.classPrivateFieldLooseBase(this,et)[et]().render(),babelHelpers.classPrivateFieldLooseBase(this,st)[st]().render())}return d.Tag.render(Ze||(Ze=We`
			<div class="rest-market-expired-popup__buttons-wrapper">
				<div class="rest-market-expired-popup__button-container">
					${0}
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,tt)[tt]().render(),babelHelpers.classPrivateFieldLooseBase(this,st)[st]().render())}function _t(){return`\n\t\t\tlimit_v2_nosubscription_marketplace_withapplications\n\t\t\t${this.withDiscount?"":"_nodiscount"}\n\t\t\t_off\n\t\t\t${this.withDemo?"":"_no_demo"}\n\t\t`}function Pt(e,t,s){const i=t.createElement("script");i.async=true;i.src=`${s}?${Date.now()/6e4|0}`;const r=t.getElementsByTagName("script")[0];r.parentNode.insertBefore(i,r)}var bt=babelHelpers.classPrivateFieldLooseKey("getPopupClass");var ht=babelHelpers.classPrivateFieldLooseKey("getAnalytic");var Tt=babelHelpers.classPrivateFieldLooseKey("getListItemCount");var vt=babelHelpers.classPrivateFieldLooseKey("getDiscountEar");var gt=babelHelpers.classPrivateFieldLooseKey("getMarketList");class Rt{constructor(e){Object.defineProperty(this,gt,{value:mt});Object.defineProperty(this,vt,{value:Bt});Object.defineProperty(this,Tt,{value:Lt});Object.defineProperty(this,ht,{value:It});Object.defineProperty(this,bt,{value:Et});this.config=e}async createPopup(){let e=null;const t=babelHelpers.classPrivateFieldLooseBase(this,ht)[ht]();const s=babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt]();const{appList:i,integrationList:r}=await babelHelpers.classPrivateFieldLooseBase(this,gt)[gt](s,t);if(i||r){const s=babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]();const a=babelHelpers.classPrivateFieldLooseBase(this,bt)[bt]();e=new a({appList:i,integrationList:r,analytic:t,discountEar:s,expireDate:this.config.expireDate,marketSubscriptionUrl:this.config.marketSubscriptionUrl,withDemo:this.config.withDemo,olWidgetCode:this.config.olWidgetCode,type:this.config.type,expireDays:this.config.expireDays,isRenamedMarket:this.config.isRenamedMarket})}return e}}function Et(){switch(this.config.category){case F.TRIAL:return Te;case F.SUBSCRIPTION:return Ae;case F.TRANSITION:default:return nt}}function It(){var e,t;return new H({withDiscount:(e=(t=this.config.discount)==null?void 0:t.isAvailable)!=null?e:false,popupType:this.config.type,popupCategory:this.config.category})}function Lt(){switch(this.config.category){case F.TRIAL:case F.SUBSCRIPTION:return 2;case F.TRANSITION:default:return 3}}function Bt(){const e=this.config.discount;if(!(e!=null&&e.isAvailable)){return null}switch(this.config.category){case F.TRIAL:case F.SUBSCRIPTION:return new Ue({discountPercentage:e.percentage,termsUrl:e.termsUrl,isRenamedMarket:this.config.isRenamedMarket});case F.TRANSITION:default:return new je}}async function mt(e,t){const s=(e,t,s,i)=>{if(!e||!e.data){return null}const{items:r,count:a}=e.data;const o=[];if(r.length===0||a<1){return null}Object.values(r).forEach((e=>{o.push(new g({name:e.name,icon:e.icon}))}));return new O({title:s,count:a,items:o,link:t,onClick:i})};let i=null;let r=null;await Promise.all([d.ajax.runAction("rest.integration.getApplicationList",{data:{limit:e}}),d.ajax.runAction("rest.integration.getIntegrationList",{data:{limit:e}})]).then((([e,a])=>{i=s(e,"/market/installed/",d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_MARKET_LIST_TITLE_APPS"),(()=>{t.sendClickButton("view_all_apps")}));r=s(a,"/devops/list/",d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_MARKET_LIST_TITLE_INTEGRATIONS"),(()=>{t.sendClickButton("view_all_integrations")}))})).catch((e=>{console.log(e)}));return{appList:i,integrationList:r}}class St{}St.INTEGRATION="Integration";St.APPLICATION="Application";St.ANY_PAGE="AnyPage";let At=e=>e,yt;var Ot=babelHelpers.classPrivateFieldLooseKey("panel");var kt=babelHelpers.classPrivateFieldLooseKey("getPanel");var Nt=babelHelpers.classPrivateFieldLooseKey("sendAnalytics");class ft{constructor(e){Object.defineProperty(this,Nt,{value:Mt});Object.defineProperty(this,kt,{value:Ft});Object.defineProperty(this,Ot,{writable:true,value:null});this.options=e}show(){o.BannerDispatcher.critical.toQueue((e=>{const t=babelHelpers.classPrivateFieldLooseBase(this,kt)[kt](e);t.show();babelHelpers.classPrivateFieldLooseBase(this,Nt)[Nt]("show_notification_panel")}))}getRightButtons(){return[]}getContent(){throw new Error("Not Implemented")}onRightButtonClick(){babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]().hide();babelHelpers.classPrivateFieldLooseBase(this,Nt)[Nt]("click_button")}onHide(){}}function Ft(e){var t,s;(s=(t=babelHelpers.classPrivateFieldLooseBase(this,Ot))[Ot])!=null?s:t[Ot]=new n.NotificationPanel({content:d.Tag.render(yt||(yt=At`
				<span class="rest-market-expired-curtain">${0}</span>
			`),this.getContent()),backgroundColor:"#E89B06",crossColor:"#FFFFFF",leftIcon:new l.Icon({icon:l.Main.MARKET_1,color:"#FFFFFF"}),rightButtons:this.getRightButtons(),events:{onHide:()=>{e();this.onHide()}},zIndex:1001});return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot]}function Mt(e){const t={tool:"infohelper",category:"market",event:e,type:"notification_panel"};c.sendData(t)}class Ct extends ft{getRightButtons(){return[new u.Button({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_SUBSCRIBE"),size:u.Button.Size.EXTRA_SMALL,color:u.Button.Color.CURTAIN_WARNING,tag:u.Button.Tag.LINK,noCaps:true,round:true,props:{href:this.options.marketSubscriptionUrl},onclick:()=>super.onRightButtonClick.bind(this)})]}getContent(){if(this.options.type===f.FINAL){return this.options.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_TRIAL_FINAL_TEXT_BITRIX_GPT"):d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_TRIAL_FINAL_TEXT_MARKET_PLUS")}return this.options.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_TRIAL_WARNING_TEXT_BITRIX_GPT",{"#DAYS#":this.options.expireDays}):d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_TRIAL_WARNING_TEXT_MARKET_PLUS",{"#DAYS#":this.options.expireDays})}onHide(){if(this.options.type===f.FINAL){BX.userOptions.save("rest",`marketSubscriptionCurtain${this.options.curtainPage}Dismiss`,null,"Y")}else{BX.userOptions.save("rest",`marketSubscriptionCurtain${this.options.curtainPage}Ts`,null,Math.floor(Date.now()/1e3))}}}class Dt extends ft{getRightButtons(){return[new u.Button({text:d.Loc.getMessage("REST_MARKET_EXPIRED_POPUP_BUTTON_RENEW_SUBSCRIPTION"),size:u.Button.Size.EXTRA_SMALL,color:u.Button.Color.CURTAIN_WARNING,tag:u.Button.Tag.LINK,noCaps:true,round:true,props:{href:this.options.marketSubscriptionUrl},onclick:()=>super.onRightButtonClick.bind(this)})]}getContent(){if(this.options.type===f.FINAL){return this.options.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_SUBSCRIPTION_FINAL_TEXT_BITRIX_GPT"):d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_SUBSCRIPTION_FINAL_TEXT_MARKET_PLUS")}return this.options.isRenamedMarket?d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_SUBSCRIPTION_WARNING_TEXT_BITRIX_GPT",{"#DAYS#":this.options.expireDays}):d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_SUBSCRIPTION_WARNING_TEXT_MARKET_PLUS",{"#DAYS#":this.options.expireDays})}onHide(){if(this.options.type===f.FINAL){BX.userOptions.save("rest",`marketSubscriptionCurtain${this.options.curtainPage}Dismiss`,null,"Y")}else{BX.userOptions.save("rest",`marketSubscriptionCurtain${this.options.curtainPage}Ts`,null,Math.floor(Date.now()/1e3))}}}class Ht extends ft{getRightButtons(){return[new u.Button({text:d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_TRANSITION_BUTTON"),size:u.Button.Size.EXTRA_SMALL,color:u.Button.Color.CURTAIN_WARNING,tag:u.Button.Tag.LINK,noCaps:true,round:true,props:{href:"FEATURE_PROMOTER=limit_v2_nosubscription_marketplace_withapplications_off"},onclick:()=>super.onRightButtonClick.bind(this)})]}getContent(){return d.Loc.getMessage("REST_MARKET_EXPIRED_CURTAIN_TRANSITION_TEXT")}onHide(){BX.userOptions.save("rest",`marketTransitionCurtain${this.options.curtainPage}Ts`,null,Math.floor(Date.now()/1e3))}}var Ut=babelHelpers.classPrivateFieldLooseKey("getCurtainClass");class xt{constructor(e){Object.defineProperty(this,Ut,{value:Kt});this.config=e}createCurtain(e){const t=babelHelpers.classPrivateFieldLooseBase(this,Ut)[Ut]();return new t({marketSubscriptionUrl:this.config.marketSubscriptionUrl,type:this.config.type,expireDays:this.config.expireDays,curtainPage:e,isRenamedMarket:this.config.isRenamedMarket})}}function Kt(){switch(this.config.category){case F.TRIAL:return Ct;case F.SUBSCRIPTION:return Dt;case F.TRANSITION:default:return Ht}}class Xt{constructor(e){this.config=e}static async getPopup(e=null){const t=e!=null?e:d.Extension.getSettings("rest.market-expired");const s=new Rt(t);return s.createPopup()}static getCurtain(e,t=null){const s=t!=null?t:d.Extension.getSettings("rest.market-expired");const i=new xt(s);return i.createCurtain(e)}}e.CurtainPage=St;e.MarketExpired=Xt})(this.BX.Rest=this.BX.Rest||{},BX.Main,BX,BX.Event,BX,BX.UI,BX.UI,BX.UI,BX.UI.IconSet,BX.UI.Analytics,BX,BX.UI,BX);
//# sourceMappingURL=market-expired.bundle.map.js