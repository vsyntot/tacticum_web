this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e){"use strict";function t(e){return{type:e}}const n=t("SELECTION_CHANGE_COMMAND");const o=t("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND");const r=t("CLICK_COMMAND");const s=t("DELETE_CHARACTER_COMMAND");const i=t("INSERT_LINE_BREAK_COMMAND");const l=t("INSERT_PARAGRAPH_COMMAND");const c=t("CONTROLLED_TEXT_INSERTION_COMMAND");const a=t("PASTE_COMMAND");const u=t("REMOVE_TEXT_COMMAND");const f=t("DELETE_WORD_COMMAND");const d=t("DELETE_LINE_COMMAND");const h=t("FORMAT_TEXT_COMMAND");const g=t("UNDO_COMMAND");const _=t("REDO_COMMAND");const p=t("KEYDOWN_COMMAND");const m=t("KEY_ARROW_RIGHT_COMMAND");const N=t("MOVE_TO_END");const y=t("KEY_ARROW_LEFT_COMMAND");const C=t("MOVE_TO_START");const T=t("KEY_ARROW_UP_COMMAND");const E=t("KEY_ARROW_DOWN_COMMAND");const S=t("KEY_ENTER_COMMAND");const w=t("KEY_SPACE_COMMAND");const x=t("KEY_BACKSPACE_COMMAND");const b=t("KEY_ESCAPE_COMMAND");const O=t("KEY_DELETE_COMMAND");const M=t("KEY_TAB_COMMAND");const A=t("INSERT_TAB_COMMAND");const D=t("INDENT_CONTENT_COMMAND");const v=t("OUTDENT_CONTENT_COMMAND");const R=t("DROP_COMMAND");const k=t("FORMAT_ELEMENT_COMMAND");const I=t("DRAGSTART_COMMAND");const L=t("DRAGOVER_COMMAND");const P=t("DRAGEND_COMMAND");const $=t("COPY_COMMAND");const F=t("CUT_COMMAND");const K=t("SELECT_ALL_COMMAND");const B=t("CLEAR_EDITOR_COMMAND");const W=t("CLEAR_HISTORY_COMMAND");const z=t("CAN_REDO_COMMAND");const H=t("CAN_UNDO_COMMAND");const U=t("FOCUS_COMMAND");const Y=t("BLUR_COMMAND");const J=t("KEY_MODIFIER_COMMAND");const j=typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof window.document.createElement!=="undefined";const G=j&&"documentMode"in document?document.documentMode:null;const X=j&&/Mac|iPod|iPhone|iPad/.test(navigator.platform);const V=j&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);const q=j&&"InputEvent"in window&&!G?"getTargetRanges"in new window.InputEvent("input"):false;const Q=j&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent);const Z=j&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;const ee=j&&/Android/.test(navigator.userAgent);const te=j&&/^(?=.*Chrome).*/i.test(navigator.userAgent);const ne=j&&ee&&te;const oe=j&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!te;const re=1;const se=3;const ie=0;const le=1;const ce=2;const ae=0;const ue=1;const fe=2;const de=1;const he=1<<1;const ge=1<<2;const _e=1<<3;const pe=1<<4;const me=1<<5;const Ne=1<<6;const ye=1<<7;const Ce=de|he|ge|_e|pe|me|Ne|ye;const Te=1;const Ee=1<<1;const Se=1;const we=2;const xe=3;const be=4;const Oe=5;const Me=6;const Ae="\xa0";const De="\u200b";const ve=Q||Z||oe?Ae:De;const Re="\n\n";const ke=V?Ae:ve;const Ie="\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc";const Le="A-Za-z\xc0-\xd6\xd8-\xf6"+"\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c"+"\ufe00-\ufe6f\ufefd-\uffff";const Pe=new RegExp("^[^"+Le+"]*["+Ie+"]");const $e=new RegExp("^[^"+Ie+"]*["+Le+"]");const Fe={bold:de,code:pe,highlight:ye,italic:he,strikethrough:ge,subscript:me,superscript:Ne,underline:_e};const Ke={directionless:Te,unmergeable:Ee};const Be={center:we,end:Me,justify:be,left:Se,right:xe,start:Oe};const We={[we]:"center",[Me]:"end",[be]:"justify",[Se]:"left",[xe]:"right",[Oe]:"start"};const ze={normal:ae,segmented:fe,token:ue};const He={[ae]:"normal",[fe]:"segmented",[ue]:"token"};function Ue(...e){const t=[];for(const n of e){if(n&&typeof n==="string"){for(const[e]of n.matchAll(/\S+/g)){t.push(e)}}}return t}const Ye=100;let Je=false;let je=0;function Ge(){return Je}function Xe(e){je=e.timeStamp}function Ve(e){if(je===0){to(e).addEventListener("textInput",Xe,true)}}function qe(e,t,n){return t.__lexicalLineBreak===e||e[`__lexicalKey_${n._key}`]!==undefined}function Qe(e){return e.getEditorState().read((()=>{const e=ui();return e!==null?e.clone():null}))}function Ze(e,t,n){const o=go(n._window);let r=null;let s=null;if(o!==null&&o.anchorNode===e){r=o.anchorOffset;s=o.focusOffset}const i=e.nodeValue;if(i!==null){Qt(t,i,r,s,false)}}function et(e,t,n){if(Hs(e)){const t=e.anchor.getNode();if(t.is(n)&&e.format!==t.getFormat()){return false}}return t.nodeType===se&&n.isAttached()}function tt(e,t,n){Je=true;const o=performance.now()-je>Ye;try{tl(e,(()=>{const r=ui()||Qe(e);const s=new Map;const i=e.getRootElement();const l=e._editorState;const c=e._blockCursorElement;let a=false;let u="";for(let n=0;n<t.length;n++){const f=t[n];const d=f.type;const h=f.target;let g=Pt(h,l);if(g===null&&h!==i||il(g)){continue}if(d==="characterData"){if(o&&vs(g)&&et(r,h,g)){Ze(h,g,e)}}else if(d==="childList"){a=true;const t=f.addedNodes;for(let n=0;n<t.length;n++){const o=t[n];const r=Lt(o);const s=o.parentNode;if(s!=null&&o!==c&&r===null&&(o.nodeName!=="BR"||!qe(o,s,e))){if(V){const e=o.innerText||o.nodeValue;if(e){u+=e}}s.removeChild(o)}}const n=f.removedNodes;const o=n.length;if(o>0){let t=0;for(let r=0;r<o;r++){const o=n[r];if(o.nodeName==="BR"&&qe(o,h,e)||c===o){h.appendChild(o);t++}}if(o!==t){if(h===i){g=Wt(l)}s.set(h,g)}}}}if(s.size>0){for(const[t,n]of s){if(ol(n)){const o=n.getChildrenKeys();let r=t.firstChild;for(let n=0;n<o.length;n++){const s=o[n];const i=e.getElementByKey(s);if(i===null){continue}if(r==null){t.appendChild(i);r=i}else if(r!==i){t.replaceChild(i,r)}r=r.nextSibling}}else if(vs(n)){n.markDirty()}}}const f=n.takeRecords();if(f.length>0){for(let t=0;t<f.length;t++){const n=f[t];const o=n.addedNodes;const r=n.target;for(let t=0;t<o.length;t++){const n=o[t];const s=n.parentNode;if(s!=null&&n.nodeName==="BR"&&!qe(n,r,e)){s.removeChild(n)}}}n.takeRecords()}if(r!==null){if(a){r.dirty=true;zt(r)}if(V&&Un(e)){r.insertRawText(u)}}}))}finally{Je=false}}function nt(e){const t=e._observer;if(t!==null){const n=t.takeRecords();tt(e,n,t)}}function ot(e){Ve(e);e._observer=new MutationObserver(((t,n)=>{tt(e,t,n)}))}function rt(e,t){const n=e.__mode;const o=e.__format;const r=e.__style;const s=t.__mode;const i=t.__format;const l=t.__style;return(n===null||n===s)&&(o===null||o===i)&&(r===null||r===l)}function st(e,t){const n=e.mergeWithSibling(t);const o=ki()._normalizedNodes;o.add(e.__key);o.add(t.__key);return n}function it(e){let t=e;if(t.__text===""&&t.isSimpleText()&&!t.isUnmergeable()){t.remove();return}let n;while((n=t.getPreviousSibling())!==null&&vs(n)&&n.isSimpleText()&&!n.isUnmergeable()){if(n.__text===""){n.remove()}else if(rt(n,t)){t=st(n,t);break}else{break}}let o;while((o=t.getNextSibling())!==null&&vs(o)&&o.isSimpleText()&&!o.isUnmergeable()){if(o.__text===""){o.remove()}else if(rt(t,o)){t=st(t,o);break}else{break}}}function lt(e){ct(e.anchor);ct(e.focus);return e}function ct(e){while(e.type==="element"){const t=e.getNode();const n=e.offset;let o;let r;if(n===t.getChildrenSize()){o=t.getChildAtIndex(n-1);r=true}else{o=t.getChildAtIndex(n);r=false}if(vs(o)){e.set(o.__key,r?o.getTextContentSize():0,"text");break}else if(!ol(o)){break}e.set(o.__key,r?o.getChildrenSize():0,"element")}}let at=1;function ut(){at=1}function ft(){return""+at++}function dt(e,t){const n=e._nodes.get(t);if(n===undefined){{throw Error(`registeredNode: Type ${t} not found`)}}return n}const ht=typeof queueMicrotask==="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function gt(e){return il(Pt(e))}function _t(e){const t=document.activeElement;if(t===null){return false}const n=t.nodeName;return il(Pt(e))&&(n==="INPUT"||n==="TEXTAREA"||t.contentEditable==="true"&&yt(t)==null)}function pt(e,t,n){const o=e.getRootElement();try{return o!==null&&o.contains(t)&&o.contains(n)&&t!==null&&!_t(t)&&Nt(t)===e}catch(e){return false}}function mt(e){return e instanceof Al}function Nt(e){let t=e;while(t!=null){const e=yt(t);if(mt(e)){return e}t=Gn(t)}return null}function yt(e){return e?e.__lexicalEditor:null}function Ct(e){if(Pe.test(e)){return"rtl"}if($e.test(e)){return"ltr"}return null}function Tt(e){return e.isToken()||e.isSegmented()}function Et(e){return e.nodeType===se}function St(e){let t=e;while(t!=null){if(Et(t)){return t}t=t.firstChild}return null}function wt(e,t,n){const o=Fe[t];if(n!==null&&(e&o)===(n&o)){return e}let r=e^o;if(t==="subscript"){r&=~Fe.superscript}else if(t==="superscript"){r&=~Fe.subscript}return r}function xt(e){return vs(e)||as(e)||il(e)}function bt(e,t){if(t!=null){{Ot(e,t)}e.__key=t;return}Di();vi();const n=ki();const o=Ri();const r=ft();o._nodeMap.set(r,e);if(ol(e)){n._dirtyElements.set(r,true)}else{n._dirtyLeaves.add(r)}n._cloneNotNeeded.add(r);n._dirtyType=le;e.__key=r}function Ot(e,t){const n=Pi();if(!n){return}const o=n._nodeMap.get(t);if(o&&o.constructor!==e.constructor){if(e.constructor.name!==o.constructor.name){{throw Error(`Lexical node with constructor ${e.constructor.name} attempted to re-use key from node in active editor state with constructor ${o.constructor.name}. Keys must not be re-used when the type is changed.`)}}else{{throw Error(`Lexical node with constructor ${e.constructor.name} attempted to re-use key from node in active editor state with different constructor with the same name (possibly due to invalid Hot Module Replacement). Keys must not be re-used when the type is changed.`)}}}}function Mt(e,t,n){let o=e;while(o!==null){if(n.has(o)){return}const e=t.get(o);if(e===undefined){break}n.set(o,false);o=e.__parent}}function At(e){const t=e.getParent();if(t!==null){const n=e.getWritable();const o=t.getWritable();const r=e.getPreviousSibling();const s=e.getNextSibling();if(r===null){if(s!==null){const e=s.getWritable();o.__first=s.__key;e.__prev=null}else{o.__first=null}}else{const e=r.getWritable();if(s!==null){const t=s.getWritable();t.__prev=e.__key;e.__next=t.__key}else{e.__next=null}n.__prev=null}if(s===null){if(r!==null){const e=r.getWritable();o.__last=r.__key;e.__next=null}else{o.__last=null}}else{const e=s.getWritable();if(r!==null){const t=r.getWritable();t.__next=e.__key;e.__prev=t.__key}else{e.__prev=null}n.__next=null}o.__size--;n.__parent=null}}function Dt(e){vi();const t=e.getLatest();const n=t.__parent;const o=Ri();const r=ki();const s=o._nodeMap;const i=r._dirtyElements;if(n!==null){Mt(n,s,i)}const l=t.__key;r._dirtyType=le;if(ol(e)){i.set(l,true)}else{r._dirtyLeaves.add(l)}}function vt(e){const t=e.getPreviousSibling();const n=e.getNextSibling();if(t!==null){Dt(t)}if(n!==null){Dt(n)}}function Rt(e){Di();const t=ki();const n=t._compositionKey;if(e!==n){t._compositionKey=e;if(n!==null){const e=It(n);if(e!==null){e.getWritable()}}if(e!==null){const t=It(e);if(t!==null){t.getWritable()}}}}function kt(){if(Ai()){return null}const e=ki();return e._compositionKey}function It(e,t){const n=t||Ri();const o=n._nodeMap.get(e);if(o===undefined){return null}return o}function Lt(e,t){const n=ki();const o=e[`__lexicalKey_${n._key}`];if(o!==undefined){return It(o,t)}return null}function Pt(e,t){let n=e;while(n!=null){const e=Lt(n,t);if(e!==null){return e}n=Gn(n)}return null}function $t(e){const t=e._decorators;const n=Object.assign({},t);e._pendingDecorators=n;return n}function Ft(e){return e.read((()=>Bt().getTextContent()))}function Kt(e,t){tl(e,(()=>{const e=Ri();if(e.isEmpty()){return}if(t==="root"){Bt().markDirty();return}const n=e._nodeMap;for(const[,e]of n){e.markDirty()}}),e._pendingEditorState===null?{tag:"history-merge"}:undefined)}function Bt(){return Wt(Ri())}function Wt(e){return e._nodeMap.get("root")}function zt(e){Di();const t=Ri();if(e!==null){{if(Object.isFrozen(e)){{throw Error(`$setSelection called on frozen selection object. Ensure selection is cloned before passing in.`)}}}e.dirty=true;e.setCachedNodes(null)}t._selection=e}function Ht(){Di();const e=ki();nt(e)}function Ut(e){const t=ki();const n=Jt(e,t);if(n===null){const n=t.getRootElement();if(e===n){return It("root")}return null}return It(n)}function Yt(e,t){return t?e.getTextContentSize():0}function Jt(e,t){let n=e;while(n!=null){const e=n[`__lexicalKey_${t._key}`];if(e!==undefined){return e}n=Gn(n)}return null}function jt(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Gt(e){const t=[];let n=e;while(n!==null){t.push(n);n=n._parentEditor}return t}function Xt(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function Vt(e){if(e.nodeType===se){return e.nodeValue}return null}function qt(e,t,n){const o=go(t._window);if(o===null){return}const r=o.anchorNode;let{anchorOffset:s,focusOffset:i}=o;if(r!==null){let t=Vt(r);const o=Pt(r);if(t!==null&&vs(o)){if(t===ve&&n){const e=n.length;t=n;s=e;i=e}if(t!==null){Qt(o,t,s,i,e)}}}}function Qt(e,t,n,o,r){let s=e;if(s.isAttached()&&(r||!s.isDirty())){const i=s.isComposing();let l=t;if((i||r)&&t[t.length-1]===ve){l=t.slice(0,-1)}const c=s.getTextContent();if(r||l!==c){if(l===""){Rt(null);if(!Q&&!Z&&!oe){const e=ki();setTimeout((()=>{e.update((()=>{if(s.isAttached()){s.remove()}}))}),20)}else{s.remove()}return}const t=s.getParent();const r=fi();const c=s.getTextContentSize();const a=kt();const u=s.getKey();if(s.isToken()||a!==null&&u===a&&!i||Hs(r)&&(t!==null&&!t.canInsertTextBefore()&&r.anchor.offset===0||r.anchor.key===e.__key&&r.anchor.offset===0&&!s.canInsertTextBefore()&&!i||r.focus.key===e.__key&&r.focus.offset===c&&!s.canInsertTextAfter()&&!i)){s.markDirty();return}const f=ui();if(!Hs(f)||n===null||o===null){s.setTextContent(l);return}f.setTextNodeRange(s,n,s,o);if(s.isSegmented()){const e=s.getTextContent();const t=Ds(e);s.replace(t);s=t}s.setTextContent(l)}}}function Zt(e){const t=e.getPreviousSibling();return(vs(t)||ol(t)&&t.isInline())&&!t.canInsertTextAfter()}function en(e,t){if(t.isSegmented()){return true}if(!e.isCollapsed()){return false}const n=e.anchor.offset;const o=t.getParentOrThrow();const r=t.isToken();if(n===0){return!t.canInsertTextBefore()||!o.canInsertTextBefore()&&!t.isComposing()||r||Zt(t)}else if(n===t.getTextContentSize()){return!t.canInsertTextAfter()||!o.canInsertTextAfter()&&!t.isComposing()||r}else{return false}}function tn(e,t,n,o){return e==="Tab"&&!t&&!n&&!o}function nn(e,t,n,o){return e.toLowerCase()==="b"&&!t&&Rn(n,o)}function on(e,t,n,o){return e.toLowerCase()==="i"&&!t&&Rn(n,o)}function rn(e,t,n,o){return e.toLowerCase()==="u"&&!t&&Rn(n,o)}function sn(e,t){return kn(e)&&!t}function ln(e,t){return kn(e)&&t}function cn(e,t){return X&&t&&e.toLowerCase()==="o"}function an(e,t,n){return In(e)&&(X?t:n)}function un(e,t,n){return Pn(e)&&(X?t:n)}function fn(e,t){return X&&t&&In(e)}function dn(e,t){return X&&t&&Pn(e)}function hn(e,t,n,o){if(X){if(t||n){return false}return In(e)||e.toLowerCase()==="h"&&o}if(o||t||n){return false}return In(e)}function gn(e,t,n,o,r){if(X){if(n||o||r){return false}return Pn(e)||e.toLowerCase()==="d"&&t}if(t||o||r||n){return false}return Pn(e)}function _n(e,t,n,o){return e.toLowerCase()===n.toLowerCase()||t===o}function pn(e,t,n,o,r){return _n(e,r,"z",90)&&!t&&Rn(n,o)}function mn(e,t,n,o,r){if(X){return _n(e,r,"z",90)&&n&&t}return _n(e,r,"y",89)&&o||_n(e,r,"z",90)&&o&&t}function Nn(e,t,n,o){if(t){return false}if(e.toLowerCase()==="c"){return X?n:o}return false}function yn(e,t,n,o){if(t){return false}if(e.toLowerCase()==="x"){return X?n:o}return false}function Cn(e){return e==="ArrowLeft"}function Tn(e){return e==="ArrowRight"}function En(e){return e==="ArrowUp"}function Sn(e){return e==="ArrowDown"}function wn(e,t,n,o){return Cn(e)&&!t&&!o&&!n}function xn(e,t,n,o,r){return Cn(e)&&!o&&!n&&(t||r)}function bn(e,t,n,o){return Tn(e)&&!t&&!o&&!n}function On(e,t,n,o,r){return Tn(e)&&!o&&!n&&(t||r)}function Mn(e,t,n){return En(e)&&!t&&!n}function An(e,t,n){return Sn(e)&&!t&&!n}function Dn(e,t,n,o){return e||t||n||o}function vn(e){return e===" "}function Rn(e,t){if(X){return e}return t}function kn(e){return e==="Enter"}function In(e){return e==="Backspace"}function Ln(e){return e==="Escape"}function Pn(e){return e==="Delete"}function $n(e,t,n){return e.toLowerCase()==="a"&&Rn(t,n)}function Fn(){const e=Bt();const t=e.select(0,e.getChildrenSize());zt(lt(t))}function Kn(e,t){if(e.__lexicalClassNameCache===undefined){e.__lexicalClassNameCache={}}const n=e.__lexicalClassNameCache;const o=n[t];if(o!==undefined){return o}const r=e[t];if(typeof r==="string"){const e=Ue(r);n[t]=e;return e}return r}function Bn(e,t,n,o,r){if(n.size===0){return}const s=o.__type;const i=o.__key;const l=t.get(s);if(l===undefined){{throw Error(`Type ${s} not in registeredNodes`)}}const c=l.klass;let a=e.get(c);if(a===undefined){a=new Map;e.set(c,a)}const u=a.get(i);const f=u==="destroyed"&&r==="created";if(u===undefined||f){a.set(i,f?"updated":r)}}function Wn(e){const t=e.getType();const n=Ri();if(n._readOnly){const e=xo(n).get(t);return e?Array.from(e.values()):[]}const o=n._nodeMap;const r=[];for(const[,n]of o){if(n instanceof e&&n.__type===t&&n.isAttached()){r.push(n)}}return r}function zn(e,t,n){const o=e.getParent();let r=n;let s=e;if(o!==null){if(t&&n===0){r=s.getIndexWithinParent();s=o}else if(!t&&n===s.getChildrenSize()){r=s.getIndexWithinParent()+1;s=o}}return s.getChildAtIndex(t?r-1:r)}function Hn(e,t){const n=e.offset;if(e.type==="element"){const o=e.getNode();return zn(o,t,n)}else{const o=e.getNode();if(t&&n===0||!t&&n===o.getTextContentSize()){const e=t?o.getPreviousSibling():o.getNextSibling();if(e===null){return zn(o.getParentOrThrow(),t,o.getIndexWithinParent()+(t?0:1))}return e}}return null}function Un(e){const t=to(e).event;const n=t&&t.inputType;return n==="insertFromPaste"||n==="insertFromPasteAsQuotation"}function Yn(e,t,n){return Vi(e,t,n)}function Jn(e){return!al(e)&&!e.isLastChild()&&!e.isInline()}function jn(e,t){const n=e._keyToDOMMap.get(t);if(n===undefined){{throw Error(`Reconciliation: could not find DOM element for node key ${t}`)}}return n}function Gn(e){const t=e.assignedSlot||e.parentElement;return t!==null&&t.nodeType===11?t.host:t}function Xn(e,t,n){const o=n.ownerDocument;const r=o.defaultView;if(r===null){return}let{top:s,bottom:i}=t;let l=0;let c=0;let a=n;while(a!==null){const t=a===o.body;if(t){l=0;c=to(e).innerHeight}else{const e=a.getBoundingClientRect();l=e.top;c=e.bottom}let n=0;if(s<l){n=-(l-s)}else if(i>c){n=i-c}if(n!==0){if(t){r.scrollBy(0,n)}else{const e=a.scrollTop;a.scrollTop+=n;const t=a.scrollTop-e;s-=t;i-=t}}if(t){break}a=Gn(a)}}function Vn(e){const t=ki();return t._updateTags.has(e)}function qn(e){Di();const t=ki();t._updateTags.add(e)}function Qn(e){const t=ui();if(!Hs(t)||!ol(e)){return t}const{anchor:n,focus:o}=t;const r=n.getNode();const s=o.getNode();if(Zn(r,e)){n.set(e.__key,0,"element")}if(Zn(s,e)){o.set(e.__key,0,"element")}return t}function Zn(e,t){let n=e.getParent();while(n!==null){if(n.is(t)){return true}n=n.getParent()}return false}function eo(e){const t=e.ownerDocument;return t&&t.defaultView||null}function to(e){const t=e._window;if(t===null){{throw Error(`window object not found`)}}return t}function no(e){return ol(e)&&e.isInline()||il(e)&&e.isInline()}function oo(e){let t=e.getParentOrThrow();while(t!==null){if(ro(t)){return t}t=t.getParentOrThrow()}return t}function ro(e){return al(e)||ol(e)&&e.isShadowRoot()}function so(e){const t=e.constructor.clone(e);bt(t,null);return t}function io(e){const t=ki();const n=e.constructor.getType();const o=t._nodes.get(n);if(o===undefined){{throw Error(`$initializeNode failed. Ensure node has been registered to the editor. You can do this by passing the node class via the "nodes" array in the editor config.`)}}const r=o.replace;if(r!==null){const t=r(e);if(!(t instanceof e.constructor)){{throw Error(`$initializeNode failed. Ensure replacement node is a subclass of the original node.`)}}return t}return e}function lo(e,t){const n=e.getParent();if(al(n)&&!ol(t)&&!il(t)){{throw Error(`Only element or decorator nodes can be inserted in to the root node`)}}}function co(e){const t=It(e);if(t===null){{throw Error(`Expected node with key ${e} to exist but it's not in the nodeMap.`)}}return t}function ao(e){const t=e.theme;const n=document.createElement("div");n.contentEditable="false";n.setAttribute("data-lexical-cursor","true");let o=t.blockCursor;if(o!==undefined){if(typeof o==="string"){const e=Ue(o);o=t.blockCursor=e}if(o!==undefined){n.classList.add(...o)}}return n}function uo(e){return(il(e)||ol(e)&&!e.canBeEmpty())&&!e.isInline()}function fo(e,t,n){n.style.removeProperty("caret-color");t._blockCursorElement=null;const o=e.parentElement;if(o!==null){o.removeChild(e)}}function ho(e,t,n){let o=e._blockCursorElement;if(Hs(n)&&n.isCollapsed()&&n.anchor.type==="element"&&t.contains(document.activeElement)){const r=n.anchor;const s=r.getNode();const i=r.offset;const l=s.getChildrenSize();let c=false;let a=null;if(i===l){const e=s.getChildAtIndex(i-1);if(uo(e)){c=true}}else{const t=s.getChildAtIndex(i);if(uo(t)){const n=t.getPreviousSibling();if(n===null||uo(n)){c=true;a=e.getElementByKey(t.__key)}}}if(c){const n=e.getElementByKey(s.__key);if(o===null){e._blockCursorElement=o=ao(e._config)}t.style.caretColor="transparent";if(a===null){n.appendChild(o)}else{n.insertBefore(o,a)}return}}if(o!==null){fo(o,e,t)}}function go(e){return!j?null:(e||window).getSelection()}function _o(e,t){let n=e.getChildAtIndex(t);if(n==null){n=e}if(!!ro(e)){throw Error(`Can not call $splitNode() on root element`)}const o=e=>{const t=e.getParentOrThrow();const r=ro(t);const s=e===n&&!r?e:so(e);if(r){if(!(ol(e)&&ol(s))){throw Error(`Children of a root must be ElementNode`)}e.insertAfter(s);return[e,s,s]}else{const[n,r,i]=o(t);const l=e.getNextSiblings();i.append(s,...l);return[n,r,s]}};const[r,s]=o(n);return[r,s]}function po(e){return mo(e)&&e.tagName==="A"}function mo(e){return e.nodeType===1}function No(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function yo(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function Co(e){if(al(e)||il(e)&&!e.isInline()){return true}if(!ol(e)||ro(e)){return false}const t=e.getFirstChild();const n=t===null||as(t)||vs(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==false&&n}function To(e,t){let n=e;while(n!==null&&n.getParent()!==null&&!t(n)){n=n.getParentOrThrow()}return t(n)?n:null}function Eo(){return ki()}const So=new WeakMap;const wo=new Map;function xo(e){if(!e._readOnly&&e.isEmpty()){return wo}if(!e._readOnly){throw Error(`getCachedTypeToNodeMap called with a writable EditorState`)}let t=So.get(e);if(!t){t=new Map;So.set(e,t);for(const[n,o]of e._nodeMap){const e=o.__type;let r=t.get(e);if(!r){r=new Map;t.set(e,r)}r.set(n,o)}}return t}function bo(e){const t=e.constructor;const n=t.clone(e);n.afterCloneFrom(e);{if(!(n.__key===e.__key)){throw Error(`$cloneWithProperties: ${t.name}.clone(node) (with type '${t.getType()}') did not return a node with the same key, make sure to specify node.__key as the last argument to the constructor`)}if(!(n.__parent===e.__parent&&n.__next===e.__next&&n.__prev===e.__prev)){throw Error(`$cloneWithProperties: ${t.name}.clone(node) (with type '${t.getType()}') overrided afterCloneFrom but did not call super.afterCloneFrom(prevNode)`)}}return n}function Oo(e,t){const n=e._decorators;const o=e._pendingDecorators;let r=o||n;const s=t._nodeMap;let i;for(i in r){if(!s.has(i)){if(r===n){r=$t(e)}delete r[i]}}}function Mo(e,t,n,o,r,s){let i=e.getFirstChild();while(i!==null){const e=i.__key;if(i.__parent===t){if(ol(i)){Mo(i,e,n,o,r,s)}if(!n.has(e)){s.delete(e)}r.push(e)}i=i.getNextSibling()}}function Ao(e,t,n,o){const r=e._nodeMap;const s=t._nodeMap;const i=[];for(const[e]of o){const t=s.get(e);if(t!==undefined){if(!t.isAttached()){if(ol(t)){Mo(t,e,r,s,i,o)}if(!r.has(e)){o.delete(e)}i.push(e)}}}for(const e of i){s.delete(e)}for(const e of n){const t=s.get(e);if(t!==undefined&&!t.isAttached()){if(!r.has(e)){n.delete(e)}s.delete(e)}}}let Do="";let vo="";let Ro=null;let ko="";let Io="";let Lo;let Po;let $o;let Fo=false;let Ko=false;let Bo;let Wo=null;let zo;let Ho;let Uo;let Yo;let Jo;let jo;function Go(e,t){const n=Uo.get(e);if(t!==null){const n=Nr(e);if(n.parentNode===t){t.removeChild(n)}}if(!Yo.has(e)){Po._keyToDOMMap.delete(e)}if(ol(n)){const e=ar(n,Uo);Xo(e,0,e.length-1,null)}if(n!==undefined){Bn(jo,$o,Bo,n,"destroyed")}}function Xo(e,t,n,o){let r=t;for(;r<=n;++r){const t=e[r];if(t!==undefined){Go(t,o)}}}function Vo(e,t){e.setProperty("text-align",t)}const qo="40px";function Qo(e,t){const n=Lo.theme.indent;if(typeof n==="string"){const o=e.classList.contains(n);if(t>0&&!o){e.classList.add(n)}else if(t<1&&o){e.classList.remove(n)}}const o=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||qo;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${o})`)}function Zo(e,t){const n=e.style;if(t===0){Vo(n,"")}else if(t===Se){Vo(n,"left")}else if(t===we){Vo(n,"center")}else if(t===xe){Vo(n,"right")}else if(t===be){Vo(n,"justify")}else if(t===Oe){Vo(n,"start")}else if(t===Me){Vo(n,"end")}}function er(e,t,n){const o=Yo.get(e);if(o===undefined){{throw Error(`createNode: node does not exist in nodeMap`)}}const r=o.createDOM(Lo,Po);mr(e,r,Po);if(vs(o)){r.setAttribute("data-lexical-text","true")}else if(il(o)){r.setAttribute("data-lexical-decorator","true")}if(ol(o)){const e=o.__indent;const t=o.__size;if(e!==0){Qo(r,e)}if(t!==0){const e=t-1;const n=ar(o,Yo);tr(n,e,o,r)}const n=o.__format;if(n!==0){Zo(r,n)}if(!o.isInline()){rr(null,o,r)}if(Jn(o)){Do+=Re;Io+=Re}}else{const t=o.getTextContent();if(il(o)){const t=o.decorate(Po,Lo);if(t!==null){dr(e,t)}r.contentEditable="false"}else if(vs(o)){if(!o.isDirectionless()){vo+=t}}Do+=t;Io+=t}if(t!==null){if(n!=null){t.insertBefore(r,n)}else{const e=t.__lexicalLineBreak;if(e!=null){t.insertBefore(r,e)}else{t.appendChild(r)}}}{Object.freeze(o)}Bn(jo,$o,Bo,o,"created");return r}function tr(e,t,n,o){const r=vo;vo="";nr(e,n,0,t,o,null);lr(n,o);vo=r}function nr(e,t,n,o,r,s){const i=Do;Do="";let l=n;for(;l<=o;++l){er(e[l],r,s);const t=Yo.get(e[l]);if(t!==null&&vs(t)){if(Ro===null){Ro=t.getFormat()}if(ko===""){ko=t.getStyle()}}}if(Jn(t)){Do+=Re}r.__lexicalTextContent=Do;Do=i+Do}function or(e,t){const n=t.get(e);return as(n)||il(n)&&n.isInline()}function rr(e,t,n){const o=e!==null&&(e.__size===0||or(e.__last,Uo));const r=t.__size===0||or(t.__last,Yo);if(o){if(!r){const e=n.__lexicalLineBreak;if(e!=null){try{n.removeChild(e)}catch(t){if(typeof t==="object"&&t!=null){const o=`${t.toString()} Parent: ${n.tagName}, child: ${e.tagName}.`;throw new Error(o)}else{throw t}}}n.__lexicalLineBreak=null}}else if(r){const e=document.createElement("br");n.__lexicalLineBreak=e;n.appendChild(e)}}function sr(e){if(yl(e)&&Ro!=null&&Ro!==e.__textFormat&&!Ko){e.setTextFormat(Ro);e.setTextStyle(ko)}}function ir(e){if(yl(e)&&ko!==""&&ko!==e.__textStyle&&!Ko){e.setTextStyle(ko)}}function lr(e,t){const n=t.__lexicalDirTextContent;const o=t.__lexicalDir;if(n!==vo||o!==Wo){const n=vo==="";const r=n?Wo:Ct(vo);if(r!==o){const s=t.classList;const i=Lo.theme;let l=o!==null?i[o]:undefined;let c=r!==null?i[r]:undefined;if(l!==undefined){if(typeof l==="string"){const e=Ue(l);l=i[o]=e}s.remove(...l)}if(r===null||n&&r==="ltr"){t.removeAttribute("dir")}else{if(c!==undefined){if(typeof c==="string"){const e=Ue(c);c=i[r]=e}if(c!==undefined){s.add(...c)}}t.dir=r}if(!Ko){const t=e.getWritable();t.__dir=r}}Wo=r;t.__lexicalDirTextContent=vo;t.__lexicalDir=r}}function cr(e,t,n){const o=vo;vo="";Ro=null;ko="";ur(e,t,n);lr(t,n);sr(t);ir(t);vo=o}function ar(e,t){const n=[];let o=e.__first;while(o!==null){const e=t.get(o);if(e===undefined){{throw Error(`createChildrenArray: node does not exist in nodeMap`)}}n.push(o);o=e.__next}return n}function ur(e,t,n){const o=Do;const r=e.__size;const s=t.__size;Do="";if(r===1&&s===1){const o=e.__first;const r=t.__first;if(o===r){fr(o,n)}else{const e=Nr(o);const t=er(r,null,null);try{n.replaceChild(t,e)}catch(s){if(typeof s==="object"&&s!=null){const i=`${s.toString()} Parent: ${n.tagName}, new child: {tag: ${t.tagName} key: ${r}}, old child: {tag: ${e.tagName}, key: ${o}}.`;throw new Error(i)}else{throw s}}Go(o,null)}const s=Yo.get(r);if(vs(s)){if(Ro===null){Ro=s.getFormat()}if(ko===""){ko=s.getStyle()}}}else{const o=ar(e,Uo);const i=ar(t,Yo);if(r===0){if(s!==0){nr(i,t,0,s-1,n,null)}}else if(s===0){if(r!==0){const e=n.__lexicalLineBreak;const t=e==null;Xo(o,0,r-1,t?null:n);if(t){n.textContent=""}}}else{_r(t,o,i,r,s,n)}}if(Jn(t)){Do+=Re}n.__lexicalTextContent=Do;Do=o+Do}function fr(e,t){const n=Uo.get(e);let o=Yo.get(e);if(n===undefined||o===undefined){{throw Error(`reconcileNode: prevNode or nextNode does not exist in nodeMap`)}}const r=Fo||Ho.has(e)||zo.has(e);const s=jn(Po,e);if(n===o&&!r){if(ol(n)){const e=s.__lexicalTextContent;if(e!==undefined){Do+=e;Io+=e}const t=s.__lexicalDirTextContent;if(t!==undefined){vo+=t}}else{const e=n.getTextContent();if(vs(n)&&!n.isDirectionless()){vo+=e}Io+=e;Do+=e}return s}if(n!==o&&r){Bn(jo,$o,Bo,o,"updated")}if(o.updateDOM(n,s,Lo)){const n=er(e,null,null);if(t===null){{throw Error(`reconcileNode: parentDOM is null`)}}t.replaceChild(n,s);Go(e,null);return n}if(ol(n)&&ol(o)){const e=o.__indent;if(e!==n.__indent){Qo(s,e)}const t=o.__format;if(t!==n.__format){Zo(s,t)}if(r){cr(n,o,s);if(!al(o)&&!o.isInline()){rr(n,o,s)}}if(Jn(o)){Do+=Re;Io+=Re}}else{const t=o.getTextContent();if(il(o)){const t=o.decorate(Po,Lo);if(t!==null){dr(e,t)}}else if(vs(o)&&!o.isDirectionless()){vo+=t}Do+=t;Io+=t}if(!Ko&&al(o)&&o.__cachedText!==Io){const e=o.getWritable();e.__cachedText=Io;o=e}{Object.freeze(o)}return s}function dr(e,t){let n=Po._pendingDecorators;const o=Po._decorators;if(n===null){if(o[e]===t){return}n=$t(Po)}n[e]=t}function hr(e){return e.firstChild}function gr(e){let t=e.nextSibling;if(t!==null&&t===Po._blockCursorElement){t=t.nextSibling}return t}function _r(e,t,n,o,r,s){const i=o-1;const l=r-1;let c;let a;let u=hr(s);let f=0;let d=0;while(f<=i&&d<=l){const e=t[f];const o=n[d];if(e===o){u=gr(fr(o,s));f++;d++}else{if(c===undefined){c=new Set(t)}if(a===undefined){a=new Set(n)}const r=a.has(e);const i=c.has(o);if(!r){u=gr(Nr(e));Go(e,s);f++}else if(!i){er(o,s,u);d++}else{const e=jn(Po,o);if(e===u){u=gr(fr(o,s))}else{if(u!=null){s.insertBefore(e,u)}else{s.appendChild(e)}fr(o,s)}f++;d++}}const r=Yo.get(o);if(r!==null&&vs(r)){if(Ro===null){Ro=r.getFormat()}if(ko===""){ko=r.getStyle()}}}const h=f>i;const g=d>l;if(h&&!g){const t=n[l+1];const o=t===undefined?null:Po.getElementByKey(t);nr(n,e,d,l,s,o)}else if(g&&!h){Xo(t,f,i,s)}}function pr(e,t,n,o,r,s){Do="";Io="";vo="";Fo=o===ce;Wo=null;Po=n;Lo=n._config;$o=n._nodes;Bo=Po._listeners.mutation;zo=r;Ho=s;Uo=e._nodeMap;Yo=t._nodeMap;Ko=t._readOnly;Jo=new Map(n._keyToDOMMap);const i=new Map;jo=i;fr("root",null);Po=undefined;$o=undefined;zo=undefined;Ho=undefined;Uo=undefined;Yo=undefined;Lo=undefined;Jo=undefined;jo=undefined;return i}function mr(e,t,n){const o=n._keyToDOMMap;t["__lexicalKey_"+n._key]=e;o.set(e,t)}function Nr(e){const t=Jo.get(e);if(t===undefined){{throw Error(`Reconciliation: could not find DOM element for node key ${e}`)}}return t}const yr=Object.freeze({});const Cr=30;const Tr=[["keydown",Yr],["pointerdown",Pr],["compositionstart",zr],["compositionend",Ur],["input",Wr],["click",Lr],["cut",yr],["copy",yr],["dragstart",yr],["dragover",yr],["dragend",yr],["paste",yr],["focus",yr],["blur",yr],["drop",yr]];if(q){Tr.push(["beforeinput",(e,t)=>Br(e,t)])}let Er=0;let Sr=null;let wr=0;let xr=null;const br=new WeakMap;let Or=false;let Mr=false;let Ar=false;let Dr=false;let vr=[0,"",0,"root",0];function Rr(e,t,n,o,r){const s=e.anchor;const i=e.focus;const l=s.getNode();const c=ki();const a=go(c._window);const u=a!==null?a.anchorNode:null;const f=s.key;const d=c.getElementByKey(f);const h=n.length;return f!==i.key||!vs(l)||(!r&&(!q||wr<o+50)||l.isDirty()&&h<2||jt(n))&&s.offset!==i.offset&&!l.isComposing()||Tt(l)||l.isDirty()&&h>1||(r||!q)&&d!==null&&!l.isComposing()&&u!==St(d)||a!==null&&t!==null&&(!t.collapsed||t.startContainer!==a.anchorNode||t.startOffset!==a.anchorOffset)||l.getFormat()!==e.format||l.getStyle()!==e.style||en(e,l)}function kr(e,t){return e!==null&&e.nodeValue!==null&&e.nodeType===se&&t!==0&&t!==e.nodeValue.length}function Ir(e,t,o){const{anchorNode:r,anchorOffset:s,focusNode:i,focusOffset:l}=e;if(Or){Or=false;if(kr(r,s)&&kr(i,l)){return}}tl(t,(()=>{if(!o){zt(null);return}if(!pt(t,r,i)){return}const c=ui();if(Hs(c)){const n=c.anchor;const o=n.getNode();if(c.isCollapsed()){if(e.type==="Range"&&e.anchorNode===e.focusNode){c.dirty=true}const r=to(t).event;const s=r?r.timeStamp:performance.now();const[i,l,a,u,f]=vr;const d=Bt();const h=t.isComposing()===false&&d.getTextContent()==="";if(s<f+200&&n.offset===a&&n.key===u){c.format=i;c.style=l}else{if(n.type==="text"){if(!vs(o)){throw Error(`Point.getNode() must return TextNode when type is text`)}c.format=o.getFormat();c.style=o.getStyle()}else if(n.type==="element"&&!h){const e=n.getNode();c.style="";if(e instanceof pl&&e.getChildrenSize()===0){c.format=e.getTextFormat();c.style=e.getTextStyle()}else{c.format=0}}}}else{const e=n.key;const t=c.focus;const o=t.key;const r=c.getNodes();const i=r.length;const a=c.isBackward();const u=a?l:s;const f=a?s:l;const d=a?o:e;const h=a?e:o;let g=Ce;let _=false;for(let e=0;e<i;e++){const t=r[e];const n=t.getTextContentSize();if(vs(t)&&n!==0&&!(e===0&&t.__key===d&&u===n||e===i-1&&t.__key===h&&f===0)){_=true;g&=t.getFormat();if(g===0){break}}}c.format=_?g:0}}Yn(t,n,undefined)}))}function Lr(e,t){tl(t,(()=>{const n=ui();const o=go(t._window);const s=fi();if(o){if(Hs(n)){const t=n.anchor;const r=t.getNode();if(t.type==="element"&&t.offset===0&&n.isCollapsed()&&!al(r)&&Bt().getChildrenSize()===1&&r.getTopLevelElementOrThrow().isEmpty()&&s!==null&&n.is(s)){o.removeAllRanges();n.dirty=true}else if(e.detail===3&&!n.isCollapsed()){const e=n.focus;const t=e.getNode();if(r!==t){if(ol(r)){r.select(0)}else{r.getParentOrThrow().select(0)}}}}else if(e.pointerType==="touch"){const n=o.anchorNode;if(n!==null){const r=n.nodeType;if(r===re||r===se){const n=ai(s,o,t,e);zt(n)}}}}Yn(t,r,e)}))}function Pr(e,t){const n=e.target;const o=e.pointerType;if(n instanceof Node&&o!=="touch"){tl(t,(()=>{if(!gt(n)){Mr=true}}))}}function $r(e){if(!e.getTargetRanges){return null}const t=e.getTargetRanges();if(t.length===0){return null}return t[0]}function Fr(e,t){return e!==t||ol(e)||ol(t)||!e.isToken()||!t.isToken()}function Kr(e){return Sr==="MediaLast"&&e<Er+Cr}function Br(e,t){const n=e.inputType;const o=$r(e);if(n==="deleteCompositionText"||V&&Un(t)){return}else if(n==="insertCompositionText"){return}tl(t,(()=>{const r=ui();if(n==="deleteContentBackward"){if(r===null){const e=fi();if(!Hs(e)){return}zt(e.clone())}if(Hs(r)){const n=r.anchor.key===r.focus.key;if(Kr(e.timeStamp)&&t.isComposing()&&n){Rt(null);Er=0;setTimeout((()=>{tl(t,(()=>{Rt(null)}))}),Cr);if(Hs(r)){const e=r.anchor.getNode();e.markDirty();r.format=e.getFormat();if(!vs(e)){throw Error(`Anchor node must be a TextNode`)}r.style=e.getStyle()}}else{Rt(null);e.preventDefault();const o=r.anchor.getNode().getTextContent();const i=r.anchor.offset===0&&r.focus.offset===o.length;const l=ne&&n&&!i;if(!l){Yn(t,s,true)}}return}}if(!Hs(r)){return}const p=e.data;if(xr!==null){qt(false,t,xr)}if((!r.dirty||xr!==null)&&r.isCollapsed()&&!al(r.anchor.getNode())&&o!==null){r.applyDOMRange(o)}xr=null;const m=r.anchor;const N=r.focus;const y=m.getNode();const C=N.getNode();if(n==="insertText"||n==="insertTranspose"){if(p==="\n"){e.preventDefault();Yn(t,i,false)}else if(p===Re){e.preventDefault();Yn(t,l,undefined)}else if(p==null&&e.dataTransfer){const t=e.dataTransfer.getData("text/plain");e.preventDefault();r.insertRawText(t)}else if(p!=null&&Rr(r,o,p,e.timeStamp,true)){e.preventDefault();Yn(t,c,p)}else{xr=p}wr=e.timeStamp;return}e.preventDefault();switch(n){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":{Yn(t,c,e);break}case"insertFromComposition":{Rt(null);Yn(t,c,e);break}case"insertLineBreak":{Rt(null);Yn(t,i,false);break}case"insertParagraph":{Rt(null);if(Ar&&!Z){Ar=false;Yn(t,i,false)}else{Yn(t,l,undefined)}break}case"insertFromPaste":case"insertFromPasteAsQuotation":{Yn(t,a,e);break}case"deleteByComposition":{if(Fr(y,C)){Yn(t,u,e)}break}case"deleteByDrag":case"deleteByCut":{Yn(t,u,e);break}case"deleteContent":{Yn(t,s,false);break}case"deleteWordBackward":{Yn(t,f,true);break}case"deleteWordForward":{Yn(t,f,false);break}case"deleteHardLineBackward":case"deleteSoftLineBackward":{Yn(t,d,true);break}case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":{Yn(t,d,false);break}case"formatStrikeThrough":{Yn(t,h,"strikethrough");break}case"formatBold":{Yn(t,h,"bold");break}case"formatItalic":{Yn(t,h,"italic");break}case"formatUnderline":{Yn(t,h,"underline");break}case"historyUndo":{Yn(t,g,undefined);break}case"historyRedo":{Yn(t,_,undefined);break}}}))}function Wr(e,t){e.stopPropagation();tl(t,(()=>{const n=ui();const o=e.data;const r=$r(e);if(o!=null&&Hs(n)&&Rr(n,r,o,e.timeStamp,false)){if(Dr){Hr(t,o);Dr=false}const r=n.anchor;const s=r.getNode();const i=go(t._window);if(i===null){return}const l=n.isBackward();const a=l?n.anchor.offset:n.focus.offset;const u=l?n.focus.offset:n.anchor.offset;if(!q||n.isCollapsed()||!vs(s)||i.anchorNode===null||s.getTextContent().slice(0,a)+o+s.getTextContent().slice(a+u)!==Vt(i.anchorNode)){Yn(t,c,o)}const f=o.length;if(V&&f>1&&e.inputType==="insertCompositionText"&&!t.isComposing()){n.anchor.offset-=f}if(!Q&&!Z&&!oe&&t.isComposing()){Er=0;Rt(null)}}else{const e=o!==null?o:undefined;qt(false,t,e);if(Dr){Hr(t,o||undefined);Dr=false}}Ht()}));xr=null}function zr(e,t){tl(t,(()=>{const n=ui();if(Hs(n)&&!t.isComposing()){const o=n.anchor;const r=n.anchor.getNode();Rt(o.key);if(e.timeStamp<Er+Cr||o.type==="element"||!n.isCollapsed()||r.getFormat()!==n.format||vs(r)&&r.getStyle()!==n.style){Yn(t,c,ke)}}}))}function Hr(e,t){const n=e._compositionKey;Rt(null);if(n!==null&&t!=null){if(t===""){const t=It(n);const o=St(e.getElementByKey(n));if(o!==null&&o.nodeValue!==null&&vs(t)){Qt(t,o.nodeValue,null,null,true)}return}if(t[t.length-1]==="\n"){const t=ui();if(Hs(t)){const n=t.focus;t.anchor.set(n.key,n.offset,n.type);Yn(e,S,null);return}}}qt(true,e,t)}function Ur(e,t){if(V){Dr=true}else{tl(t,(()=>{Hr(t,e.data)}))}}function Yr(e,t){Er=e.timeStamp;Sr=e.key;if(t.isComposing()){return}const{key:n,shiftKey:o,ctrlKey:r,metaKey:l,altKey:c,keyCode:a}=e;if(Yn(t,p,e)){return}if(n==null){return}if(bn(n,r,c,l)){Yn(t,m,e)}else if(On(n,r,o,c,l)){Yn(t,N,e)}else if(wn(n,r,c,l)){Yn(t,y,e)}else if(xn(n,r,o,c,l)){Yn(t,C,e)}else if(Mn(n,r,l)){Yn(t,T,e)}else if(An(n,r,l)){Yn(t,E,e)}else if(ln(n,o)){Ar=true;Yn(t,S,e)}else if(vn(n)){Yn(t,w,e)}else if(cn(n,r)){e.preventDefault();Ar=true;Yn(t,i,true)}else if(sn(n,o)){Ar=false;Yn(t,S,e)}else if(hn(n,c,l,r)){if(In(n)){Yn(t,x,e)}else{e.preventDefault();Yn(t,s,true)}}else if(Ln(n)){Yn(t,b,e)}else if(gn(n,r,o,c,l)){if(Pn(n)){Yn(t,O,e)}else{e.preventDefault();Yn(t,s,false)}}else if(an(n,c,r)){e.preventDefault();Yn(t,f,true)}else if(un(n,c,r)){e.preventDefault();Yn(t,f,false)}else if(fn(n,l)){e.preventDefault();Yn(t,d,true)}else if(dn(n,l)){e.preventDefault();Yn(t,d,false)}else if(nn(n,c,l,r)){e.preventDefault();Yn(t,h,"bold")}else if(rn(n,c,l,r)){e.preventDefault();Yn(t,h,"underline")}else if(on(n,c,l,r)){e.preventDefault();Yn(t,h,"italic")}else if(tn(n,c,r,l)){Yn(t,M,e)}else if(pn(n,o,l,r,a)){e.preventDefault();Yn(t,g,undefined)}else if(mn(n,o,l,r,a)){e.preventDefault();Yn(t,_,undefined)}else{const s=t._editorState._selection;if(Ys(s)){if(Nn(n,o,l,r)){e.preventDefault();Yn(t,$,e)}else if(yn(n,o,l,r)){e.preventDefault();Yn(t,F,e)}else if($n(n,l,r)){e.preventDefault();Yn(t,K,e)}}else if(!V&&$n(n,l,r)){e.preventDefault();Yn(t,K,e)}}if(Dn(r,o,c,l)){Yn(t,J,e)}}function Jr(e){let t=e.__lexicalEventHandles;if(t===undefined){t=[];e.__lexicalEventHandles=t}return t}const jr=new Map;function Gr(e){const t=e.target;const n=t==null?null:t.nodeType===9?t.defaultView:t.ownerDocument.defaultView;const o=go(n);if(o===null){return}const r=Nt(o.anchorNode);if(r===null){return}if(Mr){Mr=false;tl(r,(()=>{const t=fi();const n=o.anchorNode;if(n===null){return}const s=n.nodeType;if(s!==re&&s!==se){return}const i=ai(t,o,r,e);zt(i)}))}const s=Gt(r);const i=s[s.length-1];const l=i._key;const c=jr.get(l);const a=c||i;if(a!==r){Ir(o,a,false)}Ir(o,r,true);if(r!==i){jr.set(l,r)}else if(c){jr.delete(l)}}function Xr(e){e._lexicalHandled=true}function Vr(e){const t=e._lexicalHandled===true;return t}function qr(e,t){const n=e.ownerDocument;const o=br.get(n);if(o===undefined||o<1){n.addEventListener("selectionchange",Gr)}br.set(n,(o||0)+1);e.__lexicalEditor=t;const r=Jr(e);for(let n=0;n<Tr.length;n++){const[o,s]=Tr[n];const i=typeof s==="function"?e=>{if(Vr(e)){return}Xr(e);if(t.isEditable()||o==="click"){s(e,t)}}:e=>{if(Vr(e)){return}Xr(e);const n=t.isEditable();switch(o){case"cut":return n&&Yn(t,F,e);case"copy":return Yn(t,$,e);case"paste":return n&&Yn(t,a,e);case"dragstart":return n&&Yn(t,I,e);case"dragover":return n&&Yn(t,L,e);case"dragend":return n&&Yn(t,P,e);case"focus":return n&&Yn(t,U,e);case"blur":{return n&&Yn(t,Y,e)}case"drop":return n&&Yn(t,R,e)}};e.addEventListener(o,i);r.push((()=>{e.removeEventListener(o,i)}))}}function Qr(e){const t=e.ownerDocument;const n=br.get(t);if(!(n!==undefined)){throw Error(`Root element not registered`)}const o=n-1;if(!(o>=0)){throw Error(`Root element count less than 0`)}br.set(t,o);if(o===0){t.removeEventListener("selectionchange",Gr)}const r=yt(e);if(mt(r)){Zr(r);e.__lexicalEditor=null}else if(r){{throw Error(`Attempted to remove event handlers from a node that does not belong to this build of Lexical`)}}const s=Jr(e);for(let e=0;e<s.length;e++){s[e]()}e.__lexicalEventHandles=[]}function Zr(e){if(e._parentEditor!==null){const t=Gt(e);const n=t[t.length-1];const o=n._key;if(jr.get(o)===e){jr.delete(o)}}else{jr.delete(e._key)}}function es(){Or=true}function ts(e,t,n,o,r){vr=[e,t,n,o,r]}function ns(e,t,n){Di();const o=e.__key;const r=e.getParent();if(r===null){return}const s=Qn(e);let i=false;if(Hs(s)&&t){const t=s.anchor;const n=s.focus;if(t.key===o){_i(t,e,r,e.getPreviousSibling(),e.getNextSibling());i=true}if(n.key===o){_i(n,e,r,e.getPreviousSibling(),e.getNextSibling());i=true}}else if(Ys(s)&&t&&e.isSelected()){e.selectPrevious()}if(Hs(s)&&t&&!i){const t=e.getIndexWithinParent();At(e);di(s,r,t,-1)}else{At(e)}if(!n&&!ro(r)&&!r.canBeEmpty()&&r.isEmpty()){ns(r,t)}if(t&&al(r)&&r.isEmpty()){r.selectEnd()}}class os{static getType(){{throw Error(`LexicalNode: Node ${this.name} does not implement .getType().`)}}static clone(e){{throw Error(`LexicalNode: Node ${this.name} does not implement .clone().`)}}afterCloneFrom(e){this.__parent=e.__parent;this.__next=e.__next;this.__prev=e.__prev}constructor(e){this.__type=this.constructor.getType();this.__parent=null;this.__prev=null;this.__next=null;bt(this,e);{if(this.__type!=="root"){Di();rs(this.__type,this.constructor)}}}getType(){return this.__type}isInline(){{throw Error(`LexicalNode: Node ${this.constructor.name} does not implement .isInline().`)}}isAttached(){let e=this.__key;while(e!==null){if(e==="root"){return true}const t=It(e);if(t===null){break}e=t.__parent}return false}isSelected(e){const t=e||ui();if(t==null){return false}const n=t.getNodes().some((e=>e.__key===this.__key));if(vs(this)){return n}const o=Hs(t)&&t.anchor.type==="element"&&t.focus.type==="element";if(o){if(t.isCollapsed()){return false}const e=this.getParent();if(il(this)&&this.isInline()&&e){const n=t.isBackward()?t.focus:t.anchor;const o=n.getNode();if(n.offset===o.getChildrenSize()&&o.is(e)&&o.getLastChildOrThrow().is(this)){return false}}}return n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null){return-1}let t=e.getFirstChild();let n=0;while(t!==null){if(this.is(t)){return n}n++;t=t.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;if(e===null){return null}return It(e)}getParentOrThrow(){const e=this.getParent();if(e===null){{throw Error(`Expected node ${this.__key} to have a parent.`)}}return e}getTopLevelElement(){let e=this;while(e!==null){const t=e.getParent();if(ro(t)){if(!(ol(e)||e===this&&il(e))){throw Error(`Children of root nodes must be elements or decorators`)}return e}e=t}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();if(e===null){{throw Error(`Expected node ${this.__key} to have a top parent element.`)}}return e}getParents(){const e=[];let t=this.getParent();while(t!==null){e.push(t);t=t.getParent()}return e}getParentKeys(){const e=[];let t=this.getParent();while(t!==null){e.push(t.__key);t=t.getParent()}return e}getPreviousSibling(){const e=this.getLatest();const t=e.__prev;return t===null?null:It(t)}getPreviousSiblings(){const e=[];const t=this.getParent();if(t===null){return e}let n=t.getFirstChild();while(n!==null){if(n.is(this)){break}e.push(n);n=n.getNextSibling()}return e}getNextSibling(){const e=this.getLatest();const t=e.__next;return t===null?null:It(t)}getNextSiblings(){const e=[];let t=this.getNextSibling();while(t!==null){e.push(t);t=t.getNextSibling()}return e}getCommonAncestor(e){const t=this.getParents();const n=e.getParents();if(ol(this)){t.unshift(this)}if(ol(e)){n.unshift(e)}const o=t.length;const r=n.length;if(o===0||r===0||t[o-1]!==n[r-1]){return null}const s=new Set(n);for(let e=0;e<o;e++){const n=t[e];if(s.has(n)){return n}}return null}is(e){if(e==null){return false}return this.__key===e.__key}isBefore(e){if(this===e){return false}if(e.isParentOf(this)){return true}if(this.isParentOf(e)){return false}const t=this.getCommonAncestor(e);let n=0;let o=0;let r=this;while(true){const e=r.getParentOrThrow();if(e===t){n=r.getIndexWithinParent();break}r=e}r=e;while(true){const e=r.getParentOrThrow();if(e===t){o=r.getIndexWithinParent();break}r=e}return n<o}isParentOf(e){const t=this.__key;if(t===e.__key){return false}let n=e;while(n!==null){if(n.__key===t){return true}n=n.getParent()}return false}getNodesBetween(e){const t=this.isBefore(e);const n=[];const o=new Set;let r=this;while(true){if(r===null){break}const s=r.__key;if(!o.has(s)){o.add(s);n.push(r)}if(r===e){break}const i=ol(r)?t?r.getFirstChild():r.getLastChild():null;if(i!==null){r=i;continue}const l=t?r.getNextSibling():r.getPreviousSibling();if(l!==null){r=l;continue}const c=r.getParentOrThrow();if(!o.has(c.__key)){n.push(c)}if(c===e){break}let a=null;let u=c;do{if(u===null){{throw Error(`getNodesBetween: ancestor is null`)}}a=t?u.getNextSibling():u.getPreviousSibling();u=u.getParent();if(u!==null){if(a===null&&!o.has(u.__key)){n.push(u)}}else{break}}while(a===null);r=a}if(!t){n.reverse()}return n}isDirty(){const e=ki();const t=e._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const e=It(this.__key);if(e===null){{throw Error(`Lexical node does not exist in active editor state. Avoid using the same node references between nested closures from editorState.read/editor.update.`)}}return e}getWritable(){Di();const e=Ri();const t=ki();const n=e._nodeMap;const o=this.__key;const r=this.getLatest();const s=t._cloneNotNeeded;const i=ui();if(i!==null){i.setCachedNodes(null)}if(s.has(o)){Dt(r);return r}const l=bo(r);s.add(o);Dt(l);n.set(o,l);return l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,t){{throw Error(`createDOM: base method not extended`)}}updateDOM(e,t,n){{throw Error(`updateDOM: base method not extended`)}}exportDOM(e){const t=this.createDOM(e._config,e);return{element:t}}exportJSON(){{throw Error(`exportJSON: base method not extended`)}}static importJSON(e){{throw Error(`LexicalNode: Node ${this.name} does not implement .importJSON().`)}}static transform(){return null}remove(e){ns(this,true,e)}replace(e,t){Di();let n=ui();if(n!==null){n=n.clone()}lo(this,e);const o=this.getLatest();const r=this.__key;const s=e.__key;const i=e.getWritable();const l=this.getParentOrThrow().getWritable();const c=l.__size;At(i);const a=o.getPreviousSibling();const u=o.getNextSibling();const f=o.__prev;const d=o.__next;const h=o.__parent;ns(o,false,true);if(a===null){l.__first=s}else{const e=a.getWritable();e.__next=s}i.__prev=f;if(u===null){l.__last=s}else{const e=u.getWritable();e.__prev=s}i.__next=d;i.__parent=h;l.__size=c;if(t){if(!(ol(this)&&ol(i))){throw Error(`includeChildren should only be true for ElementNodes`)}this.getChildren().forEach((e=>{i.append(e)}))}if(Hs(n)){zt(n);const e=n.anchor;const t=n.focus;if(e.key===r){Ks(e,i)}if(t.key===r){Ks(t,i)}}if(kt()===r){Rt(s)}return i}insertAfter(e,t=true){Di();lo(this,e);const n=this.getWritable();const o=e.getWritable();const r=o.getParent();const s=ui();let i=false;let l=false;if(r!==null){const t=e.getIndexWithinParent();At(o);if(Hs(s)){const e=r.__key;const n=s.anchor;const o=s.focus;i=n.type==="element"&&n.key===e&&n.offset===t+1;l=o.type==="element"&&o.key===e&&o.offset===t+1}}const c=this.getNextSibling();const a=this.getParentOrThrow().getWritable();const u=o.__key;const f=n.__next;if(c===null){a.__last=u}else{const e=c.getWritable();e.__prev=u}a.__size++;n.__next=u;o.__next=f;o.__prev=n.__key;o.__parent=n.__parent;if(t&&Hs(s)){const e=this.getIndexWithinParent();di(s,a,e+1);const t=a.__key;if(i){s.anchor.set(t,e+2,"element")}if(l){s.focus.set(t,e+2,"element")}}return e}insertBefore(e,t=true){Di();lo(this,e);const n=this.getWritable();const o=e.getWritable();const r=o.__key;At(o);const s=this.getPreviousSibling();const i=this.getParentOrThrow().getWritable();const l=n.__prev;const c=this.getIndexWithinParent();if(s===null){i.__first=r}else{const e=s.getWritable();e.__next=r}i.__size++;n.__prev=r;o.__prev=l;o.__next=n.__key;o.__parent=n.__parent;const a=ui();if(t&&Hs(a)){const e=this.getParentOrThrow();di(a,e,c)}return e}isParentRequired(){return false}createParentElementNode(){return Nl()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){Di();const n=this.getPreviousSibling();const o=this.getParentOrThrow();if(n===null){return o.select(0,0)}if(ol(n)){return n.select()}else if(!vs(n)){const e=n.getIndexWithinParent()+1;return o.select(e,e)}return n.select(e,t)}selectNext(e,t){Di();const n=this.getNextSibling();const o=this.getParentOrThrow();if(n===null){return o.select()}if(ol(n)){return n.select(0,0)}else if(!vs(n)){const e=n.getIndexWithinParent();return o.select(e,e)}return n.select(e,t)}markDirty(){this.getWritable()}}function rs(e,t){const n=ki()._nodes.get(e);if(n===undefined){{throw Error(`Create node: Attempted to create node ${t.name} that was not configured to be used on the editor.`)}}const o=n.klass;if(o!==t){{throw Error(`Create node: Type ${e} in node ${t.name} does not match registered node ${o.name} with the same type`)}}}function ss(e,t,n){const o=t.getParentOrThrow().getLastChild();let r=t;const s=[t];while(r!==o){if(!r.getNextSibling()){{throw Error(`insertRangeAfter: lastToInsert must be a later sibling of firstToInsert`)}}r=r.getNextSibling();s.push(r)}let i=e;for(const e of s){i=i.insertAfter(e)}}class is extends os{static getType(){return"linebreak"}static clone(e){return new is(e.__key)}constructor(e){super(e)}getTextContent(){return"\n"}createDOM(){return document.createElement("br")}updateDOM(){return false}static importDOM(){return{br:e=>{if(us(e)||fs(e)){return null}return{conversion:ls,priority:0}}}}static importJSON(e){return cs()}exportJSON(){return{type:"linebreak",version:1}}}function ls(e){return{node:cs()}}function cs(){return io(new is)}function as(e){return e instanceof is}function us(e){const t=e.parentElement;if(t!==null&&yo(t)){const n=t.firstChild;if(n===e||n.nextSibling===e&&ds(n)){const n=t.lastChild;if(n===e||n.previousSibling===e&&ds(n)){return true}}}return false}function fs(e){const t=e.parentElement;if(t!==null&&yo(t)){const n=t.firstChild;if(n===e||n.nextSibling===e&&ds(n)){return false}const o=t.lastChild;if(o===e||o.previousSibling===e&&ds(o)){return true}}return false}function ds(e){return e.nodeType===se&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function hs(e,t){if(t&pe){return"code"}if(t&ye){return"mark"}if(t&me){return"sub"}if(t&Ne){return"sup"}return null}function gs(e,t){if(t&de){return"strong"}if(t&he){return"em"}return"span"}function _s(e,t,n,o,r){const s=o.classList;let i=Kn(r,"base");if(i!==undefined){s.add(...i)}i=Kn(r,"underlineStrikethrough");let l=false;const c=t&_e&&t&ge;const a=n&_e&&n&ge;if(i!==undefined){if(a){l=true;if(!c){s.add(...i)}}else if(c){s.remove(...i)}}for(const e in Fe){const o=e;const a=Fe[o];i=Kn(r,e);if(i!==undefined){if(n&a){if(l&&(e==="underline"||e==="strikethrough")){if(t&a){s.remove(...i)}continue}if((t&a)===0||c&&e==="underline"||e==="strikethrough"){s.add(...i)}}else if(t&a){s.remove(...i)}}}}function ps(e,t){const n=e.length;const o=t.length;let r=0;let s=0;while(r<n&&r<o&&e[r]===t[r]){r++}while(s+r<n&&s+r<o&&e[n-s-1]===t[o-s-1]){s++}return[r,n-r-s,t.slice(r,o-s)]}function ms(e,t,n){const o=t.firstChild;const r=n.isComposing();const s=r?ve:"";const i=e+s;if(o==null){t.textContent=i}else{const e=o.nodeValue;if(e!==i){if(r||V){const[t,n,r]=ps(e,i);if(n!==0){o.deleteData(t,n)}o.insertData(t,r)}else{o.nodeValue=i}}}}function Ns(e,t,n,o,r,s){ms(r,e,t);const i=s.theme;const l=i.text;if(l!==undefined){_s(n,0,o,e,l)}}function ys(e,t){const n=document.createElement(t);n.appendChild(e);return n}class Cs extends os{static getType(){return"text"}static clone(e){return new Cs(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e);this.__format=e.__format;this.__style=e.__style;this.__mode=e.__mode;this.__detail=e.__detail}constructor(e,t){super(t);this.__text=e;this.__format=0;this.__style="";this.__mode=0;this.__detail=0}getFormat(){const e=this.getLatest();return e.__format}getDetail(){const e=this.getLatest();return e.__detail}getMode(){const e=this.getLatest();return He[e.__mode]}getStyle(){const e=this.getLatest();return e.__style}isToken(){const e=this.getLatest();return e.__mode===ue}isComposing(){return this.__key===kt()}isSegmented(){const e=this.getLatest();return e.__mode===fe}isDirectionless(){const e=this.getLatest();return(e.__detail&Te)!==0}isUnmergeable(){const e=this.getLatest();return(e.__detail&Ee)!==0}hasFormat(e){const t=Fe[e];return(this.getFormat()&t)!==0}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){const e=this.getLatest();return e.__text}getFormatFlags(e,t){const n=this.getLatest();const o=n.__format;return wt(o,e,t)}canHaveFormat(){return true}createDOM(e,t){const n=this.__format;const o=hs(this,n);const r=gs(this,n);const s=o===null?r:o;const i=document.createElement(s);let l=i;if(this.hasFormat("code")){i.setAttribute("spellcheck","false")}if(o!==null){l=document.createElement(r);i.appendChild(l)}const c=this.__text;Ns(l,this,r,n,c,e);const a=this.__style;if(a!==""){i.style.cssText=a}return i}updateDOM(e,t,n){const o=this.__text;const r=e.__format;const s=this.__format;const i=hs(this,r);const l=hs(this,s);const c=gs(this,r);const a=gs(this,s);const u=i===null?c:i;const f=l===null?a:l;if(u!==f){return true}if(i===l&&c!==a){const e=t.firstChild;if(e==null){{throw Error(`updateDOM: prevInnerDOM is null or undefined`)}}const r=document.createElement(a);Ns(r,this,a,s,o,n);t.replaceChild(r,e);return false}let d=t;if(l!==null){if(i!==null){d=t.firstChild;if(d==null){{throw Error(`updateDOM: innerDOM is null or undefined`)}}}}ms(o,d,this);const h=n.theme;const g=h.text;if(g!==undefined&&r!==s){_s(a,r,s,d,g)}const _=e.__style;const p=this.__style;if(_!==p){t.style.cssText=p}return false}static importDOM(){return{"#text":()=>({conversion:bs,priority:0}),b:()=>({conversion:Es,priority:0}),code:()=>({conversion:As,priority:0}),em:()=>({conversion:As,priority:0}),i:()=>({conversion:As,priority:0}),s:()=>({conversion:As,priority:0}),span:()=>({conversion:Ts,priority:0}),strong:()=>({conversion:As,priority:0}),sub:()=>({conversion:As,priority:0}),sup:()=>({conversion:As,priority:0}),u:()=>({conversion:As,priority:0})}}static importJSON(e){const t=Ds(e.text);t.setFormat(e.format);t.setDetail(e.detail);t.setMode(e.mode);t.setStyle(e.style);return t}exportDOM(e){let{element:t}=super.exportDOM(e);if(!(t!==null&&mo(t))){throw Error(`Expected TextNode createDOM to always return a HTMLElement`)}t.style.whiteSpace="pre-wrap";if(this.hasFormat("bold")){t=ys(t,"b")}if(this.hasFormat("italic")){t=ys(t,"i")}if(this.hasFormat("strikethrough")){t=ys(t,"s")}if(this.hasFormat("underline")){t=ys(t,"u")}return{element:t}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),type:"text",version:1}}selectionTransform(e,t){return}setFormat(e){const t=this.getWritable();t.__format=typeof e==="string"?Fe[e]:e;return t}setDetail(e){const t=this.getWritable();t.__detail=typeof e==="string"?Ke[e]:e;return t}setStyle(e){const t=this.getWritable();t.__style=e;return t}toggleFormat(e){const t=this.getFormat();const n=wt(t,e,null);return this.setFormat(n)}toggleDirectionless(){const e=this.getWritable();e.__detail^=Te;return e}toggleUnmergeable(){const e=this.getWritable();e.__detail^=Ee;return e}setMode(e){const t=ze[e];if(this.__mode===t){return this}const n=this.getWritable();n.__mode=t;return n}setTextContent(e){if(this.__text===e){return this}const t=this.getWritable();t.__text=e;return t}select(e,t){Di();let n=e;let o=t;const r=ui();const s=this.getTextContent();const i=this.__key;if(typeof s==="string"){const e=s.length;if(n===undefined){n=e}if(o===undefined){o=e}}else{n=0;o=0}if(!Hs(r)){return ri(i,n,i,o,"text","text")}else{const e=kt();if(e===r.anchor.key||e===r.focus.key){Rt(i)}r.setTextNodeRange(this,n,this,o)}return r}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,n,o){const r=this.getWritable();const s=r.__text;const i=n.length;let l=e;if(l<0){l=i+l;if(l<0){l=0}}const c=ui();if(o&&Hs(c)){const t=e+i;c.setTextNodeRange(r,t,r,t)}const a=s.slice(0,l)+n+s.slice(l+t);r.__text=a;return r}canInsertTextBefore(){return true}canInsertTextAfter(){return true}splitText(...e){Di();const t=this.getLatest();const n=t.getTextContent();const o=t.__key;const r=kt();const s=new Set(e);const i=[];const l=n.length;let c="";for(let e=0;e<l;e++){if(c!==""&&s.has(e)){i.push(c);c=""}c+=n[e]}if(c!==""){i.push(c)}const a=i.length;if(a===0){return[]}else if(i[0]===n){return[t]}const u=i[0];const f=t.getParent();let d;const h=t.getFormat();const g=t.getStyle();const _=t.__detail;let p=false;if(t.isSegmented()){d=Ds(u);d.__format=h;d.__style=g;d.__detail=_;p=true}else{d=t.getWritable();d.__text=u}const m=ui();const N=[d];let y=u.length;for(let e=1;e<a;e++){const t=i[e];const n=t.length;const s=Ds(t).getWritable();s.__format=h;s.__style=g;s.__detail=_;const l=s.__key;const c=y+n;if(Hs(m)){const e=m.anchor;const t=m.focus;if(e.key===o&&e.type==="text"&&e.offset>y&&e.offset<=c){e.key=l;e.offset-=y;m.dirty=true}if(t.key===o&&t.type==="text"&&t.offset>y&&t.offset<=c){t.key=l;t.offset-=y;m.dirty=true}}if(r===o){Rt(l)}y=c;N.push(s)}if(f!==null){vt(this);const e=f.getWritable();const t=this.getIndexWithinParent();if(p){e.splice(t,0,N);this.remove()}else{e.splice(t,1,N)}if(Hs(m)){di(m,f,t,a-1)}}return N}mergeWithSibling(e){const t=e===this.getPreviousSibling();if(!t&&e!==this.getNextSibling()){{throw Error(`mergeWithSibling: sibling must be a previous or next sibling`)}}const n=this.__key;const o=e.__key;const r=this.__text;const s=r.length;const i=kt();if(i===o){Rt(n)}const l=ui();if(Hs(l)){const r=l.anchor;const i=l.focus;if(r!==null&&r.key===o){pi(r,t,n,e,s);l.dirty=true}if(i!==null&&i.key===o){pi(i,t,n,e,s);l.dirty=true}}const c=e.__text;const a=t?c+r:r+c;this.setTextContent(a);const u=this.getWritable();e.remove();return u}isTextEntity(){return false}}function Ts(e){const t=e;const n=t.style;return{forChild:Rs(n),node:null}}function Es(e){const t=e;const n=t.style.fontWeight==="normal";return{forChild:Rs(t.style,n?undefined:"bold"),node:null}}const Ss=new WeakMap;function ws(e){return e.nodeName==="PRE"||e.nodeType===re&&e.style!==undefined&&e.style.whiteSpace!==undefined&&e.style.whiteSpace.startsWith("pre")}function xs(e){let t;let n=e.parentNode;const o=[e];while(n!==null&&(t=Ss.get(n))===undefined&&!ws(n)){o.push(n);n=n.parentNode}const r=t===undefined?n:t;for(let e=0;e<o.length;e++){Ss.set(o[e],r)}return r}function bs(e){const t=e;const n=e.parentElement;if(!(n!==null)){throw Error(`Expected parentElement of Text not to be null`)}let o=t.textContent||"";if(xs(t)!==null){const e=o.split(/(\r?\n|\t)/);const t=[];const n=e.length;for(let o=0;o<n;o++){const n=e[o];if(n==="\n"||n==="\r\n"){t.push(cs())}else if(n==="\t"){t.push(Is())}else if(n!==""){t.push(Ds(n))}}return{node:t}}o=o.replace(/\r/g,"").replace(/[ \t\n]+/g," ");if(o===""){return{node:null}}if(o[0]===" "){let e=t;let n=true;while(e!==null&&(e=Os(e,false))!==null){const t=e.textContent||"";if(t.length>0){if(/[ \t\n]$/.test(t)){o=o.slice(1)}n=false;break}}if(n){o=o.slice(1)}}if(o[o.length-1]===" "){let e=t;let n=true;while(e!==null&&(e=Os(e,true))!==null){const t=(e.textContent||"").replace(/^( |\t|\r?\n)+/,"");if(t.length>0){n=false;break}}if(n){o=o.slice(0,o.length-1)}}if(o===""){return{node:null}}return{node:Ds(o)}}function Os(e,t){let n=e;while(true){let e;while((e=t?n.nextSibling:n.previousSibling)===null){const e=n.parentElement;if(e===null){return null}n=e}n=e;if(n.nodeType===re){const e=n.style.display;if(e===""&&!No(n)||e!==""&&!e.startsWith("inline")){return null}}let o=n;while((o=t?n.firstChild:n.lastChild)!==null){n=o}if(n.nodeType===se){return n}else if(n.nodeName==="BR"){return null}}}const Ms={code:"code",em:"italic",i:"italic",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function As(e){const t=Ms[e.nodeName.toLowerCase()];if(t===undefined){return{node:null}}return{forChild:Rs(e.style,t),node:null}}function Ds(e=""){return io(new Cs(e))}function vs(e){return e instanceof Cs}function Rs(e,t){const n=e.fontWeight;const o=e.textDecoration.split(" ");const r=n==="700"||n==="bold";const s=o.includes("line-through");const i=e.fontStyle==="italic";const l=o.includes("underline");const c=e.verticalAlign;return e=>{if(!vs(e)){return e}if(r&&!e.hasFormat("bold")){e.toggleFormat("bold")}if(s&&!e.hasFormat("strikethrough")){e.toggleFormat("strikethrough")}if(i&&!e.hasFormat("italic")){e.toggleFormat("italic")}if(l&&!e.hasFormat("underline")){e.toggleFormat("underline")}if(c==="sub"&&!e.hasFormat("subscript")){e.toggleFormat("subscript")}if(c==="super"&&!e.hasFormat("superscript")){e.toggleFormat("superscript")}if(t&&!e.hasFormat(t)){e.toggleFormat(t)}return e}}class ks extends Cs{static getType(){return"tab"}static clone(e){return new ks(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e);this.__text=e.__text}constructor(e){super("\t",e);this.__detail=Ee}static importDOM(){return null}static importJSON(e){const t=Is();t.setFormat(e.format);t.setStyle(e.style);return t}exportJSON(){return{...super.exportJSON(),type:"tab",version:1}}setTextContent(e){{throw Error(`TabNode does not support setTextContent`)}}setDetail(e){{throw Error(`TabNode does not support setDetail`)}}setMode(e){{throw Error(`TabNode does not support setMode`)}}canInsertTextBefore(){return false}canInsertTextAfter(){return false}}function Is(){return io(new ks)}function Ls(e){return e instanceof ks}class Ps{constructor(e,t,n){this._selection=null;this.key=e;this.offset=t;this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){let t=this.getNode();let n=e.getNode();const o=this.offset;const r=e.offset;if(ol(t)){const e=t.getDescendantByIndex(o);t=e!=null?e:t}if(ol(n)){const e=n.getDescendantByIndex(r);n=e!=null?e:n}if(t===n){return o<r}return t.isBefore(n)}getNode(){const e=this.key;const t=It(e);if(t===null){{throw Error(`Point.getNode: node not found`)}}return t}set(e,t,n){const o=this._selection;const r=this.key;this.key=e;this.offset=t;this.type=n;if(!Ai()){if(kt()===r){Rt(e)}if(o!==null){o.setCachedNodes(null);o.dirty=true}}}}function $s(e,t,n){return new Ps(e,t,n)}function Fs(e,t){let n=t.__key;let o=e.offset;let r="element";if(vs(t)){r="text";const e=t.getTextContentSize();if(o>e){o=e}}else if(!ol(t)){const e=t.getNextSibling();if(vs(e)){n=e.__key;o=0;r="text"}else{const e=t.getParent();if(e){n=e.__key;o=t.getIndexWithinParent()+1}}}e.set(n,o,r)}function Ks(e,t){if(ol(t)){const n=t.getLastDescendant();if(ol(n)||vs(n)){Fs(e,n)}else{Fs(e,t)}}else{Fs(e,t)}}function Bs(e,t,n,o){const r=e.getNode();const s=r.getChildAtIndex(e.offset);const i=Ds();const l=al(r)?Nl().append(i):i;i.setFormat(n);i.setStyle(o);if(s===null){r.append(l)}else{s.insertBefore(l)}if(e.is(t)){t.set(i.__key,0,"text")}e.set(i.__key,0,"text")}function Ws(e,t,n,o){e.key=t;e.offset=n;e.type=o}class zs{constructor(e){this._cachedNodes=null;this._nodes=e;this.dirty=false}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Ys(e)){return false}const t=this._nodes;const n=e._nodes;return t.size===n.size&&Array.from(t).every((e=>n.has(e)))}isCollapsed(){return false}isBackward(){return false}getStartEndPoints(){return null}add(e){this.dirty=true;this._nodes.add(e);this._cachedNodes=null}delete(e){this.dirty=true;this._nodes.delete(e);this._cachedNodes=null}clear(){this.dirty=true;this._nodes.clear();this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new zs(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.getNodes();const n=t.length;const o=t[n-1];let r;if(vs(o)){r=o.select()}else{const e=o.getIndexWithinParent()+1;r=o.getParentOrThrow().select(e,e)}r.insertNodes(e);for(let e=0;e<n;e++){t[e].remove()}}getNodes(){const e=this._cachedNodes;if(e!==null){return e}const t=this._nodes;const n=[];for(const e of t){const t=It(e);if(t!==null){n.push(t)}}if(!Ai()){this._cachedNodes=n}return n}getTextContent(){const e=this.getNodes();let t="";for(let n=0;n<e.length;n++){t+=e[n].getTextContent()}return t}}function Hs(e){return e instanceof Us}class Us{constructor(e,t,n,o){this.anchor=e;this.focus=t;e._selection=this;t._selection=this;this._cachedNodes=null;this.format=n;this.style=o;this.dirty=false}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Hs(e)){return false}return this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null){return e}const t=this.anchor;const n=this.focus;const o=t.isBefore(n);const r=o?t:n;const s=o?n:t;let i=r.getNode();let l=s.getNode();const c=r.offset;const a=s.offset;if(ol(i)){const e=i.getDescendantByIndex(c);i=e!=null?e:i}if(ol(l)){let e=l.getDescendantByIndex(a);if(e!==null&&e!==i&&l.getChildAtIndex(a)===e){e=e.getPreviousSibling()}l=e!=null?e:l}let u;if(i.is(l)){if(ol(i)&&i.getChildrenSize()>0){u=[]}else{u=[i]}}else{u=i.getNodesBetween(l)}if(!Ai()){this._cachedNodes=u}return u}setTextNodeRange(e,t,n,o){Ws(this.anchor,e.__key,t,"text");Ws(this.focus,n.__key,o,"text");this._cachedNodes=null;this.dirty=true}getTextContent(){const e=this.getNodes();if(e.length===0){return""}const t=e[0];const n=e[e.length-1];const o=this.anchor;const r=this.focus;const s=o.isBefore(r);const[i,l]=js(this);let c="";let a=true;for(let u=0;u<e.length;u++){const f=e[u];if(ol(f)&&!f.isInline()){if(!a){c+="\n"}if(f.isEmpty()){a=false}else{a=true}}else{a=false;if(vs(f)){let e=f.getTextContent();if(f===t){if(f===n){if(o.type!=="element"||r.type!=="element"||r.offset===o.offset){e=i<l?e.slice(i,l):e.slice(l,i)}}else{e=s?e.slice(i):e.slice(l)}}else if(f===n){e=s?e.slice(0,l):e.slice(0,i)}c+=e}else if((il(f)||as(f))&&(f!==n||!this.isCollapsed())){c+=f.getTextContent()}}}return c}applyDOMRange(e){const t=ki();const n=t.getEditorState();const o=n._selection;const r=ni(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,o);if(r===null){return}const[s,i]=r;Ws(this.anchor,s.key,s.offset,s.type);Ws(this.focus,i.key,i.offset,i.type);this._cachedNodes=null}clone(){const e=this.anchor;const t=this.focus;const n=new Us($s(e.key,e.offset,e.type),$s(t.key,t.offset,t.type),this.format,this.style);return n}toggleFormat(e){this.format=wt(this.format,e,null);this.dirty=true}setStyle(e){this.style=e;this.dirty=true}hasFormat(e){const t=Fe[e];return(this.format&t)!==0}insertRawText(e){const t=e.split(/(\r?\n|\t)/);const n=[];const o=t.length;for(let e=0;e<o;e++){const o=t[e];if(o==="\n"||o==="\r\n"){n.push(cs())}else if(o==="\t"){n.push(Is())}else{n.push(Ds(o))}}this.insertNodes(n)}insertText(e){const t=this.anchor;const n=this.focus;const o=this.format;const r=this.style;let s=t;let i=n;if(!this.isCollapsed()&&n.isBefore(t)){s=n;i=t}if(s.type==="element"){Bs(s,i,o,r)}const l=s.offset;let c=i.offset;const a=this.getNodes();const u=a.length;let f=a[0];if(!vs(f)){{throw Error(`insertText: first node is not a text node`)}}const d=f.getTextContent();const h=d.length;const g=f.getParentOrThrow();const _=u-1;let p=a[_];if(u===1&&i.type==="element"){c=h;i.set(s.key,c,"text")}if(this.isCollapsed()&&l===h&&(f.isSegmented()||f.isToken()||!f.canInsertTextAfter()||!g.canInsertTextAfter()&&f.getNextSibling()===null)){let t=f.getNextSibling();if(!vs(t)||!t.canInsertTextBefore()||Tt(t)){t=Ds();t.setFormat(o);t.setStyle(r);if(!g.canInsertTextAfter()){g.insertAfter(t)}else{f.insertAfter(t)}}t.select(0,0);f=t;if(e!==""){this.insertText(e);return}}else if(this.isCollapsed()&&l===0&&(f.isSegmented()||f.isToken()||!f.canInsertTextBefore()||!g.canInsertTextBefore()&&f.getPreviousSibling()===null)){let t=f.getPreviousSibling();if(!vs(t)||Tt(t)){t=Ds();t.setFormat(o);if(!g.canInsertTextBefore()){g.insertBefore(t)}else{f.insertBefore(t)}}t.select();f=t;if(e!==""){this.insertText(e);return}}else if(f.isSegmented()&&l!==h){const e=Ds(f.getTextContent());e.setFormat(o);f.replace(e);f=e}else if(!this.isCollapsed()&&e!==""){const t=p.getParent();if(!g.canInsertTextBefore()||!g.canInsertTextAfter()||ol(t)&&(!t.canInsertTextBefore()||!t.canInsertTextAfter())){this.insertText("");ti(this.anchor,this.focus,null);this.insertText(e);return}}if(u===1){if(f.isToken()){const t=Ds(e);t.select();f.replace(t);return}const t=f.getFormat();const n=f.getStyle();if(l===c&&(t!==o||n!==r)){if(f.getTextContent()===""){f.setFormat(o);f.setStyle(r)}else{const t=Ds(e);t.setFormat(o);t.setStyle(r);t.select();if(l===0){f.insertBefore(t,false)}else{const[e]=f.splitText(l);e.insertAfter(t,false)}if(t.isComposing()&&this.anchor.type==="text"){this.anchor.offset-=e.length}return}}else if(Ls(f)){const t=Ds(e);t.setFormat(o);t.setStyle(r);t.select();f.replace(t);return}const s=c-l;f=f.spliceText(l,s,e,true);if(f.getTextContent()===""){f.remove()}else if(this.anchor.type==="text"){if(f.isComposing()){this.anchor.offset-=e.length}else{this.format=t;this.style=n}}}else{const t=new Set([...f.getParentKeys(),...p.getParentKeys()]);const n=ol(f)?f:f.getParentOrThrow();let o=ol(p)?p:p.getParentOrThrow();let r=p;if(!n.is(o)&&o.isInline()){do{r=o;o=o.getParentOrThrow()}while(o.isInline())}if(i.type==="text"&&(c!==0||p.getTextContent()==="")||i.type==="element"&&p.getIndexWithinParent()<c){if(vs(p)&&!p.isToken()&&c!==p.getTextContentSize()){if(p.isSegmented()){const e=Ds(p.getTextContent());p.replace(e);p=e}if(!al(i.getNode())&&i.type==="text"){p=p.spliceText(0,c,"")}t.add(p.__key)}else{const e=p.getParentOrThrow();if(!e.canBeEmpty()&&e.getChildrenSize()===1){e.remove()}else{p.remove()}}}else{t.add(p.__key)}const s=o.getChildren();const d=new Set(a);const g=n.is(o);const _=n.isInline()&&f.getNextSibling()===null?n:f;for(let e=s.length-1;e>=0;e--){const t=s[e];if(t.is(f)||ol(t)&&t.isParentOf(f)){break}if(t.isAttached()){if(!d.has(t)||t.is(r)){if(!g){_.insertAfter(t,false)}}else{t.remove()}}}if(!g){let e=o;let n=null;while(e!==null){const o=e.getChildren();const r=o.length;if(r===0||o[r-1].is(n)){t.delete(e.__key);n=e}e=e.getParent()}}if(!f.isToken()){f=f.spliceText(l,h-l,e,true);if(f.getTextContent()===""){f.remove()}else if(f.isComposing()&&this.anchor.type==="text"){this.anchor.offset-=e.length}}else if(l===h){f.select()}else{const t=Ds(e);t.select();f.replace(t)}for(let e=1;e<u;e++){const n=a[e];const o=n.__key;if(!t.has(o)){n.remove()}}}}removeText(){this.insertText("")}formatText(e){if(this.isCollapsed()){this.toggleFormat(e);Rt(null);return}const t=this.getNodes();const n=[];for(const e of t){if(vs(e)){n.push(e)}}const o=n.length;if(o===0){this.toggleFormat(e);Rt(null);return}const r=this.anchor;const s=this.focus;const i=this.isBackward();const l=i?s:r;const c=i?r:s;let a=0;let u=n[0];let f=l.type==="element"?0:l.offset;if(l.type==="text"&&f===u.getTextContentSize()){a=1;u=n[1];f=0}if(u==null){return}const d=u.getFormatFlags(e,null);const h=o-1;let g=n[h];const _=c.type==="text"?c.offset:g.getTextContentSize();if(u.is(g)){if(f===_){return}if(Tt(u)||f===0&&_===u.getTextContentSize()){u.setFormat(d)}else{const e=u.splitText(f,_);const t=f===0?e[0]:e[1];t.setFormat(d);if(l.type==="text"){l.set(t.__key,0,"text")}if(c.type==="text"){c.set(t.__key,_-f,"text")}}this.format=d;return}if(f!==0&&!Tt(u)){[,u]=u.splitText(f);f=0}u.setFormat(d);const p=g.getFormatFlags(e,d);if(_>0){if(_!==g.getTextContentSize()&&!Tt(g)){[g]=g.splitText(_)}g.setFormat(p)}for(let t=a+1;t<h;t++){const o=n[t];const r=o.getFormatFlags(e,p);o.setFormat(r)}if(l.type==="text"){l.set(u.__key,f,"text")}if(c.type==="text"){c.set(g.__key,_,"text")}this.format=d|p}insertNodes(e){if(e.length===0){return}if(this.anchor.key==="root"){this.insertParagraph();const t=ui();if(!Hs(t)){throw Error(`Expected RangeSelection after insertParagraph`)}return t.insertNodes(e)}const t=this.isBackward()?this.focus:this.anchor;const n=To(t.getNode(),Co);const o=e[e.length-1];if("__language"in n&&ol(n)){if("__language"in e[0]){this.insertText(e[0].getTextContent())}else{const t=Ci(this);n.splice(t,0,e);o.selectEnd()}return}const r=e=>(ol(e)||il(e))&&!e.isInline();if(!e.some(r)){if(!ol(n)){throw Error(`Expected 'firstBlock' to be an ElementNode`)}const t=Ci(this);n.splice(t,0,e);o.selectEnd();return}const s=Ei(e);const i=s.getLastDescendant();const l=s.getChildren();const c=e=>ol(e)&&Co(e)&&!e.isEmpty()&&ol(n)&&(!n.isEmpty()||n.canMergeWhenEmpty());const a=!ol(n)||!n.isEmpty();const u=a?this.insertParagraph():null;const f=l[l.length-1];let d=l[0];if(c(d)){if(!ol(n)){throw Error(`Expected 'firstBlock' to be an ElementNode`)}n.append(...d.getChildren());d=l[1]}if(d){ss(n,d)}const h=To(i,Co);if(u&&ol(h)&&(u.canMergeWhenEmpty()||Co(f))){h.append(...u.getChildren());u.remove()}if(ol(n)&&n.isEmpty()){n.remove()}i.selectEnd();const g=ol(n)?n.getLastChild():null;if(as(g)&&h!==n){g.remove()}}insertParagraph(){if(this.anchor.key==="root"){const e=Nl();Bt().splice(this.anchor.offset,0,[e]);e.select();return e}const e=Ci(this);const t=To(this.anchor.getNode(),Co);if(!ol(t)){throw Error(`Expected ancestor to be an ElementNode`)}const n=t.getChildAtIndex(e);const o=n?[n,...n.getNextSiblings()]:[];const r=t.insertNewAfter(this,false);if(r){r.append(...o);r.selectStart();return r}return null}insertLineBreak(e){const t=cs();this.insertNodes([t]);if(e){const e=t.getParentOrThrow();const n=t.getIndexWithinParent();e.select(n,n)}}extract(){const e=this.getNodes();const t=e.length;const n=t-1;const o=this.anchor;const r=this.focus;let s=e[0];let i=e[n];const[l,c]=js(this);if(t===0){return[]}else if(t===1){if(vs(s)&&!this.isCollapsed()){const e=l>c?c:l;const t=l>c?l:c;const n=s.splitText(e,t);const o=e===0?n[0]:n[1];return o!=null?[o]:[]}return[s]}const a=o.isBefore(r);if(vs(s)){const t=a?l:c;if(t===s.getTextContentSize()){e.shift()}else if(t!==0){[,s]=s.splitText(t);e[0]=s}}if(vs(i)){const t=i.getTextContent();const o=t.length;const r=a?c:l;if(r===0){e.pop()}else if(r!==o){[i]=i.splitText(r);e[n]=i}}return e}modify(e,t,n){const o=this.focus;const r=this.anchor;const s=e==="move";const i=Hn(o,t);if(il(i)&&!i.isIsolated()){if(s&&i.isKeyboardSelectable()){const e=ii();e.add(i.__key);zt(e);return}const e=t?i.getPreviousSibling():i.getNextSibling();if(!vs(e)){const n=i.getParentOrThrow();let l;let c;if(ol(e)){c=e.__key;l=t?e.getChildrenSize():0}else{l=i.getIndexWithinParent();c=n.__key;if(!t){l++}}o.set(c,l,"element");if(s){r.set(c,l,"element")}return}else{const n=e.__key;const i=t?e.getTextContent().length:0;o.set(n,i,"text");if(s){r.set(n,i,"text")}return}}const l=ki();const c=go(l._window);if(!c){return}const a=l._blockCursorElement;const u=l._rootElement;if(u!==null&&a!==null&&ol(i)&&!i.isInline()&&!i.canBeEmpty()){fo(a,l,u)}Xs(c,e,t?"backward":"forward",n);if(c.rangeCount>0){const e=c.getRangeAt(0);const n=this.anchor.getNode();const o=al(n)?n:oo(n);this.applyDOMRange(e);this.dirty=true;if(!s){const n=this.getNodes();const r=[];let s=false;for(let e=0;e<n.length;e++){const t=n[e];if(Zn(t,o)){r.push(t)}else{s=true}}if(s&&r.length>0){if(t){const e=r[0];if(ol(e)){e.selectStart()}else{e.getParentOrThrow().selectStart()}}else{const e=r[r.length-1];if(ol(e)){e.selectEnd()}else{e.getParentOrThrow().selectEnd()}}}if(c.anchorNode!==e.startContainer||c.anchorOffset!==e.startOffset){Gs(this)}}}}forwardDeletion(e,t,n){if(!n&&(e.type==="element"&&ol(t)&&e.offset===t.getChildrenSize()||e.type==="text"&&e.offset===t.getTextContentSize())){const e=t.getParent();const n=t.getNextSibling()||(e===null?null:e.getNextSibling());if(ol(n)&&n.isShadowRoot()){return true}}return false}deleteCharacter(e){const t=this.isCollapsed();if(this.isCollapsed()){const t=this.anchor;let o=t.getNode();if(this.forwardDeletion(t,o,e)){return}const r=this.focus;const s=Hn(r,e);if(il(s)&&!s.isIsolated()){if(s.isKeyboardSelectable()&&ol(o)&&o.getChildrenSize()===0){o.remove();const e=ii();e.add(s.__key);zt(e)}else{s.remove();const e=ki();e.dispatchCommand(n,undefined)}return}else if(!e&&ol(s)&&ol(o)&&o.isEmpty()){o.remove();s.selectStart();return}this.modify("extend",e,"character");if(!this.isCollapsed()){const n=r.type==="text"?r.getNode():null;o=t.type==="text"?t.getNode():null;if(n!==null&&n.isSegmented()){const t=r.offset;const s=n.getTextContentSize();if(n.is(o)||e&&t!==s||!e&&t!==0){qs(n,e,t);return}}else if(o!==null&&o.isSegmented()){const r=t.offset;const s=o.getTextContentSize();if(o.is(n)||e&&r!==0||!e&&r!==s){qs(o,e,r);return}}Vs(this,e)}else if(e&&t.offset===0){const e=t.type==="element"?t.getNode():t.getNode().getParentOrThrow();if(e.collapseAtStart(this)){return}}}this.removeText();if(e&&!t&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const e=this.anchor.getNode();if(e.isEmpty()&&al(e.getParent())&&e.getIndexWithinParent()===0){e.collapseAtStart(this)}}}deleteLine(e){if(this.isCollapsed()){const t=this.anchor.type==="element";if(t){this.insertText(" ")}this.modify("extend",e,"lineboundary");const n=e?this.focus:this.anchor;if(n.offset===0){this.modify("extend",e,"character")}if(t){const t=e?this.anchor:this.focus;t.set(t.key,t.offset+1,t.type)}}this.removeText()}deleteWord(e){if(this.isCollapsed()){const t=this.anchor;const n=t.getNode();if(this.forwardDeletion(t,n,e)){return}this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Ys(e){return e instanceof zs}function Js(e){const t=e.offset;if(e.type==="text"){return t}const n=e.getNode();return t===n.getChildrenSize()?n.getTextContent().length:0}function js(e){const t=e.getStartEndPoints();if(t===null){return[0,0]}const[n,o]=t;if(n.type==="element"&&o.type==="element"&&n.key===o.key&&n.offset===o.offset){return[0,0]}return[Js(n),Js(o)]}function Gs(e){const t=e.focus;const n=e.anchor;const o=n.key;const r=n.offset;const s=n.type;Ws(n,t.key,t.offset,t.type);Ws(t,o,r,s);e._cachedNodes=null}function Xs(e,t,n,o){e.modify(t,n,o)}function Vs(e,t){const n=e.anchor;const o=e.focus;const r=n.getNode();const s=o.getNode();if(r===s&&n.type==="text"&&o.type==="text"){const e=n.offset;const s=o.offset;const i=e<s;const l=i?e:s;const c=i?s:e;const a=c-1;if(l!==a){const e=r.getTextContent().slice(l,c);if(!jt(e)){if(t){o.offset=a}else{n.offset=a}}}}}function qs(e,t,n){const o=e;const r=o.getTextContent();const s=r.split(/(?=\s)/g);const i=s.length;let l=0;let c=0;for(let e=0;e<i;e++){const o=s[e];const r=e===i-1;c=l;l+=o.length;if(t&&l===n||l>n||r){s.splice(e,1);if(r){c=undefined}break}}const a=s.join("").trim();if(a===""){o.remove()}else{o.setTextContent(a);o.select(c,c)}}function Qs(e,t,n){const o=e.getParent();return n===null||o===null||!o.canBeEmpty()||o!==n.getNode()}function Zs(e,t,n,o){let r=t;let s;if(e.nodeType===re){let i=false;const l=e.childNodes;const c=l.length;const a=o._blockCursorElement;if(r===c){i=true;r=c-1}let u=l[r];let f=false;if(u===a){u=l[r+1];f=true}else if(a!==null){const n=a.parentNode;if(e===n){const e=Array.prototype.indexOf.call(n.children,a);if(t>e){r--}}}s=Ut(u);if(vs(s)){r=Yt(s,i)}else{let o=Ut(e);if(o===null){return null}if(ol(o)){r=Math.min(o.getChildrenSize(),r);let e=o.getChildAtIndex(r);if(ol(e)&&Qs(e,r,n)){const t=i?e.getLastDescendant():e.getFirstDescendant();if(t===null){o=e}else{e=t;o=ol(e)?e:e.getParentOrThrow()}r=0}if(vs(e)){s=e;o=null;r=Yt(e,i)}else if(e!==o&&i&&!f){r++}}else{const n=o.getIndexWithinParent();if(t===0&&il(o)&&Ut(e)===o){r=n}else{r=n+1}o=o.getParentOrThrow()}if(ol(o)){return $s(o.__key,r,"element")}}}else{s=Ut(e)}if(!vs(s)){return null}return $s(s.__key,r,"text")}function ei(e,t,n){const o=e.offset;const r=e.getNode();if(o===0){const o=r.getPreviousSibling();const s=r.getParent();if(!t){if(ol(o)&&!n&&o.isInline()){e.key=o.__key;e.offset=o.getChildrenSize();e.type="element"}else if(vs(o)){e.key=o.__key;e.offset=o.getTextContent().length}}else if((n||!t)&&o===null&&ol(s)&&s.isInline()){const t=s.getPreviousSibling();if(vs(t)){e.key=t.__key;e.offset=t.getTextContent().length}}}else if(o===r.getTextContent().length){const o=r.getNextSibling();const s=r.getParent();if(t&&ol(o)&&o.isInline()){e.key=o.__key;e.offset=0;e.type="element"}else if((n||t)&&o===null&&ol(s)&&s.isInline()&&!s.canInsertTextAfter()){const t=s.getNextSibling();if(vs(t)){e.key=t.__key;e.offset=0}}}}function ti(e,t,n){if(e.type==="text"&&t.type==="text"){const o=e.isBefore(t);const r=e.is(t);ei(e,o,r);ei(t,!o,r);if(r){t.key=e.key;t.offset=e.offset;t.type=e.type}const s=ki();if(s.isComposing()&&s._compositionKey!==e.key&&Hs(n)){const o=n.anchor;const r=n.focus;Ws(e,o.key,o.offset,o.type);Ws(t,r.key,r.offset,r.type)}}}function ni(e,t,n,o,r,s){if(e===null||n===null||!pt(r,e,n)){return null}const i=Zs(e,t,Hs(s)?s.anchor:null,r);if(i===null){return null}const l=Zs(n,o,Hs(s)?s.focus:null,r);if(l===null){return null}if(i.type==="element"&&l.type==="element"){const t=Ut(e);const o=Ut(n);if(il(t)&&il(o)){return null}}ti(i,l,s);return[i,l]}function oi(e){return ol(e)&&!e.isInline()}function ri(e,t,n,o,r,s){const i=Ri();const l=new Us($s(e,t,r),$s(n,o,s),0,"");l.dirty=true;i._selection=l;return l}function si(){const e=$s("root",0,"element");const t=$s("root",0,"element");return new Us(e,t,0,"")}function ii(){return new zs(new Set)}function li(e){const t=e.getEditorState();const n=t._selection;const o=go(e._window);if(Hs(n)||n==null){return ai(n,o,e,null)}return n.clone()}function ci(e,t){return ai(null,e,t,null)}function ai(e,t,n,o){const r=n._window;if(r===null){return null}const s=o||r.event;const i=s?s.type:undefined;const l=i==="selectionchange";const c=!Ge()&&(l||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&s&&s.detail===3||i==="drop"||i===undefined);let a,u,f,d;if(!Hs(e)||c){if(t===null){return null}a=t.anchorNode;u=t.focusNode;f=t.anchorOffset;d=t.focusOffset;if(l&&Hs(e)&&!pt(n,a,u)){return e.clone()}}else{return e.clone()}const h=ni(a,f,u,d,n,e);if(h===null){return null}const[g,_]=h;return new Us(g,_,!Hs(e)?0:e.format,!Hs(e)?"":e.style)}function ui(){const e=Ri();return e._selection}function fi(){const e=ki();return e._editorState._selection}function di(e,t,n,o=1){const r=e.anchor;const s=e.focus;const i=r.getNode();const l=s.getNode();if(!t.is(i)&&!t.is(l)){return}const c=t.__key;if(e.isCollapsed()){const t=r.offset;if(n<=t&&o>0||n<t&&o<0){const n=Math.max(0,t+o);r.set(c,n,"element");s.set(c,n,"element");hi(e)}}else{const i=e.isBackward();const l=i?s:r;const a=l.getNode();const u=i?r:s;const f=u.getNode();if(t.is(a)){const e=l.offset;if(n<=e&&o>0||n<e&&o<0){l.set(c,Math.max(0,e+o),"element")}}if(t.is(f)){const e=u.offset;if(n<=e&&o>0||n<e&&o<0){u.set(c,Math.max(0,e+o),"element")}}}hi(e)}function hi(e){const t=e.anchor;const n=t.offset;const o=e.focus;const r=o.offset;const s=t.getNode();const i=o.getNode();if(e.isCollapsed()){if(!ol(s)){return}const e=s.getChildrenSize();const r=n>=e;const i=r?s.getChildAtIndex(e-1):s.getChildAtIndex(n);if(vs(i)){let e=0;if(r){e=i.getTextContentSize()}t.set(i.__key,e,"text");o.set(i.__key,e,"text")}return}if(ol(s)){const e=s.getChildrenSize();const o=n>=e;const r=o?s.getChildAtIndex(e-1):s.getChildAtIndex(n);if(vs(r)){let e=0;if(o){e=r.getTextContentSize()}t.set(r.__key,e,"text")}}if(ol(i)){const e=i.getChildrenSize();const t=r>=e;const n=t?i.getChildAtIndex(e-1):i.getChildAtIndex(r);if(vs(n)){let e=0;if(t){e=n.getTextContentSize()}o.set(n.__key,e,"text")}}}function gi(e,t){const n=t.getEditorState();const o=n._selection;const r=e._selection;if(Hs(r)){const e=r.anchor;const t=r.focus;let n;if(e.type==="text"){n=e.getNode();n.selectionTransform(o,r)}if(t.type==="text"){const e=t.getNode();if(n!==e){e.selectionTransform(o,r)}}}}function _i(e,t,n,o,r){let s=null;let i=0;let l=null;if(o!==null){s=o.__key;if(vs(o)){i=o.getTextContentSize();l="text"}else if(ol(o)){i=o.getChildrenSize();l="element"}}else{if(r!==null){s=r.__key;if(vs(r)){l="text"}else if(ol(r)){l="element"}}}if(s!==null&&l!==null){e.set(s,i,l)}else{i=t.getIndexWithinParent();if(i===-1){i=n.getChildrenSize()}e.set(n.__key,i,"element")}}function pi(e,t,n,o,r){if(e.type==="text"){e.key=n;if(!t){e.offset+=r}}else if(e.offset>o.getIndexWithinParent()){e.offset-=1}}function mi(e,t,n,o,r,s,i){const l=o.anchorNode;const c=o.focusNode;const a=o.anchorOffset;const u=o.focusOffset;const f=document.activeElement;if(r.has("collaboration")&&f!==s||f!==null&&_t(f)){return}if(!Hs(t)){if(e!==null&&pt(n,l,c)){o.removeAllRanges()}return}const d=t.anchor;const h=t.focus;const g=d.key;const _=h.key;const p=jn(n,g);const m=jn(n,_);const N=d.offset;const y=h.offset;const C=t.format;const T=t.style;const E=t.isCollapsed();let S=p;let w=m;let x=false;if(d.type==="text"){S=St(p);const e=d.getNode();x=e.getFormat()!==C||e.getStyle()!==T}else if(Hs(e)&&e.anchor.type==="text"){x=true}if(h.type==="text"){w=St(m)}if(S===null||w===null){return}if(E&&(e===null||x||Hs(e)&&(e.format!==C||e.style!==T))){ts(C,T,N,g,performance.now())}if(a===N&&u===y&&l===S&&c===w&&!(o.type==="Range"&&E)){if(f===null||!s.contains(f)){s.focus({preventScroll:true})}if(d.type!=="element"){return}}try{o.setBaseAndExtent(S,N,w,y)}catch(e){{console.warn(e)}}if(!r.has("skip-scroll-into-view")&&t.isCollapsed()&&s!==null&&s===document.activeElement){const e=t instanceof Us&&t.anchor.type==="element"?S.childNodes[N]||null:o.rangeCount>0?o.getRangeAt(0):null;if(e!==null){let t;if(e instanceof Text){const n=document.createRange();n.selectNode(e);t=n.getBoundingClientRect()}else{t=e.getBoundingClientRect()}Xn(n,t,s)}}es()}function Ni(e){let t=ui()||fi();if(t===null){t=Bt().selectEnd()}t.insertNodes(e)}function yi(){const e=ui();if(e===null){return""}return e.getTextContent()}function Ci(e){let t=e;if(!e.isCollapsed()){t.removeText()}const n=ui();if(Hs(n)){t=n}if(!Hs(t)){throw Error(`Unexpected dirty selection to be null`)}const o=t.anchor;let r=o.getNode();let s=o.offset;while(!Co(r)){[r,s]=Ti(r,s)}return s}function Ti(e,t){const n=e.getParent();if(!n){const e=Nl();Bt().append(e);e.select();return[Bt(),0]}if(vs(e)){const o=e.splitText(t);if(o.length===0){return[n,e.getIndexWithinParent()]}const r=t===0?0:1;const s=o[0].getIndexWithinParent()+r;return[n,s]}if(!ol(e)||t===0){return[n,e.getIndexWithinParent()]}const o=e.getChildAtIndex(t);if(o){const n=new Us($s(e.__key,t,"element"),$s(e.__key,t,"element"),0,"");const r=e.insertNewAfter(n);if(r){r.append(o,...o.getNextSiblings())}}return[n,e.getIndexWithinParent()+1]}function Ei(e){const t=Nl();let n=null;for(let o=0;o<e.length;o++){const r=e[o];const s=as(r);if(s||il(r)&&r.isInline()||ol(r)&&r.isInline()||vs(r)||r.isParentRequired()){if(n===null){n=r.createParentElementNode();t.append(n);if(s){continue}}if(n!==null){n.append(r)}}else{t.append(r);n=null}}return t}let Si=null;let wi=null;let xi=false;let bi=false;let Oi=0;const Mi={characterData:true,childList:true,subtree:true};function Ai(){return xi||Si!==null&&Si._readOnly}function Di(){if(xi){{throw Error(`Cannot use method in read-only mode.`)}}}function vi(){if(Oi>99){{throw Error(`One or more transforms are endlessly triggering additional transforms. May have encountered infinite recursion caused by transforms that have their preconditions too lose and/or conflict with each other.`)}}}function Ri(){if(Si===null){{throw Error(`Unable to find an active editor state. State helpers or node methods can only be used synchronously during the callback of editor.update(), editor.read(), or editorState.read().${Ii()}`)}}return Si}function ki(){if(wi===null){{throw Error(`Unable to find an active editor. This method can only be used synchronously during the callback of editor.update() or editor.read().${Ii()}`)}}return wi}function Ii(){let e=0;const t=new Set;const n=Al.version;if(typeof window!=="undefined"){for(const o of document.querySelectorAll("[contenteditable]")){const r=yt(o);if(mt(r)){e++}else if(r){let e=String(r.constructor.version||"<0.17.1");if(e===n){e+=" (separately built, likely a bundler configuration issue)"}t.add(e)}}}let o=` Detected on the page: ${e} compatible editor(s) with version ${n}`;if(t.size){o+=` and incompatible editors with versions ${Array.from(t).join(", ")}`}return o}function Li(){return wi}function Pi(){return Si}function $i(e,t,n){const o=t.__type;const r=dt(e,o);let s=n.get(o);if(s===undefined){s=Array.from(r.transforms);n.set(o,s)}const i=s.length;for(let e=0;e<i;e++){s[e](t);if(!t.isAttached()){break}}}function Fi(e,t){return e!==undefined&&e.__key!==t&&e.isAttached()}function Ki(e,t){const n=t._dirtyLeaves;const o=e._nodeMap;for(const e of n){const t=o.get(e);if(vs(t)&&t.isAttached()&&t.isSimpleText()&&!t.isUnmergeable()){it(t)}}}function Bi(e,t){const n=t._dirtyLeaves;const o=t._dirtyElements;const r=e._nodeMap;const s=kt();const i=new Map;let l=n;let c=l.size;let a=o;let u=a.size;while(c>0||u>0){if(c>0){t._dirtyLeaves=new Set;for(const e of l){const o=r.get(e);if(vs(o)&&o.isAttached()&&o.isSimpleText()&&!o.isUnmergeable()){it(o)}if(o!==undefined&&Fi(o,s)){$i(t,o,i)}n.add(e)}l=t._dirtyLeaves;c=l.size;if(c>0){Oi++;continue}}t._dirtyLeaves=new Set;t._dirtyElements=new Map;for(const e of a){const n=e[0];const l=e[1];if(n!=="root"&&!l){continue}const c=r.get(n);if(c!==undefined&&Fi(c,s)){$i(t,c,i)}o.set(n,l)}l=t._dirtyLeaves;c=l.size;a=t._dirtyElements;u=a.size;Oi++}t._dirtyLeaves=n;t._dirtyElements=o}function Wi(e){const t=e;return zi(t,ki()._nodes)}function zi(e,t){const n=e.type;const o=t.get(n);if(o===undefined){{throw Error(`parseEditorState: type "${n}" + not found`)}}const r=o.klass;if(e.type!==r.getType()){{throw Error(`LexicalNode: Node ${r.name} does not implement .importJSON().`)}}const s=r.importJSON(e);const i=e.children;if(ol(s)&&Array.isArray(i)){for(let e=0;e<i.length;e++){const n=i[e];const o=zi(n,t);s.append(o)}}return s}function Hi(e,t,n){const o=dl();const r=Si;const s=xi;const i=wi;const l=t._dirtyElements;const c=t._dirtyLeaves;const a=t._cloneNotNeeded;const u=t._dirtyType;t._dirtyElements=new Map;t._dirtyLeaves=new Set;t._cloneNotNeeded=new Set;t._dirtyType=0;Si=o;xi=false;wi=t;try{const r=t._nodes;const s=e.root;zi(s,r);if(n){n()}o._readOnly=true;{Yi(o)}}catch(e){if(e instanceof Error){t._onError(e)}}finally{t._dirtyElements=l;t._dirtyLeaves=c;t._cloneNotNeeded=a;t._dirtyType=u;Si=r;xi=s;wi=i}return o}function Ui(e,t,n){const o=Si;const r=xi;const s=wi;Si=t;xi=true;wi=e;try{return n()}finally{Si=o;xi=r;wi=s}}function Yi(e){const t=e._nodeMap;t.set=()=>{throw new Error("Cannot call set() on a frozen Lexical node map")};t.clear=()=>{throw new Error("Cannot call clear() on a frozen Lexical node map")};t.delete=()=>{throw new Error("Cannot call delete() on a frozen Lexical node map")}}function Ji(e,t){const o=e._pendingEditorState;const r=e._rootElement;const s=e._headless||r===null;if(o===null){return}const i=e._editorState;const l=i._selection;const c=o._selection;const a=e._dirtyType!==ie;const u=Si;const f=xi;const d=wi;const h=e._updating;const g=e._observer;let _=null;e._pendingEditorState=null;e._editorState=o;if(!s&&a&&g!==null){wi=e;Si=o;xi=false;e._updating=true;try{const t=e._dirtyType;const n=e._dirtyElements;const r=e._dirtyLeaves;g.disconnect();_=pr(i,o,e,t,n,r)}catch(t){if(t instanceof Error){e._onError(t)}if(!bi){bl(e,null,r,o);ot(e);e._dirtyType=ce;bi=true;Ji(e,i);bi=false}else{throw t}return}finally{g.observe(r,Mi);e._updating=h;Si=u;xi=f;wi=d}}if(!o._readOnly){o._readOnly=true;{Yi(o);if(Hs(c)){Object.freeze(c.anchor);Object.freeze(c.focus)}Object.freeze(c)}}const p=e._dirtyLeaves;const m=e._dirtyElements;const N=e._normalizedNodes;const y=e._updateTags;const C=e._deferred;if(a){e._dirtyType=ie;e._cloneNotNeeded.clear();e._dirtyLeaves=new Set;e._dirtyElements=new Map;e._normalizedNodes=new Set;e._updateTags=new Set}Oo(e,o);const T=s?null:go(e._window);if(e._editable&&T!==null&&(a||c===null||c.dirty)){wi=e;Si=o;try{if(g!==null){g.disconnect()}if(a||c===null||c.dirty){const t=e._blockCursorElement;if(t!==null){fo(t,e,r)}mi(l,c,e,T,y,r)}ho(e,r,c);if(g!==null){g.observe(r,Mi)}}finally{wi=d;Si=u}}if(_!==null){Gi(e,_,y,p,i)}if(!Hs(c)&&c!==null&&(l===null||!l.is(c))){e.dispatchCommand(n,undefined)}const E=e._pendingDecorators;if(E!==null){e._decorators=E;e._pendingDecorators=null;Xi("decorator",e,true,E)}ji(e,t||i,o);Xi("update",e,true,{dirtyElements:m,dirtyLeaves:p,editorState:o,normalizedNodes:N,prevEditorState:t||i,tags:y});Qi(e,C);qi(e)}function ji(e,t,n){const o=Ft(t);const r=Ft(n);if(o!==r){Xi("textcontent",e,true,r)}}function Gi(e,t,n,o,r){const s=Array.from(e._listeners.mutation);const i=s.length;for(let e=0;e<i;e++){const[i,l]=s[e];const c=t.get(l);if(c!==undefined){i(c,{dirtyLeaves:o,prevEditorState:r,updateTags:n})}}}function Xi(e,t,n,...o){const r=t._updating;t._updating=n;try{const n=Array.from(t._listeners[e]);for(let e=0;e<n.length;e++){n[e].apply(null,o)}}finally{t._updating=r}}function Vi(e,t,n){if(e._updating===false||wi!==e){let o=false;e.update((()=>{o=Vi(e,t,n)}));return o}const o=Gt(e);for(let r=4;r>=0;r--){for(let s=0;s<o.length;s++){const i=o[s];const l=i._commands;const c=l.get(t);if(c!==undefined){const t=c[r];if(t!==undefined){const o=Array.from(t);const r=o.length;for(let t=0;t<r;t++){if(o[t](n,e)===true){return true}}}}}}return false}function qi(e){const t=e._updates;if(t.length!==0){const n=t.shift();if(n){const[t,o]=n;el(e,t,o)}}}function Qi(e,t){e._deferred=[];if(t.length!==0){const n=e._updating;e._updating=true;try{for(let e=0;e<t.length;e++){t[e]()}}finally{e._updating=n}}}function Zi(e,t){const n=e._updates;let o=t||false;while(n.length!==0){const t=n.shift();if(t){const[n,r]=t;let s;let i;if(r!==undefined){s=r.onUpdate;i=r.tag;if(r.skipTransforms){o=true}if(r.discrete){const t=e._pendingEditorState;if(!(t!==null)){throw Error(`Unexpected empty pending editor state on discrete nested update`)}t._flushSync=true}if(s){e._deferred.push(s)}if(i){e._updateTags.add(i)}}n()}}return o}function el(e,t,n){const o=e._updateTags;let r;let s;let i=false;let l=false;if(n!==undefined){r=n.onUpdate;s=n.tag;if(s!=null){o.add(s)}i=n.skipTransforms||false;l=n.discrete||false}if(r){e._deferred.push(r)}const c=e._editorState;let a=e._pendingEditorState;let u=false;if(a===null||a._readOnly){a=e._pendingEditorState=fl(a||c);u=true}a._flushSync=l;const f=Si;const d=xi;const h=wi;const g=e._updating;Si=a;xi=false;e._updating=true;wi=e;try{if(u){if(e._headless){if(c._selection!==null){a._selection=c._selection.clone()}}else{a._selection=li(e)}}const n=e._compositionKey;t();i=Zi(e,i);gi(a,e);if(e._dirtyType!==ie){if(i){Ki(a,e)}else{Bi(a,e)}Zi(e);Ao(c,a,e._dirtyLeaves,e._dirtyElements)}const o=e._compositionKey;if(n!==o){a._flushSync=true}const r=a._selection;if(Hs(r)){const e=a._nodeMap;const t=r.anchor.key;const n=r.focus.key;if(e.get(t)===undefined||e.get(n)===undefined){{throw Error(`updateEditor: selection has been lost because the previously selected nodes have been removed and selection wasn't moved to another node. Ensure selection changes after removing/replacing a selected node.`)}}}else if(Ys(r)){if(r._nodes.size===0){a._selection=null}}}catch(t){if(t instanceof Error){e._onError(t)}e._pendingEditorState=c;e._dirtyType=ce;e._cloneNotNeeded.clear();e._dirtyLeaves=new Set;e._dirtyElements.clear();Ji(e);return}finally{Si=f;xi=d;wi=h;e._updating=g;Oi=0}const _=e._dirtyType!==ie||ul(a,e);if(_){if(a._flushSync){a._flushSync=false;Ji(e)}else if(u){ht((()=>{Ji(e)}))}}else{a._flushSync=false;if(u){o.clear();e._deferred=[];e._pendingEditorState=null}}}function tl(e,t,n){if(e._updating){e._updates.push([t,n])}else{el(e,t,n)}}class nl extends os{constructor(e){super(e);this.__first=null;this.__last=null;this.__size=0;this.__format=0;this.__style="";this.__indent=0;this.__dir=null}afterCloneFrom(e){super.afterCloneFrom(e);this.__first=e.__first;this.__last=e.__last;this.__size=e.__size;this.__indent=e.__indent;this.__format=e.__format;this.__style=e.__style;this.__dir=e.__dir}getFormat(){const e=this.getLatest();return e.__format}getFormatType(){const e=this.getFormat();return We[e]||""}getStyle(){const e=this.getLatest();return e.__style}getIndent(){const e=this.getLatest();return e.__indent}getChildren(){const e=[];let t=this.getFirstChild();while(t!==null){e.push(t);t=t.getNextSibling()}return e}getChildrenKeys(){const e=[];let t=this.getFirstChild();while(t!==null){e.push(t.__key);t=t.getNextSibling()}return e}getChildrenSize(){const e=this.getLatest();return e.__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const e=ki();const t=e._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const e=this.getLatest();const t=this.getParentOrThrow().getLastChild();return t!==null&&t.is(e)}getAllTextNodes(){const e=[];let t=this.getFirstChild();while(t!==null){if(vs(t)){e.push(t)}if(ol(t)){const n=t.getAllTextNodes();e.push(...n)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();while(ol(e)){const t=e.getFirstChild();if(t===null){break}e=t}return e}getLastDescendant(){let e=this.getLastChild();while(ol(e)){const t=e.getLastChild();if(t===null){break}e=t}return e}getDescendantByIndex(e){const t=this.getChildren();const n=t.length;if(e>=n){const e=t[n-1];return ol(e)&&e.getLastDescendant()||e||null}const o=t[e];return ol(o)&&o.getFirstDescendant()||o||null}getFirstChild(){const e=this.getLatest();const t=e.__first;return t===null?null:It(t)}getFirstChildOrThrow(){const e=this.getFirstChild();if(e===null){{throw Error(`Expected node ${this.__key} to have a first child.`)}}return e}getLastChild(){const e=this.getLatest();const t=e.__last;return t===null?null:It(t)}getLastChildOrThrow(){const e=this.getLastChild();if(e===null){{throw Error(`Expected node ${this.__key} to have a last child.`)}}return e}getChildAtIndex(e){const t=this.getChildrenSize();let n;let o;if(e<t/2){n=this.getFirstChild();o=0;while(n!==null&&o<=e){if(o===e){return n}n=n.getNextSibling();o++}return null}n=this.getLastChild();o=t-1;while(n!==null&&o>=e){if(o===e){return n}n=n.getPreviousSibling();o--}return null}getTextContent(){let e="";const t=this.getChildren();const n=t.length;for(let o=0;o<n;o++){const r=t[o];e+=r.getTextContent();if(ol(r)&&o!==n-1&&!r.isInline()){e+=Re}}return e}getTextContentSize(){let e=0;const t=this.getChildren();const n=t.length;for(let o=0;o<n;o++){const r=t[o];e+=r.getTextContentSize();if(ol(r)&&o!==n-1&&!r.isInline()){e+=Re.length}}return e}getDirection(){const e=this.getLatest();return e.__dir}hasFormat(e){if(e!==""){const t=Be[e];return(this.getFormat()&t)!==0}return false}select(e,t){Di();const n=ui();let o=e;let r=t;const s=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&t===0){const e=this.getFirstChild();if(vs(e)||ol(e)){return e.select(0,0)}}else if((e===undefined||e===s)&&(t===undefined||t===s)){const e=this.getLastChild();if(vs(e)||ol(e)){return e.select()}}}if(o===undefined){o=s}if(r===undefined){r=s}const i=this.__key;if(!Hs(n)){return ri(i,o,i,r,"element","element")}else{n.anchor.set(i,o,"element");n.focus.set(i,r,"element");n.dirty=true}return n}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();const t=this.getChildren();t.forEach((e=>e.remove()));return e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const t=this.getWritable();t.__dir=e;return t}setFormat(e){const t=this.getWritable();t.__format=e!==""?Be[e]:0;return this}setStyle(e){const t=this.getWritable();t.__style=e||"";return this}setIndent(e){const t=this.getWritable();t.__indent=e;return this}splice(e,t,n){const o=n.length;const r=this.getChildrenSize();const s=this.getWritable();const i=s.__key;const l=[];const c=[];const a=this.getChildAtIndex(e+t);let u=null;let f=r-t+o;if(e!==0){if(e===r){u=this.getLastChild()}else{const t=this.getChildAtIndex(e);if(t!==null){u=t.getPreviousSibling()}}}if(t>0){let e=u===null?this.getFirstChild():u.getNextSibling();for(let n=0;n<t;n++){if(e===null){{throw Error(`splice: sibling not found`)}}const t=e.getNextSibling();const n=e.__key;const o=e.getWritable();At(o);c.push(n);e=t}}let d=u;for(let e=0;e<o;e++){const t=n[e];if(d!==null&&t.is(d)){u=d=d.getPreviousSibling()}const o=t.getWritable();if(o.__parent===i){f--}At(o);const r=t.__key;if(d===null){s.__first=r;o.__prev=null}else{const e=d.getWritable();e.__next=r;o.__prev=e.__key}if(t.__key===i){{throw Error(`append: attempting to append self`)}}o.__parent=i;l.push(r);d=t}if(e+t===r){if(d!==null){const e=d.getWritable();e.__next=null;s.__last=d.__key}}else if(a!==null){const e=a.getWritable();if(d!==null){const t=d.getWritable();e.__prev=d.__key;t.__next=a.__key}else{e.__prev=null}}s.__size=f;if(c.length){const e=ui();if(Hs(e)){const t=new Set(c);const n=new Set(l);const{anchor:o,focus:r}=e;if(rl(o,t,n)){_i(o,o.getNode(),this,u,a)}if(rl(r,t,n)){_i(r,r.getNode(),this,u,a)}if(f===0&&!this.canBeEmpty()&&!ro(this)){this.remove()}}}return s}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"element",version:1}}insertNewAfter(e,t){return null}canIndent(){return true}collapseAtStart(e){return false}excludeFromCopy(e){return false}canReplaceWith(e){return true}canInsertAfter(e){return true}canBeEmpty(){return true}canInsertTextBefore(){return true}canInsertTextAfter(){return true}isInline(){return false}isShadowRoot(){return false}canMergeWith(e){return false}extractWithChild(e,t,n){return false}canMergeWhenEmpty(){return false}}function ol(e){return e instanceof nl}function rl(e,t,n){let o=e.getNode();while(o){const e=o.__key;if(t.has(e)&&!n.has(e)){return true}o=o.getParent()}return false}class sl extends os{constructor(e){super(e)}decorate(e,t){{throw Error(`decorate: base method not extended`)}}isIsolated(){return false}isInline(){return true}isKeyboardSelectable(){return true}}function il(e){return e instanceof sl}class ll extends nl{static getType(){return"root"}static clone(){return new ll}constructor(){super("root");this.__cachedText=null}getTopLevelElementOrThrow(){{throw Error(`getTopLevelElementOrThrow: root nodes are not top level elements`)}}getTextContent(){const e=this.__cachedText;if(Ai()||ki()._dirtyType===ie){if(e!==null){return e}}return super.getTextContent()}remove(){{throw Error(`remove: cannot be called on root nodes`)}}replace(e){{throw Error(`replace: cannot be called on root nodes`)}}insertBefore(e){{throw Error(`insertBefore: cannot be called on root nodes`)}}insertAfter(e){{throw Error(`insertAfter: cannot be called on root nodes`)}}updateDOM(e,t){return false}append(...e){for(let t=0;t<e.length;t++){const n=e[t];if(!ol(n)&&!il(n)){{throw Error(`rootNode.append: Only element or decorator nodes can be appended to the root node`)}}}return super.append(...e)}static importJSON(e){const t=Bt();t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"root",version:1}}collapseAtStart(){return true}}function cl(){return new ll}function al(e){return e instanceof ll}function ul(e,t){const n=t.getEditorState()._selection;const o=e._selection;if(o!==null){if(o.dirty||!o.is(n)){return true}}else if(n!==null){return true}return false}function fl(e){return new gl(new Map(e._nodeMap))}function dl(){return new gl(new Map([["root",cl()]]))}function hl(e){const t=e.exportJSON();const n=e.constructor;if(t.type!==n.getType()){{throw Error(`LexicalNode: Node ${n.name} does not match the serialized type. Check if .exportJSON() is implemented and it is returning the correct type.`)}}if(ol(e)){const o=t.children;if(!Array.isArray(o)){{throw Error(`LexicalNode: Node ${n.name} is an element but .exportJSON() does not have a children array.`)}}const r=e.getChildren();for(let e=0;e<r.length;e++){const t=r[e];const n=hl(t);o.push(n)}}return t}class gl{constructor(e,t){this._nodeMap=e;this._selection=t||null;this._flushSync=false;this._readOnly=false}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e,t){return Ui(t&&t.editor||null,this,e)}clone(e){const t=new gl(this._nodeMap,e===undefined?this._selection:e);t._readOnly=true;return t}toJSON(){return Ui(null,this,(()=>({root:hl(Bt())})))}}class _l extends nl{static getType(){return"artificial"}createDOM(e){const t=document.createElement("div");return t}}class pl extends nl{constructor(e){super(e);this.__textFormat=0;this.__textStyle=""}static getType(){return"paragraph"}getTextFormat(){const e=this.getLatest();return e.__textFormat}setTextFormat(e){const t=this.getWritable();t.__textFormat=e;return t}hasTextFormat(e){const t=Fe[e];return(this.getTextFormat()&t)!==0}getTextStyle(){const e=this.getLatest();return e.__textStyle}setTextStyle(e){const t=this.getWritable();t.__textStyle=e;return t}static clone(e){return new pl(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e);this.__textFormat=e.__textFormat;this.__textStyle=e.__textStyle}createDOM(e){const t=document.createElement("p");const n=Kn(e.theme,"paragraph");if(n!==undefined){const e=t.classList;e.add(...n)}return t}updateDOM(e,t,n){return false}static importDOM(){return{p:e=>({conversion:ml,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&mo(t)){if(this.isEmpty()){t.append(document.createElement("br"))}const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();if(n){t.dir=n}const o=this.getIndent();if(o>0){t.style.textIndent=`${o*20}px`}}return{element:t}}static importJSON(e){const t=Nl();t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);t.setTextFormat(e.textFormat);return t}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle(),type:"paragraph",version:1}}insertNewAfter(e,t){const n=Nl();n.setTextFormat(e.format);n.setTextStyle(e.style);const o=this.getDirection();n.setDirection(o);n.setFormat(this.getFormatType());n.setStyle(this.getTextStyle());this.insertAfter(n,t);return n}collapseAtStart(){const e=this.getChildren();if(e.length===0||vs(e[0])&&e[0].getTextContent().trim()===""){const e=this.getNextSibling();if(e!==null){this.selectNext();this.remove();return true}const t=this.getPreviousSibling();if(t!==null){this.selectPrevious();this.remove();return true}}return false}}function ml(e){const t=Nl();if(e.style){t.setFormat(e.style.textAlign);const n=parseInt(e.style.textIndent,10)/20;if(n>0){t.setIndent(n)}}return{node:t}}function Nl(){return io(new pl)}function yl(e){return e instanceof pl}const Cl=true;const Tl=0;const El=1;const Sl=2;const wl=3;const xl=4;function bl(e,t,n,o){const r=e._keyToDOMMap;r.clear();e._editorState=dl();e._pendingEditorState=o;e._compositionKey=null;e._dirtyType=ie;e._cloneNotNeeded.clear();e._dirtyLeaves=new Set;e._dirtyElements.clear();e._normalizedNodes=new Set;e._updateTags=new Set;e._updates=[];e._blockCursorElement=null;const s=e._observer;if(s!==null){s.disconnect();e._observer=null}if(t!==null){t.textContent=""}if(n!==null){n.textContent="";r.set("root",n)}}function Ol(e,t){const n=new Map;const o=new Set;const r=e=>{Object.keys(e).forEach((t=>{let o=n.get(t);if(o===undefined){o=[];n.set(t,o)}o.push(e[t])}))};e.forEach((e=>{const t=e.klass.importDOM;if(t==null||o.has(t)){return}o.add(t);const n=t.call(e.klass);if(n!==null){r(n)}}));if(t){r(t)}return n}function Ml(e){const t=e||{};const n=Li();const o=t.theme||{};const r=e===undefined?n:t.parentEditor||null;const s=t.disableEvents||false;const i=dl();const l=t.namespace||(r!==null?r._config.namespace:Xt());const c=t.editorState;const a=[ll,Cs,is,ks,pl,_l,...t.nodes||[]];const{onError:u,html:f}=t;const d=t.editable!==undefined?t.editable:true;let h;if(e===undefined&&n!==null){h=n._nodes}else{h=new Map;for(let e=0;e<a.length;e++){let t=a[e];let n=null;let o=null;if(typeof t!=="function"){const e=t;t=e.replace;n=e.with;o=e.withKlass||null}{const e=Object.prototype.hasOwnProperty.call(t,"getType")&&t.getType();const n=t.name;if(o){if(!(o.prototype instanceof t)){throw Error(`${o.name} doesn't extend the ${n}`)}}if(n!=="RootNode"&&e!=="root"&&e!=="artificial"){const e=t.prototype;["getType","clone"].forEach((e=>{if(!t.hasOwnProperty(e)){console.warn(`${n} must implement static "${e}" method`)}}));if(!t.hasOwnProperty("importDOM")&&t.hasOwnProperty("exportDOM")){console.warn(`${n} should implement "importDOM" if using a custom "exportDOM" method to ensure HTML serialization (important for copy & paste) works as expected`)}if(e instanceof sl){if(!e.hasOwnProperty("decorate")){console.warn(`${e.constructor.name} must implement "decorate" method`)}}if(!t.hasOwnProperty("importJSON")){console.warn(`${n} should implement "importJSON" method to ensure JSON and default HTML serialization works as expected`)}if(!e.hasOwnProperty("exportJSON")){console.warn(`${n} should implement "exportJSON" method to ensure JSON and default HTML serialization works as expected`)}}}const r=t.getType();const s=t.transform();const i=new Set;if(s!==null){i.add(s)}h.set(r,{exportDOM:f&&f.export?f.export.get(t):undefined,klass:t,replace:n,replaceWithKlass:o,transforms:i})}}const g=new Al(i,r,h,{disableEvents:s,namespace:l,theme:o},u?u:console.error,Ol(h,f?f.import:undefined),d);if(c!==undefined){g._pendingEditorState=c;g._dirtyType=ce}return g}class Al{constructor(e,t,n,o,r,s,i){this._parentEditor=t;this._rootElement=null;this._editorState=e;this._pendingEditorState=null;this._compositionKey=null;this._deferred=[];this._keyToDOMMap=new Map;this._updates=[];this._updating=false;this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set};this._commands=new Map;this._config=o;this._nodes=n;this._decorators={};this._pendingDecorators=null;this._dirtyType=ie;this._cloneNotNeeded=new Set;this._dirtyLeaves=new Set;this._dirtyElements=new Map;this._normalizedNodes=new Set;this._updateTags=new Set;this._observer=null;this._key=Xt();this._onError=r;this._htmlConversions=s;this._editable=i;this._headless=t!==null&&t._headless;this._window=null;this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const t=this._listeners.update;t.add(e);return()=>{t.delete(e)}}registerEditableListener(e){const t=this._listeners.editable;t.add(e);return()=>{t.delete(e)}}registerDecoratorListener(e){const t=this._listeners.decorator;t.add(e);return()=>{t.delete(e)}}registerTextContentListener(e){const t=this._listeners.textcontent;t.add(e);return()=>{t.delete(e)}}registerRootListener(e){const t=this._listeners.root;e(this._rootElement,null);t.add(e);return()=>{e(null,this._rootElement);t.delete(e)}}registerCommand(e,t,n){if(n===undefined){{throw Error(`Listener for type "command" requires a "priority".`)}}const o=this._commands;if(!o.has(e)){o.set(e,[new Set,new Set,new Set,new Set,new Set])}const r=o.get(e);if(r===undefined){{throw Error(`registerCommand: Command ${String(e)} not found in command map`)}}const s=r[n];s.add(t);return()=>{s.delete(t);if(r.every((e=>e.size===0))){o.delete(e)}}}registerMutationListener(e,t,n){const o=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass;const r=this._listeners.mutation;r.set(t,o);const s=n&&n.skipInitialization;if(!(s===undefined?Cl:s)){this.initializeMutationListener(t,o)}return()=>{r.delete(t)}}getRegisteredNode(e){const t=this._nodes.get(e.getType());if(t===undefined){{throw Error(`Node ${e.name} has not been registered. Ensure node has been passed to createEditor.`)}}return t}resolveRegisteredNodeAfterReplacements(e){while(e.replaceWithKlass){e=this.getRegisteredNode(e.replaceWithKlass)}return e}initializeMutationListener(e,t){const n=this._editorState;const o=xo(n).get(t.getType());if(!o){return}const r=new Map;for(const e of o.keys()){r.set(e,"created")}if(r.size>0){e(r,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}}registerNodeTransformToKlass(e,t){const n=this.getRegisteredNode(e);n.transforms.add(t);return n}registerNodeTransform(e,t){const n=this.registerNodeTransformToKlass(e,t);const o=[n];const r=n.replaceWithKlass;if(r!=null){const e=this.registerNodeTransformToKlass(r,t);o.push(e)}Kt(this,e.getType());return()=>{o.forEach((e=>e.transforms.delete(t)))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return Yn(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const t=this._rootElement;if(e!==t){const n=Kn(this._config.theme,"root");const o=this._pendingEditorState||this._editorState;this._rootElement=e;bl(this,t,e,o);if(t!==null){if(!this._config.disableEvents){Qr(t)}if(n!=null){t.classList.remove(...n)}}if(e!==null){const t=eo(e);const o=e.style;o.userSelect="text";o.whiteSpace="pre-wrap";o.wordBreak="break-word";e.setAttribute("data-lexical-editor","true");this._window=t;this._dirtyType=ce;ot(this);this._updateTags.add("history-merge");Ji(this);if(!this._config.disableEvents){qr(e,this)}if(n!=null){e.classList.add(...n)}}else{this._editorState=o;this._pendingEditorState=null;this._window=null}Xi("root",this,false,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,t){if(e.isEmpty()){{throw Error(`setEditorState: the editor state is empty. Ensure the editor state's root node never becomes empty.`)}}nt(this);const n=this._pendingEditorState;const o=this._updateTags;const r=t!==undefined?t.tag:null;if(n!==null&&!n.isEmpty()){if(r!=null){o.add(r)}Ji(this)}this._pendingEditorState=e;this._dirtyType=ce;this._dirtyElements.set("root",false);this._compositionKey=null;if(r!=null){o.add(r)}Ji(this)}parseEditorState(e,t){const n=typeof e==="string"?JSON.parse(e):e;return Hi(n,this,t)}read(e){Ji(this);return this.getEditorState().read(e,{editor:this})}update(e,t){tl(this,e,t)}focus(e,t={}){const n=this._rootElement;if(n!==null){n.setAttribute("autocapitalize","off");tl(this,(()=>{const e=ui();const n=Bt();if(e!==null){e.dirty=true}else if(n.getChildrenSize()!==0){if(t.defaultSelection==="rootStart"){n.selectStart()}else{n.selectEnd()}}}),{onUpdate:()=>{n.removeAttribute("autocapitalize");if(e){e()}},tag:"focus"});if(this._pendingEditorState===null){n.removeAttribute("autocapitalize")}}}blur(){const e=this._rootElement;if(e!==null){e.blur()}const t=go(this._window);if(t!==null){t.removeAllRanges()}}isEditable(){return this._editable}setEditable(e){if(this._editable!==e){this._editable=e;Xi("editable",this,true,e)}}toJSON(){return{editorState:this._editorState.toJSON()}}}Al.version="0.17.1+dev.esm";var Dl=Object.freeze({$addUpdateTag:qn,$applyNodeReplacement:io,$cloneWithProperties:bo,$copyNode:so,$createLineBreakNode:cs,$createNodeSelection:ii,$createParagraphNode:Nl,$createPoint:$s,$createRangeSelection:si,$createRangeSelectionFromDom:ci,$createTabNode:Is,$createTextNode:Ds,$getAdjacentNode:Hn,$getCharacterOffsets:js,$getEditor:Eo,$getNearestNodeFromDOMNode:Pt,$getNearestRootOrShadowRoot:oo,$getNodeByKey:It,$getNodeByKeyOrThrow:co,$getPreviousSelection:fi,$getRoot:Bt,$getSelection:ui,$getTextContent:yi,$hasAncestor:Zn,$hasUpdateTag:Vn,$insertNodes:Ni,$isBlockElementNode:oi,$isDecoratorNode:il,$isElementNode:ol,$isInlineElementOrDecoratorNode:no,$isLeafNode:xt,$isLineBreakNode:as,$isNodeSelection:Ys,$isParagraphNode:yl,$isRangeSelection:Hs,$isRootNode:al,$isRootOrShadowRoot:ro,$isTabNode:Ls,$isTextNode:vs,$isTokenOrSegmented:Tt,$nodesOfType:Wn,$normalizeSelection__EXPERIMENTAL:lt,$parseSerializedNode:Wi,$selectAll:Fn,$setCompositionKey:Rt,$setSelection:zt,$splitNode:_o,ArtificialNode__DO_NOT_USE:_l,BLUR_COMMAND:Y,CAN_REDO_COMMAND:z,CAN_UNDO_COMMAND:H,CLEAR_EDITOR_COMMAND:B,CLEAR_HISTORY_COMMAND:W,CLICK_COMMAND:r,COMMAND_PRIORITY_CRITICAL:xl,COMMAND_PRIORITY_EDITOR:Tl,COMMAND_PRIORITY_HIGH:wl,COMMAND_PRIORITY_LOW:El,COMMAND_PRIORITY_NORMAL:Sl,CONTROLLED_TEXT_INSERTION_COMMAND:c,COPY_COMMAND:$,CUT_COMMAND:F,DELETE_CHARACTER_COMMAND:s,DELETE_LINE_COMMAND:d,DELETE_WORD_COMMAND:f,DRAGEND_COMMAND:P,DRAGOVER_COMMAND:L,DRAGSTART_COMMAND:I,DROP_COMMAND:R,DecoratorNode:sl,ElementNode:nl,FOCUS_COMMAND:U,FORMAT_ELEMENT_COMMAND:k,FORMAT_TEXT_COMMAND:h,INDENT_CONTENT_COMMAND:D,INSERT_LINE_BREAK_COMMAND:i,INSERT_PARAGRAPH_COMMAND:l,INSERT_TAB_COMMAND:A,IS_ALL_FORMATTING:Ce,IS_BOLD:de,IS_CODE:pe,IS_HIGHLIGHT:ye,IS_ITALIC:he,IS_STRIKETHROUGH:ge,IS_SUBSCRIPT:me,IS_SUPERSCRIPT:Ne,IS_UNDERLINE:_e,KEY_ARROW_DOWN_COMMAND:E,KEY_ARROW_LEFT_COMMAND:y,KEY_ARROW_RIGHT_COMMAND:m,KEY_ARROW_UP_COMMAND:T,KEY_BACKSPACE_COMMAND:x,KEY_DELETE_COMMAND:O,KEY_DOWN_COMMAND:p,KEY_ENTER_COMMAND:S,KEY_ESCAPE_COMMAND:b,KEY_MODIFIER_COMMAND:J,KEY_SPACE_COMMAND:w,KEY_TAB_COMMAND:M,LineBreakNode:is,MOVE_TO_END:N,MOVE_TO_START:C,OUTDENT_CONTENT_COMMAND:v,PASTE_COMMAND:a,ParagraphNode:pl,REDO_COMMAND:_,REMOVE_TEXT_COMMAND:u,RootNode:ll,SELECTION_CHANGE_COMMAND:n,SELECTION_INSERT_CLIPBOARD_NODES_COMMAND:o,SELECT_ALL_COMMAND:K,TEXT_TYPE_TO_FORMAT:Fe,TabNode:ks,TextNode:Cs,UNDO_COMMAND:g,createCommand:t,createEditor:Ml,getEditorPropertyFromDOMNode:yt,getNearestEditorFromDOMNode:Nt,isBlockDomNode:yo,isCurrentlyReadOnlyMode:Ai,isHTMLAnchorElement:po,isHTMLElement:mo,isInlineDomNode:No,isLexicalEditor:mt,isSelectionCapturedInDecoratorInput:_t,isSelectionWithinEditor:pt,resetRandomKey:ut});const vl="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Rl=vl&&"documentMode"in document?document.documentMode:null,kl=vl&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Il=vl&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),Ll=!(!vl||!("InputEvent"in window)||Rl)&&"getTargetRanges"in new window.InputEvent("input"),Pl=vl&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),$l=vl&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Fl=vl&&/Android/.test(navigator.userAgent),Kl=vl&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Bl=vl&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!Kl;function Wl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zl=Wl((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const Hl=Object.freeze({});const Ul=Dl;const Yl=Ul.$addUpdateTag;const Jl=Ul.$applyNodeReplacement;const jl=Ul.$cloneWithProperties;const Gl=Ul.$copyNode;const Xl=Ul.$createLineBreakNode;const Vl=Ul.$createNodeSelection;const ql=Ul.$createParagraphNode;const Ql=Ul.$createPoint;const Zl=Ul.$createRangeSelection;const ec=Ul.$createRangeSelectionFromDom;const tc=Ul.$createTabNode;const nc=Ul.$createTextNode;const oc=Ul.$getAdjacentNode;const rc=Ul.$getCharacterOffsets;const sc=Ul.$getEditor;const ic=Ul.$getNearestNodeFromDOMNode;const lc=Ul.$getNearestRootOrShadowRoot;const cc=Ul.$getNodeByKey;const ac=Ul.$getNodeByKeyOrThrow;const uc=Ul.$getPreviousSelection;const fc=Ul.$getRoot;const dc=Ul.$getSelection;const hc=Ul.$getTextContent;const gc=Ul.$hasAncestor;const _c=Ul.$hasUpdateTag;const pc=Ul.$insertNodes;const mc=Ul.$isBlockElementNode;const Nc=Ul.$isDecoratorNode;const yc=Ul.$isElementNode;const Cc=Ul.$isInlineElementOrDecoratorNode;const Tc=Ul.$isLeafNode;const Ec=Ul.$isLineBreakNode;const Sc=Ul.$isNodeSelection;const wc=Ul.$isParagraphNode;const xc=Ul.$isRangeSelection;const bc=Ul.$isRootNode;const Oc=Ul.$isRootOrShadowRoot;const Mc=Ul.$isTabNode;const Ac=Ul.$isTextNode;const Dc=Ul.$isTokenOrSegmented;const vc=Ul.$nodesOfType;const Rc=Ul.$normalizeSelection__EXPERIMENTAL;const kc=Ul.$parseSerializedNode;const Ic=Ul.$selectAll;const Lc=Ul.$setCompositionKey;const Pc=Ul.$setSelection;const $c=Ul.$splitNode;const Fc=Ul.ArtificialNode__DO_NOT_USE;const Kc=Ul.BLUR_COMMAND;const Bc=Ul.CAN_REDO_COMMAND;const Wc=Ul.CAN_UNDO_COMMAND;const zc=Ul.CLEAR_EDITOR_COMMAND;const Hc=Ul.CLEAR_HISTORY_COMMAND;const Uc=Ul.CLICK_COMMAND;const Yc=Ul.COMMAND_PRIORITY_CRITICAL;const Jc=Ul.COMMAND_PRIORITY_EDITOR;const jc=Ul.COMMAND_PRIORITY_HIGH;const Gc=Ul.COMMAND_PRIORITY_LOW;const Xc=Ul.COMMAND_PRIORITY_NORMAL;const Vc=Ul.CONTROLLED_TEXT_INSERTION_COMMAND;const qc=Ul.COPY_COMMAND;const Qc=Ul.CUT_COMMAND;const Zc=Ul.DELETE_CHARACTER_COMMAND;const ea=Ul.DELETE_LINE_COMMAND;const ta=Ul.DELETE_WORD_COMMAND;const na=Ul.DRAGEND_COMMAND;const oa=Ul.DRAGOVER_COMMAND;const ra=Ul.DRAGSTART_COMMAND;const sa=Ul.DROP_COMMAND;const ia=Ul.DecoratorNode;const la=Ul.ElementNode;const ca=Ul.FOCUS_COMMAND;const aa=Ul.FORMAT_ELEMENT_COMMAND;const ua=Ul.FORMAT_TEXT_COMMAND;const fa=Ul.INDENT_CONTENT_COMMAND;const da=Ul.INSERT_LINE_BREAK_COMMAND;const ha=Ul.INSERT_PARAGRAPH_COMMAND;const ga=Ul.INSERT_TAB_COMMAND;const _a=Ul.IS_ALL_FORMATTING;const pa=Ul.IS_BOLD;const ma=Ul.IS_CODE;const Na=Ul.IS_HIGHLIGHT;const ya=Ul.IS_ITALIC;const Ca=Ul.IS_STRIKETHROUGH;const Ta=Ul.IS_SUBSCRIPT;const Ea=Ul.IS_SUPERSCRIPT;const Sa=Ul.IS_UNDERLINE;const wa=Ul.KEY_ARROW_DOWN_COMMAND;const xa=Ul.KEY_ARROW_LEFT_COMMAND;const ba=Ul.KEY_ARROW_RIGHT_COMMAND;const Oa=Ul.KEY_ARROW_UP_COMMAND;const Ma=Ul.KEY_BACKSPACE_COMMAND;const Aa=Ul.KEY_DELETE_COMMAND;const Da=Ul.KEY_DOWN_COMMAND;const va=Ul.KEY_ENTER_COMMAND;const Ra=Ul.KEY_ESCAPE_COMMAND;const ka=Ul.KEY_MODIFIER_COMMAND;const Ia=Ul.KEY_SPACE_COMMAND;const La=Ul.KEY_TAB_COMMAND;const Pa=Ul.LineBreakNode;const $a=Ul.MOVE_TO_END;const Fa=Ul.MOVE_TO_START;const Ka=Ul.OUTDENT_CONTENT_COMMAND;const Ba=Ul.PASTE_COMMAND;const Wa=Ul.ParagraphNode;const za=Ul.REDO_COMMAND;const Ha=Ul.REMOVE_TEXT_COMMAND;const Ua=Ul.RootNode;const Ya=Ul.SELECTION_CHANGE_COMMAND;const Ja=Ul.SELECTION_INSERT_CLIPBOARD_NODES_COMMAND;const ja=Ul.SELECT_ALL_COMMAND;const Ga=Ul.TEXT_TYPE_TO_FORMAT;const Xa=Ul.TabNode;const Va=Ul.TextNode;const qa=Ul.UNDO_COMMAND;const Qa=Ul.createCommand;const Za=Ul.createEditor;const eu=Ul.getEditorPropertyFromDOMNode;const tu=Ul.getNearestEditorFromDOMNode;const nu=Ul.isBlockDomNode;const ou=Ul.isCurrentlyReadOnlyMode;const ru=Ul.isHTMLAnchorElement;const su=Ul.isHTMLElement;const iu=Ul.isInlineDomNode;const lu=Ul.isLexicalEditor;const cu=Ul.isSelectionCapturedInDecoratorInput;const au=Ul.isSelectionWithinEditor;const uu=Ul.resetRandomKey;var fu=Object.freeze({$addUpdateTag:Yl,$applyNodeReplacement:Jl,$cloneWithProperties:jl,$copyNode:Gl,$createLineBreakNode:Xl,$createNodeSelection:Vl,$createParagraphNode:ql,$createPoint:Ql,$createRangeSelection:Zl,$createRangeSelectionFromDom:ec,$createTabNode:tc,$createTextNode:nc,$getAdjacentNode:oc,$getCharacterOffsets:rc,$getEditor:sc,$getNearestNodeFromDOMNode:ic,$getNearestRootOrShadowRoot:lc,$getNodeByKey:cc,$getNodeByKeyOrThrow:ac,$getPreviousSelection:uc,$getRoot:fc,$getSelection:dc,$getTextContent:hc,$hasAncestor:gc,$hasUpdateTag:_c,$insertNodes:pc,$isBlockElementNode:mc,$isDecoratorNode:Nc,$isElementNode:yc,$isInlineElementOrDecoratorNode:Cc,$isLeafNode:Tc,$isLineBreakNode:Ec,$isNodeSelection:Sc,$isParagraphNode:wc,$isRangeSelection:xc,$isRootNode:bc,$isRootOrShadowRoot:Oc,$isTabNode:Mc,$isTextNode:Ac,$isTokenOrSegmented:Dc,$nodesOfType:vc,$normalizeSelection__EXPERIMENTAL:Rc,$parseSerializedNode:kc,$selectAll:Ic,$setCompositionKey:Lc,$setSelection:Pc,$splitNode:$c,ArtificialNode__DO_NOT_USE:Fc,BLUR_COMMAND:Kc,CAN_REDO_COMMAND:Bc,CAN_UNDO_COMMAND:Wc,CLEAR_EDITOR_COMMAND:zc,CLEAR_HISTORY_COMMAND:Hc,CLICK_COMMAND:Uc,COMMAND_PRIORITY_CRITICAL:Yc,COMMAND_PRIORITY_EDITOR:Jc,COMMAND_PRIORITY_HIGH:jc,COMMAND_PRIORITY_LOW:Gc,COMMAND_PRIORITY_NORMAL:Xc,CONTROLLED_TEXT_INSERTION_COMMAND:Vc,COPY_COMMAND:qc,CUT_COMMAND:Qc,DELETE_CHARACTER_COMMAND:Zc,DELETE_LINE_COMMAND:ea,DELETE_WORD_COMMAND:ta,DRAGEND_COMMAND:na,DRAGOVER_COMMAND:oa,DRAGSTART_COMMAND:ra,DROP_COMMAND:sa,DecoratorNode:ia,ElementNode:la,FOCUS_COMMAND:ca,FORMAT_ELEMENT_COMMAND:aa,FORMAT_TEXT_COMMAND:ua,INDENT_CONTENT_COMMAND:fa,INSERT_LINE_BREAK_COMMAND:da,INSERT_PARAGRAPH_COMMAND:ha,INSERT_TAB_COMMAND:ga,IS_ALL_FORMATTING:_a,IS_BOLD:pa,IS_CODE:ma,IS_HIGHLIGHT:Na,IS_ITALIC:ya,IS_STRIKETHROUGH:Ca,IS_SUBSCRIPT:Ta,IS_SUPERSCRIPT:Ea,IS_UNDERLINE:Sa,KEY_ARROW_DOWN_COMMAND:wa,KEY_ARROW_LEFT_COMMAND:xa,KEY_ARROW_RIGHT_COMMAND:ba,KEY_ARROW_UP_COMMAND:Oa,KEY_BACKSPACE_COMMAND:Ma,KEY_DELETE_COMMAND:Aa,KEY_DOWN_COMMAND:Da,KEY_ENTER_COMMAND:va,KEY_ESCAPE_COMMAND:Ra,KEY_MODIFIER_COMMAND:ka,KEY_SPACE_COMMAND:Ia,KEY_TAB_COMMAND:La,LineBreakNode:Pa,MOVE_TO_END:$a,MOVE_TO_START:Fa,OUTDENT_CONTENT_COMMAND:Ka,PASTE_COMMAND:Ba,ParagraphNode:Wa,REDO_COMMAND:za,REMOVE_TEXT_COMMAND:Ha,RootNode:Ua,SELECTION_CHANGE_COMMAND:Ya,SELECTION_INSERT_CLIPBOARD_NODES_COMMAND:Ja,SELECT_ALL_COMMAND:ja,TEXT_TYPE_TO_FORMAT:Ga,TabNode:Xa,TextNode:Va,UNDO_COMMAND:qa,createCommand:Qa,createEditor:Za,getEditorPropertyFromDOMNode:eu,getNearestEditorFromDOMNode:tu,isBlockDomNode:nu,isCurrentlyReadOnlyMode:ou,isHTMLAnchorElement:ru,isHTMLElement:su,isInlineDomNode:iu,isLexicalEditor:lu,isSelectionCapturedInDecoratorInput:cu,isSelectionWithinEditor:au,resetRandomKey:uu});const du=new Map;function hu(e){let t=e;while(t!=null){if(t.nodeType===Node.TEXT_NODE){return t}t=t.firstChild}return null}function gu(e){const t=e.parentNode;if(t==null){throw new Error("Should never happen")}return[t,Array.from(t.childNodes).indexOf(e)]}function _u(e,t,n,o,r){const s=t.getKey();const i=o.getKey();const l=document.createRange();let c=e.getElementByKey(s);let a=e.getElementByKey(i);let u=n;let f=r;if(Ac(t)){c=hu(c)}if(Ac(o)){a=hu(a)}if(t===undefined||o===undefined||c===null||a===null){return null}if(c.nodeName==="BR"){[c,u]=gu(c)}if(a.nodeName==="BR"){[a,f]=gu(a)}const d=c.firstChild;if(c===a&&d!=null&&d.nodeName==="BR"&&u===0&&f===0){f=1}try{l.setStart(c,u);l.setEnd(a,f)}catch(e){return null}if(l.collapsed&&(u!==f||s!==i)){l.setStart(a,f);l.setEnd(c,u)}return l}function pu(e,t){const n=e.getRootElement();if(n===null){return[]}const o=n.getBoundingClientRect();const r=getComputedStyle(n);const s=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight);const i=Array.from(t.getClientRects());let l=i.length;i.sort(((e,t)=>{const n=e.top-t.top;if(Math.abs(n)<=3){return e.left-t.left}return n}));let c;for(let e=0;e<l;e++){const t=i[e];const n=c&&c.top<=t.top&&c.top+c.height>t.top&&c.left+c.width>t.left;const r=t.width+s===o.width;if(n||r){i.splice(e--,1);l--;continue}c=t}return i}function mu(e){const t={};const n=e.split(";");for(const e of n){if(e!==""){const[n,o]=e.split(/:([^]+)/);if(n&&o){t[n.trim()]=o.trim()}}}return t}function Nu(e){let t=du.get(e);if(t===undefined){t=mu(e);du.set(e,t)}{Object.freeze(t)}return t}function yu(e){let t="";for(const n in e){if(n){t+=`${n}: ${e[n]};`}}return t}function Cu(e,t){const n=e.getStartEndPoints();if(t.isSelected(e)&&!t.isSegmented()&&!t.isToken()&&n!==null){const[o,r]=n;const s=e.isBackward();const i=o.getNode();const l=r.getNode();const c=t.is(i);const a=t.is(l);if(c||a){const[n,o]=rc(e);const r=i.is(l);const c=t.is(s?l:i);const a=t.is(s?i:l);let u=0;let f=undefined;if(r){u=n>o?o:n;f=n>o?n:o}else if(c){const e=s?o:n;u=e;f=undefined}else if(a){const e=s?n:o;u=0;f=e}t.__text=t.__text.slice(u,f);return t}}return t}function Tu(e){if(e.type==="text"){return e.offset===e.getNode().getTextContentSize()}const t=e.getNode();if(!yc(t)){throw Error(`isAtNodeEnd: node must be a TextNode or ElementNode`)}return e.offset===t.getChildrenSize()}function Eu(e,t,n){let o=t.getNode();let r=n;if(yc(o)){const e=o.getDescendantByIndex(t.offset);if(e!==null){o=e}}while(r>0&&o!==null){if(yc(o)){const e=o.getLastDescendant();if(e!==null){o=e}}let n=o.getPreviousSibling();let s=0;if(n===null){let e=o.getParentOrThrow();let t=e.getPreviousSibling();while(t===null){e=e.getParent();if(e===null){n=null;break}t=e.getPreviousSibling()}if(e!==null){s=e.isInline()?0:2;n=t}}let i=o.getTextContent();if(i===""&&yc(o)&&!o.isInline()){i="\n\n"}const l=i.length;if(!Ac(o)||r>=l){const e=o.getParent();o.remove();if(e!=null&&e.getChildrenSize()===0&&!bc(e)){e.remove()}r-=l+s;o=n}else{const n=o.getKey();const s=e.getEditorState().read((()=>{const e=cc(n);if(Ac(e)&&e.isSimpleText()){return e.getTextContent()}return null}));const c=l-r;const a=i.slice(0,c);if(s!==null&&s!==i){const e=uc();let t=o;if(!o.isSimpleText()){const e=nc(s);o.replace(e);t=e}else{o.setTextContent(s)}if(xc(e)&&e.isCollapsed()){const n=e.anchor.offset;t.select(n,n)}}else if(o.isSimpleText()){const e=t.key===n;let s=t.offset;if(s<r){s=l}const i=e?s-r:0;const a=e?s:c;if(e&&i===0){const[e]=o.splitText(i,a);e.remove()}else{const[,e]=o.splitText(i,a);e.remove()}}else{const e=nc(a);o.replace(e)}r=0}}}function Su(e){const t=e.getStyle();const n=mu(t);du.set(t,n)}function wu(e,t){const n=Nu("getStyle"in e?e.getStyle():e.style);const o=Object.entries(t).reduce(((t,[o,r])=>{if(typeof r==="function"){t[o]=r(n[o],e)}else if(r===null){delete t[o]}else{t[o]=r}return t}),{...n}||{});const r=yu(o);e.setStyle(r);du.set(r,o)}function xu(e,t){const n=e.getNodes();const o=n.length;const r=e.getStartEndPoints();if(r===null){return}const[s,i]=r;const l=o-1;let c=n[0];let a=n[l];if(e.isCollapsed()&&xc(e)){wu(e,t);return}const u=c.getTextContent();const f=u.length;const d=i.offset;let h=s.offset;const g=s.isBefore(i);let _=g?h:d;let p=g?d:h;const m=g?s.type:i.type;const N=g?i.type:s.type;const y=g?i.key:s.key;if(Ac(c)&&_===f){const e=c.getNextSibling();if(Ac(e)){h=0;_=0;c=e}}if(n.length===1){if(Ac(c)&&c.canHaveFormat()){_=m==="element"?0:h>d?d:h;p=N==="element"?f:h>d?h:d;if(_===p){return}if(Dc(c)||_===0&&p===f){wu(c,t);c.select(_,p)}else{const e=c.splitText(_,p);const n=_===0?e[0]:e[1];wu(n,t);n.select(0,p-_)}}}else{if(Ac(c)&&_<c.getTextContentSize()&&c.canHaveFormat()){if(_!==0&&!Dc(c)){c=c.splitText(_)[1];_=0;if(g){s.set(c.getKey(),_,"text")}else{i.set(c.getKey(),_,"text")}}wu(c,t)}if(Ac(a)&&a.canHaveFormat()){const e=a.getTextContent();const n=e.length;if(a.__key!==y&&p!==0){p=n}if(p!==n&&!Dc(a)){[a]=a.splitText(p)}if(p!==0||N==="element"){wu(a,t)}}for(let e=1;e<l;e++){const o=n[e];const r=o.getKey();if(Ac(o)&&o.canHaveFormat()&&r!==c.getKey()&&r!==a.getKey()&&!o.isToken()){wu(o,t)}}}}function bu(e,t){if(e===null){return}const n=e.getStartEndPoints();const o=n?n[0]:null;if(o!==null&&o.key==="root"){const e=t();const n=fc();const o=n.getFirstChild();if(o){o.replace(e,true)}else{n.append(e)}return}const r=e.getNodes();const s=o!==null?Ku(o.getNode(),Fu):false;if(s&&r.indexOf(s)===-1){r.push(s)}for(let e=0;e<r.length;e++){const n=r[e];if(!Fu(n)){continue}if(!yc(n)){throw Error(`Expected block node to be an ElementNode`)}const o=t();o.setFormat(n.getFormatType());o.setIndent(n.getIndent());n.replace(o,true)}}function Ou(e){return e.getNode().isAttached()}function Mu(e){let t=e;while(t!==null&&!Oc(t)){const e=t.getLatest();const n=t.getParent();if(e.getChildrenSize()===0){t.remove(true)}t=n}}function Au(e,t,n=null){const o=e.getStartEndPoints();const r=o?o[0]:null;const s=e.getNodes();const i=s.length;if(r!==null&&(i===0||i===1&&r.type==="element"&&r.getNode().getChildrenSize()===0)){const e=r.type==="text"?r.getNode().getParentOrThrow():r.getNode();const o=e.getChildren();let s=t();s.setFormat(e.getFormatType());s.setIndent(e.getIndent());o.forEach((e=>s.append(e)));if(n){s=n.append(s)}e.replace(s);return}let l=null;let c=[];for(let o=0;o<i;o++){const r=s[o];if(Oc(r)){Du(e,c,c.length,t,n);c=[];l=r}else if(l===null||l!==null&&gc(r,l)){c.push(r)}else{Du(e,c,c.length,t,n);c=[r]}}Du(e,c,c.length,t,n)}function Du(e,t,n,o,r=null){if(t.length===0){return}const s=t[0];const i=new Map;const l=[];let c=yc(s)?s:s.getParentOrThrow();if(c.isInline()){c=c.getParentOrThrow()}let a=false;while(c!==null){const e=c.getPreviousSibling();if(e!==null){c=e;a=true;break}c=c.getParentOrThrow();if(Oc(c)){break}}const u=new Set;for(let e=0;e<n;e++){const n=t[e];if(yc(n)&&n.getChildrenSize()===0){u.add(n.getKey())}}const f=new Set;for(let e=0;e<n;e++){const n=t[e];let r=n.getParent();if(r!==null&&r.isInline()){r=r.getParent()}if(r!==null&&Tc(n)&&!f.has(n.getKey())){const e=r.getKey();if(i.get(e)===undefined){const t=o();t.setFormat(r.getFormatType());t.setIndent(r.getIndent());l.push(t);i.set(e,t);r.getChildren().forEach((e=>{t.append(e);f.add(e.getKey());if(yc(e)){e.getChildrenKeys().forEach((e=>f.add(e)))}}));Mu(r)}}else if(u.has(n.getKey())){if(!yc(n)){throw Error(`Expected node in emptyElements to be an ElementNode`)}const e=o();e.setFormat(n.getFormatType());e.setIndent(n.getIndent());l.push(e);n.remove(true)}}if(r!==null){for(let e=0;e<l.length;e++){const t=l[e];r.append(t)}}let d=null;if(Oc(c)){if(a){if(r!==null){c.insertAfter(r)}else{for(let e=l.length-1;e>=0;e--){const t=l[e];c.insertAfter(t)}}}else{const e=c.getFirstChild();if(yc(e)){c=e}if(e===null){if(r){c.append(r)}else{for(let e=0;e<l.length;e++){const t=l[e];c.append(t);d=t}}}else{if(r!==null){e.insertBefore(r)}else{for(let t=0;t<l.length;t++){const n=l[t];e.insertBefore(n);d=n}}}}}else{if(r){c.insertAfter(r)}else{for(let e=l.length-1;e>=0;e--){const t=l[e];c.insertAfter(t);d=t}}}const h=uc();if(xc(h)&&Ou(h.anchor)&&Ou(h.focus)){Pc(h.clone())}else if(d!==null){d.selectEnd()}else{e.dirty=true}}function vu(e,t){const n=oc(e.focus,t);return Nc(n)&&!n.isIsolated()||yc(n)&&!n.isInline()&&!n.canBeEmpty()}function Ru(e,t,n,o){e.modify(t?"extend":"move",n,o)}function ku(e){const t=e.anchor.getNode();const n=bc(t)?t:t.getParentOrThrow();return n.getDirection()==="rtl"}function Iu(e,t,n){const o=ku(e);Ru(e,t,n?!o:o,"character")}function Lu(e){const t=e.anchor;const n=e.focus;const o=t.getNode();const r=o.getTopLevelElementOrThrow();const s=r.getParentOrThrow();let i=s.getFirstDescendant();let l=s.getLastDescendant();let c="element";let a="element";let u=0;if(Ac(i)){c="text"}else if(!yc(i)&&i!==null){i=i.getParentOrThrow()}if(Ac(l)){a="text";u=l.getTextContentSize()}else if(!yc(l)&&l!==null){l=l.getParentOrThrow()}if(i&&l){t.set(i.getKey(),0,c);n.set(l.getKey(),u,a)}}function Pu(e,t,n){const o=e.getStyle();const r=Nu(o);if(r!==null){return r[t]||n}return n}function $u(e,t,n=""){let o=null;const r=e.getNodes();const s=e.anchor;const i=e.focus;const l=e.isBackward();const c=l?i.offset:s.offset;const a=l?i.getNode():s.getNode();if(xc(e)&&e.isCollapsed()&&e.style!==""){const n=e.style;const o=Nu(n);if(o!==null&&t in o){return o[t]}}for(let e=0;e<r.length;e++){const s=r[e];if(e!==0&&c===0&&s.is(a)){continue}if(Ac(s)){const e=Pu(s,t,n);if(o===null){o=e}else if(o!==e){o="";break}}}return o===null?n:o}function Fu(e){if(Nc(e)){return false}if(!yc(e)||Oc(e)){return false}const t=e.getFirstChild();const n=t===null||Ec(t)||Ac(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==false&&n}function Ku(e,t){let n=e;while(n!==null&&n.getParent()!==null&&!t(n)){n=n.getParentOrThrow()}return t(n)?n:null}const Bu=Eu;var Wu=Object.freeze({$addNodeStyle:Su,$getSelectionStyleValueForProperty:$u,$isAtNodeEnd:Tu,$isParentElementRTL:ku,$moveCaretSelection:Ru,$moveCharacter:Iu,$patchStyleText:xu,$selectAll:Lu,$setBlocksType:bu,$shouldOverrideDefaultCharacterSelection:vu,$sliceSelectedTextNodeContent:Cu,$trimTextContentFromAnchor:Eu,$wrapNodes:Au,createDOMRange:_u,createRectsFromDOMRange:pu,getStyleObjectFromCSS:Nu,trimTextContentFromAnchor:Bu,$cloneWithProperties:jl});function zu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Hu=zu((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const Uu=Wu;const Yu=Uu.$addNodeStyle;const Ju=Uu.$cloneWithProperties;const ju=Uu.$getSelectionStyleValueForProperty;const Gu=Uu.$isAtNodeEnd;const Xu=Uu.$isParentElementRTL;const Vu=Uu.$moveCaretSelection;const qu=Uu.$moveCharacter;const Qu=Uu.$patchStyleText;const Zu=Uu.$selectAll;const ef=Uu.$setBlocksType;const tf=Uu.$shouldOverrideDefaultCharacterSelection;const nf=Uu.$sliceSelectedTextNodeContent;const of=Uu.$trimTextContentFromAnchor;const rf=Uu.$wrapNodes;const sf=Uu.createDOMRange;const lf=Uu.createRectsFromDOMRange;const cf=Uu.getStyleObjectFromCSS;const af=Uu.trimTextContentFromAnchor;var uf=Object.freeze({$addNodeStyle:Yu,$cloneWithProperties:Ju,$getSelectionStyleValueForProperty:ju,$isAtNodeEnd:Gu,$isParentElementRTL:Xu,$moveCaretSelection:Vu,$moveCharacter:qu,$patchStyleText:Qu,$selectAll:Zu,$setBlocksType:ef,$shouldOverrideDefaultCharacterSelection:tf,$sliceSelectedTextNodeContent:nf,$trimTextContentFromAnchor:of,$wrapNodes:rf,createDOMRange:sf,createRectsFromDOMRange:lf,getStyleObjectFromCSS:cf,trimTextContentFromAnchor:af});const ff=typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof window.document.createElement!=="undefined";const df=ff&&"documentMode"in document?document.documentMode:null;const hf=ff&&/Mac|iPod|iPhone|iPad/.test(navigator.platform);const gf=ff&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);const _f=ff&&"InputEvent"in window&&!df?"getTargetRanges"in new window.InputEvent("input"):false;const pf=ff&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent);const mf=ff&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;const Nf=ff&&/Android/.test(navigator.userAgent);const yf=ff&&/^(?=.*Chrome).*/i.test(navigator.userAgent);const Cf=ff&&Nf&&yf;const Tf=ff&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!yf;function Ef(...e){const t=[];for(const n of e){if(n&&typeof n==="string"){for(const[e]of n.matchAll(/\S+/g)){t.push(e)}}}return t}function Sf(...e){return()=>{for(let t=e.length-1;t>=0;t--){e[t]()}e.length=0}}function wf(e){return`${e}px`}const xf={attributes:true,characterData:true,childList:true,subtree:true};function bf(e,t,n){let o=null;let r=null;let s=null;let i=[];const l=document.createElement("div");function c(){if(!(o!==null)){throw Error(`Unexpected null rootDOMNode`)}if(!(r!==null)){throw Error(`Unexpected null parentDOMNode`)}const{left:s,top:c}=o.getBoundingClientRect();const a=r;const u=lf(e,t);if(!l.isConnected){a.append(l)}let f=false;for(let e=0;e<u.length;e++){const t=u[e];const n=i[e]||document.createElement("div");const o=n.style;if(o.position!=="absolute"){o.position="absolute";f=true}const r=wf(t.left-s);if(o.left!==r){o.left=r;f=true}const a=wf(t.top-c);if(o.top!==a){n.style.top=a;f=true}const d=wf(t.width);if(o.width!==d){n.style.width=d;f=true}const h=wf(t.height);if(o.height!==h){n.style.height=h;f=true}if(n.parentNode!==l){l.append(n);f=true}i[e]=n}while(i.length>u.length){i.pop()}if(f){n(i)}}function a(){r=null;o=null;if(s!==null){s.disconnect()}s=null;l.remove();for(const e of i){e.remove()}i=[]}function u(){const t=e.getRootElement();if(t===null){return a()}const n=t.parentElement;if(!(n instanceof HTMLElement)){return a()}a();o=t;r=n;s=new MutationObserver((t=>{const n=e.getRootElement();const s=n&&n.parentElement;if(n!==o||s!==r){return u()}for(const e of t){if(!l.contains(e.target)){return c()}}}));s.observe(n,xf);c()}const f=e.registerRootListener(u);return()=>{f();a()}}function Of(e,t){let n=null;let o=null;let r=null;let s=null;let i=()=>{};function l(l){l.read((()=>{const l=dc();if(!xc(l)){n=null;o=null;r=null;s=null;i();i=()=>{};return}const{anchor:c,focus:a}=l;const u=c.getNode();const f=u.getKey();const d=c.offset;const h=a.getNode();const g=h.getKey();const _=a.offset;const p=e.getElementByKey(f);const m=e.getElementByKey(g);const N=n===null||p===null||d!==o||f!==n.getKey()||u!==n&&(!(n instanceof Va)||u.updateDOM(n,p,e._config));const y=r===null||m===null||_!==s||g!==r.getKey()||h!==r&&(!(r instanceof Va)||h.updateDOM(r,m,e._config));if(N||y){const n=e.getElementByKey(c.getNode().getKey());const o=e.getElementByKey(a.getNode().getKey());if(n!==null&&o!==null&&n.tagName==="SPAN"&&o.tagName==="SPAN"){const r=document.createRange();let s;let l;let u;let f;if(a.isBefore(c)){s=o;l=a.offset;u=n;f=c.offset}else{s=n;l=c.offset;u=o;f=a.offset}const d=s.firstChild;if(!(d!==null)){throw Error(`Expected text node to be first child of span`)}const h=u.firstChild;if(!(h!==null)){throw Error(`Expected text node to be first child of span`)}r.setStart(d,l);r.setEnd(h,f);i();i=bf(e,r,(e=>{for(const t of e){const e=t.style;if(e.background!=="Highlight"){e.background="Highlight"}if(e.color!=="HighlightText"){e.color="HighlightText"}if(e.zIndex!=="-1"){e.zIndex="-1"}if(e.pointerEvents!=="none"){e.pointerEvents="none"}if(e.marginTop!==wf(-1.5)){e.marginTop=wf(-1.5)}if(e.paddingTop!==wf(4)){e.paddingTop=wf(4)}if(e.paddingBottom!==wf(0)){e.paddingBottom=wf(0)}}if(t!==undefined){t(e)}}))}}n=u;o=d;r=h;s=_}))}l(e.getEditorState());return Sf(e.registerUpdateListener((({editorState:e})=>l(e))),i,(()=>{i()}))}const Mf=_f;const Af=ff;const Df=Nf;const vf=Cf;const Rf=hf;const kf=Tf;const If=yf;const Lf=gf;const Pf=mf;const $f=pf;function Ff(e,...t){const n=Ef(...t);if(n.length>0){e.classList.add(...n)}}function Kf(e,...t){const n=Ef(...t);if(n.length>0){e.classList.remove(...n)}}function Bf(e,t){for(const n of t){if(e.type.startsWith(n)){return true}}return false}function Wf(e,t){const n=e[Symbol.iterator]();return new Promise(((e,o)=>{const r=[];const s=()=>{const{done:i,value:l}=n.next();if(i){return e(r)}const c=new FileReader;c.addEventListener("error",o);c.addEventListener("load",(()=>{const e=c.result;if(typeof e==="string"){r.push({file:l,result:e})}s()}));if(Bf(l,t)){c.readAsDataURL(l)}else{s()}};s()}))}function zf(e,t){const n=[];const o=(e||fc()).getLatest();const r=t||(yc(o)?o.getLastDescendant()||o:o);let s=o;let i=Hf(s);while(s!==null&&!s.is(r)){n.push({depth:i,node:s});if(yc(s)&&s.getChildrenSize()>0){s=s.getFirstChild();i++}else{let e=null;while(e===null&&s!==null){e=s.getNextSibling();if(e===null){s=s.getParent();i--}else{s=e}}}}if(s!==null&&s.is(r)){n.push({depth:i,node:s})}return n}function Hf(e){let t=e;let n=0;while((t=t.getParent())!==null){n++}return n}function Uf(e){let t=e;if(yc(t)&&t.getChildrenSize()>0){t=t.getLastChild()}else{let e=null;while(e===null&&t!==null){e=t.getPreviousSibling();if(e===null){t=t.getParent()}else{t=e}}}return t}function Yf(e,t){let n=e;while(n!=null){if(n instanceof t){return n}n=n.getParent()}return null}function Jf(e){const t=jf(e,(e=>yc(e)&&!e.isInline()));if(!yc(t)){{throw Error(`Expected node ${e.__key} to have closest block element node.`)}}return t}const jf=(e,t)=>{let n=e;while(n!==fc()&&n!=null){if(t(n)){return n}n=n.getParent()}return null};function Gf(e,t,n,o){const r=e=>e instanceof t;const s=e=>{const t=e.getChildren();for(let e=0;e<t.length;e++){const n=t[e];if(r(n)){return null}}let n=e;let o=e;while(n!==null){o=n;n=n.getParent();if(r(n)){return{child:o,parent:n}}}return null};const i=e=>{const t=s(e);if(t!==null){const{child:r,parent:s}=t;if(r.is(e)){o(s,e);const t=r.getNextSiblings();const i=t.length;s.insertAfter(r);if(i!==0){const e=n(s);r.insertAfter(e);for(let n=0;n<i;n++){e.append(t[n])}}if(!s.canBeEmpty()&&s.getChildrenSize()===0){s.remove()}}}};return e.registerNodeTransform(t,i)}function Xf(e,t){const n=2;const o=new Map;const r=e._pendingEditorState;for(const[e,n]of t._nodeMap){o.set(e,jl(n))}if(r){r._nodeMap=o}e._dirtyType=n;const s=t._selection;Pc(s===null?null:s.clone())}function Vf(e){const t=dc()||uc();if(xc(t)){const{focus:n}=t;const o=n.getNode();const r=n.offset;if(Oc(o)){const t=o.getChildAtIndex(r);if(t==null){o.append(e)}else{t.insertBefore(e)}e.selectNext()}else{let t;let n;if(Ac(o)){t=o.getParentOrThrow();n=o.getIndexWithinParent();if(r>0){n+=1;o.splitText(r)}}else{t=o;n=r}const[,s]=$c(t,n);s.insertBefore(e);s.selectStart()}}else{if(t!=null){const n=t.getNodes();n[n.length-1].getTopLevelElementOrThrow().insertAfter(e)}else{const t=fc();t.append(e)}const n=ql();e.insertAfter(n);n.select()}return e.getLatest()}function qf(e,t){const n=t();e.replace(n);n.append(e);return n}function Qf(e,t){return e!==null?Object.getPrototypeOf(e).constructor.name===t.name:false}function Zf(e,t){const n=[];for(let o=0;o<e.length;o++){const r=t(e[o]);if(r!==null){n.push(r)}}return n}function ed(e,t){const n=e.getFirstChild();if(n!==null){n.insertBefore(t)}else{e.append(t)}}function td(e){if(Lf){return 1}let t=1;while(e){t*=Number(window.getComputedStyle(e).getPropertyValue("zoom"));e=e.parentElement}return t}function nd(e){return e._parentEditor!==null}var od=Object.freeze({$dfs:zf,$filter:Zf,$findMatchingParent:jf,$getNearestBlockElementAncestorOrThrow:Jf,$getNearestNodeOfType:Yf,$getNextRightPreorderNode:Uf,$insertFirst:ed,$insertNodeToNearestRoot:Vf,$isEditorIsNestedEditor:nd,$restoreEditorState:Xf,$wrapNodeInElement:qf,CAN_USE_BEFORE_INPUT:Mf,CAN_USE_DOM:Af,IS_ANDROID:Df,IS_ANDROID_CHROME:vf,IS_APPLE:Rf,IS_APPLE_WEBKIT:kf,IS_CHROME:If,IS_FIREFOX:Lf,IS_IOS:Pf,IS_SAFARI:$f,addClassNamesToElement:Ff,calculateZoomLevel:td,isMimeType:Bf,markSelection:Of,mediaFileReader:Wf,mergeRegister:Sf,objectKlassEquals:Qf,positionNodeOnRange:bf,registerNestedElementResolver:Gf,removeClassNamesFromElement:Kf,$splitNode:$c,isBlockDomNode:nu,isHTMLAnchorElement:ru,isHTMLElement:su,isInlineDomNode:iu});function rd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sd=rd((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const id="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,ld=id&&"documentMode"in document?document.documentMode:null,cd=id&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),ad=id&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),ud=!(!id||!("InputEvent"in window)||ld)&&"getTargetRanges"in new window.InputEvent("input"),fd=id&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),dd=id&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,hd=id&&/Android/.test(navigator.userAgent),gd=id&&/^(?=.*Chrome).*/i.test(navigator.userAgent),_d=id&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!gd;const pd=od;const md=pd.$dfs;const Nd=pd.$filter;const yd=pd.$findMatchingParent;const Cd=pd.$getNearestBlockElementAncestorOrThrow;const Td=pd.$getNearestNodeOfType;const Ed=pd.$getNextRightPreorderNode;const Sd=pd.$insertFirst;const wd=pd.$insertNodeToNearestRoot;const xd=pd.$isEditorIsNestedEditor;const bd=pd.$restoreEditorState;const Od=pd.$splitNode;const Md=pd.$wrapNodeInElement;const Ad=pd.CAN_USE_BEFORE_INPUT;const Dd=pd.CAN_USE_DOM;const vd=pd.IS_ANDROID;const Rd=pd.IS_ANDROID_CHROME;const kd=pd.IS_APPLE;const Id=pd.IS_APPLE_WEBKIT;const Ld=pd.IS_CHROME;const Pd=pd.IS_FIREFOX;const $d=pd.IS_IOS;const Fd=pd.IS_SAFARI;const Kd=pd.addClassNamesToElement;const Bd=pd.calculateZoomLevel;const Wd=pd.isBlockDomNode;const zd=pd.isHTMLAnchorElement;const Hd=pd.isHTMLElement;const Ud=pd.isInlineDomNode;const Yd=pd.isMimeType;const Jd=pd.markSelection;const jd=pd.mediaFileReader;const Gd=pd.mergeRegister;const Xd=pd.objectKlassEquals;const Vd=pd.positionNodeOnRange;const qd=pd.registerNestedElementResolver;const Qd=pd.removeClassNamesFromElement;var Zd=Object.freeze({$dfs:md,$filter:Nd,$findMatchingParent:yd,$getNearestBlockElementAncestorOrThrow:Cd,$getNearestNodeOfType:Td,$getNextRightPreorderNode:Ed,$insertFirst:Sd,$insertNodeToNearestRoot:wd,$isEditorIsNestedEditor:xd,$restoreEditorState:bd,$splitNode:Od,$wrapNodeInElement:Md,CAN_USE_BEFORE_INPUT:Ad,CAN_USE_DOM:Dd,IS_ANDROID:vd,IS_ANDROID_CHROME:Rd,IS_APPLE:kd,IS_APPLE_WEBKIT:Id,IS_CHROME:Ld,IS_FIREFOX:Pd,IS_IOS:$d,IS_SAFARI:Fd,addClassNamesToElement:Kd,calculateZoomLevel:Bd,isBlockDomNode:Wd,isHTMLAnchorElement:zd,isHTMLElement:Hd,isInlineDomNode:Ud,isMimeType:Yd,markSelection:Jd,mediaFileReader:jd,mergeRegister:Gd,objectKlassEquals:Xd,positionNodeOnRange:Vd,registerNestedElementResolver:qd,removeClassNamesFromElement:Qd});function eh(e,t){const n=t.body?t.body.childNodes:[];let o=[];const r=[];for(let t=0;t<n.length;t++){const s=n[t];if(!rh.has(s.nodeName)){const t=sh(s,e,r,false);if(t!==null){o=o.concat(t)}}}lh(r);return o}function th(e,t){if(typeof document==="undefined"||typeof window==="undefined"&&typeof global.window==="undefined"){throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.")}const n=document.createElement("div");const o=fc();const r=o.getChildren();for(let o=0;o<r.length;o++){const s=r[o];nh(e,s,n,t)}return n.innerHTML}function nh(e,t,n,o=null){let r=o!==null?t.isSelected(o):true;const s=yc(t)&&t.excludeFromCopy("html");let i=t;if(o!==null){let e=jl(t);e=Ac(e)&&o!==null?nf(o,e):e;i=e}const l=yc(i)?i.getChildren():[];const c=e._nodes.get(i.getType());let a;if(c&&c.exportDOM!==undefined){a=c.exportDOM(e,i)}else{a=i.exportDOM(e)}const{element:u,after:f}=a;if(!u){return false}const d=document.createDocumentFragment();for(let n=0;n<l.length;n++){const s=l[n];const i=nh(e,s,d,o);if(!r&&yc(t)&&i&&t.extractWithChild(s,o,"html")){r=true}}if(r&&!s){if(Hd(u)){u.append(d)}n.append(u);if(f){const e=f.call(i,u);if(e){u.replaceWith(e)}}}else{n.append(d)}return r}function oh(e,t){const{nodeName:n}=e;const o=t._htmlConversions.get(n.toLowerCase());let r=null;if(o!==undefined){for(const t of o){const n=t(e);if(n!==null&&(r===null||(r.priority||0)<(n.priority||0))){r=n}}}return r!==null?r.conversion:null}const rh=new Set(["STYLE","SCRIPT"]);function sh(e,t,n,o,r=new Map,s){let i=[];if(rh.has(e.nodeName)){return i}let l=null;const c=oh(e,t);const a=c?c(e):null;let u=null;if(a!==null){u=a.after;const t=a.node;l=Array.isArray(t)?t[t.length-1]:t;if(l!==null){for(const[,e]of r){l=e(l,s);if(!l){break}}if(l){i.push(...Array.isArray(t)?t:[l])}}if(a.forChild!=null){r.set(e.nodeName,a.forChild)}}const f=e.childNodes;let d=[];const h=l!=null&&Oc(l)?false:l!=null&&mc(l)||o;for(let e=0;e<f.length;e++){d.push(...sh(f[e],t,n,h,new Map(r),l))}if(u!=null){d=u(d)}if(Wd(e)){if(!h){d=ih(e,d,ql)}else{d=ih(e,d,(()=>{const e=new Fc;n.push(e);return e}))}}if(l==null){if(d.length>0){i=i.concat(d)}else{if(Wd(e)&&ch(e)){i=i.concat(Xl())}}}else{if(yc(l)){l.append(...d)}}return i}function ih(e,t,n){const o=e.style.textAlign;const r=[];let s=[];for(let e=0;e<t.length;e++){const i=t[e];if(mc(i)){if(o&&!i.getFormat()){i.setFormat(o)}r.push(i)}else{s.push(i);if(e===t.length-1||e<t.length-1&&mc(t[e+1])){const e=n();e.setFormat(o);e.append(...s);r.push(e);s=[]}}}return r}function lh(e){for(const t of e){if(t.getNextSibling()instanceof Fc){t.insertAfter(Xl())}}for(const t of e){const e=t.getChildren();for(const n of e){t.insertBefore(n)}t.remove()}}function ch(e){if(e.nextSibling==null||e.previousSibling==null){return false}return iu(e.nextSibling)&&iu(e.previousSibling)}var ah=Object.freeze({$generateHtmlFromNodes:th,$generateNodesFromDOM:eh});const uh=ah;const fh=uh.$generateHtmlFromNodes;const dh=uh.$generateNodesFromDOM;var hh=Object.freeze({$generateHtmlFromNodes:fh,$generateNodesFromDOM:dh});function gh(e){let t=1;let n=e.getParent();while(n!=null){if(Fh(n)){const e=n.getParent();if(Jh(e)){t++;n=e.getParent();continue}{throw Error(`A ListItemNode must have a ListNode for a parent.`)}}return t}return t}function _h(e){let t=e.getParent();if(!Jh(t)){{throw Error(`A ListItemNode must have a ListNode for a parent.`)}}let n=t;while(n!==null){n=n.getParent();if(Jh(n)){t=n}}return t}function ph(e){let t=[];const n=e.getChildren().filter(Fh);for(let e=0;e<n.length;e++){const o=n[e];const r=o.getFirstChild();if(Jh(r)){t=t.concat(ph(r))}else{t.push(o)}}return t}function mh(e){return Fh(e)&&Jh(e.getFirstChild())}function Nh(e){let t=e;while(t.getNextSibling()==null&&t.getPreviousSibling()==null){const e=t.getParent();if(e==null||!(Fh(t)||Jh(t))){break}t=e}t.remove()}function yh(e){const t=$h();return t.append(e)}function Ch(e,t){return Fh(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function Th(e,t){e.update((()=>{const e=dc();if(e!==null){const n=e.getNodes();if(xc(e)){const o=e.getStartEndPoints();if(!(o!==null)){throw Error(`insertList: anchor should be defined`)}const[r]=o;const s=r.getNode();const i=s.getParent();if(Ch(s,n)){const e=Yh(t);if(Oc(i)){s.replace(e);const t=$h();if(yc(s)){t.setFormat(s.getFormatType());t.setIndent(s.getIndent())}e.append(t)}else if(Fh(s)){const t=s.getParentOrThrow();Eh(e,t.getChildren());t.replace(e)}return}}const o=new Set;for(let e=0;e<n.length;e++){const r=n[e];if(yc(r)&&r.isEmpty()&&!Fh(r)&&!o.has(r.getKey())){Sh(r,t);continue}if(Tc(r)){let e=r.getParent();while(e!=null){const n=e.getKey();if(Jh(e)){if(!o.has(n)){const r=Yh(t);Eh(r,e.getChildren());e.replace(r);o.add(n)}break}else{const r=e.getParent();if(Oc(r)&&!o.has(n)){o.add(n);Sh(e,t);break}e=r}}}}}}))}function Eh(e,t){e.splice(e.getChildrenSize(),0,t)}function Sh(e,t){if(Jh(e)){return e}const n=e.getPreviousSibling();const o=e.getNextSibling();const r=$h();r.setFormat(e.getFormatType());r.setIndent(e.getIndent());Eh(r,e.getChildren());if(Jh(n)&&t===n.getListType()){n.append(r);e.remove();if(Jh(o)&&t===o.getListType()){Eh(n,o.getChildren());o.remove()}return n}else if(Jh(o)&&t===o.getListType()){o.getFirstChildOrThrow().insertBefore(r);e.remove();return o}else{const n=Yh(t);n.append(r);e.replace(n);return n}}function wh(e,t){const n=e.getLastChild();const o=t.getFirstChild();if(n&&o&&mh(n)&&mh(o)){wh(n.getFirstChild(),o.getFirstChild());o.remove()}const r=t.getChildren();if(r.length>0){e.append(...r)}t.remove()}function xh(e){e.update((()=>{const e=dc();if(xc(e)){const t=new Set;const n=e.getNodes();const o=e.anchor.getNode();if(Ch(o,n)){t.add(_h(o))}else{for(let e=0;e<n.length;e++){const o=n[e];if(Tc(o)){const e=Td(o,Rh);if(e!=null){t.add(_h(e))}}}}for(const n of t){let t=n;const o=ph(n);for(const n of o){const o=ql();Eh(o,n.getChildren());t.insertAfter(o);t=o;if(n.__key===e.anchor.key){e.anchor.set(o.getKey(),0,"element")}if(n.__key===e.focus.key){e.focus.set(o.getKey(),0,"element")}n.remove()}n.remove()}}}))}function bh(e){const t=e.getListType()!=="check";let n=e.getStart();for(const o of e.getChildren()){if(Fh(o)){if(o.getValue()!==n){o.setValue(n)}if(t&&o.getLatest().__checked!=null){o.setChecked(undefined)}if(!Jh(o.getFirstChild())){n++}}}}function Oh(e){const t=e.getNextSibling();if(Jh(t)&&e.getListType()===t.getListType()){wh(e,t)}}function Mh(e){const t=new Set;if(mh(e)||t.has(e.getKey())){return}const n=e.getParent();const o=e.getNextSibling();const r=e.getPreviousSibling();if(mh(o)&&mh(r)){const n=r.getFirstChild();if(Jh(n)){n.append(e);const r=o.getFirstChild();if(Jh(r)){const e=r.getChildren();Eh(n,e);o.remove();t.add(o.getKey())}}}else if(mh(o)){const t=o.getFirstChild();if(Jh(t)){const n=t.getFirstChild();if(n!==null){n.insertBefore(e)}}}else if(mh(r)){const t=r.getFirstChild();if(Jh(t)){t.append(e)}}else{if(Jh(n)){const t=$h();const s=Yh(n.getListType());t.append(s);s.append(e);if(r){r.insertAfter(t)}else if(o){o.insertBefore(t)}else{n.append(t)}}}}function Ah(e){if(mh(e)){return}const t=e.getParent();const n=t?t.getParent():undefined;const o=n?n.getParent():undefined;if(Jh(o)&&Fh(n)&&Jh(t)){const o=t?t.getFirstChild():undefined;const r=t?t.getLastChild():undefined;if(e.is(o)){n.insertBefore(e);if(t.isEmpty()){n.remove()}}else if(e.is(r)){n.insertAfter(e);if(t.isEmpty()){n.remove()}}else{const o=t.getListType();const r=$h();const s=Yh(o);r.append(s);e.getPreviousSiblings().forEach((e=>s.append(e)));const i=$h();const l=Yh(o);i.append(l);Eh(l,e.getNextSiblings());n.insertBefore(r);n.insertAfter(i);n.replace(e)}}}function Dh(){const e=dc();if(!xc(e)||!e.isCollapsed()){return false}const t=e.anchor.getNode();if(!Fh(t)||t.getChildrenSize()!==0){return false}const n=_h(t);const o=t.getParent();if(!Jh(o)){throw Error(`A ListItemNode must have a ListNode for a parent.`)}const r=o.getParent();let s;if(Oc(r)){s=ql();n.insertAfter(s)}else if(Fh(r)){s=$h();r.insertAfter(s)}else{return false}s.select();const i=t.getNextSiblings();if(i.length>0){const e=Yh(o.getListType());if(wc(s)){s.insertAfter(e)}else{const t=$h();t.append(e);s.insertAfter(t)}i.forEach((t=>{t.remove();e.append(t)}))}Nh(t);return true}function vh(...e){const t=[];for(const n of e){if(n&&typeof n==="string"){for(const[e]of n.matchAll(/\S+/g)){t.push(e)}}}return t}class Rh extends la{static getType(){return"listitem"}static clone(e){return new Rh(e.__value,e.__checked,e.__key)}constructor(e,t,n){super(n);this.__value=e===undefined?1:e;this.__checked=t}createDOM(e){const t=document.createElement("li");const n=this.getParent();if(Jh(n)&&n.getListType()==="check"){Ih(t,this,null)}t.value=this.__value;kh(t,e.theme,this);return t}updateDOM(e,t,n){const o=this.getParent();if(Jh(o)&&o.getListType()==="check"){Ih(t,this,e)}t.value=this.__value;kh(t,n.theme,this);return false}static transform(){return e=>{if(!Fh(e)){throw Error(`node is not a ListItemNode`)}if(e.__checked==null){return}const t=e.getParent();if(Jh(t)){if(t.getListType()!=="check"&&e.getChecked()!=null){e.setChecked(undefined)}}}}static importDOM(){return{li:()=>({conversion:Lh,priority:0})}}static importJSON(e){const t=$h();t.setChecked(e.checked);t.setValue(e.value);t.setFormat(e.format);t.setDirection(e.direction);return t}exportDOM(e){const t=this.createDOM(e._config);t.style.textAlign=this.getFormatType();return{element:t}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),type:"listitem",value:this.getValue(),version:1}}append(...e){for(let t=0;t<e.length;t++){const n=e[t];if(yc(n)&&this.canMergeWith(n)){const e=n.getChildren();this.append(...e);n.remove()}else{super.append(n)}}return this}replace(e,t){if(Fh(e)){return super.replace(e)}this.setIndent(0);const n=this.getParentOrThrow();if(!Jh(n)){return e}if(n.__first===this.getKey()){n.insertBefore(e)}else if(n.__last===this.getKey()){n.insertAfter(e)}else{const t=Yh(n.getListType());let o=this.getNextSibling();while(o){const e=o;o=o.getNextSibling();t.append(e)}n.insertAfter(e);e.insertAfter(t)}if(t){if(!yc(e)){throw Error(`includeChildren should only be true for ElementNodes`)}this.getChildren().forEach((t=>{e.append(t)}))}this.remove();if(n.getChildrenSize()===0){n.remove()}return e}insertAfter(e,t=true){const n=this.getParentOrThrow();if(!Jh(n)){{throw Error(`insertAfter: list node is not parent of list item node`)}}if(Fh(e)){return super.insertAfter(e,t)}const o=this.getNextSiblings();n.insertAfter(e,t);if(o.length!==0){const r=Yh(n.getListType());o.forEach((e=>r.append(e)));e.insertAfter(r,t)}return e}remove(e){const t=this.getPreviousSibling();const n=this.getNextSibling();super.remove(e);if(t&&n&&mh(t)&&mh(n)){wh(t.getFirstChild(),n.getFirstChild());n.remove()}}insertNewAfter(e,t=true){const n=$h(this.__checked==null?undefined:false);this.insertAfter(n,t);return n}collapseAtStart(e){const t=ql();const n=this.getChildren();n.forEach((e=>t.append(e)));const o=this.getParentOrThrow();const r=o.getParentOrThrow();const s=Fh(r);if(o.getChildrenSize()===1){if(s){o.remove();r.select()}else{o.insertBefore(t);o.remove();const n=e.anchor;const r=e.focus;const s=t.getKey();if(n.type==="element"&&n.getNode().is(this)){n.set(s,n.offset,"element")}if(r.type==="element"&&r.getNode().is(this)){r.set(s,r.offset,"element")}}}else{o.insertBefore(t);this.remove()}return true}getValue(){const e=this.getLatest();return e.__value}setValue(e){const t=this.getWritable();t.__value=e}getChecked(){const e=this.getLatest();let t;const n=this.getParent();if(Jh(n)){t=n.getListType()}return t==="check"?Boolean(e.__checked):undefined}setChecked(e){const t=this.getWritable();t.__checked=e}toggleChecked(){this.setChecked(!this.__checked)}getIndent(){const e=this.getParent();if(e===null){return this.getLatest().__indent}let t=e.getParentOrThrow();let n=0;while(Fh(t)){t=t.getParentOrThrow().getParentOrThrow();n++}return n}setIndent(e){if(!(typeof e==="number")){throw Error(`Invalid indent value.`)}e=Math.floor(e);if(!(e>=0)){throw Error(`Indent value must be non-negative.`)}let t=this.getIndent();while(t!==e){if(t<e){Mh(this);t++}else{Ah(this);t--}}return this}canInsertAfter(e){return Fh(e)}canReplaceWith(e){return Fh(e)}canMergeWith(e){return wc(e)||Fh(e)}extractWithChild(e,t){if(!xc(t)){return false}const n=t.anchor.getNode();const o=t.focus.getNode();return this.isParentOf(n)&&this.isParentOf(o)&&this.getTextContent().length===t.getTextContent().length}isParentRequired(){return true}createParentElementNode(){return Yh("bullet")}canMergeWhenEmpty(){return true}}function kh(e,t,n){const o=[];const r=[];const s=t.list;const i=s?s.listitem:undefined;let l;if(s&&s.nested){l=s.nested.listitem}if(i!==undefined){o.push(...vh(i))}if(s){const e=n.getParent();const t=Jh(e)&&e.getListType()==="check";const i=n.getChecked();if(!t||i){r.push(s.listitemUnchecked)}if(!t||!i){r.push(s.listitemChecked)}if(t){o.push(i?s.listitemChecked:s.listitemUnchecked)}}if(l!==undefined){const e=vh(l);if(n.getChildren().some((e=>Jh(e)))){o.push(...e)}else{r.push(...e)}}if(r.length>0){Qd(e,...r)}if(o.length>0){Kd(e,...o)}}function Ih(e,t,n,o){if(Jh(t.getFirstChild())){e.removeAttribute("role");e.removeAttribute("tabIndex");e.removeAttribute("aria-checked")}else{e.setAttribute("role","checkbox");e.setAttribute("tabIndex","-1");if(!n||t.__checked!==n.__checked){e.setAttribute("aria-checked",t.getChecked()?"true":"false")}}}function Lh(e){const t=e.classList.contains("task-list-item");if(t){for(const t of e.children){if(t.tagName==="INPUT"){return Ph(t)}}}const n=e.getAttribute("aria-checked");const o=n==="true"?true:n==="false"?false:undefined;return{node:$h(o)}}function Ph(e){const t=e.getAttribute("type")==="checkbox";if(!t){return{node:null}}const n=e.hasAttribute("checked");return{node:$h(n)}}function $h(e){return Jl(new Rh(undefined,e))}function Fh(e){return e instanceof Rh}class Kh extends la{static getType(){return"list"}static clone(e){const t=e.__listType||Uh[e.__tag];return new Kh(t,e.__start,e.__key)}constructor(e,t,n){super(n);const o=Uh[e]||e;this.__listType=o;this.__tag=o==="number"?"ol":"ul";this.__start=t}getTag(){return this.__tag}setListType(e){const t=this.getWritable();t.__listType=e;t.__tag=e==="number"?"ol":"ul"}getListType(){return this.__listType}getStart(){return this.__start}createDOM(e,t){const n=this.__tag;const o=document.createElement(n);if(this.__start!==1){o.setAttribute("start",String(this.__start))}o.__lexicalListType=this.__listType;Bh(o,e.theme,this);return o}updateDOM(e,t,n){if(e.__tag!==this.__tag){return true}Bh(t,n.theme,this);return false}static transform(){return e=>{if(!Jh(e)){throw Error(`node is not a ListNode`)}Oh(e);bh(e)}}static importDOM(){return{ol:()=>({conversion:Hh,priority:0}),ul:()=>({conversion:Hh,priority:0})}}static importJSON(e){const t=Yh(e.listType,e.start);t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&Hd(t)){if(this.__start!==1){t.setAttribute("start",String(this.__start))}if(this.__listType==="check"){t.setAttribute("__lexicalListType","check")}}return{element:t}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag(),type:"list",version:1}}canBeEmpty(){return false}canIndent(){return false}append(...e){for(let t=0;t<e.length;t++){const n=e[t];if(Fh(n)){super.append(n)}else{const e=$h();if(Jh(n)){e.append(n)}else if(yc(n)){const t=nc(n.getTextContent());e.append(t)}else{e.append(n)}super.append(e)}}return this}extractWithChild(e){return Fh(e)}}function Bh(e,t,n){const o=[];const r=[];const s=t.list;if(s!==undefined){const e=s[`${n.__tag}Depth`]||[];const t=gh(n)-1;const i=t%e.length;const l=e[i];const c=s[n.__tag];let a;const u=s.nested;const f=s.checklist;if(u!==undefined&&u.list){a=u.list}if(c!==undefined){o.push(c)}if(f!==undefined&&n.__listType==="check"){o.push(f)}if(l!==undefined){o.push(...vh(l));for(let t=0;t<e.length;t++){if(t!==i){r.push(n.__tag+t)}}}if(a!==undefined){const e=vh(a);if(t>1){o.push(...e)}else{r.push(...e)}}}if(r.length>0){Qd(e,...r)}if(o.length>0){Kd(e,...o)}}function Wh(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n];if(Fh(o)){t.push(o);const e=o.getChildren();if(e.length>1){e.forEach((e=>{if(Jh(e)){t.push(yh(e))}}))}}else{t.push(yh(o))}}return t}function zh(e){if(e.getAttribute("__lexicallisttype")==="check"||e.classList.contains("contains-task-list")){return true}for(const t of e.childNodes){if(Hd(t)&&t.hasAttribute("aria-checked")){return true}}return false}function Hh(e){const t=e.nodeName.toLowerCase();let n=null;if(t==="ol"){const t=e.start;n=Yh("number",t)}else if(t==="ul"){if(zh(e)){n=Yh("check")}else{n=Yh("bullet")}}return{after:Wh,node:n}}const Uh={ol:"number",ul:"bullet"};function Yh(e,t=1){return Jl(new Kh(e,t))}function Jh(e){return e instanceof Kh}const jh=Qa("INSERT_UNORDERED_LIST_COMMAND");const Gh=Qa("INSERT_ORDERED_LIST_COMMAND");const Xh=Qa("INSERT_CHECK_LIST_COMMAND");const Vh=Qa("REMOVE_LIST_COMMAND");var qh=Object.freeze({$createListItemNode:$h,$createListNode:Yh,$getListDepth:gh,$handleListInsertParagraph:Dh,$isListItemNode:Fh,$isListNode:Jh,INSERT_CHECK_LIST_COMMAND:Xh,INSERT_ORDERED_LIST_COMMAND:Gh,INSERT_UNORDERED_LIST_COMMAND:jh,ListItemNode:Rh,ListNode:Kh,REMOVE_LIST_COMMAND:Vh,insertList:Th,removeList:xh});function Qh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zh=Qh((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const eg=Qa("INSERT_UNORDERED_LIST_COMMAND"),tg=Qa("INSERT_ORDERED_LIST_COMMAND"),ng=Qa("INSERT_CHECK_LIST_COMMAND"),og=Qa("REMOVE_LIST_COMMAND");const rg=qh;const sg=rg.$createListItemNode;const ig=rg.$createListNode;const lg=rg.$getListDepth;const cg=rg.$handleListInsertParagraph;const ag=rg.$isListItemNode;const ug=rg.$isListNode;const fg=rg.INSERT_CHECK_LIST_COMMAND;const dg=rg.INSERT_ORDERED_LIST_COMMAND;const hg=rg.INSERT_UNORDERED_LIST_COMMAND;const gg=rg.ListItemNode;const _g=rg.ListNode;const pg=rg.REMOVE_LIST_COMMAND;const mg=rg.insertList;const Ng=rg.removeList;var yg=Object.freeze({$createListItemNode:sg,$createListNode:ig,$getListDepth:lg,$handleListInsertParagraph:cg,$isListItemNode:ag,$isListNode:ug,INSERT_CHECK_LIST_COMMAND:fg,INSERT_ORDERED_LIST_COMMAND:dg,INSERT_UNORDERED_LIST_COMMAND:hg,ListItemNode:gg,ListNode:_g,REMOVE_LIST_COMMAND:pg,insertList:mg,removeList:Ng});const Cg=new Set(["http:","https:","mailto:","sms:","tel:"]);class Tg extends la{static getType(){return"link"}static clone(e){return new Tg(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e,t={},n){super(n);const{target:o=null,rel:r=null,title:s=null}=t;this.__url=e;this.__target=o;this.__rel=r;this.__title=s}createDOM(e){const t=document.createElement("a");t.href=this.sanitizeUrl(this.__url);if(this.__target!==null){t.target=this.__target}if(this.__rel!==null){t.rel=this.__rel}if(this.__title!==null){t.title=this.__title}Kd(t,e.theme.link);return t}updateDOM(e,t,n){if(t instanceof HTMLAnchorElement){const n=this.__url;const o=this.__target;const r=this.__rel;const s=this.__title;if(n!==e.__url){t.href=n}if(o!==e.__target){if(o){t.target=o}else{t.removeAttribute("target")}}if(r!==e.__rel){if(r){t.rel=r}else{t.removeAttribute("rel")}}if(s!==e.__title){if(s){t.title=s}else{t.removeAttribute("title")}}}return false}static importDOM(){return{a:e=>({conversion:Eg,priority:1})}}static importJSON(e){const t=Sg(e.url,{rel:e.rel,target:e.target,title:e.title});t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}sanitizeUrl(e){try{const t=new URL(e);if(!Cg.has(t.protocol)){return"about:blank"}}catch(t){return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),type:"link",url:this.getURL(),version:1}}getURL(){return this.getLatest().__url}setURL(e){const t=this.getWritable();t.__url=e}getTarget(){return this.getLatest().__target}setTarget(e){const t=this.getWritable();t.__target=e}getRel(){return this.getLatest().__rel}setRel(e){const t=this.getWritable();t.__rel=e}getTitle(){return this.getLatest().__title}setTitle(e){const t=this.getWritable();t.__title=e}insertNewAfter(e,t=true){const n=Sg(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});this.insertAfter(n,t);return n}canInsertTextBefore(){return false}canInsertTextAfter(){return false}canBeEmpty(){return false}isInline(){return true}extractWithChild(e,t,n){if(!xc(t)){return false}const o=t.anchor.getNode();const r=t.focus.getNode();return this.isParentOf(o)&&this.isParentOf(r)&&t.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function Eg(e){let t=null;if(zd(e)){const n=e.textContent;if(n!==null&&n!==""||e.children.length>0){t=Sg(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")})}}return{node:t}}function Sg(e,t){return Jl(new Tg(e,t))}function wg(e){return e instanceof Tg}class xg extends Tg{constructor(e,t={},n){super(e,t,n);this.__isUnlinked=t.isUnlinked!==undefined&&t.isUnlinked!==null?t.isUnlinked:false}static getType(){return"autolink"}static clone(e){return new xg(e.__url,{isUnlinked:e.__isUnlinked,rel:e.__rel,target:e.__target,title:e.__title},e.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(e){const t=this.getWritable();t.__isUnlinked=e;return t}createDOM(e){if(this.__isUnlinked){return document.createElement("span")}else{return super.createDOM(e)}}updateDOM(e,t,n){return super.updateDOM(e,t,n)||e.__isUnlinked!==this.__isUnlinked}static importJSON(e){const t=bg(e.url,{isUnlinked:e.isUnlinked,rel:e.rel,target:e.target,title:e.title});t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked,type:"autolink",version:1}}insertNewAfter(e,t=true){const n=this.getParentOrThrow().insertNewAfter(e,t);if(yc(n)){const e=bg(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});n.append(e);return e}return null}}function bg(e,t){return Jl(new xg(e,t))}function Og(e){return e instanceof xg}const Mg=Qa("TOGGLE_LINK_COMMAND");function Ag(e,t={}){const{target:n,title:o}=t;const r=t.rel===undefined?"noreferrer":t.rel;const s=dc();if(!xc(s)){return}const i=s.extract();if(e===null){i.forEach((e=>{const t=e.getParent();if(!Og(t)&&wg(t)){const e=t.getChildren();for(let n=0;n<e.length;n++){t.insertBefore(e[n])}t.remove()}}))}else{if(i.length===1){const t=i[0];const s=vg(t,wg);if(s!==null){s.setURL(e);if(n!==undefined){s.setTarget(n)}if(r!==null){s.setRel(r)}if(o!==undefined){s.setTitle(o)}return}}let t=null;let s=null;i.forEach((i=>{const l=i.getParent();if(l===s||l===null||yc(i)&&!i.isInline()){return}if(wg(l)){s=l;l.setURL(e);if(n!==undefined){l.setTarget(n)}if(r!==null){s.setRel(r)}if(o!==undefined){s.setTitle(o)}return}if(!l.is(t)){t=l;s=Sg(e,{rel:r,target:n,title:o});if(wg(l)){if(i.getPreviousSibling()===null){l.insertBefore(s)}else{l.insertAfter(s)}}else{i.insertBefore(s)}}if(wg(i)){if(i.is(s)){return}if(s!==null){const e=i.getChildren();for(let t=0;t<e.length;t++){s.append(e[t])}}i.remove();return}if(s!==null){s.append(i)}}))}}const Dg=Ag;function vg(e,t){let n=e;while(n!==null&&n.getParent()!==null&&!t(n)){n=n.getParentOrThrow()}return t(n)?n:null}var Rg=Object.freeze({$createAutoLinkNode:bg,$createLinkNode:Sg,$isAutoLinkNode:Og,$isLinkNode:wg,$toggleLink:Ag,AutoLinkNode:xg,LinkNode:Tg,TOGGLE_LINK_COMMAND:Mg,toggleLink:Dg});const kg=Qa("TOGGLE_LINK_COMMAND");const Ig=Rg;const Lg=Ig.$createAutoLinkNode;const Pg=Ig.$createLinkNode;const $g=Ig.$isAutoLinkNode;const Fg=Ig.$isLinkNode;const Kg=Ig.$toggleLink;const Bg=Ig.AutoLinkNode;const Wg=Ig.LinkNode;const zg=Ig.TOGGLE_LINK_COMMAND;const Hg=Ig.toggleLink;var Ug=Object.freeze({$createAutoLinkNode:Lg,$createLinkNode:Pg,$isAutoLinkNode:$g,$isLinkNode:Fg,$toggleLink:Kg,AutoLinkNode:Bg,LinkNode:Wg,TOGGLE_LINK_COMMAND:zg,toggleLink:Hg});const Yg=typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof window.document.createElement!=="undefined";const Jg=e=>Yg?(e||window).getSelection():null;function jg(e,t=dc()){if(t==null){{throw Error(`Expected valid LexicalSelection`)}}if(xc(t)&&t.isCollapsed()||t.getNodes().length===0){return""}return fh(e,t)}function Gg(e,t=dc()){if(t==null){{throw Error(`Expected valid LexicalSelection`)}}if(xc(t)&&t.isCollapsed()||t.getNodes().length===0){return null}return JSON.stringify(e_(e,t))}function Xg(e,t){const n=e.getData("text/plain")||e.getData("text/uri-list");if(n!=null){t.insertRawText(n)}}function Vg(e,t,n){const o=e.getData("application/x-lexical-editor");if(o){try{const e=JSON.parse(o);if(e.namespace===n._config.namespace&&Array.isArray(e.nodes)){const o=t_(e.nodes);return qg(n,o,t)}}catch(e){}}const r=e.getData("text/html");if(r){try{const e=new DOMParser;const o=e.parseFromString(r,"text/html");const s=dh(n,o);return qg(n,s,t)}catch(e){}}const s=e.getData("text/plain")||e.getData("text/uri-list");if(s!=null){if(xc(t)){const e=s.split(/(\r?\n|\t)/);if(e[e.length-1]===""){e.pop()}for(let t=0;t<e.length;t++){const n=dc();if(xc(n)){const o=e[t];if(o==="\n"||o==="\r\n"){n.insertParagraph()}else if(o==="\t"){n.insertNodes([tc()])}else{n.insertText(o)}}}}else{t.insertRawText(s)}}}function qg(e,t,n){if(!e.dispatchCommand(Ja,{nodes:t,selection:n})){n.insertNodes(t)}return}function Qg(e){const t=e.exportJSON();const n=e.constructor;if(t.type!==n.getType()){{throw Error(`LexicalNode: Node ${n.name} does not implement .exportJSON().`)}}if(yc(e)){const e=t.children;if(!Array.isArray(e)){{throw Error(`LexicalNode: Node ${n.name} is an element but .exportJSON() does not have a children array.`)}}}return t}function Zg(e,t,n,o=[]){let r=t!==null?n.isSelected(t):true;const s=yc(n)&&n.excludeFromCopy("html");let i=n;if(t!==null){let e=jl(n);e=Ac(e)&&t!==null?nf(t,e):e;i=e}const l=yc(i)?i.getChildren():[];const c=Qg(i);if(Ac(i)){const e=i.__text;if(e.length>0){c.text=e}else{r=false}}for(let o=0;o<l.length;o++){const s=l[o];const i=Zg(e,t,s,c.children);if(!r&&yc(n)&&i&&n.extractWithChild(s,t,"clone")){r=true}}if(r&&!s){o.push(c)}else if(Array.isArray(c.children)){for(let e=0;e<c.children.length;e++){const t=c.children[e];o.push(t)}}return r}function e_(e,t){const n=[];const o=fc();const r=o.getChildren();for(let o=0;o<r.length;o++){const s=r[o];Zg(e,t,s,n)}return{namespace:e._config.namespace,nodes:n}}function t_(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n];const r=kc(o);if(Ac(r)){Yu(r)}t.push(r)}return t}const n_=50;let o_=null;async function r_(e,t,n){if(o_!==null){return false}if(t!==null){return new Promise(((o,r)=>{e.update((()=>{o(s_(e,t,n))}))}))}const o=e.getRootElement();const r=e._window==null?window.document:e._window.document;const s=Jg(e._window);if(o===null||s===null){return false}const i=r.createElement("span");i.style.cssText="position: fixed; top: -1000px;";i.append(r.createTextNode("#"));o.append(i);const l=new Range;l.setStart(i,0);l.setEnd(i,1);s.removeAllRanges();s.addRange(l);return new Promise(((t,o)=>{const s=e.registerCommand(qc,(o=>{if(Xd(o,ClipboardEvent)){s();if(o_!==null){window.clearTimeout(o_);o_=null}t(s_(e,o,n))}return true}),Yc);o_=window.setTimeout((()=>{s();o_=null;t(false)}),n_);r.execCommand("copy");i.remove()}))}function s_(e,t,n){if(n===undefined){const t=Jg(e._window);if(!t){return false}const o=t.anchorNode;const r=t.focusNode;if(o!==null&&r!==null&&!au(e,o,r)){return false}const s=dc();if(s===null){return false}n=l_(s)}t.preventDefault();const o=t.clipboardData;if(o===null){return false}c_(o,n);return true}const i_=[["text/html",jg],["application/x-lexical-editor",Gg]];function l_(e=dc()){const t={"text/plain":e?e.getTextContent():""};if(e){const n=sc();for(const[o,r]of i_){const s=r(n,e);if(s!==null){t[o]=s}}}return t}function c_(e,t){for(const n in t){const o=t[n];if(o!==undefined){e.setData(n,o)}}}var a_=Object.freeze({$generateJSONFromSelectedNodes:e_,$generateNodesFromSerializedNodes:t_,$getClipboardDataFromSelection:l_,$getHtmlContent:jg,$getLexicalContent:Gg,$insertDataTransferForPlainText:Xg,$insertDataTransferForRichText:Vg,$insertGeneratedNodes:qg,copyToClipboard:r_,setLexicalClipboardDataTransfer:c_});function u_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f_=u_((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const d_="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;const h_=a_;const g_=h_.$generateJSONFromSelectedNodes;const __=h_.$generateNodesFromSerializedNodes;const p_=h_.$getClipboardDataFromSelection;const m_=h_.$getHtmlContent;const N_=h_.$getLexicalContent;const y_=h_.$insertDataTransferForPlainText;const C_=h_.$insertDataTransferForRichText;const T_=h_.$insertGeneratedNodes;const E_=h_.copyToClipboard;const S_=h_.setLexicalClipboardDataTransfer;var w_=Object.freeze({$generateJSONFromSelectedNodes:g_,$generateNodesFromSerializedNodes:__,$getClipboardDataFromSelection:p_,$getHtmlContent:m_,$getLexicalContent:N_,$insertDataTransferForPlainText:y_,$insertDataTransferForRichText:C_,$insertGeneratedNodes:T_,copyToClipboard:E_,setLexicalClipboardDataTransfer:S_});const x_=0;const b_=1;const O_=2;const M_=0;const A_=1;const D_=2;const v_=3;const R_=4;function k_(e,t,n){const o=e._nodeMap;const r=[];for(const e of t){const t=o.get(e);if(t!==undefined){r.push(t)}}for(const[e,t]of n){if(!t){continue}const n=o.get(e);if(n!==undefined&&!bc(n)){r.push(n)}}return r}function I_(e,t,n,o,r){if(e===null||n.size===0&&o.size===0&&!r){return M_}const s=t._selection;const i=e._selection;if(r){return A_}if(!xc(s)||!xc(i)||!i.isCollapsed()||!s.isCollapsed()){return M_}const l=k_(t,n,o);if(l.length===0){return M_}if(l.length>1){const n=t._nodeMap;const o=n.get(s.anchor.key);const r=n.get(i.anchor.key);if(o&&r&&!e._nodeMap.has(o.__key)&&Ac(o)&&o.__text.length===1&&s.anchor.offset===1){return D_}return M_}const c=l[0];const a=e._nodeMap.get(c.__key);if(!Ac(a)||!Ac(c)||a.__mode!==c.__mode){return M_}const u=a.__text;const f=c.__text;if(u===f){return M_}const d=s.anchor;const h=i.anchor;if(d.key!==h.key||d.type!=="text"){return M_}const g=d.offset;const _=h.offset;const p=f.length-u.length;if(p===1&&_===g-1){return D_}if(p===-1&&_===g+1){return v_}if(p===-1&&_===g){return R_}return M_}function L_(e,t,n){const o=t._nodeMap.get(e);const r=n._nodeMap.get(e);const s=t._selection;const i=n._selection;const l=xc(s)&&xc(i)&&s.anchor.type==="element"&&s.focus.type==="element"&&i.anchor.type==="text"&&i.focus.type==="text";if(!l&&Ac(o)&&Ac(r)&&o.__parent===r.__parent){return JSON.stringify(t.read((()=>o.exportJSON())))===JSON.stringify(n.read((()=>r.exportJSON())))}return false}function P_(e,t){let n=Date.now();let o=M_;return(r,s,i,l,c,a)=>{const u=Date.now();if(a.has("historic")){o=M_;n=u;return O_}const f=I_(r,s,l,c,e.isComposing());const d=(()=>{const d=i===null||i.editor===e;const h=a.has("history-push");const g=!h&&d&&a.has("history-merge");if(g){return x_}if(r===null){return b_}const _=s._selection;const p=l.size>0||c.size>0;if(!p){if(_!==null){return x_}return O_}if(h===false&&f!==M_&&f===o&&u<n+t&&d){return x_}if(l.size===1){const e=Array.from(l)[0];if(L_(e,r,s)){return x_}}return b_})();n=u;o=f;return d}}function $_(e,t){const n=t.redoStack;const o=t.undoStack;if(n.length!==0){const r=t.current;if(r!==null){o.push(r);e.dispatchCommand(Wc,true)}const s=n.pop();if(n.length===0){e.dispatchCommand(Bc,false)}t.current=s||null;if(s){s.editor.setEditorState(s.editorState,{tag:"historic"})}}}function F_(e,t){const n=t.redoStack;const o=t.undoStack;const r=o.length;if(r!==0){const r=t.current;const s=o.pop();if(r!==null){n.push(r);e.dispatchCommand(Bc,true)}if(o.length===0){e.dispatchCommand(Wc,false)}t.current=s||null;if(s){s.editor.setEditorState(s.editorState,{tag:"historic"})}}}function K_(e){e.undoStack=[];e.redoStack=[];e.current=null}function B_(e,t,n){const o=P_(e,n);const r=({editorState:n,prevEditorState:r,dirtyLeaves:s,dirtyElements:i,tags:l})=>{const c=t.current;const a=t.redoStack;const u=t.undoStack;const f=c===null?null:c.editorState;if(c!==null&&n===f){return}const d=o(r,n,c,s,i,l);if(d===b_){if(a.length!==0){t.redoStack=[];e.dispatchCommand(Bc,false)}if(c!==null){u.push({...c});e.dispatchCommand(Wc,true)}}else if(d===O_){return}t.current={editor:e,editorState:n}};const s=Gd(e.registerCommand(qa,(()=>{F_(e,t);return true}),Jc),e.registerCommand(za,(()=>{$_(e,t);return true}),Jc),e.registerCommand(zc,(()=>{K_(t);return false}),Jc),e.registerCommand(Hc,(()=>{K_(t);e.dispatchCommand(Bc,false);e.dispatchCommand(Wc,false);return true}),Jc),e.registerUpdateListener(r));return s}function W_(){return{current:null,redoStack:[],undoStack:[]}}var z_=Object.freeze({createEmptyHistoryState:W_,registerHistory:B_});const H_=z_;const U_=H_.createEmptyHistoryState;const Y_=H_.registerHistory;var J_=Object.freeze({createEmptyHistoryState:U_,registerHistory:Y_});function j_(){const e=fc();return e.getTextContent()}function G_(e,t=true){if(e){return false}let n=j_();if(t){n=n.trim()}return n===""}function X_(e,t){return()=>G_(e,t)}function V_(e){if(!G_(e,false)){return false}const t=fc();const n=t.getChildren();const o=n.length;if(o>1){return false}for(let e=0;e<o;e++){const t=n[e];if(Nc(t)){return false}if(yc(t)){if(!wc(t)){return false}if(t.__indent!==0){return false}const n=t.getChildren();const o=n.length;for(let t=0;t<o;t++){const t=n[e];if(!Ac(t)){return false}}}}return true}function q_(e){return()=>V_(e)}function Q_(e,t){let n=e.getFirstChild();let o=0;e:while(n!==null){if(yc(n)){const e=n.getFirstChild();if(e!==null){n=e;continue}}else if(Ac(n)){const e=n.getTextContentSize();if(o+e>t){return{node:n,offset:t-o}}o+=e}const e=n.getNextSibling();if(e!==null){n=e;continue}let r=n.getParent();while(r!==null){const e=r.getNextSibling();if(e!==null){n=e;continue e}r=r.getParent()}break}return null}function Z_(e,t,n,o){const r=e=>e instanceof n;const s=e=>{const t=nc(e.getTextContent());t.setFormat(e.getFormat());e.replace(t)};const i=e=>e.getLatest().__mode;const l=e=>{if(!e.isSimpleText()){return}let n=e.getPreviousSibling();let l=e.getTextContent();let c=e;let a;if(Ac(n)){const o=n.getTextContent();const c=o+l;const a=t(c);if(r(n)){if(a===null||i(n)!==0){s(n);return}else{const t=a.end-o.length;if(t>0){const r=l.slice(0,t);const s=o+r;n.select();n.setTextContent(s);if(t===l.length){e.remove()}else{const n=l.slice(t);e.setTextContent(n)}return}}}else if(a===null||a.start<o.length){return}}let u=0;while(true){a=t(l);let e=a===null?"":l.slice(a.end);l=e;if(e===""){const n=c.getNextSibling();if(Ac(n)){e=c.getTextContent()+n.getTextContent();const o=t(e);if(o===null){if(r(n)){s(n)}else{n.markDirty()}return}else if(o.start!==0){return}}}if(a===null){return}if(a.start===0&&Ac(n)&&n.isTextEntity()){u+=a.end;continue}let i;if(a.start===0){[i,c]=c.splitText(a.end)}else{[,i,c]=c.splitText(a.start+u,a.end+u)}if(!(i!==undefined)){throw Error(`${"nodeToReplace"} should not be undefined. You may want to check splitOffsets passed to the splitText.`)}const f=o(i);f.setFormat(i.getFormat());i.replace(f);if(c==null){return}u=0;n=f}};const c=e=>{const n=e.getTextContent();const o=t(n);if(o===null||o.start!==0){s(e);return}if(n.length>o.end){e.splitText(o.end);return}const i=e.getPreviousSibling();if(Ac(i)&&i.isTextEntity()){s(i);s(e)}const l=e.getNextSibling();if(Ac(l)&&l.isTextEntity()){s(l);if(r(e)){s(e)}}};const a=e.registerNodeTransform(Va,l);const u=e.registerNodeTransform(n,c);return[a,u]}var ep=Object.freeze({$canShowPlaceholder:V_,$canShowPlaceholderCurry:q_,$findTextIntersectionFromCharacters:Q_,$isRootTextContentEmpty:G_,$isRootTextContentEmptyCurry:X_,$rootTextContent:j_,registerLexicalTextEntity:Z_});function tp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var np=tp((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const op=ep;const rp=op.$canShowPlaceholder;const sp=op.$canShowPlaceholderCurry;const ip=op.$findTextIntersectionFromCharacters;const lp=op.$isRootTextContentEmpty;const cp=op.$isRootTextContentEmptyCurry;const ap=op.$rootTextContent;const up=op.registerLexicalTextEntity;var fp=Object.freeze({$canShowPlaceholder:rp,$canShowPlaceholderCurry:sp,$findTextIntersectionFromCharacters:ip,$isRootTextContentEmpty:lp,$isRootTextContentEmptyCurry:cp,$rootTextContent:ap,registerLexicalTextEntity:up});function dp(e,t){if(typeof document.caretRangeFromPoint!=="undefined"){const n=document.caretRangeFromPoint(e,t);if(n===null){return null}return{node:n.startContainer,offset:n.startOffset}}else if(document.caretPositionFromPoint!=="undefined"){const n=document.caretPositionFromPoint(e,t);if(n===null){return null}return{node:n.offsetNode,offset:n.offset}}else{return null}}const hp=typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof window.document.createElement!=="undefined";const gp=hp&&"documentMode"in document?document.documentMode:null;const _p=hp&&"InputEvent"in window&&!gp?"getTargetRanges"in new window.InputEvent("input"):false;const pp=hp&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent);const mp=hp&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;const Np=hp&&/^(?=.*Chrome).*/i.test(navigator.userAgent);const yp=hp&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!Np;const Cp=Qa("DRAG_DROP_PASTE_FILE");class Tp extends la{static getType(){return"quote"}static clone(e){return new Tp(e.__key)}constructor(e){super(e)}createDOM(e){const t=document.createElement("blockquote");Kd(t,e.theme.quote);return t}updateDOM(e,t){return false}static importDOM(){return{blockquote:e=>({conversion:Op,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&Hd(t)){if(this.isEmpty()){t.append(document.createElement("br"))}const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();if(n){t.dir=n}}return{element:t}}static importJSON(e){const t=Ep();t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}exportJSON(){return{...super.exportJSON(),type:"quote"}}insertNewAfter(e,t){const n=ql();const o=this.getDirection();n.setDirection(o);this.insertAfter(n,t);return n}collapseAtStart(){const e=ql();const t=this.getChildren();t.forEach((t=>e.append(t)));this.replace(e);return true}canMergeWhenEmpty(){return true}}function Ep(){return Jl(new Tp)}function Sp(e){return e instanceof Tp}class wp extends la{static getType(){return"heading"}static clone(e){return new wp(e.__tag,e.__key)}constructor(e,t){super(t);this.__tag=e}getTag(){return this.__tag}createDOM(e){const t=this.__tag;const n=document.createElement(t);const o=e.theme;const r=o.heading;if(r!==undefined){const e=r[t];Kd(n,e)}return n}updateDOM(e,t){return false}static importDOM(){return{h1:e=>({conversion:bp,priority:0}),h2:e=>({conversion:bp,priority:0}),h3:e=>({conversion:bp,priority:0}),h4:e=>({conversion:bp,priority:0}),h5:e=>({conversion:bp,priority:0}),h6:e=>({conversion:bp,priority:0}),p:e=>{const t=e;const n=t.firstChild;if(n!==null&&xp(n)){return{conversion:()=>({node:null}),priority:3}}return null},span:e=>{if(xp(e)){return{conversion:e=>({node:Mp("h1")}),priority:3}}return null}}}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&Hd(t)){if(this.isEmpty()){t.append(document.createElement("br"))}const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();if(n){t.dir=n}}return{element:t}}static importJSON(e){const t=Mp(e.tag);t.setFormat(e.format);t.setIndent(e.indent);t.setDirection(e.direction);return t}exportJSON(){return{...super.exportJSON(),tag:this.getTag(),type:"heading",version:1}}insertNewAfter(e,t=true){const n=e?e.anchor.offset:0;const o=this.getLastDescendant();const r=!o||e&&e.anchor.key===o.getKey()&&n===o.getTextContentSize();const s=r||!e?ql():Mp(this.getTag());const i=this.getDirection();s.setDirection(i);this.insertAfter(s,t);if(n===0&&!this.isEmpty()&&e){const e=ql();e.select();this.replace(e,true)}return s}collapseAtStart(){const e=!this.isEmpty()?Mp(this.getTag()):ql();const t=this.getChildren();t.forEach((t=>e.append(t)));this.replace(e);return true}extractWithChild(){return true}}function xp(e){if(e.nodeName.toLowerCase()==="span"){return e.style.fontSize==="26pt"}return false}function bp(e){const t=e.nodeName.toLowerCase();let n=null;if(t==="h1"||t==="h2"||t==="h3"||t==="h4"||t==="h5"||t==="h6"){n=Mp(t);if(e.style!==null){n.setFormat(e.style.textAlign)}}return{node:n}}function Op(e){const t=Ep();if(e.style!==null){t.setFormat(e.style.textAlign)}return{node:t}}function Mp(e){return Jl(new wp(e))}function Ap(e){return e instanceof wp}function Dp(e,t){e.preventDefault();t.update((()=>{const n=dc();const o=Xd(e,InputEvent)||Xd(e,KeyboardEvent)?null:e.clipboardData;if(o!=null&&n!==null){C_(o,n,t)}}),{tag:"paste"})}async function vp(e,t){await E_(t,Xd(e,ClipboardEvent)?e:null);t.update((()=>{const e=dc();if(xc(e)){e.removeText()}else if(Sc(e)){e.getNodes().forEach((e=>e.remove()))}}))}function Rp(e){let t=null;if(Xd(e,DragEvent)){t=e.dataTransfer}else if(Xd(e,ClipboardEvent)){t=e.clipboardData}if(t===null){return[false,[],false]}const n=t.types;const o=n.includes("Files");const r=n.includes("text/html")||n.includes("text/plain");return[o,Array.from(t.files),r]}function kp(e){const t=dc();if(!xc(t)){return false}const n=new Set;const o=t.getNodes();for(let t=0;t<o.length;t++){const r=o[t];const s=r.getKey();if(n.has(s)){continue}const i=yd(r,(e=>yc(e)&&!e.isInline()));if(i===null){continue}const l=i.getKey();if(i.canIndent()&&!n.has(l)){n.add(l);e(i)}}return n.size>0}function Ip(e){const t=ic(e);return Nc(t)}function Lp(e){const t=e.focus;return t.key==="root"&&t.offset===fc().getChildrenSize()}function Pp(e){const t=Gd(e.registerCommand(Uc,(e=>{const t=dc();if(Sc(t)){t.clear();return true}return false}),0),e.registerCommand(Zc,(e=>{const t=dc();if(!xc(t)){return false}t.deleteCharacter(e);return true}),Jc),e.registerCommand(ta,(e=>{const t=dc();if(!xc(t)){return false}t.deleteWord(e);return true}),Jc),e.registerCommand(ea,(e=>{const t=dc();if(!xc(t)){return false}t.deleteLine(e);return true}),Jc),e.registerCommand(Vc,(t=>{const n=dc();if(typeof t==="string"){if(n!==null){n.insertText(t)}}else{if(n===null){return false}const o=t.dataTransfer;if(o!=null){C_(o,n,e)}else if(xc(n)){const e=t.data;if(e){n.insertText(e)}return true}}return true}),Jc),e.registerCommand(Ha,(()=>{const e=dc();if(!xc(e)){return false}e.removeText();return true}),Jc),e.registerCommand(ua,(e=>{const t=dc();if(!xc(t)){return false}t.formatText(e);return true}),Jc),e.registerCommand(aa,(e=>{const t=dc();if(!xc(t)&&!Sc(t)){return false}const n=t.getNodes();for(const t of n){const n=yd(t,(e=>yc(e)&&!e.isInline()));if(n!==null){n.setFormat(e)}}return true}),Jc),e.registerCommand(da,(e=>{const t=dc();if(!xc(t)){return false}t.insertLineBreak(e);return true}),Jc),e.registerCommand(ha,(()=>{const e=dc();if(!xc(e)){return false}e.insertParagraph();return true}),Jc),e.registerCommand(ga,(()=>{pc([tc()]);return true}),Jc),e.registerCommand(fa,(()=>kp((e=>{const t=e.getIndent();e.setIndent(t+1)}))),Jc),e.registerCommand(Ka,(()=>kp((e=>{const t=e.getIndent();if(t>0){e.setIndent(t-1)}}))),Jc),e.registerCommand(Oa,(e=>{const t=dc();if(Sc(t)&&!Ip(e.target)){const e=t.getNodes();if(e.length>0){e[0].selectPrevious();return true}}else if(xc(t)){const n=oc(t.focus,true);if(!e.shiftKey&&Nc(n)&&!n.isIsolated()&&!n.isInline()){n.selectPrevious();e.preventDefault();return true}}return false}),Jc),e.registerCommand(wa,(e=>{const t=dc();if(Sc(t)){const e=t.getNodes();if(e.length>0){e[0].selectNext(0,0);return true}}else if(xc(t)){if(Lp(t)){e.preventDefault();return true}const n=oc(t.focus,false);if(!e.shiftKey&&Nc(n)&&!n.isIsolated()&&!n.isInline()){n.selectNext();e.preventDefault();return true}}return false}),Jc),e.registerCommand(xa,(e=>{const t=dc();if(Sc(t)){const n=t.getNodes();if(n.length>0){e.preventDefault();n[0].selectPrevious();return true}}if(!xc(t)){return false}if(tf(t,true)){const n=e.shiftKey;e.preventDefault();qu(t,n,true);return true}return false}),Jc),e.registerCommand(ba,(e=>{const t=dc();if(Sc(t)&&!Ip(e.target)){const n=t.getNodes();if(n.length>0){e.preventDefault();n[0].selectNext(0,0);return true}}if(!xc(t)){return false}const n=e.shiftKey;if(tf(t,false)){e.preventDefault();qu(t,n,false);return true}return false}),Jc),e.registerCommand(Ma,(t=>{if(Ip(t.target)){return false}const n=dc();if(!xc(n)){return false}t.preventDefault();const{anchor:o}=n;const r=o.getNode();if(n.isCollapsed()&&o.offset===0&&!bc(r)){const t=Cd(r);if(t.getIndent()>0){return e.dispatchCommand(Ka,undefined)}}return e.dispatchCommand(Zc,true)}),Jc),e.registerCommand(Aa,(t=>{if(Ip(t.target)){return false}const n=dc();if(!xc(n)){return false}t.preventDefault();return e.dispatchCommand(Zc,false)}),Jc),e.registerCommand(va,(t=>{const n=dc();if(!xc(n)){return false}if(t!==null){if((mp||pp||yp)&&_p){return false}t.preventDefault();if(t.shiftKey){return e.dispatchCommand(da,false)}}return e.dispatchCommand(ha,undefined)}),Jc),e.registerCommand(Ra,(()=>{const t=dc();if(!xc(t)){return false}e.blur();return true}),Jc),e.registerCommand(sa,(t=>{const[,n]=Rp(t);if(n.length>0){const o=t.clientX;const r=t.clientY;const s=dp(o,r);if(s!==null){const{offset:t,node:o}=s;const r=ic(o);if(r!==null){const e=Zl();if(Ac(r)){e.anchor.set(r.getKey(),t,"text");e.focus.set(r.getKey(),t,"text")}else{const t=r.getParentOrThrow().getKey();const n=r.getIndexWithinParent()+1;e.anchor.set(t,n,"element");e.focus.set(t,n,"element")}const n=Rc(e);Pc(n)}e.dispatchCommand(Cp,n)}t.preventDefault();return true}const o=dc();if(xc(o)){return true}return false}),Jc),e.registerCommand(ra,(e=>{const[t]=Rp(e);const n=dc();if(t&&!xc(n)){return false}return true}),Jc),e.registerCommand(oa,(e=>{const[t]=Rp(e);const n=dc();if(t&&!xc(n)){return false}const o=e.clientX;const r=e.clientY;const s=dp(o,r);if(s!==null){const t=ic(s.node);if(Nc(t)){e.preventDefault()}}return true}),Jc),e.registerCommand(ja,(()=>{Ic();return true}),Jc),e.registerCommand(qc,(t=>{E_(e,Xd(t,ClipboardEvent)?t:null);return true}),Jc),e.registerCommand(Qc,(t=>{vp(t,e);return true}),Jc),e.registerCommand(Ba,(t=>{const[,n,o]=Rp(t);if(n.length>0&&!o){e.dispatchCommand(Cp,n);return true}if(cu(t.target)){return false}const r=dc();if(r!==null){Dp(t,e);return true}return false}),Jc));return t}var $p=Object.freeze({$createHeadingNode:Mp,$createQuoteNode:Ep,$isHeadingNode:Ap,$isQuoteNode:Sp,DRAG_DROP_PASTE:Cp,HeadingNode:wp,QuoteNode:Tp,eventFiles:Rp,registerRichText:Pp});const Fp="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Kp=Fp&&"documentMode"in document?document.documentMode:null,Bp=!(!Fp||!("InputEvent"in window)||Kp)&&"getTargetRanges"in new window.InputEvent("input"),Wp=Fp&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),zp=Fp&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Hp=Fp&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Up=Fp&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!Hp,Yp=Qa("DRAG_DROP_PASTE_FILE");const Jp=$p;const jp=Jp.$createHeadingNode;const Gp=Jp.$createQuoteNode;const Xp=Jp.$isHeadingNode;const Vp=Jp.$isQuoteNode;const qp=Jp.DRAG_DROP_PASTE;const Qp=Jp.HeadingNode;const Zp=Jp.QuoteNode;const em=Jp.eventFiles;const tm=Jp.registerRichText;var nm=Object.freeze({$createHeadingNode:jp,$createQuoteNode:Gp,$isHeadingNode:Xp,$isQuoteNode:Vp,DRAG_DROP_PASTE:qp,HeadingNode:Qp,QuoteNode:Zp,eventFiles:em,registerRichText:tm});const om=/^(\d+(?:\.\d+)?)px$/;const rm=75;const sm={BOTH:3,COLUMN:2,NO_STATUS:0,ROW:1};class im extends la{static getType(){return"tablecell"}static clone(e){const t=new im(e.__headerState,e.__colSpan,e.__width,e.__key);t.__rowSpan=e.__rowSpan;t.__backgroundColor=e.__backgroundColor;return t}static importDOM(){return{td:e=>({conversion:lm,priority:0}),th:e=>({conversion:lm,priority:0})}}static importJSON(e){const t=e.colSpan||1;const n=e.rowSpan||1;const o=cm(e.headerState,t,e.width||undefined);o.__rowSpan=n;o.__backgroundColor=e.backgroundColor||null;return o}constructor(e=sm.NO_STATUS,t=1,n,o){super(o);this.__colSpan=t;this.__rowSpan=1;this.__headerState=e;this.__width=n;this.__backgroundColor=null}createDOM(e){const t=document.createElement(this.getTag());if(this.__width){t.style.width=`${this.__width}px`}if(this.__colSpan>1){t.colSpan=this.__colSpan}if(this.__rowSpan>1){t.rowSpan=this.__rowSpan}if(this.__backgroundColor!==null){t.style.backgroundColor=this.__backgroundColor}Kd(t,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader);return t}exportDOM(e){const{element:t}=super.exportDOM(e);if(t){const e=t;e.style.border="1px solid black";if(this.__colSpan>1){e.colSpan=this.__colSpan}if(this.__rowSpan>1){e.rowSpan=this.__rowSpan}e.style.width=`${this.getWidth()||rm}px`;e.style.verticalAlign="top";e.style.textAlign="start";const n=this.getBackgroundColor();if(n!==null){e.style.backgroundColor=n}else if(this.hasHeader()){e.style.backgroundColor="#f2f3f5"}}return{element:t}}exportJSON(){return{...super.exportJSON(),backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,type:"tablecell",width:this.getWidth()}}getColSpan(){return this.__colSpan}setColSpan(e){this.getWritable().__colSpan=e;return this}getRowSpan(){return this.__rowSpan}setRowSpan(e){this.getWritable().__rowSpan=e;return this}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e){const t=this.getWritable();t.__headerState=e;return this.__headerState}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const t=this.getWritable();t.__width=e;return this.__width}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){this.getWritable().__backgroundColor=e}toggleHeaderStyle(e){const t=this.getWritable();if((t.__headerState&e)===e){t.__headerState-=e}else{t.__headerState+=e}return t}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==sm.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor}isShadowRoot(){return true}collapseAtStart(){return true}canBeEmpty(){return false}canIndent(){return false}}function lm(e){const t=e;const n=e.nodeName.toLowerCase();let o=undefined;if(om.test(t.style.width)){o=parseFloat(t.style.width)}const r=cm(n==="th"?sm.ROW:sm.NO_STATUS,t.colSpan,o);r.__rowSpan=t.rowSpan;const s=t.style.backgroundColor;if(s!==""){r.__backgroundColor=s}const i=t.style;const l=i.textDecoration.split(" ");const c=i.fontWeight==="700"||i.fontWeight==="bold";const a=l.includes("line-through");const u=i.fontStyle==="italic";const f=l.includes("underline");return{after:e=>{if(e.length===0){e.push(ql())}return e},forChild:(e,t)=>{if(am(t)&&!yc(e)){const t=ql();if(Ec(e)&&e.getTextContent()==="\n"){return null}if(Ac(e)){if(c){e.toggleFormat("bold")}if(a){e.toggleFormat("strikethrough")}if(u){e.toggleFormat("italic")}if(f){e.toggleFormat("underline")}}t.append(e);return t}return e},node:r}}function cm(e,t=1,n){return Jl(new im(e,t,n))}function am(e){return e instanceof im}const um=Qa("INSERT_TABLE_COMMAND");class fm extends la{static getType(){return"tablerow"}static clone(e){return new fm(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:dm,priority:0})}}static importJSON(e){return hm(e.height)}constructor(e,t){super(t);this.__height=e}exportJSON(){return{...super.exportJSON(),...this.getHeight()&&{height:this.getHeight()},type:"tablerow",version:1}}createDOM(e){const t=document.createElement("tr");if(this.__height){t.style.height=`${this.__height}px`}Kd(t,e.theme.tableRow);return t}isShadowRoot(){return true}setHeight(e){const t=this.getWritable();t.__height=e;return this.__height}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return false}canIndent(){return false}}function dm(e){const t=e;let n=undefined;if(om.test(t.style.height)){n=parseFloat(t.style.height)}return{node:hm(n)}}function hm(e){return Jl(new fm(e))}function gm(e){return e instanceof fm}const _m=typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof window.document.createElement!=="undefined";function pm(e,t,n=true){const o=xN();for(let r=0;r<e;r++){const e=hm();for(let o=0;o<t;o++){let t=sm.NO_STATUS;if(typeof n==="object"){if(r===0&&n.rows){t|=sm.ROW}if(o===0&&n.columns){t|=sm.COLUMN}}else if(n){if(r===0){t|=sm.ROW}if(o===0){t|=sm.COLUMN}}const s=cm(t);const i=ql();i.append(nc());s.append(i);e.append(s)}o.append(e)}return o}function mm(e){const t=yd(e,(e=>am(e)));if(am(t)){return t}return null}function Nm(e){const t=yd(e,(e=>gm(e)));if(gm(t)){return t}throw new Error("Expected table cell to be inside of table row.")}function ym(e){const t=yd(e,(e=>bN(e)));if(bN(t)){return t}throw new Error("Expected table cell to be inside of table.")}function Cm(e){const t=Nm(e);const n=ym(t);return n.getChildren().findIndex((e=>e.is(t)))}function Tm(e){const t=Nm(e);return t.getChildren().findIndex((t=>t.is(e)))}function Em(e,t){const n=ym(e);const{x:o,y:r}=n.getCordsFromCellNode(e,t);return{above:n.getCellNodeFromCords(o,r-1,t),below:n.getCellNodeFromCords(o,r+1,t),left:n.getCellNodeFromCords(o-1,r,t),right:n.getCellNodeFromCords(o+1,r,t)}}function Sm(e,t){const n=e.getChildren();if(t>=n.length||t<0){throw new Error("Expected table cell to be inside of table row.")}const o=n[t];o.remove();return e}function wm(e,t,n=true,o,r){const s=e.getChildren();if(t>=s.length||t<0){throw new Error("Table row target index out of range")}const i=s[t];if(gm(i)){for(let e=0;e<o;e++){const e=i.getChildren();const t=e.length;const o=hm();for(let n=0;n<t;n++){const t=e[n];if(!am(t)){throw Error(`Expected table cell`)}const{above:s,below:i}=Em(t,r);let l=sm.NO_STATUS;const c=s&&s.getWidth()||i&&i.getWidth()||undefined;if(s&&s.hasHeaderState(sm.COLUMN)||i&&i.hasHeaderState(sm.COLUMN)){l|=sm.COLUMN}const a=cm(l,1,c);a.append(ql());o.append(a)}if(n){i.insertAfter(o)}else{i.insertBefore(o)}}}else{throw new Error("Row before insertion index does not exist.")}return e}const xm=(e,t)=>{if(e===sm.BOTH||e===t){return t}return sm.NO_STATUS};function bm(e=true){const t=dc();if(!(xc(t)||Bm(t))){throw Error(`Expected a RangeSelection or TableSelection`)}const n=t.focus.getNode();const[o,,r]=$m(n);const[s,i]=Lm(r,o,o);const l=s[0].length;const{startRow:c}=i;if(e){const e=c+o.__rowSpan-1;const t=s[e];const n=hm();for(let o=0;o<l;o++){const{cell:r,startRow:s}=t[o];if(s+r.__rowSpan-1<=e){const e=t[o].cell;const r=e.__headerState;const s=xm(r,sm.COLUMN);n.append(cm(s).append(ql()))}else{r.setRowSpan(r.__rowSpan+1)}}const i=r.getChildAtIndex(e);if(!gm(i)){throw Error(`focusEndRow is not a TableRowNode`)}i.insertAfter(n)}else{const e=s[c];const t=hm();for(let n=0;n<l;n++){const{cell:o,startRow:r}=e[n];if(r===c){const o=e[n].cell;const r=o.__headerState;const s=xm(r,sm.COLUMN);t.append(cm(s).append(ql()))}else{o.setRowSpan(o.__rowSpan+1)}}const n=r.getChildAtIndex(c);if(!gm(n)){throw Error(`focusEndRow is not a TableRowNode`)}n.insertBefore(t)}}function Om(e,t,n=true,o,r){const s=e.getChildren();const i=[];for(let e=0;e<s.length;e++){const n=s[e];if(gm(n)){for(let e=0;e<o;e++){const e=n.getChildren();if(t>=e.length||t<0){throw new Error("Table column target index out of range")}const o=e[t];if(!am(o)){throw Error(`Expected table cell`)}const{left:s,right:l}=Em(o,r);let c=sm.NO_STATUS;if(s&&s.hasHeaderState(sm.ROW)||l&&l.hasHeaderState(sm.ROW)){c|=sm.ROW}const a=cm(c);a.append(ql());i.push({newTableCell:a,targetCell:o})}}}i.forEach((({newTableCell:e,targetCell:t})=>{if(n){t.insertAfter(e)}else{t.insertBefore(e)}}));return e}function Mm(e=true){const t=dc();if(!(xc(t)||Bm(t))){throw Error(`Expected a RangeSelection or TableSelection`)}const n=t.anchor.getNode();const o=t.focus.getNode();const[r]=$m(n);const[s,,i]=$m(o);const[l,c,a]=Lm(i,s,r);const u=l.length;const f=e?Math.max(c.startColumn,a.startColumn):Math.min(c.startColumn,a.startColumn);const d=e?f+s.__colSpan-1:f-1;const h=i.getFirstChild();if(!gm(h)){throw Error(`Expected firstTable child to be a row`)}let g=null;function _(e=sm.NO_STATUS){const t=cm(e).append(ql());if(g===null){g=t}return t}let p=h;e:for(let e=0;e<u;e++){if(e!==0){const e=p.getNextSibling();if(!gm(e)){throw Error(`Expected row nextSibling to be a row`)}p=e}const t=l[e];const n=t[d<0?0:d].cell.__headerState;const o=xm(n,sm.ROW);if(d<0){km(p,_(o));continue}const{cell:r,startColumn:s,startRow:i}=t[d];if(s+r.__colSpan-1<=d){let n=r;let s=i;let l=d;while(s!==e&&n.__rowSpan>1){l-=r.__colSpan;if(l>=0){const{cell:e,startRow:o}=t[l];n=e;s=o}else{p.append(_(o));continue e}}n.insertAfter(_(o))}else{r.setColSpan(r.__colSpan+1)}}if(g!==null){Rm(g)}}function Am(e,t){const n=e.getChildren();for(let e=0;e<n.length;e++){const o=n[e];if(gm(o)){const e=o.getChildren();if(t>=e.length||t<0){throw new Error("Table column target index out of range")}e[t].remove()}}return e}function Dm(){const e=dc();if(!(xc(e)||Bm(e))){throw Error(`Expected a RangeSelection or TableSelection`)}const t=e.anchor.getNode();const n=e.focus.getNode();const[o,,r]=$m(t);const[s]=$m(n);const[i,l,c]=Lm(r,o,s);const{startRow:a}=l;const{startRow:u}=c;const f=u+s.__rowSpan-1;if(i.length===f-a+1){r.remove();return}const d=i[0].length;const h=i[f+1];const g=r.getChildAtIndex(f+1);for(let e=f;e>=a;e--){for(let t=d-1;t>=0;t--){const{cell:n,startRow:o,startColumn:r}=i[e][t];if(r!==t){continue}if(e===a&&o<a){n.setRowSpan(n.__rowSpan-(o-a))}if(o>=a&&o+n.__rowSpan-1>f){n.setRowSpan(n.__rowSpan-(f-o+1));if(!(g!==null)){throw Error(`Expected nextRowNode not to be null`)}if(t===0){km(g,n)}else{const{cell:e}=h[t-1];e.insertAfter(n)}}}const t=r.getChildAtIndex(e);if(!gm(t)){throw Error(`Expected GridNode childAtIndex(${String(e)}) to be RowNode`)}t.remove()}if(h!==undefined){const{cell:e}=h[0];Rm(e)}else{const e=i[a-1];const{cell:t}=e[0];Rm(t)}}function vm(){const e=dc();if(!(xc(e)||Bm(e))){throw Error(`Expected a RangeSelection or TableSelection`)}const t=e.anchor.getNode();const n=e.focus.getNode();const[o,,r]=$m(t);const[s]=$m(n);const[i,l,c]=Lm(r,o,s);const{startColumn:a}=l;const{startRow:u,startColumn:f}=c;const d=Math.min(a,f);const h=Math.max(a+o.__colSpan-1,f+s.__colSpan-1);const g=h-d+1;const _=i[0].length;if(_===h-d+1){r.selectPrevious();r.remove();return}const p=i.length;for(let e=0;e<p;e++){for(let t=d;t<=h;t++){const{cell:n,startColumn:o}=i[e][t];if(o<d){if(t===d){const e=d-o;n.setColSpan(n.__colSpan-Math.min(g,n.__colSpan-e))}}else if(o+n.__colSpan-1>h){if(t===h){const e=h-o+1;n.setColSpan(n.__colSpan-e)}}else{n.remove()}}}const m=i[u];const N=a>f?m[a+o.__colSpan]:m[f+s.__colSpan];if(N!==undefined){const{cell:e}=N;Rm(e)}else{const e=f<a?m[f-1]:m[a-1];const{cell:t}=e;Rm(t)}}function Rm(e){const t=e.getFirstDescendant();if(t==null){e.selectStart()}else{t.getParentOrThrow().selectStart()}}function km(e,t){const n=e.getFirstChild();if(n!==null){n.insertBefore(t)}else{e.append(t)}}function Im(){const e=dc();if(!(xc(e)||Bm(e))){throw Error(`Expected a RangeSelection or TableSelection`)}const t=e.anchor.getNode();const[n,o,r]=$m(t);const s=n.__colSpan;const i=n.__rowSpan;if(s>1){for(let e=1;e<s;e++){n.insertAfter(cm(sm.NO_STATUS).append(ql()))}n.setColSpan(1)}if(i>1){const[e,t]=Lm(r,n,n);const{startColumn:l,startRow:c}=t;let a;for(let t=1;t<i;t++){const n=c+t;const r=e[n];a=(a||o).getNextSibling();if(!gm(a)){throw Error(`Expected row next sibling to be a row`)}let i=null;for(let e=0;e<l;e++){const t=r[e];const o=t.cell;if(t.startRow===n){i=o}if(o.__colSpan>1){e+=o.__colSpan-1}}if(i===null){for(let e=0;e<s;e++){km(a,cm(sm.NO_STATUS).append(ql()))}}else{for(let e=0;e<s;e++){i.insertAfter(cm(sm.NO_STATUS).append(ql()))}}}n.setRowSpan(1)}}function Lm(e,t,n){const[o,r,s]=Pm(e,t,n);if(!(r!==null)){throw Error(`Anchor not found in Grid`)}if(!(s!==null)){throw Error(`Focus not found in Grid`)}return[o,r,s]}function Pm(e,t,n){const o=[];let r=null;let s=null;function i(e,i,l){const c={cell:l,startColumn:i,startRow:e};const a=l.__rowSpan;const u=l.__colSpan;for(let t=0;t<a;t++){if(o[e+t]===undefined){o[e+t]=[]}for(let n=0;n<u;n++){o[e+t][i+n]=c}}if(t!==null&&t.is(l)){r=c}if(n!==null&&n.is(l)){s=c}}function l(e,t){return o[e]===undefined||o[e][t]===undefined}const c=e.getChildren();for(let e=0;e<c.length;e++){const t=c[e];if(!gm(t)){throw Error(`Expected GridNode children to be TableRowNode`)}const n=t.getChildren();let o=0;for(const t of n){if(!am(t)){throw Error(`Expected TableRowNode children to be TableCellNode`)}while(!l(e,o)){o++}i(e,o,t);o+=t.__colSpan}}return[o,r,s]}function $m(e){let t;if(e instanceof im){t=e}else if("__type"in e){const n=yd(e,am);if(!am(n)){throw Error(`Expected to find a parent TableCellNode`)}t=n}else{const n=yd(e.getNode(),am);if(!am(n)){throw Error(`Expected to find a parent TableCellNode`)}t=n}const n=t.getParent();if(!gm(n)){throw Error(`Expected TableCellNode to have a parent TableRowNode`)}const o=n.getParent();if(!bN(o)){throw Error(`Expected TableRowNode to have a parent GridNode`)}return[t,n,o]}function Fm(e){const[t,,n]=$m(e);const o=n.getChildren();const r=o.length;const s=o[0].getChildren().length;const i=new Array(r);for(let e=0;e<r;e++){i[e]=new Array(s)}for(let e=0;e<r;e++){const n=o[e];const r=n.getChildren();let s=0;for(let n=0;n<r.length;n++){while(i[e][s]){s++}const o=r[n];const l=o.__rowSpan||1;const c=o.__colSpan||1;for(let t=0;t<l;t++){for(let n=0;n<c;n++){i[e+t][s+n]=o}}if(t===o){return{colSpan:c,columnIndex:s,rowIndex:e,rowSpan:l}}s+=c}}return null}class Km{constructor(e,t,n){this.anchor=t;this.focus=n;t._selection=this;n._selection=this;this._cachedNodes=null;this.dirty=false;this.tableKey=e}getStartEndPoints(){return[this.anchor,this.focus]}isBackward(){return this.focus.isBefore(this.anchor)}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Bm(e)){return false}return this.tableKey===e.tableKey&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)}set(e,t,n){this.dirty=true;this.tableKey=e;this.anchor.key=t;this.focus.key=n;this._cachedNodes=null}clone(){return new Km(this.tableKey,this.anchor,this.focus)}isCollapsed(){return false}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.focus.getNode();if(!yc(t)){throw Error(`Expected TableSelection focus to be an ElementNode`)}const n=Rc(t.select(0,t.getChildrenSize()));n.insertNodes(e)}getShape(){const e=cc(this.anchor.key);if(!am(e)){throw Error(`Expected TableSelection anchor to be (or a child of) TableCellNode`)}const t=Fm(e);if(!(t!==null)){throw Error(`getCellRect: expected to find AnchorNode`)}const n=cc(this.focus.key);if(!am(n)){throw Error(`Expected TableSelection focus to be (or a child of) TableCellNode`)}const o=Fm(n);if(!(o!==null)){throw Error(`getCellRect: expected to find focusCellNode`)}const r=Math.min(t.columnIndex,o.columnIndex);const s=Math.max(t.columnIndex,o.columnIndex);const i=Math.min(t.rowIndex,o.rowIndex);const l=Math.max(t.rowIndex,o.rowIndex);return{fromX:Math.min(r,s),fromY:Math.min(i,l),toX:Math.max(r,s),toY:Math.max(i,l)}}getNodes(){const e=this._cachedNodes;if(e!==null){return e}const t=this.anchor.getNode();const n=this.focus.getNode();const o=yd(t,am);const r=yd(n,am);if(!am(o)){throw Error(`Expected TableSelection anchor to be (or a child of) TableCellNode`)}if(!am(r)){throw Error(`Expected TableSelection focus to be (or a child of) TableCellNode`)}const s=o.getParent();if(!gm(s)){throw Error(`Expected anchorCell to have a parent TableRowNode`)}const i=s.getParent();if(!bN(i)){throw Error(`Expected tableNode to have a parent TableNode`)}const l=r.getParents()[1];if(l!==i){if(!i.isParentOf(r)){const e=i.getParent();if(!(e!=null)){throw Error(`Expected gridParent to have a parent`)}this.set(this.tableKey,e.getKey(),r.getKey())}else{const e=l.getParent();if(!(e!=null)){throw Error(`Expected focusCellParent to have a parent`)}this.set(this.tableKey,r.getKey(),e.getKey())}return this.getNodes()}const[c,a,u]=Lm(i,o,r);let f=Math.min(a.startColumn,u.startColumn);let d=Math.min(a.startRow,u.startRow);let h=Math.max(a.startColumn+a.cell.__colSpan-1,u.startColumn+u.cell.__colSpan-1);let g=Math.max(a.startRow+a.cell.__rowSpan-1,u.startRow+u.cell.__rowSpan-1);let _=f;let p=d;let m=f;let N=d;function y(e){const{cell:t,startColumn:n,startRow:o}=e;f=Math.min(f,n);d=Math.min(d,o);h=Math.max(h,n+t.__colSpan-1);g=Math.max(g,o+t.__rowSpan-1)}while(f<_||d<p||h>m||g>N){if(f<_){const e=N-p;const t=_-1;for(let n=0;n<=e;n++){y(c[p+n][t])}_=t}if(d<p){const e=m-_;const t=p-1;for(let n=0;n<=e;n++){y(c[t][_+n])}p=t}if(h>m){const e=N-p;const t=m+1;for(let n=0;n<=e;n++){y(c[p+n][t])}m=t}if(g>N){const e=m-_;const t=N+1;for(let n=0;n<=e;n++){y(c[t][_+n])}N=t}}const C=[i];let T=null;for(let e=d;e<=g;e++){for(let t=f;t<=h;t++){const{cell:n}=c[e][t];const o=n.getParent();if(!gm(o)){throw Error(`Expected TableCellNode parent to be a TableRowNode`)}if(o!==T){C.push(o)}C.push(n,...zm(n));T=o}}if(!ou()){this._cachedNodes=C}return C}getTextContent(){const e=this.getNodes().filter((e=>am(e)));let t="";for(let n=0;n<e.length;n++){const o=e[n];const r=o.__parent;const s=(e[n+1]||{}).__parent;t+=o.getTextContent()+(s!==r?"\n":"\t")}return t}}function Bm(e){return e instanceof Km}function Wm(){const e=Ql("root",0,"element");const t=Ql("root",0,"element");return new Km("root",e,t)}function zm(e){const t=[];const n=[e];while(n.length>0){const o=n.pop();if(!(o!==undefined)){throw Error(`Stack.length > 0; can't be undefined`)}if(yc(o)){n.unshift(...o.getChildren())}if(o!==e){t.push(o)}}return t}class Hm{constructor(e,t){this.isHighlightingCells=false;this.anchorX=-1;this.anchorY=-1;this.focusX=-1;this.focusY=-1;this.listenersToRemove=new Set;this.tableNodeKey=t;this.editor=e;this.table={columns:0,domRows:[],rows:0};this.tableSelection=null;this.anchorCellNodeKey=null;this.focusCellNodeKey=null;this.anchorCell=null;this.focusCell=null;this.hasHijackedSelectionStyles=false;this.trackTable();this.isSelecting=false}getTable(){return this.table}removeListeners(){Array.from(this.listenersToRemove).forEach((e=>e()))}trackTable(){const e=new MutationObserver((e=>{this.editor.update((()=>{let t=false;for(let n=0;n<e.length;n++){const o=e[n];const r=o.target;const s=r.nodeName;if(s==="TABLE"||s==="TBODY"||s==="THEAD"||s==="TR"){t=true;break}}if(!t){return}const n=this.editor.getElementByKey(this.tableNodeKey);if(!n){throw new Error("Expected to find TableElement in DOM")}this.table=qm(n)}))}));this.editor.update((()=>{const t=this.editor.getElementByKey(this.tableNodeKey);if(!t){throw new Error("Expected to find TableElement in DOM")}this.table=qm(t);e.observe(t,{attributes:true,childList:true,subtree:true})}))}clearHighlight(){const e=this.editor;this.isHighlightingCells=false;this.anchorX=-1;this.anchorY=-1;this.focusX=-1;this.focusY=-1;this.tableSelection=null;this.anchorCellNodeKey=null;this.focusCellNodeKey=null;this.anchorCell=null;this.focusCell=null;this.hasHijackedSelectionStyles=false;this.enableHighlightStyle();e.update((()=>{const t=cc(this.tableNodeKey);if(!bN(t)){throw new Error("Expected TableNode.")}const n=e.getElementByKey(this.tableNodeKey);if(!n){throw new Error("Expected to find TableElement in DOM")}const o=qm(n);Qm(e,o,null);Pc(null);e.dispatchCommand(Ya,undefined)}))}enableHighlightStyle(){const e=this.editor;e.update((()=>{const t=e.getElementByKey(this.tableNodeKey);if(!t){throw new Error("Expected to find TableElement in DOM")}Qd(t,e._config.theme.tableSelection);t.classList.remove("disable-selection");this.hasHijackedSelectionStyles=false}))}disableHighlightStyle(){const e=this.editor;e.update((()=>{const t=e.getElementByKey(this.tableNodeKey);if(!t){throw new Error("Expected to find TableElement in DOM")}Kd(t,e._config.theme.tableSelection);this.hasHijackedSelectionStyles=true}))}updateTableTableSelection(e){if(e!==null&&e.tableKey===this.tableNodeKey){const t=this.editor;this.tableSelection=e;this.isHighlightingCells=true;this.disableHighlightStyle();Qm(t,this.table,this.tableSelection)}else if(e==null){this.clearHighlight()}else{this.tableNodeKey=e.tableKey;this.updateTableTableSelection(e)}}setFocusCellForSelection(e,t=false){const n=this.editor;n.update((()=>{const o=cc(this.tableNodeKey);if(!bN(o)){throw new Error("Expected TableNode.")}const r=n.getElementByKey(this.tableNodeKey);if(!r){throw new Error("Expected to find TableElement in DOM")}const s=e.x;const i=e.y;this.focusCell=e;if(this.anchorCell!==null){const e=Ym(n._window);if(e){e.setBaseAndExtent(this.anchorCell.elem,0,this.focusCell.elem,0)}}if(!this.isHighlightingCells&&(this.anchorX!==s||this.anchorY!==i||t)){this.isHighlightingCells=true;this.disableHighlightStyle()}else if(s===this.focusX&&i===this.focusY){return}this.focusX=s;this.focusY=i;if(this.isHighlightingCells){const t=ic(e.elem);if(this.tableSelection!=null&&this.anchorCellNodeKey!=null&&am(t)&&o.is(uN(t))){const e=t.getKey();this.tableSelection=this.tableSelection.clone()||Wm();this.focusCellNodeKey=e;this.tableSelection.set(this.tableNodeKey,this.anchorCellNodeKey,this.focusCellNodeKey);Pc(this.tableSelection);n.dispatchCommand(Ya,undefined);Qm(n,this.table,this.tableSelection)}}}))}setAnchorCellForSelection(e){this.isHighlightingCells=false;this.anchorCell=e;this.anchorX=e.x;this.anchorY=e.y;this.editor.update((()=>{const t=ic(e.elem);if(am(t)){const e=t.getKey();this.tableSelection=this.tableSelection!=null?this.tableSelection.clone():Wm();this.anchorCellNodeKey=e}}))}formatCells(e){this.editor.update((()=>{const t=dc();if(!Bm(t)){{throw Error(`Expected grid selection`)}}const n=Zl();const o=n.anchor;const r=n.focus;t.getNodes().forEach((t=>{if(am(t)&&t.getTextContentSize()!==0){o.set(t.getKey(),0,"element");r.set(t.getKey(),t.getChildrenSize(),"element");n.formatText(e)}}));Pc(t);this.editor.dispatchCommand(Ya,undefined)}))}clearText(){const e=this.editor;e.update((()=>{const t=cc(this.tableNodeKey);if(!bN(t)){throw new Error("Expected TableNode.")}const n=dc();if(!Bm(n)){{throw Error(`Expected grid selection`)}}const o=n.getNodes().filter(am);if(o.length===this.table.columns*this.table.rows){t.selectPrevious();t.remove();const e=fc();e.selectStart();return}o.forEach((e=>{if(yc(e)){const t=ql();const n=nc();t.append(n);e.append(t);e.getChildren().forEach((e=>{if(e!==t){e.remove()}}))}}));Qm(e,this.table,null);Pc(null);e.dispatchCommand(Ya,undefined)}))}}const Um="__lexicalTableSelection";const Ym=e=>_m?(e||window).getSelection():null;const Jm=e=>(e.buttons&1)===1;function jm(e,t,n,o){const r=n.getRootElement();if(r===null){throw new Error("No root element.")}const s=new Hm(n,e.getKey());const i=n._window||window;Gm(t,s);const l=()=>{const e=()=>{s.isSelecting=false;i.removeEventListener("mouseup",e);i.removeEventListener("mousemove",t)};const t=n=>{setTimeout((()=>{if(!Jm(n)&&s.isSelecting){s.isSelecting=false;i.removeEventListener("mouseup",e);i.removeEventListener("mousemove",t);return}const o=Vm(n.target);if(o!==null&&(s.anchorX!==o.x||s.anchorY!==o.y)){n.preventDefault();s.setFocusCellForSelection(o)}}),0)};return{onMouseMove:t,onMouseUp:e}};t.addEventListener("mousedown",(e=>{setTimeout((()=>{if(e.button!==0){return}if(!i){return}const t=Vm(e.target);if(t!==null){dN(e);s.setAnchorCellForSelection(t)}const{onMouseUp:n,onMouseMove:o}=l();s.isSelecting=true;i.addEventListener("mouseup",n);i.addEventListener("mousemove",o)}),0)}));const c=e=>{if(e.button!==0){return}n.update((()=>{const t=dc();const n=e.target;if(Bm(t)&&t.tableKey===s.tableNodeKey&&r.contains(n)){s.clearHighlight()}}))};i.addEventListener("mousedown",c);s.listenersToRemove.add((()=>i.removeEventListener("mousedown",c)));s.listenersToRemove.add(n.registerCommand(wa,(t=>fN(n,t,"down",e,s)),jc));s.listenersToRemove.add(n.registerCommand(Oa,(t=>fN(n,t,"up",e,s)),jc));s.listenersToRemove.add(n.registerCommand(xa,(t=>fN(n,t,"backward",e,s)),jc));s.listenersToRemove.add(n.registerCommand(ba,(t=>fN(n,t,"forward",e,s)),jc));s.listenersToRemove.add(n.registerCommand(Ra,(e=>{const t=dc();if(Bm(t)){const n=yd(t.focus.getNode(),am);if(am(n)){dN(e);n.selectEnd();return true}}return false}),jc));const a=t=>()=>{const n=dc();if(!rN(n,e)){return false}if(Bm(n)){s.clearText();return true}else if(xc(n)){const o=yd(n.anchor.getNode(),(e=>am(e)));if(!am(o)){return false}const r=n.anchor.getNode();const i=n.focus.getNode();const l=e.isParentOf(r);const c=e.isParentOf(i);const a=l&&!c||c&&!l;if(a){s.clearText();return true}const u=yd(n.anchor.getNode(),(e=>yc(e)));const f=u&&yd(u,(e=>yc(e)&&am(e.getParent())));if(!yc(f)||!yc(u)){return false}if(t===ea&&f.getPreviousSibling()===null){return true}}return false};[ta,ea,Zc].forEach((e=>{s.listenersToRemove.add(n.registerCommand(e,a(e),Yc))}));const u=t=>{const n=dc();if(!rN(n,e)){const e=n?n.getNodes():null;if(e){const t=e.find((e=>bN(e)&&e.getKey()===s.tableNodeKey));if(bN(t)){const e=t.getParent();if(!e){return false}t.remove()}}return false}if(Bm(n)){if(t){t.preventDefault();t.stopPropagation()}s.clearText();return true}else if(xc(n)){const e=yd(n.anchor.getNode(),(e=>am(e)));if(!am(e)){return false}}return false};s.listenersToRemove.add(n.registerCommand(Ma,u,Yc));s.listenersToRemove.add(n.registerCommand(Aa,u,Yc));s.listenersToRemove.add(n.registerCommand(Qc,(e=>{const t=dc();if(t){if(!(Bm(t)||xc(t))){return false}void E_(n,Xd(e,ClipboardEvent)?e:null,p_(t));const o=u(e);if(xc(t)){t.removeText()}return o}return false}),Yc));s.listenersToRemove.add(n.registerCommand(ua,(t=>{const n=dc();if(!rN(n,e)){return false}if(Bm(n)){s.formatCells(t);return true}else if(xc(n)){const e=yd(n.anchor.getNode(),(e=>am(e)));if(!am(e)){return false}}return false}),Yc));s.listenersToRemove.add(n.registerCommand(aa,(t=>{const n=dc();if(!Bm(n)||!rN(n,e)){return false}const o=n.anchor.getNode();const r=n.focus.getNode();if(!am(o)||!am(r)){return false}const[s,i,l]=Lm(e,o,r);const c=Math.max(i.startRow,l.startRow);const a=Math.max(i.startColumn,l.startColumn);const u=Math.min(i.startRow,l.startRow);const f=Math.min(i.startColumn,l.startColumn);for(let e=u;e<=c;e++){for(let n=f;n<=a;n++){const o=s[e][n].cell;o.setFormat(t);const r=o.getChildren();for(let e=0;e<r.length;e++){const n=r[e];if(yc(n)&&!n.isInline()){n.setFormat(t)}}}}return true}),Yc));s.listenersToRemove.add(n.registerCommand(Vc,(t=>{const o=dc();if(!rN(o,e)){return false}if(Bm(o)){s.clearHighlight();return false}else if(xc(o)){const r=yd(o.anchor.getNode(),(e=>am(e)));if(!am(r)){return false}if(typeof t==="string"){const r=TN(n,o,e);if(r){CN(r,e,[nc(t)]);return true}}}return false}),Yc));if(o){s.listenersToRemove.add(n.registerCommand(La,(t=>{const n=dc();if(!xc(n)||!n.isCollapsed()||!rN(n,e)){return false}const o=aN(n.anchor.getNode());if(o===null){return false}dN(t);const r=e.getCordsFromCellNode(o,s.table);nN(s,e,r.x,r.y,!t.shiftKey?"forward":"backward");return true}),Yc))}s.listenersToRemove.add(n.registerCommand(ca,(t=>e.isSelected()),jc));function f(t){const n=e.getCordsFromCellNode(t,s.table);return e.getDOMCellFromCordsOrThrow(n.x,n.y,s.table)}s.listenersToRemove.add(n.registerCommand(Ja,(e=>{const{nodes:t,selection:n}=e;const o=n.getStartEndPoints();const r=Bm(n);const s=xc(n);const i=s&&yd(n.anchor.getNode(),(e=>am(e)))!==null&&yd(n.focus.getNode(),(e=>am(e)))!==null||r;if(t.length!==1||!bN(t[0])||!i||o===null){return false}const[l]=o;const c=t[0];const a=c.getChildren();const u=c.getFirstChildOrThrow().getChildrenSize();const f=c.getChildrenSize();const d=yd(l.getNode(),(e=>am(e)));const h=d&&yd(d,(e=>gm(e)));const g=h&&yd(h,(e=>bN(e)));if(!am(d)||!gm(h)||!bN(g)){return false}const _=h.getIndexWithinParent();const p=Math.min(g.getChildrenSize()-1,_+f-1);const m=d.getIndexWithinParent();const N=Math.min(h.getChildrenSize()-1,m+u-1);const y=Math.min(m,N);const C=Math.min(_,p);const T=Math.max(m,N);const E=Math.max(_,p);const S=g.getChildren();let w=0;for(let e=C;e<=E;e++){const t=S[e];if(!gm(t)){return false}const n=a[w];if(!gm(n)){return false}const o=t.getChildren();const r=n.getChildren();let s=0;for(let e=y;e<=T;e++){const t=o[e];if(!am(t)){return false}const n=r[s];if(!am(n)){return false}const i=t.getChildren();n.getChildren().forEach((e=>{if(Ac(e)){const n=ql();n.append(e);t.append(e)}else{t.append(e)}}));i.forEach((e=>e.remove()));s++}w++}return true}),Yc));s.listenersToRemove.add(n.registerCommand(Ya,(()=>{const t=dc();const o=uc();if(xc(t)){const{anchor:o,focus:r}=t;const c=o.getNode();const a=r.getNode();const u=aN(c);const d=aN(a);const h=!!(u&&e.is(uN(u)));const g=!!(d&&e.is(uN(d)));const _=h!==g;const p=h&&g;const m=t.isBackward();if(_){const o=t.clone();if(g){const[t]=Lm(e,d,d);const n=t[0][0].cell;const r=t[t.length-1].at(-1).cell;o.focus.set(m?n.getKey():r.getKey(),m?n.getChildrenSize():r.getChildrenSize(),"element")}Pc(o);eN(n,s)}else if(p){if(!u.is(d)){s.setAnchorCellForSelection(f(u));s.setFocusCellForSelection(f(d),true);if(!s.isSelecting){setTimeout((()=>{const{onMouseUp:e,onMouseMove:t}=l();s.isSelecting=true;i.addEventListener("mouseup",e);i.addEventListener("mousemove",t)}),0)}}}}else if(t&&Bm(t)&&t.is(o)&&t.tableKey===e.getKey()){const o=Ym(n._window);if(o&&o.anchorNode&&o.focusNode){const r=ic(o.focusNode);const s=r&&!e.is(uN(r));const i=ic(o.anchorNode);const l=i&&e.is(uN(i));if(s&&l&&o.rangeCount>0){const r=ec(o,n);if(r){r.anchor.set(e.getKey(),t.isBackward()?e.getChildrenSize():0,"element");o.removeAllRanges();Pc(r)}}}}if(t&&!t.is(o)&&(Bm(t)||Bm(o))&&s.tableSelection&&!s.tableSelection.is(o)){if(Bm(t)&&t.tableKey===s.tableNodeKey){s.updateTableTableSelection(t)}else if(!Bm(t)&&Bm(o)&&o.tableKey===s.tableNodeKey){s.updateTableTableSelection(null)}return false}if(s.hasHijackedSelectionStyles&&!e.isSelected()){tN(n,s)}else if(!s.hasHijackedSelectionStyles&&e.isSelected()){eN(n,s)}return false}),Yc));s.listenersToRemove.add(n.registerCommand(ha,(()=>{const t=dc();if(!xc(t)||!t.isCollapsed()||!rN(t,e)){return false}const o=TN(n,t,e);if(o){CN(o,e);return true}return false}),Yc));return s}function Gm(e,t){e[Um]=t}function Xm(e){return e[Um]}function Vm(e){let t=e;while(t!=null){const e=t.nodeName;if(e==="TD"||e==="TH"){const e=t._cell;if(e===undefined){return null}return e}t=t.parentNode}return null}function qm(e){const t=[];const n={columns:0,domRows:t,rows:0};let o=e.firstChild;let r=0;let s=0;t.length=0;while(o!=null){const e=o.nodeName;if(e==="TD"||e==="TH"){const e=o;const n={elem:e,hasBackgroundColor:e.style.backgroundColor!=="",highlighted:false,x:r,y:s};o._cell=n;let i=t[s];if(i===undefined){i=t[s]=[]}i[r]=n}else{const e=o.firstChild;if(e!=null){o=e;continue}}const n=o.nextSibling;if(n!=null){r++;o=n;continue}const i=o.parentNode;if(i!=null){const e=i.nextSibling;if(e==null){break}s++;r=0;o=e}}n.columns=r+1;n.rows=s+1;return n}function Qm(e,t,n){const o=new Set(n?n.getNodes():[]);Zm(t,((t,n)=>{const r=t.elem;if(o.has(n)){t.highlighted=true;lN(e,t)}else{t.highlighted=false;cN(e,t);if(!r.getAttribute("style")){r.removeAttribute("style")}}}))}function Zm(e,t){const{domRows:n}=e;for(let e=0;e<n.length;e++){const o=n[e];if(!o){continue}for(let n=0;n<o.length;n++){const r=o[n];if(!r){continue}const s=ic(r.elem);if(s!==null){t(r,s,{x:n,y:e})}}}}function eN(e,t){t.disableHighlightStyle();Zm(t.table,(t=>{t.highlighted=true;lN(e,t)}))}function tN(e,t){t.enableHighlightStyle();Zm(t.table,(t=>{const n=t.elem;t.highlighted=false;cN(e,t);if(!n.getAttribute("style")){n.removeAttribute("style")}}))}const nN=(e,t,n,o,r)=>{const s=r==="forward";switch(r){case"backward":case"forward":if(n!==(s?e.table.columns-1:0)){sN(t.getCellNodeFromCordsOrThrow(n+(s?1:-1),o,e.table),s)}else{if(o!==(s?e.table.rows-1:0)){sN(t.getCellNodeFromCordsOrThrow(s?0:e.table.columns-1,o+(s?1:-1),e.table),s)}else if(!s){t.selectPrevious()}else{t.selectNext()}}return true;case"up":if(o!==0){sN(t.getCellNodeFromCordsOrThrow(n,o-1,e.table),false)}else{t.selectPrevious()}return true;case"down":if(o!==e.table.rows-1){sN(t.getCellNodeFromCordsOrThrow(n,o+1,e.table),true)}else{t.selectNext()}return true;default:return false}};const oN=(e,t,n,o,r)=>{const s=r==="forward";switch(r){case"backward":case"forward":if(n!==(s?e.table.columns-1:0)){e.setFocusCellForSelection(t.getDOMCellFromCordsOrThrow(n+(s?1:-1),o,e.table))}return true;case"up":if(o!==0){e.setFocusCellForSelection(t.getDOMCellFromCordsOrThrow(n,o-1,e.table));return true}else{return false}case"down":if(o!==e.table.rows-1){e.setFocusCellForSelection(t.getDOMCellFromCordsOrThrow(n,o+1,e.table));return true}else{return false}default:return false}};function rN(e,t){if(xc(e)||Bm(e)){const n=t.isParentOf(e.anchor.getNode());const o=t.isParentOf(e.focus.getNode());return n&&o}return false}function sN(e,t){if(t){e.selectStart()}else{e.selectEnd()}}const iN="172,206,247";function lN(e,t){const n=t.elem;const o=ic(n);if(!am(o)){throw Error(`Expected to find LexicalNode from Table Cell DOMNode`)}const r=o.getBackgroundColor();if(r===null){n.style.setProperty("background-color",`rgb(${iN})`)}else{n.style.setProperty("background-image",`linear-gradient(to right, rgba(${iN},0.85), rgba(${iN},0.85))`)}n.style.setProperty("caret-color","transparent")}function cN(e,t){const n=t.elem;const o=ic(n);if(!am(o)){throw Error(`Expected to find LexicalNode from Table Cell DOMNode`)}const r=o.getBackgroundColor();if(r===null){n.style.removeProperty("background-color")}n.style.removeProperty("background-image");n.style.removeProperty("caret-color")}function aN(e){const t=yd(e,am);return am(t)?t:null}function uN(e){const t=yd(e,bN);return bN(t)?t:null}function fN(e,t,n,o,r){if((n==="up"||n==="down")&&hN(e)){return false}const s=dc();if(!rN(s,o)){if(xc(s)){if(s.isCollapsed()&&n==="backward"){const e=s.anchor.type;const n=s.anchor.offset;if(e!=="element"&&!(e==="text"&&n===0)){return false}const o=s.anchor.getNode();if(!o){return false}const r=yd(o,(e=>yc(e)&&!e.isInline()));if(!r){return false}const i=r.getPreviousSibling();if(!i||!bN(i)){return false}dN(t);i.selectEnd();return true}else if(t.shiftKey&&(n==="up"||n==="down")){const e=s.focus.getNode();if(Oc(e)){const e=s.getNodes()[0];if(e){const t=yd(e,am);if(t&&o.isParentOf(t)){const e=o.getFirstDescendant();const t=o.getLastDescendant();if(!e||!t){return false}const[n]=$m(e);const[s]=$m(t);const i=o.getCordsFromCellNode(n,r.table);const l=o.getCordsFromCellNode(s,r.table);const c=o.getDOMCellFromCordsOrThrow(i.x,i.y,r.table);const a=o.getDOMCellFromCordsOrThrow(l.x,l.y,r.table);r.setAnchorCellForSelection(c);r.setFocusCellForSelection(a,true);return true}}return false}else{const t=yd(e,(e=>yc(e)&&!e.isInline()));if(!t){return false}const o=n==="down"?t.getNextSibling():t.getPreviousSibling();if(bN(o)&&r.tableNodeKey===o.getKey()){const e=o.getFirstDescendant();const t=o.getLastDescendant();if(!e||!t){return false}const[r]=$m(e);const[i]=$m(t);const l=s.clone();l.focus.set((n==="up"?r:i).getKey(),n==="up"?0:i.getChildrenSize(),"element");Pc(l);return true}}}}return false}if(xc(s)&&s.isCollapsed()){const{anchor:i,focus:l}=s;const c=yd(i.getNode(),am);const a=yd(l.getNode(),am);if(!am(c)||!c.is(a)){return false}const u=uN(c);if(u!==o&&u!=null){const o=e.getElementByKey(u.getKey());if(o!=null){r.table=qm(o);return fN(e,t,n,u,r)}}if(n==="backward"||n==="forward"){const e=i.type;const r=i.offset;const l=i.getNode();if(!l){return false}const c=s.getNodes();if(c.length===1&&Nc(c[0])){return false}if(gN(e,r,l,n)){return mN(t,l,o,n)}return false}const f=e.getElementByKey(c.__key);const d=e.getElementByKey(i.key);if(d==null||f==null){return false}let h;if(i.type==="element"){h=d.getBoundingClientRect()}else{const e=window.getSelection();if(e===null||e.rangeCount===0){return false}const t=e.getRangeAt(0);h=t.getBoundingClientRect()}const g=n==="up"?c.getFirstChild():c.getLastChild();if(g==null){return false}const _=e.getElementByKey(g.__key);if(_==null){return false}const p=_.getBoundingClientRect();const m=n==="up"?p.top>h.top-h.height:h.bottom+h.height>p.bottom;if(m){dN(t);const e=o.getCordsFromCellNode(c,r.table);if(t.shiftKey){const t=o.getDOMCellFromCordsOrThrow(e.x,e.y,r.table);r.setAnchorCellForSelection(t);r.setFocusCellForSelection(t,true)}else{return nN(r,o,e.x,e.y,n)}return true}}else if(Bm(s)){const{anchor:i,focus:l}=s;const c=yd(i.getNode(),am);const a=yd(l.getNode(),am);const[u]=s.getNodes();const f=e.getElementByKey(u.getKey());if(!am(c)||!am(a)||!bN(u)||f==null){return false}r.updateTableTableSelection(s);const d=qm(f);const h=o.getCordsFromCellNode(c,d);const g=o.getDOMCellFromCordsOrThrow(h.x,h.y,d);r.setAnchorCellForSelection(g);dN(t);if(t.shiftKey){const e=o.getCordsFromCellNode(a,d);return oN(r,u,e.x,e.y,n)}else{a.selectEnd()}return true}return false}function dN(e){e.preventDefault();e.stopImmediatePropagation();e.stopPropagation()}function hN(e){const t=e.getRootElement();if(!t){return false}return t.hasAttribute("aria-controls")&&t.getAttribute("aria-controls")==="typeahead-menu"}function gN(e,t,n,o){return _N(e,n,o)||pN(e,t,n,o)}function _N(e,t,n){return e==="element"&&(n==="backward"?t.getPreviousSibling()===null:t.getNextSibling()===null)}function pN(e,t,n,o){const r=yd(n,(e=>yc(e)&&!e.isInline()));if(!r){return false}const s=o==="backward"?t===0:t===n.getTextContentSize();return e==="text"&&s&&(o==="backward"?r.getPreviousSibling()===null:r.getNextSibling()===null)}function mN(e,t,n,o){const r=yd(t,am);if(!am(r)){return false}const[s,i]=Lm(n,r,r);if(!NN(s,i,o)){return false}const l=yN(t,o,n);if(!l||bN(l)){return false}dN(e);if(o==="backward"){l.selectEnd()}else{l.selectStart()}return true}function NN(e,t,n){const o=e[0][0];const r=e[e.length-1][e[0].length-1];const{startColumn:s,startRow:i}=t;return n==="backward"?s===o.startColumn&&i===o.startRow:s===r.startColumn&&i===r.startRow}function yN(e,t,n){const o=yd(e,(e=>yc(e)&&!e.isInline()));if(!o){return undefined}const r=t==="backward"?o.getPreviousSibling():o.getNextSibling();return r&&bN(r)?r:t==="backward"?n.getPreviousSibling():n.getNextSibling()}function CN(e,t,n){const o=ql();if(e==="first"){t.insertBefore(o)}else{t.insertAfter(o)}o.append(...n||[]);o.selectEnd()}function TN(e,t,n){const o=n.getParent();if(!o){return undefined}const r=e.getElementByKey(o.getKey());if(!r){return undefined}const s=window.getSelection();if(!s||s.anchorNode!==r){return undefined}const i=yd(t.anchor.getNode(),(e=>am(e)));if(!i){return undefined}const l=yd(i,(e=>bN(e)));if(!bN(l)||!l.is(n)){return undefined}const[c,a]=Lm(n,i,i);const u=c[0][0];const f=c[c.length-1][c[0].length-1];const{startRow:d,startColumn:h}=a;const g=d===u.startRow&&h===u.startColumn;const _=d===f.startRow&&h===f.startColumn;if(g){return"first"}else if(_){return"last"}else{return undefined}}class EN extends la{static getType(){return"table"}static clone(e){return new EN(e.__key)}static importDOM(){return{table:e=>({conversion:wN,priority:1})}}static importJSON(e){return xN()}constructor(e){super(e)}exportJSON(){return{...super.exportJSON(),type:"table",version:1}}createDOM(e,t){const n=document.createElement("table");Kd(n,e.theme.table);return n}updateDOM(){return false}exportDOM(e){return{...super.exportDOM(e),after:e=>{if(e){const t=e.cloneNode();const n=document.createElement("colgroup");const o=document.createElement("tbody");if(Hd(e)){o.append(...e.children)}const r=this.getFirstChildOrThrow();if(!gm(r)){throw new Error("Expected to find row node.")}const s=r.getChildrenSize();for(let e=0;e<s;e++){const e=document.createElement("col");n.append(e)}t.replaceChildren(n,o);return t}}}}canBeEmpty(){return false}isShadowRoot(){return true}getCordsFromCellNode(e,t){const{rows:n,domRows:o}=t;for(let t=0;t<n;t++){const n=o[t];if(n==null){continue}const r=n.findIndex((t=>{if(!t){return}const{elem:n}=t;const o=ic(n);return o===e}));if(r!==-1){return{x:r,y:t}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,t,n){const{domRows:o}=n;const r=o[t];if(r==null){return null}const s=e<r.length?e:r.length-1;const i=r[s];if(i==null){return null}return i}getDOMCellFromCordsOrThrow(e,t,n){const o=this.getDOMCellFromCords(e,t,n);if(!o){throw new Error("Cell not found at cords.")}return o}getCellNodeFromCords(e,t,n){const o=this.getDOMCellFromCords(e,t,n);if(o==null){return null}const r=ic(o.elem);if(am(r)){return r}return null}getCellNodeFromCordsOrThrow(e,t,n){const o=this.getCellNodeFromCords(e,t,n);if(!o){throw new Error("Node at cords not TableCellNode.")}return o}canSelectBefore(){return true}canIndent(){return false}}function SN(e,t){const n=e.getElementByKey(t.getKey());if(n==null){throw new Error("Table Element Not Found")}return qm(n)}function wN(e){return{node:xN()}}function xN(){return Jl(new EN)}function bN(e){return e instanceof EN}var ON=Object.freeze({$computeTableMap:Lm,$computeTableMapSkipCellCheck:Pm,$createTableCellNode:cm,$createTableNode:xN,$createTableNodeWithDimensions:pm,$createTableRowNode:hm,$createTableSelection:Wm,$deleteTableColumn:Am,$deleteTableColumn__EXPERIMENTAL:vm,$deleteTableRow__EXPERIMENTAL:Dm,$findCellNode:aN,$findTableNode:uN,$getElementForTableNode:SN,$getNodeTriplet:$m,$getTableCellNodeFromLexicalNode:mm,$getTableCellNodeRect:Fm,$getTableColumnIndexFromTableCellNode:Tm,$getTableNodeFromLexicalNodeOrThrow:ym,$getTableRowIndexFromTableCellNode:Cm,$getTableRowNodeFromTableCellNodeOrThrow:Nm,$insertTableColumn:Om,$insertTableColumn__EXPERIMENTAL:Mm,$insertTableRow:wm,$insertTableRow__EXPERIMENTAL:bm,$isTableCellNode:am,$isTableNode:bN,$isTableRowNode:gm,$isTableSelection:Bm,$removeTableRowAtIndex:Sm,$unmergeCell:Im,INSERT_TABLE_COMMAND:um,TableCellHeaderStates:sm,TableCellNode:im,TableNode:EN,TableObserver:Hm,TableRowNode:fm,applyTableHandlers:jm,getDOMCellFromTarget:Vm,getTableObserverFromTableElement:Xm});const MN=Qa("INSERT_TABLE_COMMAND");function AN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var DN=AN((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));const vN="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;const RN=ON;const kN=RN.$computeTableMap;const IN=RN.$computeTableMapSkipCellCheck;const LN=RN.$createTableCellNode;const PN=RN.$createTableNode;const $N=RN.$createTableNodeWithDimensions;const FN=RN.$createTableRowNode;const KN=RN.$createTableSelection;const BN=RN.$deleteTableColumn;const WN=RN.$deleteTableColumn__EXPERIMENTAL;const zN=RN.$deleteTableRow__EXPERIMENTAL;const HN=RN.$findCellNode;const UN=RN.$findTableNode;const YN=RN.$getElementForTableNode;const JN=RN.$getNodeTriplet;const jN=RN.$getTableCellNodeFromLexicalNode;const GN=RN.$getTableCellNodeRect;const XN=RN.$getTableColumnIndexFromTableCellNode;const VN=RN.$getTableNodeFromLexicalNodeOrThrow;const qN=RN.$getTableRowIndexFromTableCellNode;const QN=RN.$getTableRowNodeFromTableCellNodeOrThrow;const ZN=RN.$insertTableColumn;const ey=RN.$insertTableColumn__EXPERIMENTAL;const ty=RN.$insertTableRow;const ny=RN.$insertTableRow__EXPERIMENTAL;const oy=RN.$isTableCellNode;const ry=RN.$isTableNode;const sy=RN.$isTableRowNode;const iy=RN.$isTableSelection;const ly=RN.$removeTableRowAtIndex;const cy=RN.$unmergeCell;const ay=RN.INSERT_TABLE_COMMAND;const uy=RN.TableCellHeaderStates;const fy=RN.TableCellNode;const dy=RN.TableNode;const hy=RN.TableObserver;const gy=RN.TableRowNode;const _y=RN.applyTableHandlers;const py=RN.getDOMCellFromTarget;const my=RN.getTableObserverFromTableElement;var Ny=Object.freeze({$computeTableMap:kN,$computeTableMapSkipCellCheck:IN,$createTableCellNode:LN,$createTableNode:PN,$createTableNodeWithDimensions:$N,$createTableRowNode:FN,$createTableSelection:KN,$deleteTableColumn:BN,$deleteTableColumn__EXPERIMENTAL:WN,$deleteTableRow__EXPERIMENTAL:zN,$findCellNode:HN,$findTableNode:UN,$getElementForTableNode:YN,$getNodeTriplet:JN,$getTableCellNodeFromLexicalNode:jN,$getTableCellNodeRect:GN,$getTableColumnIndexFromTableCellNode:XN,$getTableNodeFromLexicalNodeOrThrow:VN,$getTableRowIndexFromTableCellNode:qN,$getTableRowNodeFromTableCellNodeOrThrow:QN,$insertTableColumn:ZN,$insertTableColumn__EXPERIMENTAL:ey,$insertTableRow:ty,$insertTableRow__EXPERIMENTAL:ny,$isTableCellNode:oy,$isTableNode:ry,$isTableRowNode:sy,$isTableSelection:iy,$removeTableRowAtIndex:ly,$unmergeCell:cy,INSERT_TABLE_COMMAND:ay,TableCellHeaderStates:uy,TableCellNode:fy,TableNode:dy,TableObserver:hy,TableRowNode:gy,applyTableHandlers:_y,getDOMCellFromTarget:py,getTableObserverFromTableElement:my});e.Core=fu;e.Html=hh;e.List=yg;e.Link=Ug;e.Clipboard=w_;e.Selection=uf;e.History=J_;e.Utils=Zd;e.Text=fp;e.RichText=nm;e.Table=Ny})(this.BX.UI.Lexical=this.BX.UI.Lexical||{});
//# sourceMappingURL=lexical.dev.bundle.map.js