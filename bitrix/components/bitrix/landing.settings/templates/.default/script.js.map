{"version":3,"file":"script.js","sources":["src/js/index.js"],"sourcesContent":["import {Event, ajax as Ajax, Tag, Dom} from 'main.core';\nimport {Loader} from \"main.loader\";\n\ntype PageOption = {\n\tpage: string,\n\tname: string,\n\tlink: ?string,\n\tlinkToSave: ?string,\n\tcurrent: ?boolean,\n\tcontainer: ?HTMLDivElement,\n\tform: ?HTMLFormElement,\n}\n\nexport class LandingSettings\n{\n\tstatic PAGE_LINK_SELECTOR = 'a[data-page], a[data-placement]';\n\n\tsiteId: number;\n\tlandingId: number;\n\tpages: {\n\t\t[code: string]: PageOption\n\t};\n\tcurrentPage: PageOption;\n\tmenu: HTMLDivElement;\n\tcontainer: HTMLDivElement;\n\tlinks: [HTMLAnchorElement];\n\tsaveButton: HTMLButtonElement;\n\tloader: Loader;\n\tloadingPages: [string];\n\n\t/**\n\t * Constructor.\n\t */\n\tconstructor(options: {\n\t\tsiteId: number,\n\t\tlandingId: number,\n\t\tpages: {\n\t\t\t[code: string]: PageOption\n\t\t},\n\t\tmenuId: string,\n\t\tcontainerId: string,\n\t\tsaveButtonId: string,\n\t\tcancelButtonId: string,\n\t\ttype: string,\n\t\ttool: string,\n\t})\n\t{\n\t\tthis.siteId = options.siteId;\n\t\tthis.landingId = options.landingId;\n\t\tthis.type = options.type;\n\t\tthis.tool = options.tool;\n\n\t\t// pages\n\t\tthis.pages = options.pages;\n\t\tthis.container = document.getElementById(options.containerId);\n\t\tthis.menu = document.getElementById(options.menuId);\n\n\t\tfor (let page in this.pages)\n\t\t{\n\t\t\tthis.pages[page].container = Tag.render`<div class=\"landing-settings-page-container\"></div>`;\n\t\t\tDom.append(this.pages[page].container, this.container);\n\t\t}\n\t\tthis.loadingPages = [];\n\n\t\tthis.loaderContainer = Tag.render`<div class=\"landing-settings-loader-container\"></div>`;\n\t\tDom.insertAfter(this.loaderContainer, this.container);\n\t\tthis.loader = new Loader({target: this.loaderContainer});\n\n\t\t// links\n\t\tthis.links = [].slice.call(this.menu.querySelectorAll(LandingSettings.PAGE_LINK_SELECTOR));\n\t\tlet currentLink = this.links[0];\n\t\tthis.links.forEach(link => {\n\t\t\tthis.bindMenuLink(link);\n\n\t\t\tif (\n\t\t\t\tlink.dataset.page\n\t\t\t\t&& this.pages[link.dataset.page]\n\t\t\t\t&& this.pages[link.dataset.page].current === true\n\t\t\t)\n\t\t\t{\n\t\t\t\tcurrentLink = link;\n\t\t\t}\n\t\t});\n\t\tif (currentLink)\n\t\t{\n\t\t\tthis.onMenuLinkClick(currentLink, false);\n\t\t}\n\n\t\t// save\n\t\tthis.saveButton = document.getElementById(options.saveButtonId);\n\t\tthis.cancelButton = document.getElementById(options.cancelButtonId);\n\t\tthis.onSave = this.onSave.bind(this);\n\t\tthis.onCancel = this.onCancel.bind(this);\n\t\tEvent.bind(this.saveButton, 'click', this.onSave);\n\t\tBX.Event.EventEmitter.subscribe('SidePanel.Slider:onClose', () => {\n\t\t\tthis.onCancel();\n\t\t});\n\t}\n\n\tshowLoader()\n\t{\n\t\tthis.loader.show();\n\t\tDom.show(this.loaderContainer);\n\t}\n\n\thideLoader()\n\t{\n\t\tthis.loader.hide();\n\t\tDom.hide(this.loaderContainer);\n\t}\n\n\tbindMenuLink(link: HTMLAnchorElement)\n\t{\n\t\tEvent.bind(link, 'click', event => {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tthis.onMenuLinkClick(link)\n\t\t});\n\t}\n\n\tbindPageLink(pageLink: HTMLAnchorElement)\n\t{\n\t\tif (pageLink.dataset.page)\n\t\t{\n\t\t\tconst currentMenuLink = this.links.find(menuLink => menuLink.dataset.page === pageLink.dataset.page);\n\t\t\tif (currentMenuLink)\n\t\t\t{\n\t\t\t\tEvent.bind(pageLink, 'click', event => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tcurrentMenuLink.click();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tonMenuLinkClick(link: HTMLAnchorElement, isUserCLick: boolean = true)\n\t{\n\t\tthis.currentLink = link;\n\n\t\tif (link.dataset.page)\n\t\t{\n\t\t\tthis.onPageChange(link.dataset.page);\n\n\t\t\tif (isUserCLick)\n\t\t\t{\n\t\t\t\tBX.UI.Analytics.sendData({\n\t\t\t\t\ttool: this.tool,\n\t\t\t\t\tcategory: 'settings',\n\t\t\t\t\tevent: 'click_on_section',\n\t\t\t\t\tp1: this.getTypePageForMetrika(link.dataset.page),\n\t\t\t\t\tp3: `siteID_${this.siteId}`,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (link.dataset.placement)\n\t\t{\n\t\t\t// for open app pages in slider\n\t\t\tif (\n\t\t\t\ttypeof BX.rest !== 'undefined' &&\n\t\t\t\ttypeof BX.rest.Marketplace !== 'undefined'\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.rest.Marketplace.bindPageAnchors({});\n\t\t\t}\n\t\t\tBX.rest.AppLayout.openApplication(\n\t\t\t\tlink.dataset.appId,\n\t\t\t\t{\n\t\t\t\t\tSITE_ID: this.siteId,\n\t\t\t\t\tLID: this.landingId,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tPLACEMENT: link.dataset.placement,\n\t\t\t\t\tPLACEMENT_ID: link.dataset.placementId,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\tonPageChange(pageId: string)\n\t{\n\t\tconst pageToLoad = this.pages[pageId];\n\t\tif (pageToLoad)\n\t\t{\n\t\t\tif (pageToLoad.container.childNodes.length === 0)\n\t\t\t{\n\t\t\t\tthis.showLoader();\n\t\t\t\tthis.loadingPages.push(pageId);\n\t\t\t\tAjax.get(pageToLoad.link, result =>\n\t\t\t\t{\n\t\t\t\t\tpageToLoad.container.innerHTML = result;\n\t\t\t\t\tthis.loadingPages.splice(this.loadingPages.indexOf(pageId), 1);\n\t\t\t\t\tif (this.loadingPages.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideLoader();\n\t\t\t\t\t}\n\t\t\t\t\tconst form = pageToLoad.container.querySelector('form.landing-form');\n\t\t\t\t\tif (form)\n\t\t\t\t\t{\n\t\t\t\t\t\tpageToLoad.form = form;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst pageLinks = pageToLoad.container.querySelectorAll(LandingSettings.PAGE_LINK_SELECTOR);\n\t\t\t\t\tif (pageLinks.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tpageLinks.forEach(link => this.bindPageLink(link));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.currentPage)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.currentPage.container.hidden = true;\n\t\t\t\t\t}\n\t\t\t\t\tthis.currentPage = pageToLoad;\n\t\t\t\t\tthis.currentPage.container.hidden = false;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.currentPage)\n\t\t\t\t{\n\t\t\t\t\tthis.currentPage.container.hidden = true;\n\t\t\t\t}\n\t\t\t\tthis.currentPage = pageToLoad;\n\t\t\t\tthis.currentPage.container.hidden = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tonSave()\n\t{\n\t\tBX.UI.Analytics.sendData({\n\t\t\ttool: this.tool,\n\t\t\tcategory: 'settings',\n\t\t\tevent: 'save',\n\t\t\tp1: this.getTypePageForMetrika(this.currentLink.dataset.page),\n\t\t\tp3: `siteID_${this.siteId}`,\n\t\t});\n\n\t\tthis.showLoader();\n\n\t\tconst submits = [];\n\t\tfor (let page in this.pages)\n\t\t{\n\t\t\tconst currPage = this.pages[page];\n\t\t\tif (currPage.form)\n\t\t\t{\n\t\t\t\tsubmits.push(\n\t\t\t\t\tfetch(currPage.linkToSave, {\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tbody: new FormData(currPage.form),\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Bx-ajax': true,\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tPromise.all(submits)\n\t\t\t.then((results: [Response]) =>\n\t\t\t{\n\t\t\t\tlet all = true;\n\t\t\t\tresults.forEach(result => {\n\t\t\t\t\tall = all && result.ok;\n\t\t\t\t});\n\t\t\t\tif (all)\n\t\t\t\t{\n\t\t\t\t\ttop.window['landingSettingsSaved'] = true;\n\t\t\t\t\ttop.BX.onCustomEvent('BX.Landing.Filter:apply');\n\t\t\t\t\tthis.hideLoader();\n\t\t\t\t\tDom.removeClass(this.saveButton, 'ui-btn-wait');\n\n\t\t\t\t\tconst previous = BX.SidePanel.Instance.getPreviousSlider();\n\t\t\t\t\tif (previous)\n\t\t\t\t\t{\n\t\t\t\t\t\tprevious.reload();\n\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.window.location.reload();\n\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error(err);\n\t\t\t});\n\t}\n\n\tonCancel()\n\t{\n\t\tBX.UI.Analytics.sendData({\n\t\t\ttool: this.tool,\n\t\t\tcategory: 'settings',\n\t\t\tevent: 'close',\n\t\t\tp1: this.getTypePageForMetrika(this.currentLink.dataset.page),\n\t\t\tp3: `siteID_${this.siteId}`,\n\t\t});\n\t}\n\n\tgetTypePageForMetrika(typePage: string): string\n\t{\n\t\tlet type = '';\n\t\tswitch (typePage)\n\t\t{\n\t\t\tcase 'SITE_EDIT':\n\t\t\t\ttype = 'site_settings';\n\t\t\t\tbreak;\n\t\t\tcase 'SITE_DESIGN':\n\t\t\t\ttype = 'site_design';\n\t\t\t\tbreak;\n\t\t\tcase 'LANDING_EDIT':\n\t\t\t\ttype = 'page_settings';\n\t\t\t\tbreak;\n\t\t\tcase 'LANDING_DESIGN':\n\t\t\t\ttype = 'page_design';\n\t\t\t\tbreak;\n\t\t\tcase 'CATALOG_EDIT':\n\t\t\t\ttype = 'catalog_settings';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttype = typePage;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn type;\n\t}\n}"],"names":["LandingSettings","options","siteId","landingId","type","tool","pages","container","document","getElementById","containerId","menu","menuId","page","Tag","render","Dom","append","loadingPages","loaderContainer","insertAfter","loader","Loader","target","links","slice","call","querySelectorAll","PAGE_LINK_SELECTOR","currentLink","forEach","link","bindMenuLink","dataset","current","onMenuLinkClick","saveButton","saveButtonId","cancelButton","cancelButtonId","onSave","bind","onCancel","Event","BX","EventEmitter","subscribe","show","hide","event","preventDefault","stopPropagation","pageLink","currentMenuLink","find","menuLink","click","isUserCLick","onPageChange","UI","Analytics","sendData","category","p1","getTypePageForMetrika","p3","placement","rest","Marketplace","bindPageAnchors","AppLayout","openApplication","appId","SITE_ID","LID","PLACEMENT","PLACEMENT_ID","placementId","pageId","pageToLoad","childNodes","length","showLoader","push","Ajax","get","result","innerHTML","splice","indexOf","hideLoader","form","querySelector","pageLinks","bindPageLink","currentPage","hidden","submits","currPage","fetch","linkToSave","method","body","FormData","headers","Promise","all","then","results","ok","top","window","onCustomEvent","removeClass","previous","SidePanel","Instance","getPreviousSlider","reload","close","location","err","console","error","typePage"],"mappings":"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"}